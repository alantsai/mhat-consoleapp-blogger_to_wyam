<?xml version='1.0' encoding='UTF-8'?><?xml-stylesheet href="https://www.blogger.com/styles/atom.css" type="text/css"?><feed xmlns='http://www.w3.org/2005/Atom' xmlns:openSearch='http://a9.com/-/spec/opensearchrss/1.0/' xmlns:gd='http://schemas.google.com/g/2005' xmlns:thr='http://purl.org/syndication/thread/1.0' xmlns:georss='http://www.georss.org/georss'><id>tag:blogger.com,1999:blog-7924743034677720383.archive</id><updated>2018-03-27T18:31:46.928+08:00</updated><title type='text'>Alan Tsai 的學習筆記</title><link rel='http://schemas.google.com/g/2005#feed' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/archive'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/archive'/><link rel='http://schemas.google.com/g/2005#post' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/archive'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/'/><author><name>Alan Tsai</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><generator version='7.00' uri='https://www.blogger.com'>Blogger</generator><entry><id>tag:blogger.com,1999:blog-7924743034677720383.layout</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#template'/><title type='text'>範本: Alan Tsai 的學習筆記</title><content type='text'>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE html&gt;
&lt;html b:version='2' class='v2' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr' xmlns:og='http://ogp.me/ns#'&gt;
  &lt;head&gt;
    &lt;!-- bing webmaster auth --&gt;
    &lt;meta content='EA3A6B1EDDA2B1FEC8F0A565D0789804' name='msvalidate.01'/&gt;
	&lt;!-- ce.baidu.com --&gt;
    &lt;meta baidu-gxt-verify-token='5368bba11be8f2b0cf71b0d936c16710'/&gt;
	&lt;!-- http://zhanzhang.baidu.com/ --&gt;
    &lt;meta content='juVRO09Xbe' name='baidu-site-verification'/&gt;

	&lt;!-- fb instant article --&gt;
	&lt;meta content='1913208602235313' property='fb:pages'/&gt;

    &lt;meta content='zh-TW' http-equiv='content-language'/&gt;
    &lt;b:if cond='data:blog.isMobile'&gt;
      &lt;meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0' name='viewport'/&gt;
      &lt;b:else/&gt;
      &lt;meta content='width=1100' name='viewport'/&gt;
    &lt;/b:if&gt;
		
    &lt;b:include data='blog' name='all-head-content'/&gt;
    &lt;b:if cond='data:blog.pageType == &amp;quot;item&amp;quot;'&gt;
		&lt;title&gt;
			&lt;data:blog.pageName/&gt; &amp;#65312; &lt;data:blog.title/&gt;&amp;#65372;An Asp .Net Mvc Web Developer Blog
		&lt;/title&gt;
	&lt;b:else/&gt;
		&lt;title&gt;
			&lt;data:blog.pageTitle/&gt;&amp;#65372;An Asp .Net Mvc Web Developer Blog
		&lt;/title&gt;
	&lt;/b:if&gt;
    &lt;b:skin&gt;&lt;![CDATA[
      /*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Josh Peterson
URL:      www.noaesthetic.com
----------------------------------------------- */
/* Variable definitions
====================
&lt;Variable name="keycolor" description="Main Color" type="color" default="#66bbdd" value="#66bbdd"/&gt;
&lt;Group description="Page Text" selector="body"&gt;
&lt;Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
&lt;Variable name="body.text.color" description="Text Color" type="color" default="#222222" value="#222222"/&gt;
&lt;/Group&gt;
&lt;Group description="Backgrounds" selector=".body-fauxcolumns-outer"&gt;
&lt;Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd" value="#66bbdd"/&gt;
&lt;Variable name="content.background.color" description="Main Background" type="color" default="#ffffff" value="#ffffff"/&gt;
&lt;Variable name="header.background.color" description="Header Background" type="color" default="transparent" value="transparent"/&gt;
&lt;/Group&gt;
&lt;Group description="Links" selector=".main-outer"&gt;
&lt;Variable name="link.color" description="Link Color" type="color" default="#2288bb" value="#2288bb"/&gt;
&lt;Variable name="link.visited.color" description="Visited Color" type="color" default="#888888" value="#888888"/&gt;
&lt;Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff" value="#33aaff"/&gt;
&lt;/Group&gt;
&lt;Group description="Blog Title" selector=".header H2"&gt;
&lt;Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
&lt;Variable name="header.text.color" description="Title Color" type="color" default="#3399bb"  value="#3399bb"/&gt;
&lt;/Group&gt;
&lt;Group description="Blog Description" selector=".header .description"&gt;
&lt;Variable name="description.text.color" description="Description Color" type="color"
default="#777777"  value="#777777"/&gt;
&lt;/Group&gt;
&lt;Group description="Tabs Text" selector=".tabs-inner .widget li a"&gt;
&lt;Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
&lt;Variable name="tabs.text.color" description="Text Color" type="color" default="#999999" value="#999999"/&gt;
&lt;Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000" value="#000000"/&gt;
&lt;/Group&gt;
&lt;Group description="Tabs Background" selector=".tabs-outer .PageList"&gt;
&lt;Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5" value="#f5f5f5"/&gt;
&lt;Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
&lt;/Group&gt;
&lt;Group description="Post Title" selector="H1.post-title, .comments h4"&gt;
&lt;Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
&lt;/Group&gt;
&lt;Group description="Date Header" selector=".date-header"&gt;
&lt;Variable name="date.header.color" description="Text Color" type="color"
default="$(body.text.color)" value="#222222"/&gt;
&lt;Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent" value="transparent"/&gt;
&lt;/Group&gt;
&lt;Group description="Post Footer" selector=".post-footer"&gt;
&lt;Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666" value="#666666"/&gt;
&lt;Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9" value="#f9f9f9"/&gt;
&lt;Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
&lt;/Group&gt;
&lt;Group description="Gadgets" selector="H5"&gt;
&lt;Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
&lt;Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000" value="#000000"/&gt;
&lt;Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999" value="#999999"/&gt;
&lt;/Group&gt;
&lt;Group description="Images" selector=".main-inner"&gt;
&lt;Variable name="image.background.color" description="Background Color" type="color" default="#ffffff" value="#ffffff"/&gt;
&lt;Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
&lt;Variable name="image.text.color" description="Caption Text Color" type="color" default="$(body.text.color)" value="#222222"/&gt;
&lt;/Group&gt;
&lt;Group description="Accents" selector=".content-inner"&gt;
&lt;Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
&lt;Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="$(body.rule.color)" value="#eeeeee"/&gt;
&lt;/Group&gt;
&lt;Variable name="body.background" description="Body Background" type="background"
color="$(body.background.color)" default="$(color) none repeat scroll top left" value="$(color) none repeat scroll top left"/&gt;
&lt;Variable name="body.background.override" description="Body Background Override" type="string" default="" value=""/&gt;
&lt;Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(//www.blogblog.com/1kt/simple/gradients_light.png)" value="url(//www.blogblog.com/1kt/simple/gradients_light.png)"/&gt;
&lt;Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(//www.blogblog.com/1kt/simple/body_gradient_tile_light.png)" value="url(//www.blogblog.com/1kt/simple/body_gradient_tile_light.png)"/&gt;
&lt;Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner" value=".content-inner"/&gt;
&lt;Variable name="content.padding" description="Content Padding" type="length" default="10px" value="10px"/&gt;
&lt;Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="$(content.padding)" value="10px"/&gt;
&lt;Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" value="40px"/&gt;
&lt;Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" value="5px"/&gt;
&lt;Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" value="10px"/&gt;
&lt;Variable name="main.border.width" description="Main Border Width" type="length" default="0" value="0"/&gt;
&lt;Variable name="header.background.gradient" description="Header Gradient" type="url" default="none" value="none"/&gt;
&lt;Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" value="-1px"/&gt;
&lt;Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" value="-1px"/&gt;
&lt;Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" value="1px"/&gt;
&lt;Variable name="header.padding" description="Header Padding" type="length" default="30px" value="30px"/&gt;
&lt;Variable name="header.border.size" description="Header Border Size" type="length" default="1px" value="1px"/&gt;
&lt;Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="$(header.border.size)" value="1px"/&gt;
&lt;Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" value="0"/&gt;
&lt;Variable name="description.text.size" description="Description Text Size" type="string" default="140%" value="140%"/&gt;
&lt;Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0"  value="0"/&gt;
&lt;Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px"  value="30px"/&gt;
&lt;Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(//www.blogblog.com/1kt/simple/gradients_light.png)" value="url(//www.blogblog.com/1kt/simple/gradients_light.png)"/&gt;
&lt;Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" value="1px"/&gt;
&lt;Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" value="1px"/&gt;
&lt;Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit" value="inherit"/&gt;
&lt;Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit" value="inherit"/&gt;
&lt;Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit" value="inherit"/&gt;
&lt;Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" value="25px"/&gt;
&lt;Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" value="2px"/&gt;
&lt;Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" value="5px"/&gt;
&lt;Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner" value=".region-inner"/&gt;
&lt;Variable name="page.width" description="Page Width" type="string" default="auto" value="auto"/&gt;
&lt;Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" value="15px"/&gt;
&lt;Variable name="main.padding" description="Main Padding" type="length" default="15px" value="15px"/&gt;
&lt;Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" value="30px"/&gt;
&lt;Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" value="30px"/&gt;
&lt;Variable name="paging.background"
color="$(content.background.color)"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center" value="transparent none no-repeat scroll top center"/&gt;
&lt;Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" value="0"/&gt;
&lt;Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left" value="transparent none repeat scroll top left"/&gt;
&lt;Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto" value="auto"/&gt;
&lt;Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff"  value="#ffffff"/&gt;
&lt;Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/&gt;
&lt;Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/&gt;
*/
/* Content
----------------------------------------------- */
body {
/*font: $(body.font);*/
font-family:"文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", "Microsoft YaHei", sans-serif
color: $(body.text.color);
background: $(body.background);
padding: 0 $(content.shadow.spread) $(content.shadow.spread) $(content.shadow.spread);
$(body.background.override)
}
html body $(page.width.selector) {
min-width: 0;
max-width: 100%;
width: $(page.width);
}
a:link {
color: $(link.color);
}
a:visited {
color: $(link.visited.color);
}
a:hover {
text-decoration:underline;
color: $(link.hover.color);
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent $(body.background.gradient.tile) repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
background: $(body.background);
$(body.background.override)
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent $(body.background.gradient.cap) repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 $(content.shadow.spread) rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 $(content.shadow.spread.webkit) rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 $(content.shadow.spread.ie) #333333;
box-shadow: 0 0 $(content.shadow.spread) rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: $(content.padding) $(content.padding.horizontal);
}
$(content.background.color.selector) {
background-color: $(content.background.color);
}
/* Header
----------------------------------------------- */
.header-outer {
background: $(header.background.color) $(header.background.gradient) repeat-x scroll 0 -400px;
_background-image: none;
}
.Header H2 {
font: $(header.font);
color: $(header.text.color);
text-shadow: $(header.shadow.offset.left) $(header.shadow.offset.top) $(header.shadow.spread) rgba(0, 0, 0, .2);
}
.Header H2 a {
color: $(header.text.color);
}
.Header .description {
/*font-size: $(description.text.size);*/
/*color: $(description.text.color);*/
color: #798f9d;
margin: 0;
padding: 0;
font-size: 24px;
font-family: "文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", "Microsoft Yahei", sans-serif
}
.header-inner .Header .titlewrapper {
padding: 22px $(header.padding);
}
.header-inner .Header .descriptionwrapper {
padding: 0 $(header.padding);
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: $(header.bottom.border.size) solid $(tabs.border.color);
}
.tabs-inner .section:first-child ul {
margin-top: -$(header.border.size);
border-top: $(header.border.size) solid $(tabs.border.color);
border-left: $(header.border.horizontalsize) solid $(tabs.border.color);
border-right: $(header.border.horizontalsize) solid $(tabs.border.color);
}
.tabs-inner .widget ul {
background: $(tabs.background.color) $(tabs.background.gradient) repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: $(tabs.border.width) solid $(tabs.border.color);
margin-top: $(tabs.margin.top);
margin-left: -$(tabs.margin.side);
margin-right: -$(tabs.margin.side);
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: $(tabs.font);
color: $(tabs.text.color);
border-$startSide: $(tabs.border.width) solid $(content.background.color);
border-$endSide: $(tabs.bevel.border.width) solid $(tabs.border.color);
}
.tabs-inner .widget li:first-child a {
border-$startSide: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: $(tabs.selected.text.color);
background-color: $(tabs.selected.background.color);
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: $(main.border.width) solid $(body.rule.color);
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid $(body.rule.color);
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid $(body.rule.color);
}
/* Headings
----------------------------------------------- 
H5 {
margin: 0 0 1em 0;
font: $(widget.title.font);
color: $(widget.title.text.color);
}
*/
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: $(widget.alternate.text.color);
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
.date-header span {
background-color: $(date.header.background.color);
color: $(date.header.color);
padding: $(date.header.padding);
letter-spacing: $(date.header.letterspacing);
margin: $(date.header.margin);
}
.main-inner {
padding-top: $(main.padding.top);
padding-bottom: $(main.padding.bottom);
}
.main-inner .column-center-inner {
padding: 0 $(main.padding);
}
.main-inner .column-center-inner .section {
margin: 0 $(main.section.margin);
}
.post {
margin: 0 0 $(post.margin.bottom) 0;
}
H1.post-title, .comments h4 {
/*font: $(post.title.font);*/
/*margin: .75em 0 0;*/
font: normal bold 1.7rem "全字庫正楷體", TW-Kai, "Yu Gothic", "Ms PGothic", SimHei, DFKai-SB, sans-serif;
margin: .75em 0 0;
}
.post-body {
/*font-size: 110%;
line-height: 1.4;
position: relative;*/
line-height: 1.5;
letter-spacing: 1.4px;
font-family: "文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", Meiryo, "微軟正黑體", "Microsoft JhengHei", sans-serif;
font-size: 1.1rem
}
/*
.post-body H5,
.post-body H1,
.post-body h4 {
font-family: "文泉驛正黑", "WenQuanYi Zen Hei", "儷黑 Pro", "LiHei Pro", "Microsoft YaHei", sans-serif;
font-size: 1.25rem;
color: #0b5394;
background-color: #fff;
border: 1px solid #8abeb7;
border-radius: 3px;
margin: 20px 0;
padding: 7px 10px;
border-left: 5px solid #8abeb7;
display: inline-block;
}
*/
.post-body H1,
.post-body H2,
.post-body H3,
.post-body H5,
.post-body h4 {
font: normal bold 1.5rem "全字庫正楷體", TW-Kai, "Yu Gothic", "Ms PGothic", SimHei, DFKai-SB, sans-serif;
margin: .75em 0 0;
}
.post-body H1{
font-size: 1.5em
}
.post-body H2{
font-size: 1.4em
}
.post-body H3{
font-size: 1.2em
}
.post-body h4{
font-size: 1.1em
}
.post-body H5{
font-size: 1.0em
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: $(image.border.small.size);
background: $(image.background.color);
border: 1px solid $(image.border.color);
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: $(image.border.large.size);
}
.post-body .tr-caption-container {
color: $(image.text.color);
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: $(post.footer.text.color);
background-color: $(post.footer.background.color);
border-bottom: 1px solid $(post.footer.border.color);
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid $(body.rule.color);
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid $(image.border.color);
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid $(widget.alternate.text.color);
border-bottom: 1px solid $(widget.alternate.text.color);
}
.comments .comment-thread.inline-thread {
background-color: $(post.footer.background.color);
}
.comments .continue {
border-top: 2px solid $(widget.alternate.text.color);
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-$startSide: 1px solid $(body.rule.color);
}
.blog-pager {
background: $(paging.background);
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: $(content.background.color);
padding: 5px;
}
.footer-outer {
border-top: $(footer.bevel) dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: $(mobile.background.size);
}
.mobile .body-fauxcolumn-outer {
background: $(mobile.background.overlay);
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
body.mobile .AdSense {
margin: 0 -$(content.shadow.spread);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile H1.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: $(content.background.color);
}
.mobile-index-contents {
color: $(body.text.color);
}
.mobile-link-button {
background-color: $(link.color);
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: $(mobile.button.color);
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: $(tabs.selected.background.color);
color: $(tabs.selected.text.color);
border-top: $(tabs.border.width) solid $(tabs.border.color);
border-bottom: $(tabs.border.width) solid $(tabs.border.color);
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-$startSide: 1px solid $(tabs.border.color);
}

    ]]&gt;&lt;/b:skin&gt;
    &lt;b:template-skin&gt;
      &lt;b:variable default='960px' name='content.width' type='length'/&gt;
      &lt;b:variable default='0' name='main.column.left.width' type='length'/&gt;
      &lt;b:variable default='310px' name='main.column.right.width' type='length'/&gt;
      &lt;![CDATA[
body {
min-width: $(content.width);
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: $(content.width);
max-width: 1280px;
_width: $(content.width);
}
.main-inner .columns {
padding-left: $(main.column.left.width);
padding-right: $(main.column.right.width);
}
.main-inner .fauxcolumn-center-outer {
left: $(main.column.left.width);
right: $(main.column.right.width);
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("$(main.column.left.width)") -
parseInt("$(main.column.right.width)") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: $(main.column.left.width);
}
.main-inner .fauxcolumn-right-outer {
width: $(main.column.right.width);
}
.main-inner .column-left-outer {
width: $(main.column.left.width);
right: 100%;
margin-left: -$(main.column.left.width);
}
.main-inner .column-right-outer {
width: $(main.column.right.width);
margin-right: -$(main.column.right.width);
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
]]&gt;
    &lt;/b:template-skin&gt;
    &lt;b:include data='blog' name='google-analytics'/&gt;
    &lt;link href='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreDefault.min.css' rel='stylesheet' type='text/css'/&gt;
    &lt;!-- Syntax highlighter end --&gt;
    &lt;link href='https://dl.dropboxusercontent.com/s/maqwai26jgftqgq/Callout.css' rel='stylesheet' type='text/css'/&gt;
    &lt;link href='https://dl.dropboxusercontent.com/s/yui7xkn97wkonlr/main.css' rel='stylesheet' type='text/css'/&gt;
    &lt;link href='https://dl.dropboxusercontent.com/s/66wn9k3u2dn7cqc/dl.css' rel='stylesheet' type='text/css'/&gt;
    &lt;style&gt;
      a{
        color: blue;
      }
    &lt;/style&gt;
    &lt;!-- Custom hide widget --&gt;
    &lt;style&gt;
      .tabs .widget h5{
        display: none;
      }
      .sidebar .widget h5{
        margin: 0px;
        margin-bottom: 5px;
        font-weight: bold;
        font-size: 1.0rem;
      }
    &lt;/style&gt;
	&lt;!-- custom search result title --&gt;
	&lt;style&gt;
	.gs-title{
		font-weight: bold;
    	font-size: 1.1em;
      }
	&lt;/style&gt;
	&lt;style&gt;
      code{
        padding: 2px 4px;
        font-size: 90%;
        color: #c7254e;
        font-family: Menlo,Monaco,Consolas,&amp;quot;Courier New&amp;quot;,monospace;
      }
  	&lt;/style&gt;
  &lt;style&gt;
	table {
		border-collapse: collapse;
	}

	table, td, th {
		border: 1px solid black;
	}

	th {
		background-color: green;
		color: white;
	}
  &lt;/style&gt;
	&lt;!-- Facebook og 與 Google meta 設定 begin --&gt;
	&lt;meta expr:content='data:blog.title　+ &amp;quot;｜An Asp .Net Mvc Web Developer Blog&amp;quot;' property='og:site_name'/&gt;
	&lt;meta content='https://www.facebook.com/alantsai.blog/' property='article:author'/&gt;
	&lt;meta expr:content='data:blog.metaDescription' itemprop='description' name='twitter:description' property='og:description'/&gt;
	&lt;meta content='@alantsai2007' name='twitter:site'/&gt;
	&lt;meta content='@alantsai2007' name='twitter:creator'/&gt;
	&lt;meta content='zh_TW' property='og:locale'/&gt; &lt;!-- 區域 --&gt;
	&lt;meta content='zh_CN' property='og:locale:alternate'/&gt; &lt;!-- 第二區域&amp;#65292; 簡中 --&gt;
	&lt;meta content='100000114892057' property='fb:admins'/&gt; 
	&lt;meta content='191958384621274' property='fb:app_id'/&gt;
	  &lt;b:if cond='data:blog.pageType == &amp;quot;index&amp;quot;'&gt;
		&lt;meta content='blog' property='og:type'/&gt;
		&lt;meta expr:content='data:blog.title + &amp;quot;｜An Asp .Net Mvc Web Developer Blog&amp;quot;' itemprop='name' name='twitter:title' property='og:title'/&gt;
		&lt;meta content='Asp .Net Mvc, .Net, .Net Framework, C#, Linq, AngularJS, Typescript' itemprop='keywords'/&gt;
		&lt;!-- 部落格網址--&gt;
		&lt;meta content='http://1.gravatar.com/avatar/e1ae813d9d045bf8ec50264f8be7b026' itemprop='image' property='og:image'/&gt;
	  &lt;b:else/&gt;
		&lt;meta content='article' property='og:type'/&gt;
		&lt;meta expr:content='data:blog.pageName + &amp;quot; ＠ &amp;quot; + data:blog.title + &amp;quot; ｜ An Asp .Net Mvc Web Developer Blog&amp;quot;' itemprop='name' name='twitter:title' property='og:title'/&gt;
		&lt;meta expr:content='data:blog.pageName' itemprop='keywords'/&gt;
		&lt;meta content='summary' name='twitter:card'/&gt;
		  &lt;b:if cond='data:blog.postImageUrl'&gt;
				&lt;meta expr:content='data:blog.postImageUrl' itemprop='image' name='twitter:image:src' property='og:image'/&gt;
			&lt;b:else/&gt;
				&lt;!--文章沒有圖片預設圖片--&gt;
				&lt;meta content='http://1.gravatar.com/avatar/e1ae813d9d045bf8ec50264f8be7b026' itemprop='image' name='twitter:image:src' property='og:image'/&gt;
		  &lt;/b:if&gt;
	  &lt;/b:if&gt;
	  

&lt;!-- Facebook og 與 Google meta 設定 end --&gt;
&lt;!--google adsense start--&gt;
&lt;script async='async' src='//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'/&gt;
&lt;script&gt;
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: &amp;quot;ca-pub-6404650808640047&amp;quot;,
    enable_page_level_ads: true
  });
&lt;/script&gt;
&lt;!--google adsense end--&gt;
  &lt;/head&gt;
  &lt;body expr:class='&amp;quot;loading&amp;quot; + data:blog.mobileClass'&gt;

	&lt;!-- facebook analytics start --&gt;
&lt;script&gt;
  window.fbAsyncInit = function() {
    FB.init({
      appId      : &amp;#39;191958384621274&amp;#39;,
      xfbml      : true,
      version    : &amp;#39;v2.9&amp;#39;
    });
    FB.AppEvents.logPageView();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = &amp;quot;//connect.facebook.net/zh_TW/sdk.js&amp;quot;;
     fjs.parentNode.insertBefore(js, fjs);
   }(document, &amp;#39;script&amp;#39;, &amp;#39;facebook-jssdk&amp;#39;));
&lt;/script&gt;

	&lt;!-- facebook analytics end --&gt;
    &lt;b:section class='navbar' id='navbar' maxwidgets='1' showaddelement='no'&gt;
      &lt;b:widget id='Navbar1' locked='true' title='導覽列' type='Navbar' version='1'&gt;
        &lt;b:includable id='main'&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener(&amp;#39;load&amp;#39;,
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent(&amp;#39;onload&amp;#39;, function(){ object[attribute] = val; });
      }
    }
  &amp;lt;/script&amp;gt;
&amp;lt;div id=&amp;quot;navbar-iframe-container&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;https://apis.google.com/js/plusone.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      gapi.load(&amp;quot;gapi.iframes:gapi.iframes.style.bubble&amp;quot;, function() {
        if (gapi.iframes &amp;amp;&amp;amp; gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: &amp;#39;https://www.blogger.com/navbar.g?targetBlogID\x3d7924743034677720383\x26blogName\x3dAlan+Tsai+%E7%9A%84%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98\x26publishMode\x3dPUBLISH_MODE_HOSTED\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttp://blog.alantsai.net/search\x26blogLocale\x3dzh_TW\x26v\x3d2\x26homepageUrl\x3dhttp://blog.alantsai.net/\x26vt\x3d54687834017881515&amp;#39;,
              where: document.getElementById(&amp;quot;navbar-iframe-container&amp;quot;),
              id: &amp;quot;navbar-iframe&amp;quot;
          });
        }
      });
    &amp;lt;/script&amp;gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
(function() {
var script = document.createElement(&amp;#39;script&amp;#39;);
script.type = &amp;#39;text/javascript&amp;#39;;
script.src = &amp;#39;//pagead2.googlesyndication.com/pagead/js/google_top_exp.js&amp;#39;;
var head = document.getElementsByTagName(&amp;#39;head&amp;#39;)[0];
if (head) {
head.appendChild(script);
}})();
&amp;lt;/script&amp;gt;
&lt;/b:includable&gt;
      &lt;/b:widget&gt;
    &lt;/b:section&gt;
    &lt;b:if cond='data:blog.pageType == &amp;quot;index&amp;quot;'&gt;
      &lt;div itemscope='itemscope' itemtype='http://schema.org/Blog' style='display: none;'&gt;
        &lt;meta expr:content='data:blog.title' itemprop='name'/&gt;
        &lt;b:if cond='data:blog.metaDescription'&gt;
          &lt;meta expr:content='data:blog.metaDescription' itemprop='description'/&gt;
        &lt;/b:if&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;
    &lt;div class='body-fauxcolumns'&gt;
      &lt;div class='fauxcolumn-outer body-fauxcolumn-outer'&gt;
        &lt;div class='cap-top'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;div class='fauxborder-left'&gt;
          &lt;div class='fauxborder-right'/&gt;
          &lt;div class='fauxcolumn-inner'&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class='cap-bottom'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='content'&gt;
      &lt;div class='content-fauxcolumns'&gt;
        &lt;div class='fauxcolumn-outer content-fauxcolumn-outer'&gt;
          &lt;div class='cap-top'&gt;
            &lt;div class='cap-left'/&gt;
            &lt;div class='cap-right'/&gt;
          &lt;/div&gt;
          &lt;div class='fauxborder-left'&gt;
            &lt;div class='fauxborder-right'/&gt;
            &lt;div class='fauxcolumn-inner'&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div class='cap-bottom'&gt;
            &lt;div class='cap-left'/&gt;
            &lt;div class='cap-right'/&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class='content-outer'&gt;
        &lt;div class='content-cap-top cap-top'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;div class='fauxborder-left content-fauxborder-left'&gt;
          &lt;div class='fauxborder-right content-fauxborder-right'/&gt;
          &lt;div class='content-inner'&gt;
            &lt;header&gt;
              &lt;div class='header-outer'&gt;
                &lt;div class='header-cap-top cap-top'&gt;
                  &lt;div class='cap-left'/&gt;
                  &lt;div class='cap-right'/&gt;
                &lt;/div&gt;
                &lt;div class='fauxborder-left header-fauxborder-left'&gt;
                  &lt;div class='fauxborder-right header-fauxborder-right'/&gt;
                  &lt;div class='region-inner header-inner'&gt;
                    &lt;b:section class='header' id='header' maxwidgets='1' showaddelement='no'&gt;
                      &lt;b:widget id='Header1' locked='true' title='Alan Tsai 的學習筆記 (標頭)' type='Header' version='1'&gt;
                        &lt;b:widget-settings&gt;
                          &lt;b:widget-setting name='displayUrl'/&gt;
                          &lt;b:widget-setting name='displayHeight'&gt;0&lt;/b:widget-setting&gt;
                          &lt;b:widget-setting name='sectionWidth'&gt;-1&lt;/b:widget-setting&gt;
                          &lt;b:widget-setting name='useImage'&gt;false&lt;/b:widget-setting&gt;
                          &lt;b:widget-setting name='shrinkToFit'&gt;false&lt;/b:widget-setting&gt;
                          &lt;b:widget-setting name='imagePlacement'&gt;BEHIND&lt;/b:widget-setting&gt;
                          &lt;b:widget-setting name='displayWidth'&gt;0&lt;/b:widget-setting&gt;
                        &lt;/b:widget-settings&gt;
                        &lt;b:includable id='main'&gt;
                          &lt;b:if cond='data:useImage'&gt;
                            &lt;b:if cond='data:imagePlacement == &amp;quot;BEHIND&amp;quot;'&gt;
                              &lt;!--
Show image as background to text. You can't really calculate the width
reliably in JS because margins are not taken into account by any of
clientWidth, offsetWidth or scrollWidth, so we don't force a minimum
width if the user is using shrink to fit.
This results in a margin-width's worth of pixels being cropped. If the
user is not using shrink to fit then we expand the header.
--&gt;
                              &lt;b:if cond='data:mobile'&gt;
                                &lt;div id='header-inner'&gt;
                                  &lt;div class='titlewrapper' style='background: transparent'&gt;
                                    &lt;H2 class='title' style='background: transparent; border-width: 0px'&gt;
                                      &lt;b:include name='title'/&gt;
                                    &lt;/H2&gt;
                                  &lt;/div&gt;
                                  &lt;b:include name='description'/&gt;
                                &lt;/div&gt;
                                &lt;b:else/&gt;
                                &lt;div expr:style='&amp;quot;background-image: url(\&amp;quot;&amp;quot; + data:sourceUrl + &amp;quot;\&amp;quot;); &amp;quot;                        + &amp;quot;background-position: &amp;quot;                        + data:backgroundPositionStyleStr + &amp;quot;; &amp;quot;                        + data:widthStyleStr                        + &amp;quot;min-height: &amp;quot; + data:height                        + &amp;quot;_height: &amp;quot; + data:height                        + &amp;quot;background-repeat: no-repeat; &amp;quot;' id='header-inner'&gt;
                                  &lt;div class='titlewrapper' style='background: transparent'&gt;
                                    &lt;H2 class='title' style='background: transparent; border-width: 0px'&gt;
                                      &lt;b:include name='title'/&gt;
                                    &lt;/H2&gt;
                                  &lt;/div&gt;
                                  &lt;b:include name='description'/&gt;
                                &lt;/div&gt;
                              &lt;/b:if&gt;
                              &lt;b:else/&gt;
                              &lt;!--Show the image only--&gt;
                              &lt;div id='header-inner'&gt;
                                &lt;a expr:href='data:blog.homepageUrl' style='display: block'&gt;
                                  &lt;img expr:alt='data:title' expr:height='data:height' expr:id='data:widget.instanceId + &amp;quot;_headerimg&amp;quot;' expr:src='data:sourceUrl' expr:width='data:width' style='display: block'/&gt;
                                &lt;/a&gt;
                                &lt;!--Show the description--&gt;
                                &lt;b:if cond='data:imagePlacement == &amp;quot;BEFORE_DESCRIPTION&amp;quot;'&gt;
                                  &lt;b:include name='description'/&gt;
                                &lt;/b:if&gt;
                              &lt;/div&gt;
                            &lt;/b:if&gt;
                            &lt;b:else/&gt;
                            &lt;!--No header image --&gt;
                            &lt;div id='header-inner'&gt;
                              &lt;div class='titlewrapper'&gt;
                                &lt;H2 class='title'&gt;
                                  &lt;b:include name='title'/&gt;
                                &lt;/H2&gt;
                              &lt;/div&gt;
                              &lt;b:include name='description'/&gt;
                            &lt;/div&gt;
                          &lt;/b:if&gt;
                        &lt;/b:includable&gt;
                        &lt;b:includable id='description'&gt;
                          &lt;div class='descriptionwrapper'&gt;
                            &lt;p class='description'&gt;
                              &lt;span&gt;
                                &lt;data:description/&gt;
                              &lt;/span&gt;
                            &lt;/p&gt;
                          &lt;/div&gt;
                        &lt;/b:includable&gt;
                        &lt;b:includable id='title'&gt;
                          &lt;b:if cond='data:blog.url == data:blog.homepageUrl'&gt;
                            &lt;data:title/&gt;
                            &lt;b:else/&gt;
                            &lt;a expr:href='data:blog.homepageUrl'&gt;
                              &lt;data:title/&gt;
                            &lt;/a&gt;
                          &lt;/b:if&gt;
                        &lt;/b:includable&gt;
                      &lt;/b:widget&gt;
                    &lt;/b:section&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class='header-cap-bottom cap-bottom'&gt;
                  &lt;div class='cap-left'/&gt;
                  &lt;div class='cap-right'/&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/header&gt;
            &lt;div class='tabs-outer'&gt;
              &lt;div class='tabs-cap-top cap-top'&gt;
                &lt;div class='cap-left'/&gt;
                &lt;div class='cap-right'/&gt;
              &lt;/div&gt;
              &lt;div class='fauxborder-left tabs-fauxborder-left'&gt;
                &lt;div class='fauxborder-right tabs-fauxborder-right'/&gt;
                &lt;div class='region-inner tabs-inner'&gt;
                  &lt;b:section class='tabs' id='crosscol' maxwidgets='1' showaddelement='yes'&gt;
                    &lt;b:widget id='PageList2' locked='false' title='網頁' type='PageList' version='1'&gt;
                      &lt;b:widget-settings&gt;
                        &lt;b:widget-setting name='pageListJson'&gt;&lt;![CDATA[{'home': {'href': 'http://blog.alantsai.net/', 'title': '首頁', 'position': 0}, 'link0': {'href': 'http://ln.alantsai.net', 'title': 'Linkedin', 'position': 1}, 'link1': {'href': 'http://fb.alantsai.net', 'title': 'FB', 'position': 2}, 'link2': {'href': 'http://slideshare.alantsai.net', 'title': 'SlideShare', 'position': 3}, 'link3': {'href': 'http://gh.alantsai.net', 'title': 'Github', 'position': 4}, 'link4': {'href': 'http://dotblog.alantsai.net/', 'title': '舊的部落格(點部落)', 'position': 5}}]]&gt;&lt;/b:widget-setting&gt;
                        &lt;b:widget-setting name='homeTitle'&gt;首頁&lt;/b:widget-setting&gt;
                      &lt;/b:widget-settings&gt;
                      &lt;b:includable id='main'&gt;
                        &lt;b:if cond='data:title'&gt;
                          &lt;H5&gt;
                            &lt;data:title/&gt;
                          &lt;/H5&gt;
                        &lt;/b:if&gt;
                        &lt;div class='widget-content'&gt;
                          &lt;b:if cond='data:mobile'&gt;
                            &lt;select expr:id='data:widget.instanceId + &amp;quot;_select&amp;quot;'&gt;
                              &lt;b:loop values='data:links' var='link'&gt;
                                &lt;b:if cond='data:link.isCurrentPage'&gt;
                                  &lt;option expr:value='data:link.href' selected='selected'&gt;
                                    &lt;data:link.title/&gt;
                                  &lt;/option&gt;
                                  &lt;b:else/&gt;
                                  &lt;option expr:value='data:link.href'&gt;
                                    &lt;data:link.title/&gt;
                                  &lt;/option&gt;
                                &lt;/b:if&gt;
                              &lt;/b:loop&gt;
                            &lt;/select&gt;
                            &lt;span class='pagelist-arrow'&gt;
                              &amp;amp;#9660;
                            &lt;/span&gt;
                            &lt;b:else/&gt;
                            &lt;ul&gt;
                              &lt;b:loop values='data:links' var='link'&gt;
                                &lt;b:if cond='data:link.isCurrentPage'&gt;
                                  &lt;li class='selected'&gt;
                                    &lt;a expr:href='data:link.href'&gt;
                                      &lt;data:link.title/&gt;
                                    &lt;/a&gt;
                                  &lt;/li&gt;
                                  &lt;b:else/&gt;
                                  &lt;li&gt;
                                    &lt;a expr:href='data:link.href'&gt;
                                      &lt;data:link.title/&gt;
                                    &lt;/a&gt;
                                  &lt;/li&gt;
                                &lt;/b:if&gt;
                              &lt;/b:loop&gt;
                            &lt;/ul&gt;
                          &lt;/b:if&gt;
                          &lt;b:include name='quickedit'/&gt;
                        &lt;/div&gt;
                      &lt;/b:includable&gt;
                    &lt;/b:widget&gt;
                  &lt;/b:section&gt;
                  &lt;b:section class='tabs' id='crosscol-overflow' showaddelement='no'/&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;div class='tabs-cap-bottom cap-bottom'&gt;
                &lt;div class='cap-left'/&gt;
                &lt;div class='cap-right'/&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class='main-outer'&gt;
              &lt;div class='main-cap-top cap-top'&gt;
                &lt;div class='cap-left'/&gt;
                &lt;div class='cap-right'/&gt;
              &lt;/div&gt;
              &lt;div class='fauxborder-left main-fauxborder-left'&gt;
                &lt;div class='fauxborder-right main-fauxborder-right'/&gt;
                &lt;div class='region-inner main-inner'&gt;
                  &lt;div class='columns fauxcolumns'&gt;
                    &lt;div class='fauxcolumn-outer fauxcolumn-center-outer'&gt;
                      &lt;div class='cap-top'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                      &lt;div class='fauxborder-left'&gt;
                        &lt;div class='fauxborder-right'/&gt;
                        &lt;div class='fauxcolumn-inner'&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      &lt;div class='cap-bottom'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class='fauxcolumn-outer fauxcolumn-left-outer'&gt;
                      &lt;div class='cap-top'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                      &lt;div class='fauxborder-left'&gt;
                        &lt;div class='fauxborder-right'/&gt;
                        &lt;div class='fauxcolumn-inner'&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      &lt;div class='cap-bottom'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class='fauxcolumn-outer fauxcolumn-right-outer'&gt;
                      &lt;div class='cap-top'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                      &lt;div class='fauxborder-left'&gt;
                        &lt;div class='fauxborder-right'/&gt;
                        &lt;div class='fauxcolumn-inner'&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      &lt;div class='cap-bottom'&gt;
                        &lt;div class='cap-left'/&gt;
                        &lt;div class='cap-right'/&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!-- corrects IE6 width calculation --&gt;
                    &lt;div class='columns-inner'&gt;
                      &lt;div class='column-center-outer'&gt;
                        &lt;div class='column-center-inner'&gt;
                          &lt;b:section class='main' id='main' showaddelement='no'&gt;
                            &lt;b:widget id='Blog1' locked='true' title='網誌文章' type='Blog' version='1'&gt;
                              &lt;b:widget-settings&gt;
                                &lt;b:widget-setting name='showDateHeader'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.textcolor'&gt;#666666&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showShareButtons'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showCommentLink'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.urlcolor'&gt;#666666&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showAuthor'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.linkcolor'&gt;#2288bb&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.unittype'&gt;TextAndImage&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.bgcolor'&gt;#ffffff&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showAuthorProfile'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.layout'&gt;300x250&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showLabels'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showLocation'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showTimestamp'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='postsPerAd'&gt;2&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showBacklinks'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='style.bordercolor'&gt;#ffffff&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showInlineAds'&gt;true&lt;/b:widget-setting&gt;
                                &lt;b:widget-setting name='showReactions'&gt;false&lt;/b:widget-setting&gt;
                              &lt;/b:widget-settings&gt;
                              &lt;b:includable id='main' var='top'&gt;
                                &lt;b:if cond='data:mobile == &amp;quot;false&amp;quot;'&gt;
                                  &lt;!-- posts --&gt;
                                  &lt;div class='blog-posts hfeed'&gt;
                                    &lt;b:include data='top' name='status-message'/&gt;
                                    &lt;data:defaultAdStart/&gt;
                                    &lt;b:loop values='data:posts' var='post'&gt;
                                      &lt;b:if cond='data:post.isDateStart'&gt;
                                        &lt;b:if cond='data:post.isFirstPost == &amp;quot;false&amp;quot;'&gt;
                                          &amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;
                                        &lt;/b:if&gt;
                                      &lt;/b:if&gt;
                                      &lt;b:if cond='data:post.isDateStart'&gt;
                                        &amp;lt;div class=&amp;quot;date-outer&amp;quot;&amp;gt;
                                      &lt;/b:if&gt;
                                      &lt;b:if cond='data:post.dateHeader'&gt;
                                        &lt;H5 class='date-header'&gt;
                                          &lt;span&gt;
                                            &lt;data:post.dateHeader/&gt;
                                          &lt;/span&gt;
                                        &lt;/H5&gt;
                                      &lt;/b:if&gt;
                                      &lt;b:if cond='data:post.isDateStart'&gt;
                                        &amp;lt;div class=&amp;quot;date-posts&amp;quot;&amp;gt;
                                      &lt;/b:if&gt;
                                      &lt;div class='post-outer'&gt;
                                        &lt;b:include data='post' name='post'/&gt;
                                        &lt;b:if cond='data:blog.pageType == &amp;quot;static_page&amp;quot;'&gt;
                                          &lt;b:include data='post' name='comment_picker'/&gt;
                                        &lt;/b:if&gt;
                                        &lt;b:if cond='data:blog.pageType == &amp;quot;item&amp;quot;'&gt;
                                          &lt;b:include data='post' name='comment_picker'/&gt;
                                        &lt;/b:if&gt;
                                      &lt;/div&gt;
                                      &lt;b:if cond='data:post.includeAd'&gt;
                                        &lt;b:if cond='data:post.isFirstPost'&gt;
                                          &lt;data:defaultAdEnd/&gt;
                                          &lt;b:else/&gt;
                                          &lt;data:adEnd/&gt;
                                        &lt;/b:if&gt;
                                        &lt;div class='inline-ad'&gt;
                                          &lt;data:adCode/&gt;
                                        &lt;/div&gt;
                                        &lt;data:adStart/&gt;
                                      &lt;/b:if&gt;
                                    &lt;/b:loop&gt;
                                    &lt;b:if cond='data:numPosts != 0'&gt;
                                      &amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;
                                    &lt;/b:if&gt;
                                    &lt;data:adEnd/&gt;
                                  &lt;/div&gt;
                                  &lt;!-- navigation --&gt;
                                  &lt;b:include name='nextprev'/&gt;
                                  &lt;!-- feed links --&gt;
                                  &lt;b:include name='feedLinks'/&gt;
                                  &lt;b:else/&gt;
                                  &lt;b:include name='mobile-main'/&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showDummy'&gt;
                                  &lt;data:top.dummyBootstrap/&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='backlinkDeleteIcon' var='backlink'&gt;
                                &lt;span expr:class='&amp;quot;item-control &amp;quot; + data:backlink.adminClass'&gt;
                                  &lt;a expr:href='data:backlink.deleteUrl' expr:title='data:top.deleteBacklinkMsg'&gt;
                                    &lt;img src='//www.blogger.com/img/icon_delete13.gif'/&gt;
                                  &lt;/a&gt;
                                &lt;/span&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='backlinks' var='post'&gt;
                                &lt;a name='links'/&gt;
                                &lt;h4&gt;
                                  &lt;data:post.backlinksLabel/&gt;
                                &lt;/h4&gt;
                                &lt;b:if cond='data:post.numBacklinks != 0'&gt;
                                  &lt;dl class='comments-block' id='comments-block'&gt;
                                    &lt;b:loop values='data:post.backlinks' var='backlink'&gt;
                                      &lt;div class='collapsed-backlink backlink-control'&gt;
                                        &lt;dt class='comment-title'&gt;
                                          &lt;span class='backlink-toggle-zippy'&gt;
                                            &amp;#160;
                                          &lt;/span&gt;
                                          &lt;a expr:href='data:backlink.url' rel='nofollow'&gt;
                                            &lt;data:backlink.title/&gt;
                                          &lt;/a&gt;
                                          &lt;b:include data='backlink' name='backlinkDeleteIcon'/&gt;
                                        &lt;/dt&gt;
                                        &lt;dd class='comment-body collapseable'&gt;
                                          &lt;data:backlink.snippet/&gt;
                                        &lt;/dd&gt;
                                        &lt;dd class='comment-footer collapseable'&gt;
                                          &lt;span class='comment-author'&gt;
                                            &lt;data:post.authorLabel/&gt;
                                            &lt;data:backlink.author/&gt;
                                          &lt;/span&gt;
                                          &lt;span class='comment-timestamp'&gt;
                                            &lt;data:post.timestampLabel/&gt;
                                            &lt;data:backlink.timestamp/&gt;
                                          &lt;/span&gt;
                                        &lt;/dd&gt;
                                      &lt;/div&gt;
                                    &lt;/b:loop&gt;
                                  &lt;/dl&gt;
                                &lt;/b:if&gt;
                                &lt;p class='comment-footer'&gt;
                                  &lt;a class='comment-link' expr:href='data:post.createLinkUrl' expr:id='data:widget.instanceId + &amp;quot;_backlinks-create-link&amp;quot;' target='_blank'&gt;
                                    &lt;data:post.createLinkLabel/&gt;
                                  &lt;/a&gt;
                                &lt;/p&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='comment-form' var='post'&gt;
                                &lt;div class='comment-form'&gt;
                                  &lt;a name='comment-form'/&gt;
                                  &lt;b:if cond='data:mobile'&gt;
                                    &lt;h4 id='comment-post-message'&gt;
                                      &lt;a expr:id='data:widget.instanceId + &amp;quot;_comment-editor-toggle-link&amp;quot;' href='javascript:void(0)'&gt;
                                        &lt;data:postCommentMsg/&gt;
                                      &lt;/a&gt;
                                    &lt;/h4&gt;
                                    &lt;p&gt;
                                      &lt;data:blogCommentMessage/&gt;
                                    &lt;/p&gt;
                                    &lt;data:blogTeamBlogMessage/&gt;
                                    &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
                                    &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' style='display: none' width='100%'/&gt;
                                    &lt;b:else/&gt;
                                    &lt;h4 id='comment-post-message'&gt;
                                      &lt;data:postCommentMsg/&gt;
                                    &lt;/h4&gt;
                                    &lt;p&gt;
                                      &lt;data:blogCommentMessage/&gt;
                                    &lt;/p&gt;
                                    &lt;data:blogTeamBlogMessage/&gt;
                                    &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
                                    &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' width='100%'/&gt;
                                  &lt;/b:if&gt;
                                  &lt;data:post.friendConnectJs/&gt;
                                  &lt;data:post.cmtfpIframe/&gt;
                                  &lt;script type='text/javascript'&gt;
                                    BLOG_CMT_createIframe(&amp;#39;&lt;data:post.appRpcRelayPath/&gt;&amp;#39;);
                                  &lt;/script&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='commentDeleteIcon' var='comment'&gt;
                                &lt;span expr:class='&amp;quot;item-control &amp;quot; + data:comment.adminClass'&gt;
                                  &lt;b:if cond='data:showCmtPopup'&gt;
                                    &lt;div class='goog-toggle-button'&gt;
                                      &lt;div class='goog-inline-block comment-action-icon'/&gt;
                                    &lt;/div&gt;
                                    &lt;b:else/&gt;
                                    &lt;a class='comment-delete' expr:href='data:comment.deleteUrl' expr:title='data:top.deleteCommentMsg'&gt;
                                      &lt;img src='//www.blogger.com/img/icon_delete13.gif'/&gt;
                                    &lt;/a&gt;
                                  &lt;/b:if&gt;
                                &lt;/span&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='comment_count_picker' var='post'&gt;
                                &lt;b:if cond='data:post.commentSource == 1'&gt;
                                  &lt;span class='cmt_count_iframe_holder' expr:data-count='data:post.numComments' expr:data-onclick='data:post.addCommentOnclick' expr:data-post-url='data:post.url' expr:data-url='data:post.canonicalUrl'&gt;
                                  &lt;/span&gt;
                                  &lt;b:else/&gt;
                                  &lt;a class='comment-link' expr:href='data:post.addCommentUrl' expr:onclick='data:post.addCommentOnclick'&gt;
                                    &lt;data:post.commentLabelFull/&gt;
                                    :
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='comment_picker' var='post'&gt;
                                &lt;b:if cond='data:post.commentSource == 1'&gt;
                                  &lt;b:include data='post' name='iframe_comments'/&gt;
                                  &lt;b:else/&gt;
                                  &lt;b:if cond='data:post.showThreadedComments'&gt;
                                    &lt;b:include data='post' name='threaded_comments'/&gt;
                                    &lt;b:else/&gt;
                                    &lt;b:include data='post' name='comments'/&gt;
                                  &lt;/b:if&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='comments' var='post'&gt;
                                &lt;div class='comments' id='comments'&gt;
                                  &lt;a name='comments'/&gt;
                                  &lt;b:if cond='data:post.allowComments'&gt;
                                    &lt;h4&gt;
                                      &lt;data:post.commentLabelFull/&gt;
                                      :
                                    &lt;/h4&gt;
                                    &lt;b:if cond='data:post.commentPagingRequired'&gt;
                                      &lt;span class='paging-control-container'&gt;
                                        &lt;b:if cond='data:post.hasOlderLinks'&gt;
                                          &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.oldestLinkUrl'&gt;
                                            &lt;data:post.oldestLinkText/&gt;
                                          &lt;/a&gt;
                                          &amp;#160;
                                          &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.olderLinkUrl'&gt;
                                            &lt;data:post.olderLinkText/&gt;
                                          &lt;/a&gt;
                                          &amp;#160;
                                        &lt;/b:if&gt;
                                        &lt;data:post.commentRangeText/&gt;
                                        &lt;b:if cond='data:post.hasNewerLinks'&gt;
                                          &amp;#160;
                                          &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newerLinkUrl'&gt;
                                            &lt;data:post.newerLinkText/&gt;
                                          &lt;/a&gt;
                                          &amp;#160;
                                          &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newestLinkUrl'&gt;
                                            &lt;data:post.newestLinkText/&gt;
                                          &lt;/a&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                    &lt;/b:if&gt;
                                    &lt;div expr:id='data:widget.instanceId + &amp;quot;_comments-block-wrapper&amp;quot;'&gt;
                                      &lt;dl expr:class='data:post.avatarIndentClass' id='comments-block'&gt;
                                        &lt;b:loop values='data:post.comments' var='comment'&gt;
                                          &lt;dt expr:class='&amp;quot;comment-author &amp;quot; + data:comment.authorClass' expr:id='data:comment.anchorName'&gt;
                                            &lt;b:if cond='data:comment.favicon'&gt;
                                              &lt;img expr:src='data:comment.favicon' height='16px' style='margin-bottom:-2px;' width='16px'/&gt;
                                            &lt;/b:if&gt;
                                            &lt;a expr:name='data:comment.anchorName'/&gt;
                                            &lt;b:if cond='data:blog.enabledCommentProfileImages'&gt;
                                              &lt;data:comment.authorAvatarImage/&gt;
                                            &lt;/b:if&gt;
                                            &lt;b:if cond='data:comment.authorUrl'&gt;
                                              &lt;a expr:href='data:comment.authorUrl' rel='nofollow'&gt;
                                                &lt;data:comment.author/&gt;
                                              &lt;/a&gt;
                                              &lt;b:else/&gt;
                                              &lt;data:comment.author/&gt;
                                            &lt;/b:if&gt;
                                            &lt;data:commentPostedByMsg/&gt;
                                          &lt;/dt&gt;
                                          &lt;dd class='comment-body' expr:id='data:widget.instanceId + data:comment.cmtBodyIdPostfix'&gt;
                                            &lt;b:if cond='data:comment.isDeleted'&gt;
                                              &lt;span class='deleted-comment'&gt;
                                                &lt;data:comment.body/&gt;
                                              &lt;/span&gt;
                                              &lt;b:else/&gt;
                                              &lt;p&gt;
                                                &lt;data:comment.body/&gt;
                                              &lt;/p&gt;
                                            &lt;/b:if&gt;
                                          &lt;/dd&gt;
                                          &lt;dd class='comment-footer'&gt;
                                            &lt;span class='comment-timestamp'&gt;
                                              &lt;a expr:href='data:comment.url' title='comment permalink'&gt;
                                                &lt;data:comment.timestamp/&gt;
                                              &lt;/a&gt;
                                              &lt;b:include data='comment' name='commentDeleteIcon'/&gt;
                                            &lt;/span&gt;
                                          &lt;/dd&gt;
                                        &lt;/b:loop&gt;
                                      &lt;/dl&gt;
                                    &lt;/div&gt;
                                    &lt;b:if cond='data:post.commentPagingRequired'&gt;
                                      &lt;span class='paging-control-container'&gt;
                                        &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.oldestLinkUrl'&gt;
                                          &lt;data:post.oldestLinkText/&gt;
                                        &lt;/a&gt;
                                        &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.olderLinkUrl'&gt;
                                          &lt;data:post.olderLinkText/&gt;
                                        &lt;/a&gt;
                                        &amp;#160;
                                        &lt;data:post.commentRangeText/&gt;
                                        &amp;#160;
                                        &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newerLinkUrl'&gt;
                                          &lt;data:post.newerLinkText/&gt;
                                        &lt;/a&gt;
                                        &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newestLinkUrl'&gt;
                                          &lt;data:post.newestLinkText/&gt;
                                        &lt;/a&gt;
                                      &lt;/span&gt;
                                    &lt;/b:if&gt;
                                    &lt;p class='comment-footer'&gt;
                                      &lt;b:if cond='data:post.embedCommentForm'&gt;
                                        &lt;b:if cond='data:post.allowNewComments'&gt;
                                          &lt;b:include data='post' name='comment-form'/&gt;
                                          &lt;b:else/&gt;
                                          &lt;data:post.noNewCommentsText/&gt;
                                        &lt;/b:if&gt;
                                        &lt;b:else/&gt;
                                        &lt;b:if cond='data:post.allowComments'&gt;
                                          &lt;a expr:href='data:post.addCommentUrl' expr:onclick='data:post.addCommentOnclick'&gt;
                                            &lt;data:postCommentMsg/&gt;
                                          &lt;/a&gt;
                                        &lt;/b:if&gt;
                                      &lt;/b:if&gt;
                                    &lt;/p&gt;
                                  &lt;/b:if&gt;
                                  &lt;b:if cond='data:showCmtPopup'&gt;
                                    &lt;div id='comment-popup'&gt;
                                      &lt;iframe allowtransparency='true' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'&gt;
                                      &lt;/iframe&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;div id='backlinks-container'&gt;
                                    &lt;div expr:id='data:widget.instanceId + &amp;quot;_backlinks-container&amp;quot;'&gt;
                                      &lt;b:if cond='data:post.showBacklinks'&gt;
                                        &lt;b:include data='post' name='backlinks'/&gt;
                                      &lt;/b:if&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='feedLinks'&gt;
                                &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt;
                                  &lt;!-- Blog feed links --&gt;
                                  &lt;b:if cond='data:feedLinks'&gt;
                                    &lt;div class='blog-feeds'&gt;
                                      &lt;b:include data='feedLinks' name='feedLinksBody'/&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;b:else/&gt;
                                  &lt;!--Post feed links --&gt;
                                  &lt;div class='post-feeds'&gt;
                                    &lt;b:loop values='data:posts' var='post'&gt;
                                      &lt;b:if cond='data:post.allowComments'&gt;
                                        &lt;b:if cond='data:post.feedLinks'&gt;
                                          &lt;b:include data='post.feedLinks' name='feedLinksBody'/&gt;
                                        &lt;/b:if&gt;
                                      &lt;/b:if&gt;
                                    &lt;/b:loop&gt;
                                  &lt;/div&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='feedLinksBody' var='links'&gt;
                                &lt;div class='feed-links'&gt;
                                  &lt;data:feedLinksMsg/&gt;
                                  &lt;b:loop values='data:links' var='f'&gt;
                                    &lt;a class='feed-link' expr:href='data:f.url' expr:type='data:f.mimeType' target='_blank'&gt;
                                      &lt;data:f.name/&gt;
                                      (
                                      &lt;data:f.feedType/&gt;
                                      )
                                    &lt;/a&gt;
                                  &lt;/b:loop&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='iframe_comments' var='post'&gt;
                                &lt;b:if cond='data:post.allowIframeComments'&gt;
                                  &lt;script expr:src='data:post.iframeCommentSrc' type='text/javascript'/&gt;
                                  &lt;div class='cmt_iframe_holder' expr:data-href='data:post.canonicalUrl' expr:data-viewtype='data:post.viewType'/&gt;
                                  &lt;b:if cond='data:post.embedCommentForm == &amp;quot;false&amp;quot;'&gt;
                                    &lt;a expr:href='data:post.addCommentUrl' expr:onclick='data:post.addCommentOnclick'&gt;
                                      &lt;data:postCommentMsg/&gt;
                                    &lt;/a&gt;
                                  &lt;/b:if&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='mobile-index-post' var='post'&gt;
                                &lt;div class='mobile-date-outer date-outer'&gt;
                                  &lt;b:if cond='data:post.dateHeader'&gt;
                                    &lt;div class='date-header'&gt;
                                      &lt;span&gt;
                                        &lt;data:post.dateHeader/&gt;
                                      &lt;/span&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;div class='mobile-post-outer'&gt;
                                    &lt;a expr:href='data:post.url'&gt;
                                      &lt;H1 class='mobile-index-title entry-title' itemprop='name'&gt;
                                        &lt;data:post.title/&gt;
                                      &lt;/H1&gt;
                                      &lt;div class='mobile-index-arrow'&gt;
                                        &amp;amp;rsaquo;
                                      &lt;/div&gt;
                                      &lt;div class='mobile-index-contents'&gt;
                                        &lt;b:if cond='data:post.thumbnailUrl'&gt;
                                          &lt;div class='mobile-index-thumbnail'&gt;
                                            &lt;div class='Image'&gt;
                                              &lt;img expr:src='data:post.thumbnailUrl'/&gt;
                                            &lt;/div&gt;
                                          &lt;/div&gt;
                                        &lt;/b:if&gt;
                                        &lt;div class='post-body'&gt;
                                          &lt;b:if cond='data:post.snippet'&gt;
                                            &lt;data:post.snippet/&gt;
                                          &lt;/b:if&gt;
                                        &lt;/div&gt;
                                      &lt;/div&gt;
                                      &lt;div style='clear: both;'/&gt;
                                    &lt;/a&gt;
                                    &lt;div class='mobile-index-comment'&gt;
                                      &lt;b:if cond='data:blog.pageType != &amp;quot;static_page&amp;quot;'&gt;
                                        &lt;b:if cond='data:post.allowComments'&gt;
                                          &lt;b:if cond='data:post.numComments != 0'&gt;
                                            &lt;b:include data='post' name='comment_count_picker'/&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/b:if&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='mobile-main' var='top'&gt;
                                &lt;!-- posts --&gt;
                                &lt;div class='blog-posts hfeed'&gt;
                                  &lt;b:include data='top' name='status-message'/&gt;
                                  &lt;b:if cond='data:blog.pageType == &amp;quot;index&amp;quot;'&gt;
                                    &lt;b:loop values='data:posts' var='post'&gt;
                                      &lt;b:include data='post' name='mobile-index-post'/&gt;
                                    &lt;/b:loop&gt;
                                    &lt;b:else/&gt;
                                    &lt;b:loop values='data:posts' var='post'&gt;
                                      &lt;b:include data='post' name='mobile-post'/&gt;
                                    &lt;/b:loop&gt;
                                  &lt;/b:if&gt;
                                &lt;/div&gt;
                                &lt;b:include name='mobile-nextprev'/&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='mobile-nextprev'&gt;
                                &lt;div class='blog-pager' id='blog-pager'&gt;
                                  &lt;b:if cond='data:newerPageUrl'&gt;
                                    &lt;div class='mobile-link-button' id='blog-pager-newer-link'&gt;
                                      &lt;a class='blog-pager-newer-link' expr:href='data:newerPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-newer-link&amp;quot;' expr:title='data:newerPageTitle'&gt;
                                        &amp;amp;lsaquo;
                                      &lt;/a&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;b:if cond='data:olderPageUrl'&gt;
                                    &lt;div class='mobile-link-button' id='blog-pager-older-link'&gt;
                                      &lt;a class='blog-pager-older-link' expr:href='data:olderPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-older-link&amp;quot;' expr:title='data:olderPageTitle'&gt;
                                        &amp;amp;rsaquo;
                                      &lt;/a&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;div class='mobile-link-button' id='blog-pager-home-link'&gt;
                                    &lt;a class='home-link' expr:href='data:blog.homepageUrl'&gt;
                                      &lt;data:homeMsg/&gt;
                                    &lt;/a&gt;
                                  &lt;/div&gt;
                                  &lt;div class='mobile-desktop-link'&gt;
                                    &lt;a class='home-link' expr:href='data:desktopLinkUrl'&gt;
                                      &lt;data:desktopLinkMsg/&gt;
                                    &lt;/a&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                                &lt;div class='clear'/&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='mobile-post' var='post'&gt;
                                &lt;div class='date-outer'&gt;
                                  &lt;b:if cond='data:post.dateHeader'&gt;
                                    &lt;H5 class='date-header'&gt;
                                      &lt;span&gt;
                                        &lt;data:post.dateHeader/&gt;
                                      &lt;/span&gt;
                                    &lt;/H5&gt;
                                  &lt;/b:if&gt;
                                  &lt;div class='date-posts'&gt;
                                    &lt;div class='post-outer'&gt;
                                      &lt;div class='post hentry uncustomized-post-template' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'&gt;
										
                    					&lt;meta expr:itemid='data:post.link ? data:post.link : data:post.url' itemType='https://schema.org/WebPage' itemprop='mainEntityOfPage' itemscope='itemscope'/&gt;
                                        &lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' style='display:none;' title='permanent link'&gt;&lt;abbr class='published' expr:title='data:post.lastUpdatedISO8601' itemprop='datePublished'&gt;&lt;meta expr:content='data:post.lastUpdatedISO8601' itemprop='dateModified'/&gt;&lt;span class='updated'&gt;&lt;data:post.timestampISO8601/&gt;&lt;/span&gt;&lt;/abbr&gt;&lt;/a&gt;

										&lt;b:if cond='data:post.thumbnailUrl'&gt;
                                          &lt;meta expr:content='data:post.thumbnailUrl' itemprop='image_url'/&gt;
                                        &lt;/b:if&gt;
                                        
                                     
                                        &lt;a expr:name='data:post.id'/&gt;
                                        &lt;b:if cond='data:post.title'&gt;
                                          &lt;H1 class='post-title entry-title' itemprop='headline'&gt;
                                            &lt;b:if cond='data:post.link'&gt;
                                              &lt;a expr:href='data:post.link'&gt;
                                                &lt;data:post.title/&gt;
                                              &lt;/a&gt;
                                              &lt;b:else/&gt;
                                              &lt;b:if cond='data:post.url'&gt;
                                                &lt;b:if cond='data:blog.url != data:post.url'&gt;
                                                  &lt;a expr:href='data:post.url'&gt;
                                                    &lt;data:post.title/&gt;
                                                  &lt;/a&gt;
                                                  &lt;b:else/&gt;
                                                  &lt;data:post.title/&gt;
                                                &lt;/b:if&gt;
                                                &lt;b:else/&gt;
                                                &lt;data:post.title/&gt;
                                              &lt;/b:if&gt;
                                            &lt;/b:if&gt;
                                          &lt;/H1&gt;
                                        &lt;/b:if&gt;
                                        &lt;div class='post-header'&gt;
                                          &lt;div class='post-header-line-1'/&gt;
                                        &lt;/div&gt;
                                        &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='articleBody'&gt;
                                          &lt;data:post.body/&gt;
                                          &lt;div style='clear: both;'/&gt;
                                          &lt;!-- clear for photos floats --&gt;
                                        &lt;/div&gt;
                                        &lt;div class='post-footer'&gt;
                                          &lt;div class='post-footer-line post-footer-line-1'&gt;
                                            &lt;span class='post-author vcard'&gt;
                                              &lt;b:if cond='data:top.showAuthor'&gt;
                                                &lt;b:if cond='data:post.authorProfileUrl'&gt;
                                                  &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                                                    &lt;meta expr:content='data:post.authorProfileUrl' itemprop='url'/&gt;
                                                    &lt;a expr:href='data:post.authorProfileUrl' rel='author' title='author profile'&gt;
                                                      &lt;span itemprop='name'&gt;
                                                        &lt;data:post.author/&gt;
                                                      &lt;/span&gt;
                                                    &lt;/a&gt;
                                                  &lt;/span&gt;
                                                  &lt;b:else/&gt;
                                                  &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                                                    &lt;span itemprop='name'&gt;
                                                      &lt;data:post.author/&gt;
                                                    &lt;/span&gt;
                                                  &lt;/span&gt;
                                                &lt;/b:if&gt;
                                              &lt;/b:if&gt;
                                            &lt;/span&gt;
                                            &lt;span class='post-timestamp'&gt;
                                              &lt;b:if cond='data:top.showTimestamp'&gt;
                                                &lt;data:top.timestampLabel/&gt;
                                                &lt;b:if cond='data:post.url'&gt;
                                                  &lt;meta expr:content='data:post.canonicalUrl' itemprop='url'/&gt;
                                                  &lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' title='permanent link'&gt;
                                                    &lt;abbr class='published' expr:title='data:post.timestampISO8601'&gt;
                                                      &lt;span class='updated'&gt;&lt;data:post.dateHeader/&gt; &lt;data:post.timestamp/&gt;&lt;/span&gt;
                                                    &lt;/abbr&gt;
                                                  &lt;/a&gt;
                                                &lt;/b:if&gt;
                                              &lt;/b:if&gt;
                                            &lt;/span&gt;
                                            &lt;span class='post-comment-link'&gt;
                                              &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt;
                                                &lt;b:if cond='data:blog.pageType != &amp;quot;static_page&amp;quot;'&gt;
                                                  &lt;b:if cond='data:post.allowComments'&gt;
                                                    &lt;b:include data='post' name='comment_count_picker'/&gt;
                                                  &lt;/b:if&gt;
                                                &lt;/b:if&gt;
                                              &lt;/b:if&gt;
                                            &lt;/span&gt;
                                          &lt;/div&gt;
                                          &lt;div class='post-footer-line post-footer-line-2'&gt;
                                            &lt;b:if cond='data:top.showMobileShare'&gt;
                                              &lt;div class='mobile-link-button goog-inline-block' id='mobile-share-button'&gt;
                                                &lt;a href='javascript:void(0);'&gt;
                                                  &lt;data:shareMsg/&gt;
                                                &lt;/a&gt;
                                              &lt;/div&gt;
                                            &lt;/b:if&gt;
                                            &lt;b:if cond='data:top.showDummy'&gt;
                                              &lt;div class='goog-inline-block dummy-container'&gt;
                                                &lt;data:post.dummyTag/&gt;
                                              &lt;/div&gt;
                                            &lt;/b:if&gt;
                                          &lt;/div&gt;
                                        &lt;/div&gt;
                                      &lt;/div&gt;
                                      &lt;b:if cond='data:blog.pageType == &amp;quot;static_page&amp;quot;'&gt;
                                        &lt;b:include data='post' name='comment_picker'/&gt;
                                      &lt;/b:if&gt;
                                      &lt;b:if cond='data:blog.pageType == &amp;quot;item&amp;quot;'&gt;
                                        &lt;b:include data='post' name='comment_picker'/&gt;
                                      &lt;/b:if&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='nextprev'&gt;
                                &lt;div class='blog-pager' id='blog-pager'&gt;
                                  &lt;b:if cond='data:newerPageUrl'&gt;
                                    &lt;span id='blog-pager-newer-link'&gt;
                                      &lt;a class='blog-pager-newer-link' expr:href='data:newerPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-newer-link&amp;quot;' expr:title='data:newerPageTitle'&gt;
                                        &lt;data:newerPageTitle/&gt;
                                      &lt;/a&gt;
                                    &lt;/span&gt;
                                  &lt;/b:if&gt;
                                  &lt;b:if cond='data:olderPageUrl'&gt;
                                    &lt;span id='blog-pager-older-link'&gt;
                                      &lt;a class='blog-pager-older-link' expr:href='data:olderPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-older-link&amp;quot;' expr:title='data:olderPageTitle'&gt;
                                        &lt;data:olderPageTitle/&gt;
                                      &lt;/a&gt;
                                    &lt;/span&gt;
                                  &lt;/b:if&gt;
                                  &lt;a class='home-link' expr:href='data:blog.homepageUrl'&gt;
                                    &lt;data:homeMsg/&gt;
                                  &lt;/a&gt;
                                  &lt;b:if cond='data:mobileLinkUrl'&gt;
                                    &lt;div class='blog-mobile-link'&gt;
                                      &lt;a expr:href='data:mobileLinkUrl'&gt;
                                        &lt;data:mobileLinkMsg/&gt;
                                      &lt;/a&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                &lt;/div&gt;
                                &lt;div class='clear'/&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='post' var='post'&gt;
                                &lt;div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'&gt;

                    &lt;meta expr:itemid='data:post.link ? data:post.link : data:post.url' itemType='https://schema.org/WebPage' itemprop='mainEntityOfPage' itemscope='itemscope'/&gt;

&lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' style='display:none' title='permanent link'&gt;&lt;abbr class='published' expr:title='data:post.lastUpdatedISO8601' itemprop='datePublished'&gt;&lt;meta expr:content='data:post.lastUpdatedISO8601' itemprop='dateModified'/&gt;&lt;span class='updated'&gt;&lt;data:post.timestampISO8601/&gt;&lt;/span&gt;&lt;/abbr&gt;&lt;/a&gt;
                                  &lt;b:if cond='data:post.firstImageUrl'&gt;
                                    &lt;meta expr:content='data:post.firstImageUrl' itemprop='image'/&gt;
                                  &lt;/b:if&gt;
                                  
                                  
                                  &lt;a expr:name='data:post.id'/&gt;
                                  &lt;b:if cond='data:post.title'&gt;
                                    &lt;H1 class='post-title entry-title' itemprop='headline'&gt;
                                      &lt;b:if cond='data:post.link'&gt;
                                        &lt;a expr:href='data:post.link'&gt;
                                          &lt;data:post.title/&gt;
                                        &lt;/a&gt;
                                        &lt;b:else/&gt;
                                        &lt;b:if cond='data:post.url'&gt;
                                          &lt;b:if cond='data:blog.url != data:post.url'&gt;
                                            &lt;a expr:href='data:post.url'&gt;
                                              &lt;data:post.title/&gt;
                                            &lt;/a&gt;
                                            &lt;b:else/&gt;
                                            &lt;data:post.title/&gt;
                                          &lt;/b:if&gt;
                                          &lt;b:else/&gt;
                                          &lt;data:post.title/&gt;
                                        &lt;/b:if&gt;
                                      &lt;/b:if&gt;
                                    &lt;/H1&gt;
                                  &lt;/b:if&gt;
&lt;div class='post-header'&gt;
  &lt;div class='post-header-line-1'/&gt;

&lt;!--開始 FB贊按鈕 - 條例和內頁title下面--&gt;
  &lt;div class='fb-like' data-action='like' data-layout='standard' data-share='true' data-show-faces='true' expr:data-href='data:post.url'&gt;
  &lt;/div&gt;
&lt;!--結束 FB贊按鈕--&gt;

  &lt;b:if cond='data:blog.pageType == &amp;quot;item&amp;quot;'&gt;
    &lt;script src='http://js1.bloggerads.net/showbanner.aspx?blogid=20150801000003&amp;amp;charset=utf-8' type='text/javascript'&gt;
    &lt;/script&gt;
  &lt;/b:if&gt;
                                  &lt;/div&gt;
                                  &lt;b:if cond='data:blog.metaDescription == &amp;quot;&amp;quot;'&gt;
                                    &lt;!-- Then use the post body as the schema.org description,
for good G+/FB snippeting. --&gt;
                                    &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='description articleBody'&gt;
                                      &lt;data:post.body/&gt;
                                      &lt;div style='clear: both;'/&gt;
                                      &lt;!-- clear for photos floats --&gt;
                                    &lt;/div&gt;
                                    &lt;b:else/&gt;
                                    &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='articleBody'&gt;
                                      &lt;data:post.body/&gt;
                                      &lt;div style='clear: both;'/&gt;
                                      &lt;!-- clear for photos floats --&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;b:if cond='data:post.hasJumpLink'&gt;
                                    &lt;div class='jump-link'&gt;
                                      &lt;a expr:href='data:post.url + &amp;quot;#more&amp;quot;' expr:title='data:post.title'&gt;
                                        &lt;data:post.jumpText/&gt;
                                      &lt;/a&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;

                                  &lt;br/&gt;
&lt;!--開始 FB贊按鈕--&gt;
  &lt;div class='fb-like' data-action='like' data-layout='standard' data-share='true' data-show-faces='true' expr:data-href='data:post.url'&gt;
  &lt;/div&gt;
&lt;!--結束 FB贊按鈕--&gt;
                                  &lt;div class='post-footer'&gt;
                                    &lt;div class='post-footer-line post-footer-line-1'&gt;
                                      &lt;span class='post-author vcard'&gt;
                                        &lt;b:if cond='data:top.showAuthor'&gt;
                                          &lt;data:top.authorLabel/&gt;
                                          &lt;b:if cond='data:post.authorProfileUrl'&gt;
                                            &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                                              &lt;meta expr:content='data:post.authorProfileUrl' itemprop='url'/&gt;
                                              &lt;a class='g-profile' expr:href='data:post.authorProfileUrl' rel='author' title='author profile'&gt;
                                                &lt;span itemprop='name'&gt;
                                                  &lt;data:post.author/&gt;
                                                &lt;/span&gt;
                                              &lt;/a&gt;
                                            &lt;/span&gt;
                                            &lt;b:else/&gt;
                                            &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                                              &lt;span itemprop='name'&gt;
                                                &lt;data:post.author/&gt;
                                              &lt;/span&gt;
                                            &lt;/span&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                      &lt;span class='post-timestamp'&gt;
                                        &lt;b:if cond='data:top.showTimestamp'&gt;
                                          &lt;data:top.timestampLabel/&gt;
                                          &lt;b:if cond='data:post.url'&gt;
                                            &lt;meta expr:content='data:post.canonicalUrl' itemprop='url'/&gt;
                                            &lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' title='permanent link'&gt;
                                              
                                                &lt;span class='updated'&gt;&lt;data:post.dateHeader/&gt;&lt;data:post.timestamp/&gt;&lt;/span&gt;
                                              
                                            &lt;/a&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                      &lt;span class='post-comment-link'&gt;
                                        &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt;
                                          &lt;b:if cond='data:blog.pageType != &amp;quot;static_page&amp;quot;'&gt;
                                            &lt;b:if cond='data:post.allowComments'&gt;
                                              &lt;b:include data='post' name='comment_count_picker'/&gt;
                                            &lt;/b:if&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                      &lt;span class='post-icons'&gt;
                                        &lt;!-- email post links --&gt;
                                        &lt;b:if cond='data:post.emailPostUrl'&gt;
                                          &lt;span class='item-action'&gt;
                                            &lt;a expr:href='data:post.emailPostUrl' expr:title='data:top.emailPostMsg'&gt;
                                              &lt;img alt='' class='icon-action' height='13' src='http://img1.blogblog.com/img/icon18_email.gif' width='18'/&gt;
                                            &lt;/a&gt;
                                          &lt;/span&gt;
                                        &lt;/b:if&gt;
                                        &lt;!-- quickedit pencil --&gt;
                                        &lt;b:include data='post' name='postQuickEdit'/&gt;
                                      &lt;/span&gt;
                                      &lt;div class='post-share-buttons goog-inline-block'&gt;
                                        &lt;b:if cond='data:post.sharePostUrl'&gt;
                                          &lt;b:include data='post' name='shareButtons'/&gt;
                                        &lt;/b:if&gt;
                                      &lt;/div&gt;
                                      &lt;span class='post-backlinks post-comment-link'&gt;
                                        &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt;
                                          &lt;b:if cond='data:blog.pageType != &amp;quot;static_page&amp;quot;'&gt;
                                            &lt;b:if cond='data:post.showBacklinks'&gt;
                                              &lt;a class='comment-link' expr:href='data:post.url + &amp;quot;#links&amp;quot;'&gt;
                                                &lt;data:top.backlinkLabel/&gt;
                                              &lt;/a&gt;
                                            &lt;/b:if&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                    &lt;/div&gt;
                                    &lt;div class='post-footer-line post-footer-line-2'&gt;
                                      &lt;span class='post-labels'&gt;
                                        &lt;b:if cond='data:post.labels'&gt;
                                          &lt;data:postLabelsLabel/&gt;
                                          &lt;b:loop values='data:post.labels' var='label'&gt;
                                            &lt;a expr:href='data:label.url' rel='tag'&gt;
                                              &lt;data:label.name/&gt;
                                            &lt;/a&gt;
                                            &lt;b:if cond='data:label.isLast != &amp;quot;true&amp;quot;'&gt;
                                              ,
                                            &lt;/b:if&gt;
                                          &lt;/b:loop&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                    &lt;/div&gt;
                                    &lt;div class='post-footer-line post-footer-line-3'&gt;
                                      &lt;span class='post-location'&gt;
                                        &lt;b:if cond='data:top.showLocation'&gt;
                                          &lt;b:if cond='data:post.location'&gt;
                                            &lt;data:postLocationLabel/&gt;
                                            &lt;a expr:href='data:post.location.mapsUrl' target='_blank'&gt;
                                              &lt;data:post.location.name/&gt;
                                            &lt;/a&gt;
                                          &lt;/b:if&gt;
                                        &lt;/b:if&gt;
                                      &lt;/span&gt;
                                    &lt;/div&gt;
                                    &lt;b:if cond='data:post.authorAboutMe'&gt;
                                      &lt;div class='author-profile' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                                        &lt;b:if cond='data:post.authorPhoto.url'&gt;
                                          &lt;img expr:src='data:post.authorPhoto.url' itemprop='image' width='50px'/&gt;
                                        &lt;/b:if&gt;
                                        &lt;div&gt;
                                          &lt;a class='g-profile' expr:href='data:post.authorProfileUrl' itemprop='url' rel='author' title='author profile'&gt;
                                            &lt;span itemprop='name'&gt;
                                              &lt;data:post.author/&gt;
                                            &lt;/span&gt;
                                          &lt;/a&gt;
                                        &lt;/div&gt;
                                        &lt;span itemprop='description'&gt;
                                          &lt;data:post.authorAboutMe/&gt;
                                        &lt;/span&gt;
                                      &lt;/div&gt;
                                    &lt;/b:if&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='postQuickEdit' var='post'&gt;
                                &lt;b:if cond='data:post.editUrl'&gt;
                                  &lt;span expr:class='&amp;quot;item-control &amp;quot; + data:post.adminClass'&gt;
                                    &lt;a expr:href='data:post.editUrl' expr:title='data:top.editPostMsg'&gt;
                                      &lt;img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/&gt;
                                    &lt;/a&gt;
                                  &lt;/span&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='shareButtons' var='post'&gt;
                                &lt;b:if cond='data:top.showEmailButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-email' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=email&amp;quot;' expr:title='data:top.emailThisMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.emailThisMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showBlogThisButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-blog' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=blog&amp;quot;' expr:onclick='&amp;quot;window.open(this.href, \&amp;quot;_blank\&amp;quot;, \&amp;quot;height=270,width=475\&amp;quot;); return false;&amp;quot;' expr:title='data:top.blogThisMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.blogThisMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showTwitterButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-twitter' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=twitter&amp;quot;' expr:title='data:top.shareToTwitterMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.shareToTwitterMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showFacebookButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-facebook' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=facebook&amp;quot;' expr:onclick='&amp;quot;window.open(this.href, \&amp;quot;_blank\&amp;quot;, \&amp;quot;height=430,width=640\&amp;quot;); return false;&amp;quot;' expr:title='data:top.shareToFacebookMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.shareToFacebookMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showOrkutButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-orkut' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=orkut&amp;quot;' expr:title='data:top.shareToOrkutMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.shareToOrkutMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showPinterestButton'&gt;
                                  &lt;a class='goog-inline-block share-button sb-pinterest' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=pinterest&amp;quot;' expr:title='data:top.shareToPinterestMsg' target='_blank'&gt;
                                    &lt;span class='share-button-link-text'&gt;
                                      &lt;data:top.shareToPinterestMsg/&gt;
                                    &lt;/span&gt;
                                  &lt;/a&gt;
                                &lt;/b:if&gt;
                                &lt;b:if cond='data:top.showDummy'&gt;
                                  &lt;div class='goog-inline-block dummy-container'&gt;
                                    &lt;data:post.dummyTag/&gt;
                                  &lt;/div&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='status-message'&gt;
                                &lt;b:if cond='data:navMessage'&gt;
                                  &lt;div class='status-msg-wrap'&gt;
                                    &lt;div class='status-msg-body'&gt;
                                      &lt;data:navMessage/&gt;
                                    &lt;/div&gt;
                                    &lt;div class='status-msg-border'&gt;
                                      &lt;div class='status-msg-bg'&gt;
                                        &lt;div class='status-msg-hidden'&gt;
                                          &lt;data:navMessage/&gt;
                                        &lt;/div&gt;
                                      &lt;/div&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                  &lt;div style='clear: both;'/&gt;
                                &lt;/b:if&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='threaded-comment-form' var='post'&gt;
                                &lt;div class='comment-form'&gt;
                                  &lt;a name='comment-form'/&gt;
                                  &lt;b:if cond='data:mobile'&gt;
                                    &lt;p&gt;
                                      &lt;data:blogCommentMessage/&gt;
                                    &lt;/p&gt;
                                    &lt;data:blogTeamBlogMessage/&gt;
                                    &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
                                    &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' style='display: none' width='100%'/&gt;
                                    &lt;b:else/&gt;
                                    &lt;p&gt;
                                      &lt;data:blogCommentMessage/&gt;
                                    &lt;/p&gt;
                                    &lt;data:blogTeamBlogMessage/&gt;
                                    &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
                                    &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' width='100%'/&gt;
                                  &lt;/b:if&gt;
                                  &lt;data:post.friendConnectJs/&gt;
                                  &lt;data:post.cmtfpIframe/&gt;
                                  &lt;script type='text/javascript'&gt;
                                    BLOG_CMT_createIframe(&amp;#39;&lt;data:post.appRpcRelayPath/&gt;&amp;#39;);
                                  &lt;/script&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='threaded_comment_js' var='post'&gt;
                                &lt;script async='async' expr:src='data:post.commentSrc' type='text/javascript'/&gt;
                                &lt;script type='text/javascript'&gt;
                                  (function() {
                                    var items = &lt;data:post.commentJso/&gt;;
                                    var msgs = &lt;data:post.commentMsgs/&gt;;
                                    var config = &lt;data:post.commentConfig/&gt;;
                                    // &lt;![CDATA[
                                    var cursor = null;
                                    if (items &amp;&amp; items.length &gt; 0) {
                                      cursor = parseInt(items[items.length - 1].timestamp) + 1;
                                    }
                                    var bodyFromEntry = function(entry) {
                                      if (entry.gd$extendedProperty) {
                                        for (var k in entry.gd$extendedProperty) {
                                          if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
                                            return '&lt;span class="deleted-comment"&gt;' + entry.content.$t + '&lt;/span&gt;';
                                          }
                                        }
                                      }
                                      return entry.content.$t;
                                    }
                                    var parse = function(data) {
                                      cursor = null;
                                      var comments = [];
                                      if (data &amp;&amp; data.feed &amp;&amp; data.feed.entry) {
                                        for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
                                          var comment = {};
                                          // comment ID, parsed out of the original id format
                                          var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
                                          comment.id = id ? id[2] : null;
                                          comment.body = bodyFromEntry(entry);
                                          comment.timestamp = Date.parse(entry.published.$t) + '';
                                          if (entry.author &amp;&amp; entry.author.constructor === Array) {
                                            var auth = entry.author[0];
                                            if (auth) {
                                              comment.author = {
                                                name: (auth.name ? auth.name.$t : undefined),
                                                profileUrl: (auth.uri ? auth.uri.$t : undefined),
                                                avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                                              };
                                            }
                                          }
                                          if (entry.link) {
                                            if (entry.link[2]) {
                                              comment.link = comment.permalink = entry.link[2].href;
                                            }
                                            if (entry.link[3]) {
                                              var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                                              if (pid &amp;&amp; pid[1]) {
                                                comment.parentId = pid[1];
                                              }
                                            }
                                          }
                                          comment.deleteclass = 'item-control blog-admin';
                                          if (entry.gd$extendedProperty) {
                                            for (var k in entry.gd$extendedProperty) {
                                              if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                                                comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                                              } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                                                comment.displayTime = entry.gd$extendedProperty[k].value;
                                              }
                                            }
                                          }
                                          comments.push(comment);
                                        }
                                      }
                                      return comments;
                                    };
                                    var paginator = function(callback) {
                                      if (hasMore()) {
                                        var url = config.feed + '?alt=json&amp;v=2&amp;orderby=published&amp;reverse=false&amp;max-results=50';
                                        if (cursor) {
                                          url += '&amp;published-min=' + new Date(cursor).toISOString();
                                        }
                                        window.bloggercomments = function(data) {
                                          var parsed = parse(data);
                                          cursor = parsed.length &lt; 50 ? null
                                          : parseInt(parsed[parsed.length - 1].timestamp) + 1
                                          callback(parsed);
                                          window.bloggercomments = null;
                                        }
                                        url += '&amp;callback=bloggercomments';
                                        var script = document.createElement('script');
                                        script.type = 'text/javascript';
                                        script.src = url;
                                        document.getElementsByTagName('head')[0].appendChild(script);
                                      }
                                    };
                                    var hasMore = function() {
                                      return !!cursor;
                                    };
                                    var getMeta = function(key, comment) {
                                      if ('iswriter' == key) {
                                        var matches = !!comment.author
                                        &amp;&amp; comment.author.name == config.authorName
                                        &amp;&amp; comment.author.profileUrl == config.authorUrl;
                                        return matches ? 'true' : '';
                                      } else if ('deletelink' == key) {
                                        return config.baseUri + '/delete-comment.g?blogID='
                                        + config.blogId + '&amp;postID=' + comment.id;
                                      } else if ('deleteclass' == key) {
                                        return comment.deleteclass;
                                      }
                                      return '';
                                    };
                                    var replybox = null;
                                    var replyUrlParts = null;
                                    var replyParent = undefined;
                                    var onReply = function(commentId, domId) {
                                      if (replybox == null) {
                                        // lazily cache replybox, and adjust to suit this style:
                                        replybox = document.getElementById('comment-editor');
                                        if (replybox != null) {
                                          replybox.height = '250px';
                                          replybox.style.display = 'block';
                                          replyUrlParts = replybox.src.split('#');
                                        }
                                      }
                                      if (replybox &amp;&amp; (commentId !== replyParent)) {
                                        document.getElementById(domId).insertBefore(replybox, null);
                                        replybox.src = replyUrlParts[0]
                                        + (commentId ? '&amp;parentID=' + commentId : '')
                                        + '#' + replyUrlParts[1];
                                        replyParent = commentId;
                                      }
                                    };
                                    var hash = (window.location.hash || '#').substring(1);
                                    var startThread, targetComment;
                                    if (/^comment-form_/.test(hash)) {
                                      startThread = hash.substring('comment-form_'.length);
                                    } else if (/^c[0-9]+$/.test(hash)) {
                                      targetComment = hash.substring(1);
                                    }
                                    // Configure commenting API:
                                    var configJso = {
                                      'maxDepth': config.maxThreadDepth
                                    };
                                    var provider = {
                                      'id': config.postId,
                                      'data': items,
                                      'loadNext': paginator,
                                      'hasMore': hasMore,
                                      'getMeta': getMeta,
                                      'onReply': onReply,
                                      'rendered': true,
                                      'initComment': targetComment,
                                      'initReplyThread': startThread,
                                      'config': configJso,
                                      'messages': msgs
                                    };
                                    var render = function() {
                                      if (window.goog &amp;&amp; window.goog.comments) {
                                        var holder = document.getElementById('comment-holder');
                                        window.goog.comments.render(holder, provider);
                                      }
                                    };
                                    // render now, or queue to render when library loads:
                                    if (window.goog &amp;&amp; window.goog.comments) {
                                      render();
                                    } else {
                                      window.goog = window.goog || {};
                                      window.goog.comments = window.goog.comments || {};
                                      window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
                                      window.goog.comments.loadQueue.push(render);
                                    }
                                  })();
                                  // ]]&gt;
                                &lt;/script&gt;
                              &lt;/b:includable&gt;
                              &lt;b:includable id='threaded_comments' var='post'&gt;
                                &lt;div class='comments' id='comments'&gt;
                                  &lt;a name='comments'/&gt;
                                  &lt;h4&gt;
                                    &lt;data:post.commentLabelFull/&gt;
                                    :
                                  &lt;/h4&gt;
                                  &lt;div class='comments-content'&gt;
                                    &lt;b:if cond='data:post.embedCommentForm'&gt;
                                      &lt;b:include data='post' name='threaded_comment_js'/&gt;
                                    &lt;/b:if&gt;
                                    &lt;div id='comment-holder'&gt;
                                      &lt;data:post.commentHtml/&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                  &lt;p class='comment-footer'&gt;
                                    &lt;b:if cond='data:post.allowNewComments'&gt;
                                      &lt;b:include data='post' name='threaded-comment-form'/&gt;
                                      &lt;b:else/&gt;
                                      &lt;data:post.noNewCommentsText/&gt;
                                    &lt;/b:if&gt;
                                  &lt;/p&gt;
                                  &lt;b:if cond='data:showCmtPopup'&gt;
                                    &lt;div id='comment-popup'&gt;
                                      &lt;iframe allowtransparency='true' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'&gt;
                                      &lt;/iframe&gt;
                                    &lt;/div&gt;
                                  &lt;/b:if&gt;
                                  &lt;div id='backlinks-container'&gt;
                                    &lt;div expr:id='data:widget.instanceId + &amp;quot;_backlinks-container&amp;quot;'&gt;
                                      &lt;b:if cond='data:post.showBacklinks'&gt;
                                        &lt;b:include data='post' name='backlinks'/&gt;
                                      &lt;/b:if&gt;
                                    &lt;/div&gt;
                                  &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;/b:includable&gt;
                            &lt;/b:widget&gt;
                          &lt;/b:section&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      &lt;div class='column-left-outer'&gt;
                        &lt;div class='column-left-inner'&gt;
                          &lt;aside&gt;
                            &lt;macro:include id='main-column-left-sections' name='sections'&gt;
                              &lt;macro:param default='0' name='num' value='0'/&gt;
                              &lt;macro:param default='sidebar-left' name='idPrefix'/&gt;
                              &lt;macro:param default='sidebar' name='class'/&gt;
                              &lt;macro:param default='true' name='includeBottom'/&gt;
                            &lt;/macro:include&gt;
                          &lt;/aside&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      &lt;div class='column-right-outer'&gt;
                        &lt;div class='column-right-inner'&gt;
                          &lt;aside&gt;
                            &lt;macro:include id='main-column-right-sections' name='sections'&gt;
                              &lt;macro:param default='2' name='num' value='1'/&gt;
                              &lt;macro:param default='sidebar-right' name='idPrefix'/&gt;
                              &lt;macro:param default='sidebar' name='class'/&gt;
                              &lt;macro:param default='true' name='includeBottom'/&gt;
                            &lt;/macro:include&gt;
                          &lt;/aside&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div style='clear: both'/&gt;
                    &lt;!-- columns --&gt;
                  &lt;/div&gt;
                  &lt;!-- main --&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              &lt;div class='main-cap-bottom cap-bottom'&gt;
                &lt;div class='cap-left'/&gt;
                &lt;div class='cap-right'/&gt;
              &lt;/div&gt;
            &lt;/div&gt;
            &lt;footer&gt;
              &lt;div class='footer-outer'&gt;
                &lt;div class='footer-cap-top cap-top'&gt;
                  &lt;div class='cap-left'/&gt;
                  &lt;div class='cap-right'/&gt;
                &lt;/div&gt;
                &lt;div class='fauxborder-left footer-fauxborder-left'&gt;
                  &lt;div class='fauxborder-right footer-fauxborder-right'/&gt;
                  &lt;div class='region-inner footer-inner'&gt;
                    &lt;macro:include id='footer-sections' name='sections'&gt;
                      &lt;macro:param default='2' name='num'/&gt;
                      &lt;macro:param default='footer' name='idPrefix'/&gt;
                      &lt;macro:param default='foot' name='class'/&gt;
                      &lt;macro:param default='false' name='includeBottom'/&gt;
                    &lt;/macro:include&gt;
                    &lt;!-- outside of the include in order to lock Attribution widget --&gt;
                    &lt;b:section class='foot' id='footer-3' showaddelement='no'&gt;
                      &lt;b:widget id='Attribution1' locked='true' title='' type='Attribution'&gt;
                        &lt;b:widget-settings&gt;
                          &lt;b:widget-setting name='copyright'/&gt;
                        &lt;/b:widget-settings&gt;
                        &lt;b:includable id='main'&gt;
    &lt;div class='widget-content' style='text-align: center;'&gt;
      &lt;b:if cond='data:attribution != &amp;quot;&amp;quot;'&gt;
       &lt;data:attribution/&gt;
      &lt;/b:if&gt;
    &lt;/div&gt;

    &lt;b:include name='quickedit'/&gt;
  &lt;/b:includable&gt;
                      &lt;/b:widget&gt;
                    &lt;/b:section&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class='footer-cap-bottom cap-bottom'&gt;
                  &lt;div class='cap-left'/&gt;
                  &lt;div class='cap-right'/&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/footer&gt;
            &lt;!-- content --&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class='content-cap-bottom cap-bottom'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;script type='text/javascript'&gt;
      window.setTimeout(function() {
        document.body.className = document.body.className.replace(&amp;#39;loading&amp;#39;, &amp;#39;&amp;#39;);
                                                                  }, 10);
    &lt;/script&gt;
    &lt;!-- Syntax highlighter start --&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCSharp.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPowerShell.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCss.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPlain.min.js' type='text/javascript'/&gt;
    &lt;script type='text/javascript'&gt;
      SyntaxHighlighter.config.bloggerMode = true;	
      SyntaxHighlighter.all();
    &lt;/script&gt;
  &lt;/body&gt;
  &lt;macro:includable id='sections' var='col'&gt;
    &lt;macro:if cond='data:col.num == 0'&gt;
      &lt;macro:else/&gt;
      &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-1&amp;quot;' preferred='yes' showaddelement='yes'/&gt;
      &lt;macro:if cond='data:col.num &amp;gt;= 2'&gt;
        &lt;table border='0' cellpadding='0' cellspacing='0' mexpr:class='&amp;quot;section-columns columns-&amp;quot; + data:col.num'&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td class='first columns-cell'&gt;
                &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-1&amp;quot;'/&gt;
              &lt;/td&gt;
              &lt;td class='columns-cell'&gt;
                &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-2&amp;quot;'/&gt;
              &lt;/td&gt;
              &lt;macro:if cond='data:col.num &amp;gt;= 3'&gt;
                &lt;td class='columns-cell'&gt;
                  &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-3&amp;quot;'/&gt;
                &lt;/td&gt;
              &lt;/macro:if&gt;
              &lt;macro:if cond='data:col.num &amp;gt;= 4'&gt;
                &lt;td class='columns-cell'&gt;
                  &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-4&amp;quot;'/&gt;
                &lt;/td&gt;
              &lt;/macro:if&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;macro:if cond='data:col.includeBottom'&gt;
          &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-3&amp;quot;' showaddelement='no'/&gt;
        &lt;/macro:if&gt;
      &lt;/macro:if&gt;
    &lt;/macro:if&gt;
  &lt;/macro:includable&gt;
  
  
  
  
&lt;b:section-contents id='sidebar-right-1'&gt;
  &lt;b:widget id='Subscribe1' locked='false' title='訂閱' type='Subscribe'&gt;
    &lt;b:includable id='main'&gt;
  &lt;div style='white-space:nowrap'&gt;
    &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
      &lt;h2 class='title'&gt;&lt;data:title/&gt;&lt;/h2&gt;
    &lt;/b:if&gt;
    &lt;div class='widget-content'&gt;
      &lt;b:loop values='data:feeds' var='feed'&gt;
        &lt;div expr:class='&amp;quot;subscribe-wrapper subscribe-type-&amp;quot; + data:feed.type'&gt;

          &lt;div expr:class='&amp;quot;subscribe expanded subscribe-type-&amp;quot; + data:feed.type' expr:id='&amp;quot;SW_READER_LIST_&amp;quot; + data:widgetId + data:feed.type' style='display:none;'&gt;
            &lt;div class='top'&gt;
              &lt;span class='inner' expr:onclick='&amp;quot;return(_SW_toggleReaderList(event, \&amp;quot;&amp;quot; + data:widgetId +data:feed.type + &amp;quot;\&amp;quot;));&amp;quot;'&gt;
                &lt;img class='subscribe-dropdown-arrow' expr:src='data:arrowDropdownImg'/&gt;
                &lt;img align='absmiddle' alt='' border='0' class='feed-icon' expr:src='data:feedIconImg'/&gt;
                &lt;data:feed.title/&gt;
              &lt;/span&gt;

              &lt;div class='feed-reader-links'&gt;
                &lt;a class='feed-reader-link' expr:href='&amp;quot;https://www.netvibes.com/subscribe.php?url=&amp;quot; + data:feed.encodedUrl' target='_blank'&gt;
                  &lt;img expr:src='data:imagePathBase + &amp;quot;subscribe-netvibes.png&amp;quot;'/&gt;
                &lt;/a&gt;
                &lt;a class='feed-reader-link' expr:href='&amp;quot;https://add.my.yahoo.com/content?url=&amp;quot; + data:feed.encodedUrl' target='_blank'&gt;
                  &lt;img expr:src='data:imagePathBase + &amp;quot;subscribe-yahoo.png&amp;quot;'/&gt;
                &lt;/a&gt;
                &lt;a class='feed-reader-link' expr:href='data:feed.url' target='_blank'&gt;
                  &lt;img align='absmiddle' class='feed-icon' expr:src='data:feedIconImg'/&gt;
                  Atom
                &lt;/a&gt;
              &lt;/div&gt;

            &lt;/div&gt;
            &lt;div class='bottom'/&gt;
          &lt;/div&gt;

          &lt;div class='subscribe' expr:id='&amp;quot;SW_READER_LIST_CLOSED_&amp;quot; + data:widgetId +data:feed.type' expr:onclick='&amp;quot;return(_SW_toggleReaderList(event, \&amp;quot;&amp;quot; + data:widgetId +data:feed.type + &amp;quot;\&amp;quot;));&amp;quot;'&gt;
            &lt;div class='top'&gt;
               &lt;span class='inner'&gt;
                 &lt;img class='subscribe-dropdown-arrow' expr:src='data:arrowDropdownImg'/&gt;
                 &lt;span expr:onclick='&amp;quot;return(_SW_toggleReaderList(event, \&amp;quot;&amp;quot; + data:widgetId +data:feed.type + &amp;quot;\&amp;quot;));&amp;quot;'&gt;
                   &lt;img align='absmiddle' alt='' border='0' class='feed-icon' expr:src='data:feedIconImg'/&gt;
                   &lt;data:feed.title/&gt;
                 &lt;/span&gt;
               &lt;/span&gt;
             &lt;/div&gt;
            &lt;div class='bottom'/&gt;
          &lt;/div&gt;

        &lt;/div&gt;
      &lt;/b:loop&gt;

      &lt;div style='clear:both'/&gt;

    &lt;/div&gt;
  &lt;/div&gt;

  &lt;b:include name='quickedit'/&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='HTML1' locked='false' title='Facebook' type='HTML'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='content'&gt;&amp;lt;div id=&amp;quot;fb-root&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;


&amp;lt;div class=&amp;quot;fb-page&amp;quot; data-href=&amp;quot;https://www.facebook.com/alantsai.blog/&amp;quot; data-tabs=&amp;quot;timeline&amp;quot; data-small-header=&amp;quot;false&amp;quot; data-adapt-container-width=&amp;quot;true&amp;quot; data-hide-cover=&amp;quot;false&amp;quot; data-show-facepile=&amp;quot;true&amp;quot;&amp;gt;&amp;lt;blockquote cite=&amp;quot;https://www.facebook.com/alantsai.blog/&amp;quot; class=&amp;quot;fb-xfbml-parse-ignore&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;https://www.facebook.com/alantsai.blog/&amp;quot;&amp;gt;Alan Tsai的學習筆記&amp;lt;/a&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;/div&amp;gt;&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;!-- only display title if it's non-empty --&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
    &lt;h2 class='title'&gt;&lt;data:title/&gt;&lt;/h2&gt;
  &lt;/b:if&gt;
  &lt;div class='widget-content'&gt;
    &lt;data:content/&gt;
  &lt;/div&gt;

  &lt;b:include name='quickedit'/&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='HTML5' locked='false' title='Linkedin' type='HTML'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='content'&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;https://platform.linkedin.com/badges/js/profile.js&amp;quot; async defer&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;div class=&amp;quot;LI-profile-badge&amp;quot;  data-version=&amp;quot;v1&amp;quot; data-size=&amp;quot;medium&amp;quot; data-locale=&amp;quot;zh_TW&amp;quot; data-type=&amp;quot;vertical&amp;quot; data-theme=&amp;quot;light&amp;quot; data-vanity=&amp;quot;alantsai2007&amp;quot;&amp;gt;&amp;lt;a class=&amp;quot;LI-simple-link&amp;quot; href=&amp;#39;https://tw.linkedin.com/in/alantsai2007/zh-tw?trk=profile-badge&amp;#39;&amp;gt;Alan Tsai&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;!-- only display title if it's non-empty --&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
    &lt;h2 class='title'&gt;&lt;data:title/&gt;&lt;/h2&gt;
  &lt;/b:if&gt;
  &lt;div class='widget-content'&gt;
    &lt;data:content/&gt;
  &lt;/div&gt;

  &lt;b:include name='quickedit'/&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='Label1' locked='false' title='標籤' type='Label' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='sorting'&gt;ALPHA&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='display'&gt;LIST&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='selectedLabelsList'/&gt;
      &lt;b:widget-setting name='showType'&gt;ALL&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showFreqNumbers'&gt;true&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;b:if cond='data:title'&gt;
          &lt;H5&gt;
            &lt;data:title/&gt;
          &lt;/H5&gt;
        &lt;/b:if&gt;
        &lt;div expr:class='&amp;quot;widget-content &amp;quot; + data:display + &amp;quot;-label-widget-content&amp;quot;'&gt;
          &lt;b:if cond='data:display == &amp;quot;list&amp;quot;'&gt;
            &lt;ul&gt;
              &lt;b:loop values='data:labels' var='label'&gt;
                &lt;li&gt;
                  &lt;b:if cond='data:blog.url == data:label.url'&gt;
                    &lt;span expr:dir='data:blog.languageDirection'&gt;
                      &lt;data:label.name/&gt;
                    &lt;/span&gt;
                    &lt;b:else/&gt;
                    &lt;a expr:dir='data:blog.languageDirection' expr:href='data:label.url'&gt;
                      &lt;data:label.name/&gt;
                    &lt;/a&gt;
                  &lt;/b:if&gt;
                  &lt;b:if cond='data:showFreqNumbers'&gt;
                    &lt;span dir='ltr'&gt;
                      (
                      &lt;data:label.count/&gt;
                      )
                    &lt;/span&gt;
                  &lt;/b:if&gt;
                &lt;/li&gt;
              &lt;/b:loop&gt;
            &lt;/ul&gt;
            &lt;b:else/&gt;
            &lt;b:loop values='data:labels' var='label'&gt;
              &lt;span expr:class='&amp;quot;label-size label-size-&amp;quot; + data:label.cssSize'&gt;
                &lt;b:if cond='data:blog.url == data:label.url'&gt;
                  &lt;span expr:dir='data:blog.languageDirection'&gt;
                    &lt;data:label.name/&gt;
                  &lt;/span&gt;
                  &lt;b:else/&gt;
                  &lt;a expr:dir='data:blog.languageDirection' expr:href='data:label.url'&gt;
                    &lt;data:label.name/&gt;
                  &lt;/a&gt;
                &lt;/b:if&gt;
                &lt;b:if cond='data:showFreqNumbers'&gt;
                  &lt;span class='label-count' dir='ltr'&gt;
                    (
                    &lt;data:label.count/&gt;
                    )
                  &lt;/span&gt;
                &lt;/b:if&gt;
              &lt;/span&gt;
            &lt;/b:loop&gt;
          &lt;/b:if&gt;
          &lt;b:include name='quickedit'/&gt;
        &lt;/div&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='LinkList1' locked='false' title='好站連結' type='LinkList'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='text-8'&gt;E.K TechThinking&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-7'&gt;https://dotblogs.com.tw/JamesFu&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-8'&gt;http://edwardkuo.imas.tw/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-5'&gt;https://yi-shiuan.github.io/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-6'&gt;https://08alan.github.io/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-3'&gt;https://michael80321.blogspot.tw/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-4'&gt;https://kyleap.github.io/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-1'&gt;遜砲賴的爆肝筆記&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-0'&gt;Matsurigoto&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-3'&gt;&lt;![CDATA[Michael's World]]&gt;&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-2'&gt;天空的垃圾場&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-5'&gt;饅頭小舖&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-4'&gt;程式宅急便&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-7'&gt;五餅二魚工作室&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='text-6'&gt;維持熱情不滅 - Alan Liu&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='sorting'&gt;NONE&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-1'&gt;http://ina-work.blogspot.tw/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-2'&gt;http://skychang.github.io/&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='link-0'&gt;http://dog0416.blogspot.tw/&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;

&lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;&lt;h2&gt;&lt;data:title/&gt;&lt;/h2&gt;&lt;/b:if&gt;
 &lt;div class='widget-content'&gt;
   &lt;ul&gt;
     &lt;b:loop values='data:links' var='link'&gt;
       &lt;li&gt;&lt;a expr:href='data:link.target'&gt;&lt;data:link.name/&gt;&lt;/a&gt;&lt;/li&gt;
     &lt;/b:loop&gt;
   &lt;/ul&gt;
   &lt;b:include name='quickedit'/&gt;
 &lt;/div&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='PopularPosts1' locked='false' title='熱門文章' type='PopularPosts'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='numItemsToShow'&gt;5&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showThumbnails'&gt;false&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showSnippets'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='timeRange'&gt;LAST_MONTH&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;&lt;h2&gt;&lt;data:title/&gt;&lt;/h2&gt;&lt;/b:if&gt;
  &lt;div class='widget-content popular-posts'&gt;
    &lt;ul&gt;
      &lt;b:loop values='data:posts' var='post'&gt;
      &lt;li&gt;
        &lt;b:if cond='!data:showThumbnails'&gt;
          &lt;b:if cond='!data:showSnippets'&gt;
            &lt;!-- (1) No snippet/thumbnail --&gt;
            &lt;a expr:href='data:post.href'&gt;&lt;data:post.title/&gt;&lt;/a&gt;
          &lt;b:else/&gt;
            &lt;!-- (2) Show only snippets --&gt;
            &lt;div class='item-title'&gt;&lt;a expr:href='data:post.href'&gt;&lt;data:post.title/&gt;&lt;/a&gt;&lt;/div&gt;
            &lt;div class='item-snippet'&gt;&lt;data:post.snippet/&gt;&lt;/div&gt;
          &lt;/b:if&gt;
        &lt;b:else/&gt;
          &lt;!-- (3) Show only thumbnails or (4) Snippets and thumbnails. --&gt;
          &lt;div expr:class='data:showSnippets ? &amp;quot;item-content&amp;quot; : &amp;quot;item-thumbnail-only&amp;quot;'&gt;
            &lt;b:if cond='data:post.featuredImage.isResizable or data:post.thumbnail'&gt;
              &lt;div class='item-thumbnail'&gt;
                &lt;a expr:href='data:post.href' target='_blank'&gt;
                  &lt;b:with value='data:post.featuredImage.isResizable                                  ? resizeImage(data:post.featuredImage, 72, &amp;quot;1:1&amp;quot;)                                  : data:post.thumbnail' var='image'&gt;
                    &lt;img alt='' border='0' expr:src='data:image'/&gt;
                  &lt;/b:with&gt;
                &lt;/a&gt;
              &lt;/div&gt;
            &lt;/b:if&gt;
            &lt;div class='item-title'&gt;&lt;a expr:href='data:post.href'&gt;&lt;data:post.title/&gt;&lt;/a&gt;&lt;/div&gt;
            &lt;b:if cond='data:showSnippets'&gt;
              &lt;div class='item-snippet'&gt;&lt;data:post.snippet/&gt;&lt;/div&gt;
            &lt;/b:if&gt;
          &lt;/div&gt;
          &lt;div style='clear: both;'/&gt;
        &lt;/b:if&gt;
      &lt;/li&gt;
      &lt;/b:loop&gt;
    &lt;/ul&gt;
    &lt;b:include name='quickedit'/&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='BlogArchive1' locked='false' title='網誌存檔' type='BlogArchive' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='showStyle'&gt;HIERARCHY&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='yearPattern'&gt;yyyy&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showWeekEnd'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='monthPattern'&gt;MMMM&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='dayPattern'&gt;MMM dd&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='weekPattern'&gt;MM/dd&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='chronological'&gt;false&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showPosts'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='frequency'&gt;MONTHLY&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;b:if cond='data:title'&gt;
          &lt;H5&gt;
            &lt;data:title/&gt;
          &lt;/H5&gt;
        &lt;/b:if&gt;
        &lt;div class='widget-content'&gt;
          &lt;div id='ArchiveList'&gt;
            &lt;div expr:id='data:widget.instanceId + &amp;quot;_ArchiveList&amp;quot;'&gt;
              &lt;b:if cond='data:style == &amp;quot;HIERARCHY&amp;quot;'&gt;
                &lt;b:include data='data' name='interval'/&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:style == &amp;quot;FLAT&amp;quot;'&gt;
                &lt;b:include data='data' name='flat'/&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:style == &amp;quot;MENU&amp;quot;'&gt;
                &lt;b:include data='data' name='menu'/&gt;
              &lt;/b:if&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;b:include name='quickedit'/&gt;
        &lt;/div&gt;
      &lt;/b:includable&gt;
    &lt;b:includable id='flat' var='data'&gt;
        &lt;ul class='flat'&gt;
          &lt;b:loop values='data:data' var='i'&gt;
            &lt;li class='archivedate'&gt;
              &lt;a expr:href='data:i.url'&gt;
                &lt;data:i.name/&gt;
              &lt;/a&gt;
              (
              &lt;data:i.post-count/&gt;
              )
            &lt;/li&gt;
          &lt;/b:loop&gt;
        &lt;/ul&gt;
      &lt;/b:includable&gt;
    &lt;b:includable id='interval' var='intervalData'&gt;
        &lt;b:loop values='data:intervalData' var='i'&gt;
          &lt;ul class='hierarchy'&gt;
            &lt;li expr:class='&amp;quot;archivedate &amp;quot; + data:i.expclass'&gt;
              &lt;b:include data='i' name='toggle'/&gt;
              &lt;a class='post-count-link' expr:href='data:i.url'&gt;
                &lt;data:i.name/&gt;
              &lt;/a&gt;
              &lt;span class='post-count' dir='ltr'&gt;
                (
                &lt;data:i.post-count/&gt;
                )
              &lt;/span&gt;
              &lt;b:if cond='data:i.data'&gt;
                &lt;b:include data='i.data' name='interval'/&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:i.posts'&gt;
                &lt;b:include data='i.posts' name='posts'/&gt;
              &lt;/b:if&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/b:loop&gt;
      &lt;/b:includable&gt;
    &lt;b:includable id='menu' var='data'&gt;
        &lt;select expr:id='data:widget.instanceId + &amp;quot;_ArchiveMenu&amp;quot;'&gt;
          &lt;option value=''&gt;
            &lt;data:title/&gt;
          &lt;/option&gt;
          &lt;b:loop values='data:data' var='i'&gt;
            &lt;option expr:value='data:i.url'&gt;
              &lt;data:i.name/&gt;
              (
              &lt;data:i.post-count/&gt;
              )
            &lt;/option&gt;
          &lt;/b:loop&gt;
        &lt;/select&gt;
      &lt;/b:includable&gt;
    &lt;b:includable id='posts' var='posts'&gt;
        &lt;ul class='posts'&gt;
          &lt;b:loop values='data:posts' var='i'&gt;
            &lt;li&gt;
              &lt;a expr:href='data:i.url'&gt;
                &lt;data:i.title/&gt;
              &lt;/a&gt;
            &lt;/li&gt;
          &lt;/b:loop&gt;
        &lt;/ul&gt;
      &lt;/b:includable&gt;
    &lt;b:includable id='toggle' var='interval'&gt;
        &lt;b:if cond='data:interval.toggleId'&gt;
          &lt;b:if cond='data:interval.expclass == &amp;quot;expanded&amp;quot;'&gt;
            &lt;a class='toggle' href='javascript:void(0)'&gt;
              &lt;span class='zippy toggle-open'&gt;
                &amp;#9660;&amp;#160;
              &lt;/span&gt;
            &lt;/a&gt;
            &lt;b:else/&gt;
            &lt;a class='toggle' href='javascript:void(0)'&gt;
              &lt;span class='zippy'&gt;
                &lt;b:if cond='data:blog.languageDirection == &amp;quot;rtl&amp;quot;'&gt;
                  &amp;#9668;&amp;#160;
                  &lt;b:else/&gt;
                  &amp;#9658;&amp;#160;
                &lt;/b:if&gt;
              &lt;/span&gt;
            &lt;/a&gt;
          &lt;/b:if&gt;
        &lt;/b:if&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='Profile1' locked='false' title='關於我自己' type='Profile' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='showaboutme'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showlocation'&gt;false&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
          &lt;H5&gt;
            &lt;data:title/&gt;
          &lt;/H5&gt;
        &lt;/b:if&gt;
        &lt;div class='widget-content'&gt;
          &lt;b:if cond='data:team == &amp;quot;true&amp;quot;'&gt;
            &lt;!-- team blog profile --&gt;
            &lt;ul&gt;
              &lt;b:loop values='data:authors' var='i'&gt;
                &lt;li&gt;
                  &lt;a class='profile-name-link g-profile' expr:href='data:i.userUrl' expr:style='&amp;quot;background-image: url(&amp;quot; + data:i.profileLogo + &amp;quot;);&amp;quot;'&gt;
                    &lt;data:i.display-name/&gt;
                  &lt;/a&gt;
                &lt;/li&gt;
              &lt;/b:loop&gt;
            &lt;/ul&gt;
            &lt;b:else/&gt;
            &lt;!-- normal blog profile --&gt;
            &lt;b:if cond='data:photo.url != &amp;quot;&amp;quot;'&gt;
              &lt;a expr:href='data:userUrl'&gt;
                &lt;img class='profile-img' expr:alt='data:photo.alt' expr:height='data:photo.height' expr:src='data:photo.url' expr:width='data:photo.width'/&gt;
              &lt;/a&gt;
            &lt;/b:if&gt;
            &lt;dl class='profile-datablock'&gt;
              &lt;dt class='profile-data'&gt;
                &lt;a class='profile-name-link g-profile' expr:href='data:userUrl' expr:style='&amp;quot;background-image: url(&amp;quot; + data:profileLogo + &amp;quot;);&amp;quot;' rel='author'&gt;
                  &lt;data:displayname/&gt;
                &lt;/a&gt;
                &lt;b:if cond='data:hasgoogleprofile'&gt;
                  &lt;br/&gt;
                  &lt;div class='g-follow' data-annotation='bubble' data-height='20' expr:data-href='data:userUrl'/&gt;
                &lt;/b:if&gt;
              &lt;/dt&gt;
              &lt;b:if cond='data:showlocation == &amp;quot;true&amp;quot;'&gt;
                &lt;dd class='profile-data'&gt;
                  &lt;data:location/&gt;
                &lt;/dd&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:aboutme != &amp;quot;&amp;quot;'&gt;
                &lt;dd class='profile-textblock'&gt;
                  &lt;data:aboutme/&gt;
                &lt;/dd&gt;
              &lt;/b:if&gt;
            &lt;/dl&gt;
            &lt;a class='profile-link' expr:href='data:userUrl' rel='author'&gt;
              &lt;data:viewProfileMsg/&gt;
            &lt;/a&gt;
          &lt;/b:if&gt;
          &lt;b:include name='quickedit'/&gt;
        &lt;/div&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='HTML2' locked='false' title='證照' type='HTML' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='content'&gt;&amp;lt;div data-iframe-width=&amp;quot;150&amp;quot; data-iframe-height=&amp;quot;270&amp;quot; data-share-badge-id=&amp;quot;559a7c05-726c-4a06-8a9e-b063469178c6&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;

  &amp;lt;div data-iframe-width=&amp;quot;150&amp;quot; data-iframe-height=&amp;quot;270&amp;quot; data-share-badge-id=&amp;quot;2fbf4a03-2b66-4f64-85e0-7ae2af3eecb2&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;

&amp;lt;div data-iframe-width=&amp;quot;150&amp;quot; data-iframe-height=&amp;quot;270&amp;quot; data-share-badge-id=&amp;quot;0341291b-63b8-4984-a6ed-7c2237bf5786&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;

&amp;lt;div data-iframe-width=&amp;quot;150&amp;quot; data-iframe-height=&amp;quot;270&amp;quot; data-share-badge-id=&amp;quot;1d46889c-5036-4229-8832-1c5b1c6ca636&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;


&amp;lt;img alt=&amp;quot;ECSP .Net&amp;quot; src=&amp;quot;https://lh5.googleusercontent.com/-GD17p21gvUc/U-V6JiusCwI/AAAAAAAAMy4/eYWqZWHA_bk/w623-h380-no/ECSP-Logo.jpg&amp;quot; style=&amp;quot;width: 160px;&amp;quot;/&amp;gt;

&amp;lt;img alt=&amp;quot;MCSD: Web Application&amp;quot; src=&amp;quot;https://lh4.googleusercontent.com/-3hmmARqNPZA/U3tmJrrK4NI/AAAAAAAAMHM/Wa2VSDIjDBo/s800/MCSD_2013%2528rgb%2529_1477.png&amp;quot; /&amp;gt; &amp;lt;img alt=&amp;quot;Programming in HTML5 with JavaScript and CSS3 Specialist&amp;quot; src=&amp;quot;https://lh4.googleusercontent.com/-zniM1esvzT0/U3tmQRpnAZI/AAAAAAAAMHM/NE8Lki2w5Ss/s800/MS_2013%2528rgb%2529_1485.png&amp;quot; /&amp;gt; &amp;lt;img alt=&amp;quot;Programming in C# Specialist&amp;quot; src=&amp;quot;https://lh3.googleusercontent.com/-P5UiA9mCusE/U3tmUckuSPI/AAAAAAAAMHM/iwoMNBPZ6rA/s800/MS_2013%2528rgb%2529_1486.png&amp;quot; /&amp;gt; 


&amp;lt;img alt=&amp;quot;ECSP .Net&amp;quot; src=&amp;quot;https://lh5.googleusercontent.com/-GD17p21gvUc/U-V6JiusCwI/AAAAAAAAMy4/eYWqZWHA_bk/w623-h380-no/ECSP-Logo.jpg&amp;quot; style=&amp;quot;width: 160px;&amp;quot;/&amp;gt;


&amp;lt;!--
&amp;lt;img alt=&amp;quot;OCPJP 6&amp;quot; src=&amp;quot;https://lh6.googleusercontent.com/-UKJX1oCdrIQ/U3tmfL9xm3I/AAAAAAAAMHM/zPMQ0Q9m1uU/w738-h428-no/OCP_JavaSE6Programmer_clr.bmp&amp;quot; style=&amp;quot;width: 160px;&amp;quot; /&amp;gt; 
--&amp;gt;


  &amp;lt;div data-iframe-width=&amp;quot;150&amp;quot; data-iframe-height=&amp;quot;270&amp;quot; data-share-badge-id=&amp;quot;31968ac6-16a3-4639-83b3-4ee8b324a8f5&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;


  &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    (function() {
      var s = document.createElement(&amp;#39;script&amp;#39;);
      s.type = &amp;#39;text/javascript&amp;#39;;
      s.async = true;
      s.src = &amp;#39;//www.youracclaim.com/assets/utilities/embed.js&amp;#39;;
      var o = document.getElementsByTagName(&amp;#39;script&amp;#39;)[0];
      o.parentNode.insertBefore(s, o);
      })();
  &amp;lt;/script&amp;gt;&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;!-- only display title if it's non-empty --&gt;
        &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
          &lt;H5 class='title'&gt;
            &lt;data:title/&gt;
          &lt;/H5&gt;
        &lt;/b:if&gt;
        &lt;div class='widget-content'&gt;
          &lt;data:content/&gt;
        &lt;/div&gt;
        &lt;b:include name='quickedit'/&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='HTML3' locked='false' title='工商服務' type='HTML' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='content'&gt;&lt;![CDATA[&lt;script type="text/javascript" src="http://js1.bloggerads.net/showads.aspx?blogid=20150801000003&amp;amp;charset=utf-8"&gt;&lt;/script&gt;]]&gt;&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;!-- only display title if it's non-empty --&gt;
        &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
          &lt;h2 class='title'&gt;
            &lt;data:title/&gt;
          &lt;/h2&gt;
        &lt;/b:if&gt;
        &lt;div class='widget-content'&gt;
          &lt;data:content/&gt;
        &lt;/div&gt;
        &lt;b:include name='quickedit'/&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='AdSense1' locked='false' title='' type='AdSense'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='style.bgcolor'&gt;#ffffff&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.textcolor'&gt;#222222&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.layout'&gt;1x1&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.bordercolor'&gt;#ffffff&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.urlcolor'&gt;#2288bb&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.linkcolor'&gt;#000000&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='style.unittype'&gt;TextAndImage&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;div class='widget-content'&gt;
    &lt;data:adCode/&gt;
    &lt;b:include name='quickedit'/&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
&lt;/b:section-contents&gt;&lt;b:section-contents id='footer-1'&gt;
  &lt;b:widget id='HTML4' locked='false' title='版權' type='HTML' version='1'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='content'&gt;&lt;![CDATA[&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;&lt;img alt="創用 CC 授權條款" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"&gt;Alan Tsai 的隨手筆記&lt;/span&gt;由&lt;a xmlns:cc="http://creativecommons.org/ns#" href="http://blog.alantsai.net" property="cc:attributionName" rel="cc:attributionURL"&gt;Alan Tsai&lt;/a&gt;製作，以&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;創用CC 姓名標示 4.0 國際 授權條款&lt;/a&gt;釋出。]]&gt;&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
        &lt;!-- only display title if it's non-empty --&gt;
        &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
          &lt;H5 class='title'&gt;
            &lt;data:title/&gt;
          &lt;/H5&gt;
        &lt;/b:if&gt;
        &lt;div class='widget-content'&gt;
          &lt;data:content/&gt;
        &lt;/div&gt;
        &lt;b:include name='quickedit'/&gt;
      &lt;/b:includable&gt;
  &lt;/b:widget&gt;
&lt;/b:section-contents&gt;&lt;b:section-contents id='footer-2-1'/&gt;&lt;b:section-contents id='footer-2-2'/&gt;&lt;/html&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/template/default'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/template/default'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_PUBLISHING_MODE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌的發佈類型。</title><content type='text'>PUBLISH_MODE_HOSTED</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PUBLISHING_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PUBLISHING_MODE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ADMIN_PERMISSION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>此網誌管理員的電子郵件清單。</title><content type='text'>alantsai2007@gmail.com</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ADMIN_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ADMIN_PERMISSION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ADULT_CONTENT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>此網誌是否包含成人內容</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ADULT_CONTENT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ADULT_CONTENT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ALTERNATE_JSRENDER_ALLOWED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否允許其他的 Java 程式碼轉譯</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ALTERNATE_JSRENDER_ALLOWED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ALTERNATE_JSRENDER_ALLOWED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ANALYTICS_ACCOUNT_NUMBER</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌的 Google Analytics (分析) 帳號</title><content type='text'>UA-57211183-1</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ANALYTICS_ACCOUNT_NUMBER'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ANALYTICS_ACCOUNT_NUMBER'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ARCHIVE_DATE_FORMAT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>封存索引日期格式號碼</title><content type='text'>9</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ARCHIVE_DATE_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ARCHIVE_DATE_FORMAT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_ARCHIVE_FREQUENCY</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>封存此網誌的頻率</title><content type='text'>MONTHLY</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ARCHIVE_FREQUENCY'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_ARCHIVE_FREQUENCY'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_AUTHOR_PERMISSION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>有權進行發佈之作者的電子郵件清單。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_AUTHOR_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_AUTHOR_PERMISSION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_BACKLINKS_ALLOWED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在網誌上顯示意見反向連結</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_BACKLINKS_ALLOWED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_BACKLINKS_ALLOWED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_BY_POST_ARCHIVING</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否提供每篇文章的封存頁面</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_BY_POST_ARCHIVING'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_BY_POST_ARCHIVING'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_ACCESS</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>誰能留言</title><content type='text'>ANYONE</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_ACCESS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_ACCESS'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_CAPTCHA</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否要求想要留下意見的使用者通過驗證碼圖片驗證</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_CAPTCHA'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_CAPTCHA'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_EMAIL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>要收到新意見通知的電子郵件地址清單</title><content type='text'>alantsai2007@gmail.com</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_EMAIL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_FEED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>針對網誌意見提供的資訊提供類型</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_FEED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_FORM_LOCATION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌的留言欄位置</title><content type='text'>EMBEDDED_IFRAME</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_FORM_LOCATION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_FORM_LOCATION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_MESSAGE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌意見訊息</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MESSAGE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MESSAGE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_MODERATION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否啟用留言管理</title><content type='text'>DISABLED</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_MODERATION_DELAY</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>新意見受到管理之後的天數</title><content type='text'>14</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION_DELAY'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION_DELAY'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_MODERATION_EMAIL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>必須將收到新意見通知的電子郵件地址管理成為</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_MODERATION_EMAIL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENT_PROFILE_IMAGES</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在意見中顯示簡介圖片</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_PROFILE_IMAGES'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENT_PROFILE_IMAGES'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENTS_ALLOWED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否顯示意見</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENTS_ALLOWED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENTS_ALLOWED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_COMMENTS_TIME_STAMP_FORMAT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>留言時間戳記格式號碼</title><content type='text'>29</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENTS_TIME_STAMP_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_COMMENTS_TIME_STAMP_FORMAT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CONVERT_LINE_BREAKS</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在文章編輯器中將分行符號轉換成 &lt;br /&gt; 標記。</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CONVERT_LINE_BREAKS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CONVERT_LINE_BREAKS'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CUSTOM_ADS_TXT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌提供給廣告搜尋引擎的自訂 ads.txt 內容。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ADS_TXT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ADS_TXT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CUSTOM_ADS_TXT_ENABLED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌是否為廣告搜尋引擎提供自訂 ads.txt 內容。</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ADS_TXT_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ADS_TXT_ENABLED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CUSTOM_PAGE_NOT_FOUND</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>使用者在找不到要求的文章或網頁所看到的內容。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_PAGE_NOT_FOUND'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_PAGE_NOT_FOUND'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CUSTOM_ROBOTS_TXT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>提供給搜尋引擎的 robots.txt 自訂內容。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ROBOTS_TXT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ROBOTS_TXT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_CUSTOM_ROBOTS_TXT_ENABLED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌是否為搜尋引擎提供 robots.txt 自訂內容。</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ROBOTS_TXT_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_CUSTOM_ROBOTS_TXT_ENABLED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_DATE_FORMAT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>日期標題格式號碼</title><content type='text'>26</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DATE_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DATE_FORMAT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_DEFAULT_BACKLINKS_MODE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>文章的預設反向連結模式</title><content type='text'>DEFAULT_HAVE_BACKLINKS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DEFAULT_BACKLINKS_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DEFAULT_BACKLINKS_MODE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_DEFAULT_COMMENTS_MODE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>文章的預設留言模式</title><content type='text'>DEFAULT_HAVE_COMMENTS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DEFAULT_COMMENTS_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DEFAULT_COMMENTS_MODE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_DESCRIPTION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌的說明</title><content type='text'>記錄軟體開發和學習到的點點滴滴
著重於微軟技術和網頁開發：C#, Asp .net, Asp .net Mvc</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DESCRIPTION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_DESCRIPTION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_EMAIL_POST_LINKS</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否顯示連結讓使用者用電子郵件發佈文章</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_EMAIL_POST_LINKS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_EMAIL_POST_LINKS'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_FEED_REDIRECT_URL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>重新導向文章資訊提供要求的目標網址</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_FEED_REDIRECT_URL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_FEED_REDIRECT_URL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_FLOAT_ALIGNMENT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌是否已啟用浮動對齊功能</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_FLOAT_ALIGNMENT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_FLOAT_ALIGNMENT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_LOCALE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌的語言</title><content type='text'>zh_TW</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_LOCALE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_LOCALE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_M2B_WHITELIST_EMAIL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>可透過電子郵件張貼網誌文章的電子郵件地址清單。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_M2B_WHITELIST_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_M2B_WHITELIST_EMAIL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_MAX_NUM</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>在主網頁上顯示的最大物件數</title><content type='text'>7</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_MAX_NUM'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_MAX_NUM'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_MAX_UNIT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>在主網頁上顯示的一組物件</title><content type='text'>POSTS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_MAX_UNIT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_MAX_UNIT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_META_DESCRIPTION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>提供給搜尋引擎的網誌中繼說明。</title><content type='text'>記錄軟體開發和學習到的點點滴滴 著重於微軟技術和網頁開發：C#, Asp .net, Asp .net Mvc</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_META_DESCRIPTION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_META_DESCRIPTION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_META_DESCRIPTION_ENABLED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌是否提供中繼說明。</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_META_DESCRIPTION_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_META_DESCRIPTION_ENABLED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_NAME</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌名稱</title><content type='text'>Alan Tsai 的學習筆記</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_NAME'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_NAME'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_PER_POST_FEED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>針對個別文章意見提供的資訊提供類型</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PER_POST_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PER_POST_FEED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_POST_FEED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>針對網誌文章提供的資訊提供類型</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_FEED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_POST_FEED_FOOTER</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>文章資訊提供中附加到每個項目結尾的頁尾</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_FEED_FOOTER'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_FEED_FOOTER'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_POST_TEMPLATE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌文章範本</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_TEMPLATE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_POST_TEMPLATE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_PROMOTED</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在 Blogger 上宣傳這個網誌</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PROMOTED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_PROMOTED'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_QUICK_EDITING</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否已啟用快速編輯</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_QUICK_EDITING'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_QUICK_EDITING'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_READ_ACCESS_MODE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>網誌讀者的存取權類型。</title><content type='text'>PUBLIC</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_READ_ACCESS_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_READ_ACCESS_MODE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_READER_PERMISSION</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>有權閱讀此網誌之使用者的電子郵件清單。</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_READER_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_READER_PERMISSION'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_SEARCHABLE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否應由搜尋引擎產生此網誌的索引</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SEARCHABLE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SEARCHABLE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_SEND_EMAIL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>要收到新網誌文章之以逗號分隔的電子郵件清單</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SEND_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SEND_EMAIL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_SHOW_TITLE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否顯示標題欄位</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SHOW_TITLE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SHOW_TITLE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_SHOW_URL</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在文章撰寫程式中顯示相關的連結方塊</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SHOW_URL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_SHOW_URL'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_TIME_STAMP_FORMAT</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>時間戳記格式號碼</title><content type='text'>4</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_TIME_STAMP_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_TIME_STAMP_FORMAT'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_TIME_ZONE</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>這個網誌的時區</title><content type='text'>Asia/Taipei</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_TIME_ZONE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_TIME_ZONE'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.settings.BLOG_USE_LIGHTBOX</id><published>2014-09-13T14:00:58.834+08:00</published><updated>2018-03-27T18:31:46.928+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>是否在燈箱中顯示使用者所點選的圖片</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_USE_LIGHTBOX'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/settings/BLOG_USE_LIGHTBOX'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5199045806810969980</id><published>2018-03-04T01:44:00.000+08:00</published><updated>2018-03-04T01:44:07.604+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「開發工具小技巧」'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><category scheme='http://www.blogger.com/atom/ns#' term='tool'/><category scheme='http://www.blogger.com/atom/ns#' term='sql'/><title type='text'>[開發工具小技巧]NimbleText - 資料處理產生符合特定結構的好用小工具</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-uHqdoNQjEiA/WprcDeVIi2I/AAAAAAAAXxE/0UvmFj5hCYwlhiuv7evX2rOa-X4U36DUACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-nhXRIIhgDMU/WprcFBmFRRI/AAAAAAAAXxI/bLgSBHlvLQsBzkUO9_82FpH_4sAA3AtDwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/confused-muddled-illogical-880735/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;標題可能有點看不懂，因為不太確定怎麼下比較符合這個工具的主要作用。不過給一個情境應該就能夠比較了解。&lt;/p&gt;&lt;p&gt;            有時候需要匯入資料的時候，可能會收到一個email清單，這個email清單需要匯入到DB裡面，如果是產生出匯入的sql語法請問會怎麼做呢？         &lt;/p&gt;&lt;p&gt;            如果這個email清單只有10筆，手刻sql語法問題還不大，但是如果有1000筆email呢？         &lt;/p&gt;&lt;p&gt;            在換個和程式開發比較相關的情境，假設SA開了一個清單告訴你這個class所需要的Property有什麼，請問如何快速的產生出這個property呢？         &lt;/p&gt;&lt;p&gt;            在這篇將會介紹，如何用NimbleText這個工具快速做到上面兩個情境的需求。         &lt;/p&gt;&lt;/section&gt;         &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494661" ;=""&gt;NimbleText介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494912" ;=""&gt;NimbleText小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494278" ;=""&gt;版本的差異&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494215" ;=""&gt;使用介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494197" ;=""&gt;使用情境1 - 依照清單產生出insert sql語法&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494629" ;=""&gt;使用情境2 - 產生出class的property&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494642" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;         &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1520098053494661"&gt;NimbleText介紹&lt;/h2&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1520098053494912"&gt;NimbleText小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;官網&lt;/em&gt;:&lt;a href="http://nimbletext.com/"&gt;http://nimbletext.com/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Live(線上版)&lt;/em&gt;:&lt;a href="http://nimbletext.com/Live"&gt;http://nimbletext.com/Live&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Desktop&lt;/em&gt;: &lt;a href="http://nimbletext.com/Download/NimbleText.exe"&gt;直接下載&lt;/a&gt; &lt;/li&gt;&lt;li&gt;&lt;em&gt;版本差異&lt;/em&gt;: &lt;a href="http://nimbletext.com/Home/Professional"&gt;http://nimbletext.com/Home/Professional&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;            NimbleText這個工具作者給他的描述是：&lt;em&gt;Manipulate text and data with light-weight patterns&lt;/em&gt;。         &lt;/p&gt;&lt;p&gt;            簡單來說，就是把清單資料依照自己定義的範本去產生出內容。         &lt;/p&gt;&lt;p&gt;            聽起來還是有點抽象，不過等一下有範例的時候就會比較清楚。         &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1520098053494278"&gt;版本的差異&lt;/h3&gt;&lt;p&gt;                NimbleText有3個版本：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;Live&lt;/em&gt; - 線上版&lt;/li&gt;&lt;li&gt;&lt;em&gt;Desktop&lt;/em&gt; - 應用程式版&lt;/li&gt;&lt;li&gt;&lt;em&gt;Desktop + License&lt;/em&gt; - 應用程式版加買license&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;                這個工具非常佛心，基本上Live和Desktop都是免費，只有進階功能才需要License。以我目前使用來說，其實Live就很夠用了。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-BQg9jSW6sa8/WprcG6QD5zI/AAAAAAAAXxM/3QFlQASEsmsSVuEYeRIc2DfE13ETxAzhACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="660" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-SyOzf8L7lgM/WprcJrw-SNI/AAAAAAAAXxQ/j-aK-n2huPw9kFQRoFRfhHYiKdSDAr5iACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;功能版本差異 - 此圖沒有列出全部，詳細請看：http://nimbletext.com/Home/Professional&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1520098053494215"&gt;使用介紹&lt;/h3&gt;&lt;p&gt;                這邊會介紹&lt;em&gt;Live&lt;/em&gt;的版本。             &lt;/p&gt;&lt;p&gt;                整個畫面有3個部分：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;For each row in the list&lt;/em&gt;: 每一筆要被處理的資料&lt;/li&gt;&lt;li&gt;&lt;em&gt;Subsitute using this pattern&lt;/em&gt;:範本的內容&lt;/li&gt;&lt;li&gt;&lt;em&gt;Result&lt;/em&gt;:最後產生的結果&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3_1UKiDO5iA/WprcLokqFFI/AAAAAAAAXxU/9FeWXNEEGE0Frd4OqDr1uQ2cn9oZYh5SwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="840" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-whImwAvFCrk/WprcQYFhQlI/AAAAAAAAXxY/umuUaWFfDig6HXdYIZmwdN5Ob5Jn4XvNwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;3個基本功能的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;                在「結果」的右邊部分，能夠設定每一筆資料的:                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;column separator&lt;/em&gt;: 切割字&lt;/li&gt;&lt;li&gt;&lt;em&gt;row separtor&lt;/em&gt;: 斷行字&lt;/li&gt;&lt;li&gt;&lt;em&gt;insert&lt;/em&gt;: 預存的範本&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XOIVFBiTYI4/WprcSKvqNqI/AAAAAAAAXxc/96OYXGrj_aMp51d-zu-IjVS57_G79IiGQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="60" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-4Ib5wngcKpU/WprcS3z3G5I/AAAAAAAAXxg/qvMMbWJcV4kjl47wrYsZy-3XFz4N9VE2gCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;切割及斷行字&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;                最簡單的使用方式就是：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;把要處理的資料丟到&lt;code&gt;For each row in the list&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在&lt;code&gt;Subsitute using this pattern&lt;/code&gt;調整結果的範本。可以使用 &lt;code&gt;$0&lt;/code&gt;代表第一個切割欄位，以此類推&lt;/li&gt;&lt;li&gt;在&lt;code&gt;Result&lt;/code&gt;把最後結果複製出來&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1520098053494197"&gt;使用情境1 - 依照清單產生出insert sql語法&lt;/h2&gt;&lt;p&gt;            這個情景是，有一個清單是insert的一部分值，例如要把每一個email都產生出一個insert sql語法。         &lt;/p&gt;&lt;p&gt;            假設，拿到的清單如下： &lt;/p&gt;&lt;pre class="brush: plain;"&gt;test@test.com&lt;br /&gt;bbb@test.com&lt;br /&gt;ccc@test.com&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;            最後要匯入的sql語法是要到&lt;code&gt;EpaperSubscribe&lt;/code&gt;table裡面的&lt;code&gt;email&lt;/code&gt;欄位：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;INSERT INTO EpaperSubscribe (email)&lt;br /&gt;VALUES ('$0');&lt;/pre&gt;&lt;p&gt;            最後就可以把&lt;code&gt;Result&lt;/code&gt;複製出來在SSMS執行。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-LcBUIVvqQAo/WprcUiiDqNI/AAAAAAAAXxk/hXg1s8jEuMsYsHLJ00x-tiDZY9lzEYH6QCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="845" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-RKauEENic-A/WprcYGLvX2I/AAAAAAAAXxo/LNNpsu-3RNcfNcSqTdHB-I790mjGIa1hACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後結果截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1520098053494629"&gt;使用情境2 - 產生出class的property&lt;/h2&gt;&lt;p&gt;            假設SA開好class裡面所有的property名稱及形態，怎麼快速產生這些property？         &lt;/p&gt;&lt;p&gt;            假設得到的property類型和名稱清單如下：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;int Id&lt;br /&gt;string Name&lt;br /&gt;DateTime CREATEDATE&lt;/pre&gt;&lt;p&gt;            要產生的property為public包含get及set的版本，範本會是：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;public $0  &amp;lt;% $1.toPascalCase() %&amp;gt; { get; set;}&lt;br /&gt;            &lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;                這邊注意到，最後一個欄位名稱是&lt;em&gt;全部大寫&lt;/em&gt;，不過透過NimbleText的功能可以建立出符合C#命名規則的Property名稱。             &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;                如果說要建立出包含private variable的property，可以從範本裡面選做參考。             &lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;                上面那個範例要能夠成功，記得&lt;em&gt;column separator&lt;/em&gt;要改成&lt;em&gt;空白&lt;/em&gt;。             &lt;/div&gt;&lt;p&gt;            最後產生的結果就直接貼到C#的class裡面。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-QjNh-qr_yCk/WprcbEzLAoI/AAAAAAAAXxs/INIpSdKvmaEaO_J3HJQqy1M0ZZJx3ATFQCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="450" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--8u5ddl4YN0/WprcgZdQ-4I/AAAAAAAAXxw/rwaorHP8npgFsZjaWO0ktTEDMAyw5BAjgCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;產生的最後結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1520098053494642"&gt;結語&lt;/h2&gt;&lt;p&gt;            如果沒有NimbleText要達到上面的功能，一般會使用類似RegEx搭配產生，但是實際上並不好寫。         &lt;/p&gt;&lt;p&gt;            透過使用NimbleText讓整個的操作上變得非常的簡單，並且透過把這些pattern記錄下來隨時都可以讓一樣資料結構產生出需要的結果。         &lt;/p&gt;&lt;p&gt;            如果有更好的工具及做法也歡迎大家留言給我。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;             &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:09e0d3b0-4fe8-4ff4-b457-8b19256b9978" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7%e5%b0%8f%e6%8a%80%e5%b7%a7%e3%80%8d" rel="tag"&gt;「開發工具小技巧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/tool" rel="tag"&gt;tool&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/C%23" rel="tag"&gt;C#&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/sql" rel="tag"&gt;sql&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5199045806810969980/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/03/devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5199045806810969980'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5199045806810969980'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/03/devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern.html' title='[開發工具小技巧]NimbleText - 資料處理產生符合特定結構的好用小工具'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-nhXRIIhgDMU/WprcFBmFRRI/AAAAAAAAXxI/bLgSBHlvLQsBzkUO9_82FpH_4sAA3AtDwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3063784864121628277</id><published>2018-02-28T19:07:00.000+08:00</published><updated>2018-02-28T19:07:01.382+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「開發工具小技巧」'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><title type='text'>[開發工具小技巧]在Visual Studio 快速找到對應的程式碼，多多使用「移至」(Go To)及套件Codinion</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Fe8-SfAxRm0/WpaHPOlD0dI/AAAAAAAAXvo/APKK8O4-ItcfcAQdUrIEgdrzgEZMho1zACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mtP8dIVwT4o/WpaHQZfuWYI/AAAAAAAAXvs/lXvyIyiFWXsOsw8A1_U4gldXFWdk_tKhQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/confused-muddled-illogical-880735/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在開發的時候，能夠用Visual Studio (以下簡稱VS) 快速定義到要改或者想找到的程式碼片段很重要。&lt;/p&gt;&lt;p&gt;        假設本來要花10秒才能夠打開要的片段，透過使用VS和套件的功能能夠在3秒內就打開，只要發生10次就能夠節省1分鐘的時間。無形之中就可以省掉很多零碎的時間。     &lt;/p&gt;&lt;p&gt;        這篇將會介紹如何用VS內建的&lt;em&gt;移至 (Go to)&lt;/em&gt;找到某個程式碼片段，用&lt;em&gt;codinion&lt;/em&gt;套件快速找到目前打開的檔案member。     &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498159574" ;=""&gt;移至 (Go to) 功能介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498159946" ;=""&gt;如何啟動 移至 的功能&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498160990" ;=""&gt;幾種 移至 的方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498160739" ;=""&gt;把 移至 的篩選限定在當前打開的檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498160787" ;=""&gt;使用Codinion套件做移動&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519813498160585" ;=""&gt;套件：codinion小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1519813498159574"&gt;移至 (Go to) 功能介紹&lt;/h2&gt;&lt;p&gt;        一般來說，開啟solution之後，接下來就是要打開要修改的code檔案。例如調整某個class內容。     &lt;/p&gt;&lt;p&gt;        如果不用任何方式的話，那麼就是用&lt;em&gt;Solution Explorer&lt;/em&gt;瀏覽到code的檔案位置然後打開。換句話說需要&lt;em&gt;記得&lt;/em&gt;資料夾結構。     &lt;/p&gt;&lt;p&gt;        如果這個Solution並不是自己從頭到尾開發或者說專案很大的話，那麼這樣開就很花時間。     &lt;/p&gt;&lt;p&gt;        換個角度來看，既然已經知道了要改的class名稱，那麼是否能夠用那個class名稱&lt;em&gt;搜索移動&lt;/em&gt;到那個class所在的位置？     &lt;/p&gt;&lt;p&gt;        這就是&lt;em&gt;移至 (Go to)&lt;/em&gt;的功能。     &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519813498159946"&gt;如何啟動 移至 的功能&lt;/h3&gt;&lt;p&gt;            可以使用：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;快捷鍵：預設是 &lt;code&gt;Ctrl + ,&lt;/code&gt;&lt;/li&gt;&lt;li&gt;                     Menu：&lt;code&gt;Edit -&amp;gt; Go To&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-64qrl1p0yWc/WpaHRaNvMfI/AAAAAAAAXvw/CDIyIJFxkGYtreSscz2e4LdajBN-92-kwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="225" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-P6bejP8MmN0/WpaHSSLKqeI/AAAAAAAAXv0/obbuy93rFiMOI62AM15W5CG8hiQeeloVQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;用Edit Toolbar開啟設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;            由於預設的快速鍵和注音輸入發的逗點快速鍵是一樣，因此很有可能按下之後還是不會出現。             &lt;/p&gt;&lt;p&gt;                因此建議調整快速鍵，以我自己為例是改成&lt;code&gt;Alt+,&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DzCr46XKerA/WpaHTQeVjAI/AAAAAAAAXv4/7GsCES47tG4kXCfBBco7w6s9M4ZicdswACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="442" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-K98rGblPCUE/WpaHUSLzk_I/AAAAAAAAXv8/sHMqIT9HimAwgngY7dAuvan8HuXh2PDaQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;修改預設快捷鍵&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519813498160990"&gt;幾種 移至 的方式&lt;/h3&gt;&lt;p&gt;            當把 移至 呼叫起來了之後，看到的畫面是：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Qjg8WVArAnA/WpaHVG3WFPI/AAAAAAAAXwA/vfb5Rhmij30VBM8pPs-VR8TMzPuyH2R8QCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="198" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MdtSdQKu4ig/WpaHWMhXVMI/AAAAAAAAXwE/oXMvlVvTl_Q_1qvKVs2fnzNezIrF4676wCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;啟動 的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;Go To Line (Ctrl+G) 字符：&lt;code&gt;:&lt;/code&gt;&lt;/em&gt; - 點下這個選項之後，可以輸入要跳過去的&lt;em&gt;行數&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Go To File (Ctrl+1, Ctrl+F) 字符: &lt;code&gt;f&lt;/code&gt;&lt;/em&gt; - 這個選項是搜索&lt;em&gt;檔名&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Go To Types (Ctrl+1, Ctrl+T) 字符: &lt;code&gt;t&lt;/code&gt;&lt;/em&gt; - 這個選項是搜索&lt;em&gt;class、Struct、Enums、Interface和Delegate&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Go To Member (Ctrl+1, Ctrl+M) 字符: &lt;code&gt;m&lt;/code&gt;&lt;/em&gt; - 這個選項是搜索&lt;em&gt;variable、property、method、constant、enum item和event&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Go To Symbol (Ctrl+1, Ctrl+S) 字符: &lt;code&gt;#&lt;/code&gt;&lt;/em&gt; - 這個選項是搜索 &lt;em&gt; Types + Member&lt;/em&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;            這幾個選項如果點下去，會發現其實就是在前面加上一個特殊字符。例如，Go To Line就是 加上&lt;code&gt;:&lt;/code&gt;。             所以完全可以只記得一個快速鍵，就是如何把Go To呼叫起來，然後在打特殊字符做篩選。         &lt;/div&gt;&lt;div class="bs-callout bs-callout-danger"&gt;            如果沒有記錯，Go To是VS 2017才有的功能，VS 2015則是只有Navigate To。兩者最大的差異是在Navigate To沒有這些篩選項目。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519813498160739"&gt;把 移至 的篩選限定在當前打開的檔案&lt;/h3&gt;&lt;p&gt;            在剛剛那5個不同篩選項目之後都是和設定有關的內容。         &lt;/p&gt;&lt;p&gt;            這邊只提Symbol選項旁邊的那個，是&lt;em&gt;Current Document (Ctrl+Alit+c)&lt;/em&gt;。這個選項的意思是，如果開啟的話，把搜索條件限制在&lt;em&gt;當前檔案&lt;/em&gt;。         &lt;/p&gt;&lt;p&gt;            這個最長和Go To Member做搭配。一般來說想要快速跳到當前檔案的某個property或者method，就會限定在目前這個檔案。         &lt;/p&gt;&lt;p&gt;            不過這個方式有個缺點，因為很多時候是打搜索的文字到一半，才想起來要限制在當前檔案，這個時候如果加上這個選項，剛剛打到一半的內容&lt;em&gt;會清空&lt;/em&gt;。             由於共用一個Go To搜索框，所以當要搜索全域的時候，很有可能已經把要打的字打了一半，才發現忘記不要開這個設定，造成要重新打。         &lt;/p&gt;&lt;p&gt;            這也是為什麼用到Codinion。因為廣域和當前檔案可以分開兩個不同快捷鍵觸發（內建的Go To沒有找到這個快捷鍵）         &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1519813498160787"&gt;使用Codinion套件做移動&lt;/h2&gt;&lt;div class="bs-callout bs-callout-info"&gt;        題外話，在另外一篇有提到Codinion的另外一個功能，為不同類型欄位給出不同的顏色：&lt;a style="line-height: 1.6; font-size: 15px;" href="wiz://open_document?guid=43dcab07-ddf6-42e4-9ddd-91c49d4f94e2&amp;amp;kbguid=&amp;amp;private_kbguid=b1ed89f6-16c8-11e1-8d03-00237def97cc"&gt;[開發工具小技巧]調整Visual Studio的字形及文字顏色&lt;/a&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1519813498160585"&gt;套件：codinion小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;套件：&lt;a href="https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion"&gt;https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載：&lt;a href="https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;官網：&lt;a href="https://www.codinion.com/"&gt;https://www.codinion.com/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;支援的VS版本：2012、2015、2017&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;        當初會裝Codinion的套件的原因就是因為在VS 2015無法區分，File、Member及Symbol，所以才找到了這個套件。     &lt;/p&gt;&lt;p&gt;        基本上VS內建的Go To可以取代大部分Codinion的搜索功能，不過當要在&lt;em&gt;當前檔案&lt;/em&gt;找到某個member的時候，個人還是覺得Codinion比較好用。     &lt;/p&gt;&lt;p&gt;        以Codinion找到目前檔案的某個member為例，快速鍵是&lt;code&gt;Alt+M&lt;/code&gt;(不確定這個是我自己改的還是內建的快速鍵)，會直接下拉出目前所有member         以及可以打來過濾：     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-QJDdx-cNnbM/WpaHZ4YFQZI/AAAAAAAAXwI/9xjVGrKFNIEw3N5-mttbZwmZACwkoPyOQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="118" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-JSLlltQwSFg/WpaHaluF_8I/AAAAAAAAXwM/ttjKNnWvQaMM7W5FzwS6_NL5c0rAWbQvwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;範例畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;        這個對我來說有兩個好處：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;有時候我想要看到所有的項目&lt;/em&gt;：因為忘記關鍵字是什麼，可以用鍵盤下來快速找&lt;/li&gt;&lt;li&gt;&lt;em&gt;搭配設定的顏色&lt;/em&gt;: 這樣可以直覺的找到什麼是什麼。例如我的method是深紅色，那麼看到就可以直覺關聯起來&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-danger"&gt;        不過Codinion有時候啟動會比較慢，可能是因為先把清單load出來造成。因此有好有壞。     &lt;/div&gt;&lt;/section&gt;      &lt;section&gt;         &lt;h2&gt;結語&lt;/h2&gt;&lt;p&gt;            能夠快速找到想要了解或者修改的程式碼是一個非常重要的技能，因為太常用到了，因此只要能夠提升速度就可以減少很多浪費的時間。         &lt;/p&gt;&lt;p&gt;            希望透過這篇能夠讓大家知道VS在這方面所提供的功能，也歡迎如果有不同的建議能夠和我做分享。         &lt;/p&gt;&lt;/section&gt;     &lt;section&gt;         &lt;h2&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="https://blogs.msdn.microsoft.com/vcblog/2016/11/16/introducing-go-to-the-successor-to-navigate-to/"&gt;Introducing Go To, the successor to Navigate To&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;                 介紹Go To的功能             &lt;/dd&gt;&lt;dt&gt;                 &lt;a href="https://www.codinion.com/"&gt;Codinion官網&lt;/a&gt;             &lt;/dt&gt;&lt;dd&gt;                 官網介紹Codinion的功能             &lt;/dd&gt;         &lt;/dl&gt;&lt;/section&gt;     &lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:65b270d2-73b3-406f-b181-84d14d4f0890" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7%e5%b0%8f%e6%8a%80%e5%b7%a7%e3%80%8d" rel="tag"&gt;「開發工具小技巧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3063784864121628277/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-3-quickly-navigate-code-using-go-to-and-codinion.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3063784864121628277'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3063784864121628277'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-3-quickly-navigate-code-using-go-to-and-codinion.html' title='[開發工具小技巧]在Visual Studio 快速找到對應的程式碼，多多使用「移至」(Go To)及套件Codinion'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-mtP8dIVwT4o/WpaHQZfuWYI/AAAAAAAAXvs/lXvyIyiFWXsOsw8A1_U4gldXFWdk_tKhQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4870779786143822068</id><published>2018-02-25T13:06:00.000+08:00</published><updated>2018-02-25T13:06:10.517+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「開發工具小技巧」'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><title type='text'>[開發工具小技巧]調整Visual Studio的字形及文字顏色</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bcZAx-tjzAU/WpJCQMVxm7I/AAAAAAAAXss/FHaXWHdjc_YNQ83pVVseQ2dG-SRdcjLVQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-STSS-6xGiCY/WpJCRwUZU4I/AAAAAAAAXsw/hQZNTslVJK0k6SMtxcQPEkUwEVWn2_gPACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/confused-muddled-illogical-880735/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;            Visual Studio(以下簡稱VS)是.Net開發者的最主要工具，而開發者天天面對的就是寫code。所以，讓code看起來舒服，好辨識非常的重要。         &lt;/p&gt;&lt;p&gt;            這篇將會對於如何讓看code的時候更加舒服，並且透過顏色的方式讓整個code更加容易辨識。         &lt;/p&gt;&lt;/section&gt;         &lt;section&gt;             &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798506" ;=""&gt;字體及大小設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798890" ;=""&gt;code的字體及大小&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798572" ;=""&gt;IntelliSense的字體及大小&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798185" ;=""&gt;調整選取到同樣的參數呈現的顏色&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798799" ;=""&gt;套件：Word Highlight With Margin&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798595" ;=""&gt;套件Word Highlight With Margin小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798155" ;=""&gt;把不同的code類型給上不同的顏色&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798158" ;=""&gt;套件：codinion小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1519533906798797" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;                &lt;a name='more'&gt;&lt;/a&gt;       &lt;section&gt;&lt;h2 id="WizKMOutline_1519533906798506"&gt;字體及大小設定&lt;/h2&gt;&lt;p&gt;            第一個影響到看code的舒適度是找一個&lt;em&gt;&lt;strong&gt;適合自己&lt;/strong&gt;&lt;/em&gt;的字體及字體大小。         &lt;/p&gt;&lt;p&gt;            我自己對於字體沒有太特別的研究，不過一個適合code的字體最少要符合以下幾點：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;間距一致 - 也就是所謂的 Monospace Font (等寬字體)&lt;/li&gt;&lt;li&gt;l(小寫 L)、I(大寫 i) 以及 1(數字) 容易分辨&lt;/li&gt;&lt;li&gt;0(數字)、o(英文字母)以及 O (英文字母大寫) 容易分辨&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RRO9SkJjzVk/WpJCTRAhDZI/AAAAAAAAXs0/806fbqONgYACRfUmYTAcqYhpOHQHAyGnQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="531" height="201" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-eqgId9OQF_4/WpJCUrpu-EI/AAAAAAAAXs4/QWWwiXAXqJgxIZ68c6sM7PDY2VcyuZU2ACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Monospace Font和Propration font的差異 - 可以看到Monospace font每個字體的寬度都一樣，來源：https://en.wikipedia.org/wiki/Monospaced_font&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;            如果不裝任何其他字體的情況下，內建的&lt;code&gt;Consolas&lt;/code&gt;就是一個很好用的字體。VS在近幾年的版本預設都是使用&lt;code&gt;consolas&lt;/code&gt;             因此如果沒有自己喜歡的字體，其實不用做任何調整。         &lt;/p&gt;&lt;p&gt;            在VS要調整字體相關的，可以用&lt;em&gt;Font and Colors&lt;/em&gt;的設定選項來改，可以直接透過右上角的&lt;em&gt;Quick lunch&lt;/em&gt;直接搜索到：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-sCLYn781kQc/WpJCVTG-HnI/AAAAAAAAXs8/TOvWoq9o8asL8z4L6Dv49RpEuawI_kTvACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="227" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-l1C5saaIxoY/WpJCWuXLEZI/AAAAAAAAXtA/IAh2Oerj_iIMkoy2OIQ6RMmmSZa0RsaWgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-BJDcgAj8vFw/WpJCX0772WI/AAAAAAAAXtE/ADJPHWG5UnU9iL4M19eCd3obTBvY_5-SgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="442" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-m_poAVaxnuU/WpJCY0F_fxI/AAAAAAAAXtI/WR9fdg1dJlAC4Yeu1fo3q-j1ix7Il_82QCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;用quick lunch找到設定位置&lt;/figcaption&gt;&lt;/figure&gt;             接下來的主要設定都在這個視窗裡面。         &lt;p&gt;            在VS裡面會建議調整兩個地方：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;code的字體及大小&lt;/li&gt;&lt;li&gt;IntelliSense的字體及大小&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519533906798890"&gt;code的字體及大小&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Text Editor &amp;gt; Plain Text&lt;/code&gt;就是設定主要code的字體及大小。             &lt;/p&gt;&lt;p&gt;                字體的部分沒有什麼太好的建議，我習慣用&lt;em&gt;consolas&lt;/em&gt;，不過字體大小建議放大一點點。以我自己電腦為例，&lt;em&gt;12&lt;/em&gt;是適合的大小：                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-PALl7CYBmV4/WpJCaGu7zxI/AAAAAAAAXtM/NWljQgbnyjg-5EjzrV1G-iE9LmVY5-7CwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="175" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-EUW2_B7AoDM/WpJCbMaV8dI/AAAAAAAAXtQ/_mc0WFyfV20_Xeyf8oECVV4eFBrjCGKOQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-cYsrraaIZeA/WpJCcPOmh1I/AAAAAAAAXtU/zGQMkmqztZESoS1rlm4b9ymuRdlrE0dkwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="204" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dXT8gh7heYw/WpJCdccC-sI/AAAAAAAAXtY/_hOCA_OF3bM_o8DE3vdRtA988NvwhwEkgCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;左邊是10的截圖，右邊則是12的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519533906798572"&gt;IntelliSense的字體及大小&lt;/h3&gt;&lt;p&gt;                另外一個可以調整的是寫code裡面出現的IntelliSense。             &lt;/p&gt;&lt;p&gt;&lt;code&gt;Editor Tooltip -&amp;gt; Plain Text&lt;/code&gt;&lt;/p&gt;&lt;p&gt;                預設大小是9，建議大小可以調整為12，字體的部分則沒有特別的建議                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-U5CtEqV1xy4/WpJCfhnSjVI/AAAAAAAAXtc/PqWrCHYFm84tXatcN03rCRuILBRibcuBwCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="442" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rEHNKo_gfQs/WpJCg5ynFII/AAAAAAAAXtg/VmojLvo3Ew0cJprJCEarWb5hbDfSYapzgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;                從下面可以看出修改前後差異：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-fmbQsDh97FA/WpJCiKO9DFI/AAAAAAAAXtk/cBWj-7T13RsQQ5qoCXqmU94grZkhFRsIACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="468" height="194" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2eNZ7g8k0o8/WpJCi4lCUpI/AAAAAAAAXto/jQl2DATrhjYlWIWsdviVk5C989SNqXh2QCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-93rMuheR5Hc/WpJCjmg2h7I/AAAAAAAAXts/EFVINL5ncxMjaiJdMFYP8bh-ntA8XoycgCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="483" height="216" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-fK1leBFPLWU/WpJCkvuJuHI/AAAAAAAAXtw/84LIC6aR3OkJuhQUnARvRnB458VHc6f9QCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;左邊是預設的大小，右邊則是改成12大小&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1519533906798185"&gt;調整選取到同樣的參數呈現的顏色&lt;/h2&gt;&lt;p&gt;           有一個常見的動作是看目前選取的參數還有在那裡有用到。預設這個顏色是灰色，建議可以改成更顯眼的顏色。          &lt;/p&gt;&lt;p&gt;            修改位置在：&lt;code&gt;Text Editor -&amp;gt; Highlighted Reference&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HQbmvJe2qjs/WpJClv6X1UI/AAAAAAAAXt0/HcVsiKGygkM-uBkS1Rjc7_ZfvGIwqmtmQCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="442" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tO1T9Is9WeM/WpJCmuOQAAI/AAAAAAAAXt4/0zIMvVCL9KQNtXPypgUiespmAinXHGN_gCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;            修改前後的差異：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-S5twfN5WK-c/WpJCnY04qDI/AAAAAAAAXt8/IfWV0t-2cjooOIeJY9XUl7H2s90fhMnswCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="498" height="166" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1-w5MHGYSHU/WpJCoQ3NhcI/AAAAAAAAXuA/H2yKlURn0uwWrX0pBn0_VpF4CQ03VezzgCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-N8XiEYgtGNQ/WpJCpjw9FnI/AAAAAAAAXuE/JOcwW4TGTxc9UeC__Q5xFRRSCt2LZ4OQwCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="489" height="160" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-B5asjc_jxFg/WpJCq0xVrYI/AAAAAAAAXuI/7HMagBulkRUCSWgvz37-YlRq1-bVkmUUQCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;左邊是修改前灰色，右邊是修改後的黃色&lt;/figcaption&gt;&lt;/figure&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1519533906798799"&gt;套件：Word Highlight With Margin&lt;/h3&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1519533906798595"&gt;套件Word Highlight With Margin小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;套件位置：&lt;a href="https://marketplace.visualstudio.com/items?itemName=TrungKienPhan.WordHighlight-18439"&gt;https://marketplace.visualstudio.com/items?itemName=TrungKienPhan.WordHighlight-18439&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載：&lt;a href="https://marketplace.visualstudio.com/items?itemName=TrungKienPhan.WordHighlight-18439"&gt;VS 2017&lt;/a&gt;&lt;/li&gt;&lt;li&gt;支援的VS版本：2012、2015和2017&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;                上面提到的改法已經符合一般使用，不過如果還要更一步更明顯的效果，可以考慮套件&lt;em&gt;&lt;strong&gt;Word Highlight With Margin&lt;/strong&gt;&lt;/em&gt;。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;                不過要注意一下，這個套件和剛剛那個做法有點不同在於剛剛那個是 &lt;em&gt;同一個參數&lt;/em&gt; 才會被highlight，這個比較像是搜索的概念，符合條件的都列出。             &lt;/div&gt;&lt;p&gt;                這個套件加了幾個特別的地方：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;右邊的scroll bar會呈現目前選取的參數位置&lt;/li&gt;&lt;li&gt;能夠設定當目前游標移動離開的時候還保留剛剛參數選取的狀況(這個模式預設不啟用)&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;                同樣範例用套件呈現的話：                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-FaEZQTiW_XA/WpJCrlM9NMI/AAAAAAAAXuM/ikjW4geEdKMR_bUgFLeGdcCA6gIbfU2XQCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="437" height="181" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ZGAfxKNWEv8/WpJCs_jFr-I/AAAAAAAAXuQ/vtwtwMki9sgUU-LWORHnRqJaVJCCDVCVACHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;使用套件的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1519533906798155"&gt;把不同的code類型給上不同的顏色&lt;/h2&gt;&lt;p&gt;            有時候在看code的時候，能夠容易識別出，那些是傳進來的參數，那些是方法的local參數，那些是方法能夠加強開發速度。         &lt;/p&gt;&lt;p&gt;            有個條件叫做&lt;em&gt;codinion&lt;/em&gt;的其中一個功能就是這個作用。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1519533906798158"&gt;套件：codinion小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;套件：&lt;a href="https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion"&gt;https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載：&lt;a href="https://marketplace.visualstudio.com/items?itemName=MartinTopfstedt.Codinion"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;官網：&lt;a href="https://www.codinion.com/"&gt;https://www.codinion.com/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;支援的VS版本：2012、2015、2017&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;            設定方式從&lt;code&gt;Codinion (Toolbar) -&amp;gt; Options -&amp;gt; &lt;/code&gt;，&lt;em&gt;options&lt;/em&gt;裡面 &lt;code&gt;Highlighting -&amp;gt; CSharp&lt;/code&gt;做調整             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Jw-fSDMVSe4/WpJCuBDP-zI/AAAAAAAAXuU/7n3Qed3-rvEjkWipvEIPUwJgqd5Z6gMGQCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="453" height="246" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ciNdM0fA9fk/WpJCvpsTr7I/AAAAAAAAXuY/q3r5O7_eQDErMCdgBuKQCTSoxRYLgZimQCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-avsdiRsapss/WpJCwqi9uJI/AAAAAAAAXuc/0RjdpwAtRi4T0bVb6OaQl6Zj-4QoForrACHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="439" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-R79kAfhGfCQ/WpJCx23qytI/AAAAAAAAXug/ljYy6ESViiI2meAnjTg5CTJurb4R17nNQCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定方式&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;            下圖左邊是原本的樣子，右邊則是有加過顏色的部分。可以看到：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;傳入的參數是灰色&lt;/li&gt;&lt;li&gt;方法是暗紅色&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-m1B521Wkdvo/WpJCy4xBeQI/AAAAAAAAXuk/GEqYpUdN7xgiXOefEn1VyILBTVCZ8-vJwCHMYCw/s1600-h/image%255B47%255D"&gt;&lt;img width="654" height="271" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9kXSvKM5zps/WpJCz5vr26I/AAAAAAAAXuo/igYADyS0SKg7ismPhGKyOgjfVVMxWzJyQCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;差異圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;透過這種方式可以一眼看出那個code屬於哪裡&lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;            題外話，codinion這個套件當初會安裝主要是為了能夠快速找到solution裡面code的功能。code的顏色這個部分則是意料之外的功能。之後在和大家介紹。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1519533906798797"&gt;結語&lt;/h2&gt;&lt;p&gt;            天天面對VS最重要的當然是看起來要舒服，code要好辨識。因此調整為自己適合的字體及大小非常重要。         &lt;/p&gt;&lt;p&gt;            這邊的一個重點是，不管怎麼設定，適合自己的才是最好。         &lt;/p&gt;&lt;p&gt;            大家有沒有建議的修改或者常用的字體要推薦呢？         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;             &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:7b0caf67-d457-4112-90cd-7531cea1a111" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7%e5%b0%8f%e6%8a%80%e5%b7%a7%e3%80%8d" rel="tag"&gt;「開發工具小技巧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4870779786143822068/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-1-set-visual-studio-fonts-and-size-with-better-highlight.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4870779786143822068'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4870779786143822068'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-1-set-visual-studio-fonts-and-size-with-better-highlight.html' title='[開發工具小技巧]調整Visual Studio的字形及文字顏色'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-STSS-6xGiCY/WpJCRwUZU4I/AAAAAAAAXsw/hQZNTslVJK0k6SMtxcQPEkUwEVWn2_gPACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1496942147133485262</id><published>2018-02-12T01:09:00.000+08:00</published><updated>2018-02-12T01:09:17.149+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「開發工具小技巧」'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><title type='text'>[開發工具小技巧]應該怎麼用Visual Studio執行和進入debug比較省時間？搭配ReAttach套件快速進入Debug模式</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-eWdifyOIYyc/WoB231QXdOI/AAAAAAAAXqM/mUowDx7z3vI6Ww1JT45EU18od72j5Ww6QCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-jyJlFU-W9IM/WoB25YNGRqI/AAAAAAAAXqQ/q--db0c1vXohe1EIsg0eItE4vHBqtbm1ACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/confused-muddled-illogical-880735/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;        最近在和同事聊天的時候，才發現到其實雖然我一直以來「以為」有多次強調該如何用Visual Studio run及進入debug比較節省時間，         但是其實有些同事還是不知道。     &lt;/p&gt;&lt;p&gt;        因此，準備一系列我個人認為大家應該都會的開發工具小技巧，這篇將會從開發每天都會做的事情，run及debug開始：在用Visual Studio開發的時候，         到底應該怎麼run和debug才是最有效率的方式，以及如何使用免費的套件ReAttach來讓debug流程更加的容易。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628634" ;=""&gt;一般的開發及debug流程&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628661" ;=""&gt;如何優化run及debug的方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628192" ;=""&gt;以 Start Without Debugging（快速鍵 Ctrl+F5）的執行方式替代 F5&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628733" ;=""&gt;當需要debug的時候以Attach Process方式進入debug模式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628975" ;=""&gt;以套件ReAttach讓attach process的流程更容易&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628764" ;=""&gt;ReAttach小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518366855628202" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518366855628634"&gt;一般的開發及debug流程&lt;/h2&gt;&lt;p&gt;        在我以前剛學會Visual Studio開發的時候，那個時候我學習到的做法都是：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;改程式&lt;/li&gt;&lt;li&gt;要測試的時候按下快速鍵：&lt;code&gt;F5&lt;/code&gt;也就是 &lt;code&gt;Start Debugging&lt;/code&gt;的動作（綠色的按鈕）&lt;/li&gt;&lt;li&gt;開始測試功能，如果需要修改，由於在debug模式，需要先&lt;em&gt;停下&lt;/em&gt;debug模式，之後才能改&lt;/li&gt;&lt;li&gt;重複第一個步奏&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;        在這個流程裡面，貌似沒有問題，但是實際上：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;em&gt;執行速度慢&lt;/em&gt;：debug模式因為要能夠debug，因此會load很多其他東西，因此造成了執行起來速度變慢&lt;/li&gt;&lt;li&gt;&lt;em&gt;需要消耗更多資源&lt;/em&gt;：同上一條一樣，因為load的東西多因此消耗的記憶體也多&lt;/li&gt;&lt;li&gt;&lt;em&gt;修改的流程消耗更多時間&lt;/em&gt;：由於在debug模式是無法修改，因此需要停下來才能夠修改&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518366855628661"&gt;如何優化run及debug的方式&lt;/h2&gt;&lt;p&gt;        既然上面知道了一般的做法有什麼問題，那能夠怎麼優化呢？以下分幾個步奏來執行：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;以 Start Without Debugging（快速鍵 Ctrl+F5）的執行方式替代 F5&lt;/li&gt;&lt;li&gt;當需要debug的時候以Attach Process方式進入debug模式&lt;/li&gt;&lt;li&gt;以套件ReAttach讓attach process的流程更容易&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518366855628192"&gt;以 Start Without Debugging（快速鍵 Ctrl+F5）的執行方式替代 F5&lt;/h3&gt;&lt;p&gt;            很多時候把網站run起來的目的只是為了&lt;em&gt;測試功能&lt;/em&gt;，因此其實不需要進入Debug模式。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;            題外話：養成不依賴debug功能其實是一個好的習慣，有發生錯誤先&lt;em&gt;思考&lt;/em&gt;一下問題發生原因，             而不是直接debug一步一步走，在整個的思維鍛煉上其實很有幫助。         &lt;/div&gt;&lt;p&gt;            所以養成以&lt;code&gt;Ctrl + F5&lt;/code&gt;&lt;em&gt;替代&lt;/em&gt;&lt;code&gt;F5&lt;/code&gt;。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3ga6A88kDP4/WoB29xFaPFI/AAAAAAAAXqU/tieMthumuqc1mYS1cp5lqJH9DiVVaF0PgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="513" height="364" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-YQO9fJOiC7g/WoB2_ucDAvI/AAAAAAAAXqY/Hhqx138_aDwGjHAVPi9JjEgOxd3H4tXfACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;F5及Ctrl + F5在Visual Studio選項位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;不過如果測試過程要改東西怎麼辦？&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;            這個時候可以用 &lt;code&gt;Build (快速鍵 F6)&lt;/code&gt;來編譯修改內容。         &lt;/p&gt;&lt;p&gt;            如果有遇到Build好像沒有很成功，這個時候可以用&lt;code&gt;Clean&lt;/code&gt;，或者&lt;code&gt;Rebuild&lt;/code&gt;(Rebuild本質上就是clean + build)。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-xORZ7ypRoY0/WoB3CE0grYI/AAAAAAAAXqc/9MUhRqs-u2QKwt3HwWi4IGWarL08fdwfwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="592" height="283" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-uuAIYB6DXT8/WoB3EuPrgQI/AAAAAAAAXqg/sATS_SRPAP4FGVza73BTmIYqG9kNjc8AgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Build、Clean及Rebuild的Visual Studio位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;            有些修改其實不需要build，因為這些是動態build出來。一般來說這種類型都是View。例如Asp.net裡面的&lt;em&gt;aspx&lt;/em&gt;或者Razor view的&lt;em&gt;cshtml&lt;/em&gt;。所以如果修改這種類型，連呼叫build都不需要，只需要存檔然後刷新頁面即可。         &lt;/div&gt;&lt;p&gt;            透過養成&lt;code&gt;Ctrl + F5&lt;/code&gt;的習慣，可以減少很多啟動debug，然後停掉debug在修改所花的時間。         &lt;/p&gt;&lt;p&gt;            不過下一個問題是，如果遇到問題需要debug怎麼辦？         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518366855628733"&gt;當需要debug的時候以Attach Process方式進入debug模式&lt;/h3&gt;&lt;p&gt;            當Visual Studioa用Start Without Debugging把網站run起來之後，這個網站會被IIS Express host起來。         &lt;/p&gt;&lt;p&gt;            而Visual Studio可以透過&lt;code&gt;Attach to Process (快捷鍵: Cltr+Alt+P)&lt;/code&gt;attach到IIS Express達到用Visual Studio啟動debug模式。         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;啟動 Attach To Process 的畫面&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-if6ZxH5a3zA/WoB3GPFqsdI/AAAAAAAAXqk/UNLiqgZ_IpwTeJ7smYpyhg383YAEAlVlwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="535" height="444" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-0WSNE4h6eE8/WoB3IThDUpI/AAAAAAAAXqo/KjXp17qRQywxZUXeSXvFe1sklGFe55pQQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;從Debug Toolbar找到&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;選擇 iisexpress.exe&lt;/dt&gt;&lt;dd&gt;                 從&lt;em&gt;Available Process&lt;/em&gt;找到&lt;em&gt;iisexpress.exe&lt;/em&gt;，如果在清單裡面沒有，可以勾選&lt;code&gt;Show process from all users&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-y9C5Fn8Zu4k/WoB3KhH9hZI/AAAAAAAAXqs/D0jFVPte33w-NbEssJAVsiMDXPzgwrKFgCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="514" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sMCnvIzq5xw/WoB3S1L4WwI/AAAAAAAAXqw/rhJt62uAEEMOg8xOOXroaKsPm6iN2lIdQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;選擇iisexpress.exe&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;            Attach完了之後，Visual Studio就會進入到一般的debug模式，剩下就和一般debug沒有什麼兩樣。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;            如果debug完了，停下來，網站是&lt;em&gt;不會停&lt;/em&gt;，這個和一般&lt;code&gt;F5&lt;/code&gt;不一樣，如果是&lt;code&gt;F5&lt;/code&gt;啟動的，當停下debug模式的時候，             整個網站&lt;em&gt;也會停下來&lt;/em&gt;。         &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;            如果attach上去之後，發現無法下中斷點，那麼最有可能是build沒有成功或者沒有乾淨，最好就是先&lt;code&gt;clean&lt;/code&gt;，在&lt;code&gt;Ctrl + F5&lt;/code&gt;。         &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;            了解了&lt;code&gt;Attach To Process&lt;/code&gt;，換個角度說其實也可以attach到一般IIS網站，甚至Remote Debug。這個完全做的到，但是這篇就不介紹了。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518366855628975"&gt;以套件ReAttach讓attach process的流程更容易&lt;/h3&gt;&lt;p&gt;            了解了&lt;code&gt;Attach To Process&lt;/code&gt;之後，下一個問題就是，每一次都要開那個畫面然後找到iisexpress真的很麻煩，是否有什麼方式讓找這個process更加容易呢？         &lt;/p&gt;&lt;p&gt;            有人因此建立了一個套件，&lt;em&gt;&lt;strong&gt;ReAttach&lt;/strong&gt;&lt;/em&gt;，甚至非常佛心的Open Source以及以Free的方式發佈出來。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1518366855628764"&gt;ReAttach小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;支援的Visual Studio版本&lt;/em&gt;：2012+&lt;/li&gt;&lt;li&gt;&lt;em&gt;官網&lt;/em&gt;：&lt;a href="https://marketplace.visualstudio.com/items?itemName=ErlandR.ReAttach"&gt;https://marketplace.visualstudio.com/items?itemName=ErlandR.ReAttach&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;直接下載&lt;/em&gt;：&lt;a href="https://marketplace.visualstudio.com/items?itemName=ErlandR.ReAttach"&gt;https://marketplace.visualstudio.com/items?itemName=ErlandR.ReAttach&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;最新版本：&lt;/em&gt;2.2&lt;/li&gt;&lt;li&gt;&lt;em&gt;Source Code&lt;/em&gt;：&lt;a href="https://github.com/erlandranvinge/ReAttach"&gt;https://github.com/erlandranvinge/ReAttach&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;            ReAttach使用非常簡單，安裝了之後，在工具列會有一個&lt;em&gt;紫色的播放按鈕&lt;/em&gt;可以按：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oh1r5hytecA/WoB3Uj2RgvI/AAAAAAAAXq0/yIRMm0ix0IkUWNQTfizsn4eaRDCA8vv0wCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="135" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-jhIgy2wZbjE/WoB3WZ6hHBI/AAAAAAAAXq4/TK4pwUNdDigML8nsoNNfZ0Dy2wwybxdZQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;ReAttach的功能&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;            在這個功能裡面，可以按旁邊下三角形看到最近的&lt;em&gt;4筆&lt;/em&gt;曾經有Attach過的Process。         &lt;/p&gt;&lt;p&gt;            最新Attach的Process會以第一筆呈現。         &lt;/p&gt;&lt;p&gt;            只需要選擇要Attach的Process即可。         &lt;/p&gt;&lt;p&gt;            如果說上面的Process都沒有目前想要Attach的，那麼可以先用&lt;code&gt;F5&lt;/code&gt;，然後停下來之後剛剛那個process就會出現在第一筆。         &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518366855628202"&gt;結語&lt;/h2&gt;&lt;p&gt;        如果養成了只以&lt;code&gt;Ctrl+F5&lt;/code&gt;的方式在Run程式，真需要debug的時候在用&lt;code&gt;Attach Process&lt;/code&gt;的方式進入debug模式，         不止能夠讓整個開發流程速度更快，也能夠鍛煉不debug情況下嘗試解決問題。     &lt;/p&gt;&lt;p&gt;        希望透過這篇，如果還沒養成這個習慣的可以先試試看，並且裝ReAttach讓整個流程變得更加順利。     &lt;/p&gt;&lt;p&gt;            如果有不同且能夠更節省開發時間的流程，也請用留言方式互相切磋切磋。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:3254e0d7-b119-4861-a2ce-ea7547a93ab2" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7%e5%b0%8f%e6%8a%80%e5%b7%a7%e3%80%8d" rel="tag"&gt;「開發工具小技巧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1496942147133485262/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-1-visual-studio-better-run-and-debug-process-using-attach-with-reattach.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1496942147133485262'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1496942147133485262'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/devtooltips-1-visual-studio-better-run-and-debug-process-using-attach-with-reattach.html' title='[開發工具小技巧]應該怎麼用Visual Studio執行和進入debug比較省時間？搭配ReAttach套件快速進入Debug模式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-jyJlFU-W9IM/WoB25YNGRqI/AAAAAAAAXqQ/q--db0c1vXohe1EIsg0eItE4vHBqtbm1ACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1653732628110366466</id><published>2018-02-11T15:51:00.000+08:00</published><updated>2018-02-11T15:55:46.575+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps][27]如何看.Net Dll版號和如何給.Net的Dll打上版號</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-65kHFuAEI-k/Wn_1jMrzvkI/AAAAAAAAXpQ/-jCaMHO-AvsCpfFH2ocN_I1S685RXne-wCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qxEzrBsMw_I/Wn_1lENjMVI/AAAAAAAAXpU/2ZHYOp5UQSU0ILs0KJY5RupfF8XwRgMQgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2018/02/devopsSeries-26-package-stage-intro.html"&gt;[26]Package階段介紹&lt;/a&gt;)介紹完了Package階段主要做的兩個事情：打包的&lt;em&gt;格式&lt;/em&gt;，以及用來區分差異的&lt;em&gt;版號 (version)&lt;/em&gt;。&lt;/p&gt;&lt;p&gt;在接下來的幾篇將會介紹和版號有關的內容。     &lt;/p&gt;&lt;p&gt;這篇會從最基本的開始，在.Net裡面是如為某一個library產生出來的dll打上版號?如何看到這個版號的資訊呢？     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728238" ;=""&gt;有寫過的相關文章&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728213" ;=""&gt;一張表看懂dll版號的值和設定版號方式 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728950" ;=""&gt;如何看dll的版號？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728142" ;=""&gt;3個版號的差異是什麼？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728214" ;=""&gt;如何設定dll的版號？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518334728728384" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;      &lt;a name='more'&gt;&lt;/a&gt;      &lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728238"&gt;有寫過的相關文章&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/10/donet-dll-hell-problem-how-to-use-bindingredirect.html"&gt;[.Net]Dll明明有在，為什麼出現找不到DLL錯誤 - 一次搞懂如何處理Dll版本問題(Dll Hell)&lt;/a&gt; - 這篇介紹的是如何在runtime的時候選擇想要執行的版本 - 也就是那個版號&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728213"&gt;一張表看懂dll版號的值和設定版號方式 - TL;DR&lt;/h2&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;Assembly Version&lt;/th&gt;&lt;th&gt;File Version&lt;/th&gt;&lt;th&gt;Product Version&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;作用&lt;/th&gt;&lt;td&gt;.Net Runtime對應&lt;br /&gt;dll版本的時候看這個值&lt;/td&gt;&lt;td&gt;區別build出來的dll和上一個版本的差異。一般build資訊會放在這邊。&lt;/td&gt;&lt;td&gt;從&lt;em&gt;產品&lt;/em&gt;的角度這個dll的版本&lt;br /&gt;用nuget exe產生nuget的時候，會用這個作為nuget的版號&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;確認dll的版號值&lt;/th&gt;&lt;td&gt;使用powershell：                 &lt;br /&gt;&lt;code&gt;[System.Reflection&lt;br /&gt;.Assembly]&lt;br /&gt;::LoadFrom("d:\xxx.dll") &lt;br /&gt;.GetName().Version&lt;/code&gt;&lt;/td&gt;&lt;td&gt;                 檔案總管&lt;br /&gt;右鍵&lt;br /&gt;Property&lt;br /&gt;Details 頁簽&lt;br /&gt;File Version             &lt;/td&gt;&lt;td&gt;                 檔案總管&lt;br /&gt;右鍵&lt;br /&gt;Property&lt;br /&gt;Details 頁簽&lt;br /&gt;Product Version             &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;設定的Attribute名稱&lt;/th&gt;&lt;td&gt;&lt;code&gt;[assembly: AssemblyVersion("1.0.0.0")]&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;[assembly: AssemblyFileVersion("1.0.0.0")]&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;[assembly: AssemblyInformationalVersion("1.0.0.0")]&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;詳細說明往下看。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728950"&gt;如何看dll的版號？&lt;/h2&gt;&lt;p&gt;當dll build出來之後，可以直接對他點：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;右鍵&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;Property (內容)&lt;/code&gt;&lt;/li&gt;&lt;li&gt;切換到 頁簽 &lt;code&gt;Details&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;裡面有兩個欄位有數字：         &lt;ol&gt;&lt;li&gt;File Version&lt;/li&gt;&lt;li&gt;Product Version&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bOInOOLYmGU/Wn_1oO9A23I/AAAAAAAAXpY/QnNdtPGLOVMzwNvYFhvVPn-xsciPfkcwwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="459" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-P7bukFWXVKU/Wn_1pSzbbYI/AAAAAAAAXpc/yniyp9TFDyopBMFmXyIMoTHhN7aezuAGACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立出來的console版號&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;不過其實這個不是完整的版號內容，在dll裡面還有一個版號，這個版號是&lt;em&gt;&lt;strong&gt;Assembly&lt;/strong&gt;&lt;/em&gt;的版號，這個版號是&lt;em&gt;&lt;strong&gt;.Net Reference dll看的版號&lt;/strong&gt;&lt;/em&gt;。如果要看這個版號可以用powershell：         &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;[System.Reflection.Assembly]::LoadFrom("d:\ConsoleApplication1.exe").GetName().Version&lt;br /&gt;        &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-FzcS-HNDWN0/Wn_1rCyi0gI/AAAAAAAAXpg/KLRU0W3MLsQEr7cSShv_LV-DKufVYBjSwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="100" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--QuijejgCAo/Wn_1u-ypEVI/AAAAAAAAXpk/O7VwZRWEvQ0KXzey9jxgzqm2XpegldTSACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;取得Assembly Version&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;從上面的資訊可以看出來，一個dll總共有3個版號：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;File Version&lt;/li&gt;&lt;li&gt;Product Version&lt;/li&gt;&lt;li&gt;Assembly Version&lt;/li&gt;&lt;/ol&gt;這3個版號的作用是什麼呢？     &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728142"&gt;3個版號的差異是什麼？&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;Assembly Version&lt;/dt&gt;&lt;dd&gt;這個是.Net裡面內部再用的，所以當有reference某個dll，會包含一個版號的資訊。這個版號看的就是Assembly Version這個值。&lt;/dd&gt;&lt;dt&gt;File Version&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;原則上這個是用來區分build和build之間差異的版本資訊。因此，一般來說這個會包含像是&lt;em&gt;&lt;strong&gt;build number&lt;/strong&gt;&lt;/em&gt;這種資訊。             &lt;/p&gt;&lt;p&gt;很有可能Assembly的版號還沒更新，但是在開發的過程，每一次build可能都不一樣，那麼這個時候File Version可能就會因此提升來&lt;em&gt;&lt;strong&gt;表示&lt;/strong&gt;&lt;/em&gt;這次build和上次build不同。             &lt;/p&gt;&lt;/dd&gt;&lt;dt&gt;Product Version&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個主要用來表示，從一個&lt;em&gt;&lt;strong&gt;產品&lt;/strong&gt;&lt;/em&gt;的角度之間的差異。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果用nuget建立出nuget的package，那麼nuget預設使用Product Version作為版號。             &lt;/div&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728214"&gt;如何設定dll的版號？&lt;/h2&gt;&lt;p&gt;到目前為止了解了3種不同版號的用意及如何看到這些版號的值，接下來就是如何在build的時候把這些版號資訊寫進去。     &lt;/p&gt;&lt;p&gt;在建立任何專案的時候，都會自動建立出&lt;code&gt;Properties\AssemblyInfo.cs&lt;/code&gt;這個檔案。     &lt;/p&gt;&lt;p&gt;這個檔案包含一些dll的meta資訊，例如assembly的名稱，assembly描述等。其中一塊就是用來定義3個版號資訊。     &lt;/p&gt;&lt;p&gt;這3個attribute分別為：         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;assembly: AssemblyVersion&lt;/dt&gt;&lt;dd&gt;對應到 Assembly Version&lt;/dd&gt;&lt;dt&gt;assembly: AssemblyFileVersion&lt;/dt&gt;&lt;dd&gt;對應到File Version&lt;/dd&gt;&lt;dt&gt;assembly: AssemblyInformationalVersion&lt;/dt&gt;&lt;dd&gt;對應到Product Version&lt;/dd&gt;&lt;/dl&gt;其中 &lt;code&gt;AssemblyInformationalVersion&lt;/code&gt;預設不存在，是需要自己手動添加。         &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Fju6tS060-Q/Wn_1yTP_4WI/AAAAAAAAXpo/e4z2DXXDoCUjEGXS8S0eMtjDQjYQssHmwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="259" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Ciq49thWe_U/Wn_12gLlQ5I/AAAAAAAAXps/GCyBWg36pAAUki76iJ1MLwfsavHaGFMIQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定內容的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518334728728384"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇介紹了在.Net裡面的3個版號值的名稱，以及怎麼查到一個dll這三個值的方式。     &lt;/p&gt;&lt;p&gt;再來介紹了如何在.Net專案透過設定&lt;code&gt;Properties\AssemblyInfo.cs&lt;/code&gt;這個檔案來設定build出來的dll的3個值。     &lt;/p&gt;&lt;p&gt;在下篇將會介紹版號的組成構架應該是如何，並且使用最常見的版號模式 SemVer 2.0（又稱為Semantic Version 2.0）     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:d5489615-e23b-48b9-a707-07a5468938ee" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1653732628110366466/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/devopsSeries-27-check-and-set-net-dll-verison-number.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1653732628110366466'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1653732628110366466'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/devopsSeries-27-check-and-set-net-dll-verison-number.html' title='[從.Net工程師的角度來看DevOps][27]如何看.Net Dll版號和如何給.Net的Dll打上版號'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-qxEzrBsMw_I/Wn_1lENjMVI/AAAAAAAAXpU/2ZHYOp5UQSU0ILs0KJY5RupfF8XwRgMQgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1966664358952865846</id><published>2018-02-10T22:50:00.000+08:00</published><updated>2018-02-10T22:51:45.916+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://www.blogger.com/atom/ns#' term='nuget'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 26]Package階段介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-tnqvDx0S9zA/Wn8GLvEs4rI/AAAAAAAAXoo/4zR5qLPEF8EWGuXhaG1tTGJjM07XLjGzwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-i6sEEVNvXsA/Wn8GNOlLmzI/AAAAAAAAXos/StTF7z3_JC8pQo8Vn1YkUPCyMmKxP1IWQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/devopsSeries-intro-to-free-ci-service-visual-studio-team-services.html"&gt;[25]在Visual Studio Team Services執行Build Script和CI Server總結&lt;/a&gt;)介紹完了VSTS的build建制之後，基本上build階段算是告一個段落了。&lt;/p&gt;&lt;p&gt;到目前為止，我們的build script不管是在CI Server那一端，還是在local端都能夠執行一樣的build script來產生出能夠執行的內容。     &lt;/p&gt;&lt;p&gt;接下來就要進入另外一個階段，也就是怎麼把產生出的內容&lt;em&gt;&lt;strong&gt;打包&lt;/strong&gt;&lt;/em&gt;成為適合發佈用的階段，也就是：&lt;em&gt;&lt;strong&gt;package&lt;/strong&gt;&lt;/em&gt;。     &lt;/p&gt;&lt;p&gt;這篇將會對於package階段的內容做個基本介紹。     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038342" ;=""&gt;Package階段在做什麼&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038258" ;=""&gt;常見的Package格式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038336" ;=""&gt;壓縮檔 - zip&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038590" ;=""&gt;nuget&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038179" ;=""&gt;Web - web deploy package&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038706" ;=""&gt;DB - dacpac&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038346" ;=""&gt;版號的重要性&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518273685038577" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;       &lt;a name='more'&gt;&lt;/a&gt;       &lt;section&gt;&lt;h2 id="WizKMOutline_1518273685038342"&gt;Package階段在做什麼&lt;/h2&gt;&lt;p&gt;還記得在一開始(&lt;a href="http://blog.alantsai.net/2016/12/devopsSeries-whatIsDevops.html"&gt;[02]什麼是DevOps？&lt;/a&gt;)介紹CI和CD的整個大框架的時候，有個部分叫做Package - 專門用來在Continus Delivery階段的時候執行：&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-MjOuYg5ORzw/Wn8GOKEWwOI/AAAAAAAAXow/DrEmHq_oiHE_FWegz2-o58Vx3o1QV6nBACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="421" height="407" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1Nh8t5tbImM/Wn8GPCmAUPI/AAAAAAAAXo0/hipTQKFPNFoD85FyH7hjmSyiea9zfs8FgCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Package階段&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;那package實際上是在做什麼事情呢？其實想一下，當我們把程式碼編譯了之後一般來說會做什麼？     &lt;/p&gt;&lt;p&gt;是不是會把編譯過的內容更新到機器上面？那要更新過去會遇到一個問題，就是怎麼 &lt;em&gt;&lt;strong&gt;打包&lt;/strong&gt;&lt;/em&gt; 讓攜帶過去更新的時候更加的方便。     &lt;/p&gt;&lt;p&gt;既然提到了打包，那麼和直覺的下一個問題就是，打包成為什麼&lt;em&gt;&lt;strong&gt;格式&lt;/strong&gt;&lt;/em&gt;。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518273685038258"&gt;常見的Package格式&lt;/h2&gt;&lt;p&gt;一般來說在.Net的世界裡面有幾種類型的格式：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;壓縮檔 - 例如 zip&lt;/li&gt;&lt;li&gt;nuget - 共用library&lt;/li&gt;&lt;li&gt;web在用 - web deploy的package&lt;/li&gt;&lt;li&gt;DB - dacpac&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518273685038336"&gt;壓縮檔 - zip&lt;/h3&gt;&lt;p&gt;一般來說會把編譯過的內容打包成為zip只有一個目的，就是copy過去的時候更&lt;em&gt;快速和方便&lt;/em&gt;。由於通用性很好，因此大部分的package本質上             都是zip。         &lt;/p&gt;&lt;p&gt;不管什麼類型的專案和檔案，也不管目標是什麼版本的windows，基本上把zip帶過去解壓縮就可以用了。因此zip是最常見的一種package方式。         &lt;/p&gt;&lt;p&gt;這種類型偏向於是要把程式&lt;em&gt;更版&lt;/em&gt;或者提供給他人能夠&lt;em&gt;直接使用&lt;/em&gt;。&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518273685038590"&gt;nuget&lt;/h3&gt;&lt;p&gt;如果今天開發的是一個&lt;em&gt;library&lt;/em&gt;或者說是用來&lt;em&gt;輔助開發&lt;/em&gt;使用的內容，那麼包成nuget是最適合的package。         &lt;/p&gt;&lt;p&gt;nuget本質上也是zip，不過和zip不同之處在於他有&lt;em&gt;一些meta資訊&lt;/em&gt;，可以提供一些像是package內容&lt;em&gt;說明和版號&lt;/em&gt;等資訊。         &lt;/p&gt;&lt;p&gt;如果是公開的library，那麼可以放到Microsoft提供的nuget server，或者可以自己架設內部的nuget server。         &lt;/p&gt;&lt;p&gt;關於如何建立nuget package，可以參考我部落格裡面和&lt;em&gt;nuget&lt;/em&gt;標籤有關的內容：&lt;a href="http://blog.alantsai.net/search/label/nuget"&gt;直接連接&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/kPw3WVpnJv2frE" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt;&lt;strong&gt; &lt;a href="//www.slideshare.net/alantsai2007/nuget-package" title="Nuget介紹- 如何使用和建立自己的package" target="_blank"&gt;Nuget介紹- 如何使用和建立自己的package&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518273685038179"&gt;Web - web deploy package&lt;/h3&gt;&lt;p&gt;如果今天要更新的內容是&lt;em&gt;&lt;strong&gt;網站類型&lt;/strong&gt;&lt;/em&gt;的內容（例如Asp.Net網站）要更新到&lt;em&gt;&lt;strong&gt;IIS&lt;/strong&gt;&lt;/em&gt;，那麼             web deploy package是一個很適合的格式。         &lt;/p&gt;&lt;p&gt;Web deploy package本質上也是zip，不過裡面有一些額外資訊可以讓IIS裡面的Web Deploy讀懂，讓更新的時候做到&lt;em&gt;&lt;strong&gt;差異更新&lt;/strong&gt;&lt;/em&gt;。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518273685038706"&gt;DB - dacpac&lt;/h3&gt;&lt;p&gt;如果今天是要更新db schema的部分，那麼dacpac是很適合的格式。         &lt;/p&gt;&lt;p&gt;dacpac本質上也是zip，不過裡面記錄了一些資訊，然後工具執行更新的時候，知道需要&lt;em&gt;&lt;strong&gt;異動&lt;/strong&gt;&lt;/em&gt;那些schema。         &lt;/p&gt;&lt;p&gt;從某種程度來說，dacpac就是同等於web deploy package在IIS裡面的地位。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;雖然DB很重要，但是在這個系列不會介紹到dacpac的建立         &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518273685038346"&gt;版號的重要性&lt;/h2&gt;&lt;p&gt;了解了不同類型的package格式了之後，下一個問題就是，在可以支援更新的那種package（也就是除了zip以外的所有package），是要怎麼知道到底有沒有更新呢？或者說怎麼知道要更新的內容和目前的內容之間的&lt;em&gt;差異&lt;/em&gt;有多少呢？     &lt;/p&gt;&lt;p&gt;這就不得提到&lt;em&gt;&lt;strong&gt;版號&lt;/strong&gt;&lt;/em&gt;了。     &lt;/p&gt;&lt;p&gt;舉個簡單例子，今天裝了&lt;em&gt;Json.Net&lt;/em&gt; 1 版的nuget，那麼如果2版出來的時候，因為版號的差異就可以知道屬於往上升的情況。     &lt;/p&gt;&lt;p&gt;因此版號的機制非常重要，好的版號機制能夠讓管理的人有個基本概念知道，&lt;em&gt;&lt;strong&gt;更新的內容是否會有breaking change&lt;/strong&gt;&lt;/em&gt;。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518273685038577"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇介紹了package的兩個基本概念：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;格式&lt;/li&gt;&lt;li&gt;版本&lt;/li&gt;&lt;/ol&gt;基本上格式的部分了解差不多了，剩下只需要了解怎麼產生即可。     &lt;p&gt;不過版本的部分牽涉的內容更多，因此接下來的篇幅將會在更深入的介紹版本的基本概念，以及如何產生版號。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:1330a604-ac89-4184-ae8d-307ae198582e" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/nuget" rel="tag"&gt;nuget&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1966664358952865846/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/devopsSeries-26-package-stage-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1966664358952865846'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1966664358952865846'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/devopsSeries-26-package-stage-intro.html' title='[從.Net工程師的角度來看DevOps 26]Package階段介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-i6sEEVNvXsA/Wn8GNOlLmzI/AAAAAAAAXos/StTF7z3_JC8pQo8Vn1YkUPCyMmKxP1IWQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7635458185927469382</id><published>2018-02-10T20:52:00.000+08:00</published><updated>2018-02-10T21:44:03.775+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='R'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][18]R語言基礎 中篇 - 1維度資料結構介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rB6N9US9IdI/Wn7qelGQ4UI/AAAAAAAAXn8/d0bxYTVVnbojdMwx_EHJNBL96odr09QaQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-xCja-LEaM1U/Wn7qgsTBGJI/AAAAAAAAXoA/8S4ykeYkKBkWZK2LF8YExB_DUpauI8nkQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：                         &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                         &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-17-r-program-basic-language-paradigm-and-data-type.html"&gt;[17]R語言基礎 上篇 - 語言特性和資料形態&lt;/a&gt;)提到R的Language Paradigm和R的Data Type。&lt;/p&gt;&lt;p&gt;裡面有提到，R其實是Vector base，換句話說一切都是vector。那vector到底有哪幾種（換句話說就是有哪些Data Structure）？     &lt;/p&gt;&lt;p&gt;這篇將對R裡面的&lt;em&gt;1維度&lt;/em&gt;Data Structure做介紹。     &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;這篇的範例程式碼在github：         &lt;a href="https://github.com/alantsai/blog-data-science-series/tree/master/src/chapter-18-r-1-dimension-data-structure"&gt;alantsai/blog-data-science-series 裡面的 src/chapter-18-r-1-dimension-data-structure&lt;/a&gt;     &lt;/div&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387475833" ;=""&gt;R的Data Structure&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476193" ;=""&gt;vector - 1維並且所有內容要是一樣的type&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476390" ;=""&gt;如何建立vector&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476319" ;=""&gt;如何使用vector&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476660" ;=""&gt;如何新增和刪除資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476533" ;=""&gt;list - 1維 但是 內容形態可以不一樣&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476364" ;=""&gt;如何建立list&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476823" ;=""&gt;如何使用List&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387476522" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1518266387477530" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518266387475833"&gt;R的Data Structure&lt;/h2&gt;&lt;p&gt;在R裡面的Data Structure基本上可以從兩個面向來看：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;幾個維度&lt;/li&gt;&lt;li&gt;是否整個資料屬於&lt;em&gt;同一個type&lt;/em&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Ran94uUJi-Y/Wn7qid65PNI/AAAAAAAAXoE/yQDkcyDVrCUUsBtvyUkn9IhvGvGN9V9YQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="218" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-T0-UfJpP7Dg/Wn7qkUlg9wI/AAAAAAAAXoI/hnXE_acPUrQW3PIvKxZto5wTk9Dar0oeQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;幾種data structure&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;如果上面的描述還是看不太懂，那麼往下看就會了解這兩個面向的意思。     &lt;/p&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518266387476193"&gt;vector - 1維並且所有內容要是一樣的type&lt;/h2&gt;&lt;p&gt;vector是一切的基礎，像我們之前的&lt;code&gt;3+5&lt;/code&gt;回傳的是一個vector，裡面&lt;em&gt;只有一個值 5&lt;/em&gt;。         &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518266387476390"&gt;如何建立vector&lt;/h3&gt;&lt;p&gt;如果要建立一個vector，使用的是&lt;code&gt;c&lt;/code&gt;這個function，例如，假設有一組資料要代表成績： &lt;/p&gt;&lt;pre class="brush: plain;"&gt;score &amp;lt;- c(20,10,50,60)&lt;br /&gt;score&lt;/pre&gt;結果是：&lt;code&gt;[1] 20 10 50 60&lt;/code&gt;&lt;p&gt;上面可以看到，vector只有一個維度，並且都是numeric。         &lt;/p&gt;&lt;p&gt;vector沒辦法混不同形態，所以假設如下面，如果最後一個分數不小心用引號包起來：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;scoreError &amp;lt;- c(20,10,50,"60")&lt;br /&gt;scoreError&lt;br /&gt;            &lt;/pre&gt;那麼最後結果會是：&lt;code&gt;[1] "20" "10" "50" "60"&lt;/code&gt;&lt;div class="bs-callout bs-callout-warning"&gt;注意到了嗎，被轉換成了所有都是char - 而不是數字             &lt;/div&gt;&lt;p&gt;除了用&lt;code&gt;c&lt;/code&gt;之外，還有一些別的方式可以建立vector，例如假設要建立1到5，可以用：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;oneToFive &amp;lt;- 1:5&lt;br /&gt;oneToFive&lt;br /&gt;            &lt;/pre&gt;執行結果：&lt;code&gt;[1] 1 2 3 4 5&lt;/code&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518266387476319"&gt;如何使用vector&lt;/h3&gt;&lt;p&gt;如果要從vector取值，可以用中括弧(&lt;code&gt;[]&lt;/code&gt;)取，不過和一般語言不一樣，它是從&lt;em&gt;1&lt;/em&gt;開始算起，而不是0。         &lt;/p&gt;&lt;p&gt;例如上面的分數，如果要取得第三個人的分數，可以用：&lt;code&gt;score[3]&lt;/code&gt;&lt;/p&gt;&lt;p&gt;除了用取那一筆的方式取得值，也可以用logic值來說這個vector是否要取到，下面例子就是用logic vector             來取值。         &lt;/p&gt;&lt;p&gt;假設要找出所有分數在&lt;em&gt;30分以上&lt;/em&gt;，可以用：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;score &amp;gt; 30&lt;br /&gt;score[score &amp;gt; 30]&lt;br /&gt;            &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-MGlklkWBJUE/Wn7qlSx0VfI/AAAAAAAAXoM/pFQkDAgb3t0TSCZytG4tse-gTpSctnLVACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="483" height="353" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-L74WqBha1yE/Wn7qph8_7qI/AAAAAAAAXoQ/3i7ROFzii1ot5WZia8VvQcPaxfq8hs7zgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;第一個得到是一個vector logic，然後用他來取得值&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;vector logic可以有很多其他運用，舉例來說，如果要找出分數在&lt;em&gt;30以上的比例&lt;/em&gt;，可以用：         &lt;/p&gt;&lt;p&gt;&lt;code&gt;mean(score &amp;gt; 30)&lt;/code&gt;，得到的結果是&lt;code&gt;0.5&lt;/code&gt;&lt;/p&gt;&lt;p&gt;因為30以上有2筆，總共4筆，所以是百分之50. &lt;/p&gt;&lt;p&gt;上面那個可以work是因為，logic的&lt;em&gt;FALSE&lt;/em&gt;和&lt;em&gt;TRUE&lt;/em&gt;其實就是&lt;em&gt;0&lt;/em&gt;和&lt;em&gt;1&lt;/em&gt;。             所以直接做平均從（&lt;code&gt;mean&lt;/code&gt;）就是把0和1 &lt;em&gt;相加然後除去總數&lt;/em&gt;。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518266387476660"&gt;如何新增和刪除資料&lt;/h3&gt;&lt;p&gt;要新增一筆資料其實非常簡單，只需要把值assign 到對應的位置即可。         &lt;/p&gt;&lt;p&gt;例如假設第5個人的分數是100，那麼可以這樣做：         &lt;/p&gt;&lt;pre class="brush: plain;"&gt;score[5] &amp;lt;- 100&lt;br /&gt;        &lt;/pre&gt;&lt;p&gt;反過來，如果要刪掉，其實就是重新assing就可以。例如把第5筆資料刪掉就會是：         &lt;/p&gt;&lt;pre class="brush: plain;"&gt;score &amp;lt;- score[1:4]&lt;br /&gt;        &lt;/pre&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-info"&gt;上面提到的一些使用和增刪資料和接下來的structure操作起來概念一樣，因此不會特別在介紹。     &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518266387476533"&gt;list - 1維 但是 內容形態可以不一樣&lt;/h2&gt;&lt;p&gt;如果說資料是1個維度但是每一個資料的形態不同，那麼可以使用list。         &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518266387476364"&gt;如何建立list&lt;/h3&gt;&lt;p&gt;&lt;code&gt;c&lt;/code&gt;是用來建立vector，而&lt;code&gt;list&lt;/code&gt;就是用來建立list用。             &lt;/p&gt;&lt;p&gt;舉例來說，假設最後一個不知道為什麼是字串，那麼：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;listScore &amp;lt;- list(20,10,50,"60")&lt;br /&gt;            &lt;/pre&gt;&lt;p&gt;那麼&lt;code&gt;listScore&lt;/code&gt;的值會是：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;[[1]]&lt;br /&gt;                [1] 20&lt;br /&gt;                &lt;br /&gt;                [[2]]&lt;br /&gt;                [1] 10&lt;br /&gt;                &lt;br /&gt;                [[3]]&lt;br /&gt;                [1] 50&lt;br /&gt;                &lt;br /&gt;                [[4]]&lt;br /&gt;                [1] "60"&lt;br /&gt;            &lt;/pre&gt;&lt;p&gt;更合理一點的例子會是，假設要把每一個分數的對應使用者名稱也加上，就可以用兩個vector在用list組合：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;name &amp;lt;- c("A", "B", "C", "D")&lt;br /&gt;                scoreWithName &amp;lt;- list(name,score)&lt;br /&gt;            &lt;/pre&gt;&lt;p&gt;這個時候&lt;code&gt;scoreWithName&lt;/code&gt;就會是：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;[[1]]&lt;br /&gt;                [1] "A" "B" "C" "D"&lt;br /&gt;                &lt;br /&gt;                [[2]]&lt;br /&gt;                [1] 20 10 50 60&lt;br /&gt;            &lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1518266387476823"&gt;如何使用List&lt;/h3&gt;&lt;p&gt;雖然list是1維，但是因為可以不同形態，所以很有可能裡面包的是一個vector，甚至是list，因此在取值的方式上面有些許的不同。             &lt;/p&gt;&lt;p&gt;要取得第一個list資料用的是兩個中括弧，因此，假設想要取得第一個人的名字，用法會是：             &lt;/p&gt;&lt;pre class="brush: plain;"&gt;scoreWithName[[1]][1]&lt;br /&gt;                # A &lt;br /&gt;            &lt;/pre&gt;&lt;p&gt;其他和一般vector沒有太大兩樣。             &lt;/p&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-info"&gt;以剛剛的例子，貌似要建立分數和名稱的對應需要用list，但是實際上不太建議，因為取值的時候不太方便並且不直覺。後面介紹的&lt;em&gt;dataframe&lt;/em&gt;             反而會是比較適合的形態。         &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518266387476522"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇介紹了R的兩種資料結構，分別為1維度同類型的&lt;em&gt;vector&lt;/em&gt;及1維度但可以不同類型的&lt;em&gt;list&lt;/em&gt;。     &lt;/p&gt;&lt;p&gt;在下一篇將會把整個資料結構做個總結，分別介紹2維度同類型的&lt;em&gt;matrix&lt;/em&gt;，及2維度不同類型的&lt;em&gt;dataframe&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1518266387477530"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;Advanced R 裡面介紹 Data Structure&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://adv-r.had.co.nz/Data-structures.html"&gt;http://adv-r.had.co.nz/Data-structures.html&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:77246517-fc7e-4cc9-87e3-6eed50445810" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/R" rel="tag"&gt;R&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7635458185927469382/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/02/data-science-series-18-r-1-dimension-data-structure.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7635458185927469382'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7635458185927469382'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/02/data-science-series-18-r-1-dimension-data-structure.html' title='[Data Science 到底是什麼從一個完全外行角度來看][18]R語言基礎 中篇 - 1維度資料結構介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-xCja-LEaM1U/Wn7qgsTBGJI/AAAAAAAAXoA/8S4ykeYkKBkWZK2LF8YExB_DUpauI8nkQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6777860431982498562</id><published>2018-01-16T23:32:00.000+08:00</published><updated>2018-01-16T23:40:45.968+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='R'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][17]R語言基礎 上篇 - 語言特性和資料形態</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-fVvknVbrq0g/Wl4ad7HFxDI/AAAAAAAAXgc/yHo92kbZMZIfzzKQ5oN6KmzusheTMU5PACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FyVTplZ-3EU/Wl4agC71f3I/AAAAAAAAXgg/cMkCZm_HdsY95BcOMHxUp_tuFcNJjQC5gCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html"&gt;[16]用R來看股票，透過quantmod了解R的強大&lt;/a&gt;)用了&lt;code&gt;quantmod&lt;/code&gt;快速了解如何使用R並且用他來做資料處理的便利性。&lt;/p&gt;&lt;p&gt;在這篇將會更深入一點點的介紹R的語言特色、幾種不同的資料形態。     &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;這篇的範例程式碼在github：&lt;a href="https://github.com/alantsai/blog-data-science-series/tree/master/src/chapter-17-r-language-paradigm-data-type"&gt;alantsai/blog-data-science-series 裡面的 src/chapter-17-r-language-paradigm-data-type&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736340" ;=""&gt;R的語言特性（Language Paradigm）&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736554" ;=""&gt;Vector Base - 一切都是向量&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736291" ;=""&gt;Functional Programming&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736936" ;=""&gt;R的資料形態(data type)&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736383" ;=""&gt;這篇有用到的R function&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1516113008736696" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;    &lt;section&gt;&lt;h2 id="WizKMOutline_1516113008736340"&gt;R的語言特性（Language Paradigm）&lt;/h2&gt;&lt;p&gt;基本上現在任何程式語言都會有多個語言特性，例如C#一開始屬於&lt;em&gt;Object Oriented Language&lt;/em&gt;，不過後來吸收了一些別的特性，又多出了像是&lt;em&gt;Functional Language&lt;/em&gt;的特性等。知道了語言特性之後，對於整個運作模式會比較了解。那R是屬於什麼類型呢？     &lt;/p&gt;&lt;p&gt;基本上，個人覺得R有兩個重要的特性：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Vector Base&lt;/li&gt;&lt;li&gt;Functional Programing&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1516113008736554"&gt;Vector Base - 一切都是向量&lt;/h3&gt;&lt;p&gt;基本上在R裡面，最基本的組成是vector，因此就算一個簡單的&lt;code&gt;2+3&lt;/code&gt;，最後的結果其實是一個vector：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-c3prHA6_ScI/Wl4ahEvkbBI/AAAAAAAAXgk/x05_rKVds1MafSV0Bhg5kclv3oJSd9aHQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="459" height="357" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-oqBnvtwTSSA/Wl4aiI2yn0I/AAAAAAAAXgo/zgdKC7UUPFoYDth0l1II5AskPaMgv47ZgCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到最後的結果是 5，不過他的值是[1] - 換句話說就是vector的&lt;em&gt;第一筆&lt;/em&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話 - 在R裡面，assign variable用的是 &lt;code&gt;&amp;lt;-&lt;/code&gt;。雖然用&lt;code&gt;=&lt;/code&gt;也可以，但是因為&lt;code&gt;=&lt;/code&gt;在特殊地方有特殊含義，因此還是建議用&lt;code&gt;&amp;lt;-&lt;/code&gt;。         &lt;/div&gt;&lt;p&gt;vector為導向有什麼特別的嗎？vector為主對於做運算非常方便：             &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;單數運算&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;如果是對&lt;em&gt;單數&lt;/em&gt;做加減乘除，會把所有的vector都加上那個值。                     &lt;/p&gt;&lt;pre class="brush: plain;"&gt;b &amp;lt;- c(2,3)&lt;br /&gt;b * 2&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-er4xFtsL8Bg/Wl4aiyXMZ3I/AAAAAAAAXgs/9TtjLK1tck4hAbPk0PBZoFj2w0YF9BUigCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="444" height="522" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-gnjjkkoGfqw/Wl4amApioiI/AAAAAAAAXgw/snn-BHxL4MIjMrZHiegQgB2yXUAlccNZwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;可以看到，在vector裡面兩個值都被*上2&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;兩個vector運算&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;如果是兩個vector相加，那麼對應的位置會互加。                     &lt;/p&gt;&lt;pre class="brush: plain;"&gt;c &amp;lt;- c(6,7)&lt;br /&gt;b+c&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vwxpJ0kBWz0/Wl4an6mE6iI/AAAAAAAAXg0/2Yj37f9Ui6cnGrqtkDmIJz4bn6FrvmjPwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="373" height="414" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-uEoGDlTZGOE/Wl4aryeB0WI/AAAAAAAAXg4/5jda_GPSGP0qDK3jt-09WdT8hZfBK16BQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;可以看到，對應位置的會互相加&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;要做到這種所有內容都要運算，一般語言都要用到loop才有辦法做到。不過vector base基本上就不需要，這也是為什麼雖然R有支援loop但是用到比較少。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1516113008736291"&gt;Functional Programming&lt;/h3&gt;&lt;p&gt;基本上R可以理解為functional programing language。因此如果很熟悉functional programming的開發方式，會覺得很親切。         &lt;/p&gt;&lt;p&gt;舉例來說，剛剛那個所有vector都+2的範例，如果改成functional寫法可以是：         &lt;/p&gt;&lt;pre class="brush: plain;"&gt;sapply(b, function(x){x + 2})&lt;/pre&gt;&lt;p&gt;得到的結果會是：&lt;code&gt;[1] 4 5&lt;/code&gt;&lt;/p&gt;&lt;p&gt;這邊的意思是，對於每一個&lt;code&gt;b&lt;/code&gt;vairable的&lt;em&gt;&lt;strong&gt;每一個值&lt;/strong&gt;&lt;/em&gt;，會對他們執行一個&lt;em&gt;anonymous function （匿名函數）&lt;/em&gt;，這個function就是把&lt;em&gt;值+2&lt;/em&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;&lt;code&gt;apply&lt;/code&gt;類型的function很常見，例如：&lt;code&gt;lapply&lt;/code&gt;、&lt;code&gt;sapply&lt;/code&gt;、&lt;code&gt;vapply&lt;/code&gt;等。             &lt;/p&gt;&lt;p&gt;基本上每一個用途差不多，差異在於&lt;em&gt;回傳的形態&lt;/em&gt;。             &lt;/p&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果C#有習慣用lambada，會覺得其實很親切，這個其實就是C#從functional language學習到的特色之一。         &lt;/div&gt;&lt;/section&gt;&lt;p&gt;R還有一些別的特性，不過個人認為上面兩個最重要，並且因為這兩個的關係，所以雖然R支援loop，但是&lt;em&gt;使用比較少&lt;/em&gt;(所以也不會特別介紹)。     &lt;/p&gt;&lt;p&gt;對於特性有點概念了之後，來看看R裡面的形態和其他資料結構。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1516113008736936"&gt;R的資料形態(data type)&lt;/h2&gt;&lt;p&gt;R和一般語言不一樣，在C#裡面如果有個variable是int，例如：&lt;code&gt;int a&lt;/code&gt;，那麼a的形態就是integer。     &lt;/p&gt;&lt;p&gt;但是在R裡面，雖然資料形態是integer，但是他的底層是&lt;em&gt;vector&lt;/em&gt;，這也是為什麼說R是vector base，因為一切都是vector。         integer只是代表&lt;em&gt;裡面&lt;/em&gt;儲存的資料形態而已。     &lt;/p&gt; &lt;table class="table"&gt;            &lt;tbody&gt;                &lt;tr&gt;                    &lt;th&gt;資料形態&lt;/th&gt;                    &lt;th&gt;範例值&lt;/th&gt;                    &lt;th&gt;Note&lt;/th&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Logical&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;TRUE&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;FALSE&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;T&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;F&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;注意要全大寫&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Numeric&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;10.5&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;2.5&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Integer&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;1L&lt;/code&gt;，&lt;br /&gt;                        &lt;code&gt;2L&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;注意後面要加上&lt;br /&gt;                        &lt;code&gt;L&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Character&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;"abc"&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;'123'&lt;/code&gt;,&lt;br /&gt;                        &lt;code&gt;"TRUE"&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;單引號&lt;br /&gt;                        &lt;code&gt;'&lt;/code&gt;或者雙引號&lt;br /&gt;                        &lt;code&gt;"&lt;/code&gt;都可以&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Complex&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;3 + 2i&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Raw&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;charToRaw("hello")&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;&lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Factor&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;code&gt;factor(c("male", "female"))&lt;/code&gt;&lt;br /&gt;                    &lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;ul&gt;                            &lt;li&gt;Factor其實就是c#的enum&lt;/li&gt;                            &lt;li&gt;Factor不算data type，不過歸在這邊比較好看&lt;/li&gt;                        &lt;/ul&gt;                    &lt;/td&gt;                &lt;/tr&gt;            &lt;/tbody&gt;        &lt;/table&gt;        &lt;table class="table"&gt;            &lt;tbody&gt;                &lt;tr&gt;                    &lt;th&gt;資料形態&lt;/th&gt;                    &lt;th&gt;範例&lt;/th&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Logical&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;l &amp;lt;- c(TRUE, FALSE, T, F)&lt;br /&gt;class(l)&lt;br /&gt;is.logical(l)&lt;br /&gt;&lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Numeric&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;n &amp;lt;- c(10.5, 2.5)&lt;br /&gt;class(n)&lt;br /&gt;is.numeric(n)&lt;br /&gt;                &lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Integer&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;i &amp;lt;- c(1L,2L)&lt;br /&gt;class(i)&lt;br /&gt;is.integer(i)&lt;br /&gt;&lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Character&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;char &amp;lt;- c("abc", '123', 'TRUE')&lt;br /&gt;class(char)&lt;br /&gt;is.character(char)&lt;br /&gt;                &lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Complex&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;complex &amp;lt;- c(3 + 2i)&lt;br /&gt;class(complex)&lt;br /&gt;is.complex(complex)&lt;br /&gt;                &lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Raw&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;raw &amp;lt;- charToRaw("hello")&lt;br /&gt;class(raw)&lt;br /&gt;is.raw(raw)&lt;br /&gt;                &lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;                &lt;tr&gt;                    &lt;td&gt;Factor&lt;/td&gt;                    &lt;td&gt;&lt;br /&gt;                        &lt;pre class="brush: plain;"&gt;gender &amp;lt;- factor(c("male", "female"))&lt;br /&gt;class(gender)&lt;br /&gt;is.factor(gender)&lt;br /&gt;                &lt;/pre&gt;                    &lt;/td&gt;                &lt;/tr&gt;            &lt;/tbody&gt;        &lt;/table&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;要非常注意這些Data Type非常重要，之後在分析資料的時候很有可能因為形態錯誤的關係導致使用的演算法結果錯誤。         &lt;/p&gt;&lt;p&gt;因此了解這些基本形態會減少掉之後很多問題。         &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1516113008736383"&gt;這篇有用到的R function介紹&lt;/h2&gt;&lt;p&gt;在這邊用到了三個R的方法（還有&lt;code&gt;c&lt;/code&gt;不過這個下一篇介紹）：         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;class&lt;/dt&gt;&lt;dd&gt;                 這個用來看variable裡面的data type是什麼             &lt;/dd&gt;&lt;dt&gt;is.*&lt;/dt&gt;&lt;dd&gt;                 用來判斷某個variable的class符不符合。                 &lt;div class="bs-callout bs-callout-info"&gt;有個function是&lt;code&gt;as.*&lt;/code&gt;，用來做&lt;em&gt;轉型&lt;/em&gt;用。                 &lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;factor()&lt;/dt&gt;&lt;dd&gt;把vector轉成factor&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1516113008736696"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇首先對R的語言特性先做了介紹，了解到兩個最重要的特性：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Vector base&lt;/li&gt;&lt;li&gt;functional programming&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;再來看了R裡面的每一個最小單位的不同形態。     &lt;/p&gt;&lt;p&gt;在下一篇將會介紹R裡面的資料結構（Data Structure），和如果有問題如何找到相關的文件。     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:32e8212f-9d42-4daa-80b6-e675453f2485" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/R" rel="tag"&gt;R&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6777860431982498562/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-17-r-program-basic-language-paradigm-and-data-type.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6777860431982498562'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6777860431982498562'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-17-r-program-basic-language-paradigm-and-data-type.html' title='[Data Science 到底是什麼從一個完全外行角度來看][17]R語言基礎 上篇 - 語言特性和資料形態'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-FyVTplZ-3EU/Wl4agC71f3I/AAAAAAAAXgg/cMkCZm_HdsY95BcOMHxUp_tuFcNJjQC5gCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6588924631878789539</id><published>2018-01-03T23:05:00.000+08:00</published><updated>2018-01-16T23:33:01.172+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='data processing'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='R'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][16]用R來看股票，透過quantmod了解R的強大</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-FkUx_u1iq7c/WkzwNVKKgOI/AAAAAAAAXdg/53UnARig8SUClzk20A6EKh8hzR05zqHPACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-LAfLycNyz4I/WkzwOhIZstI/AAAAAAAAXdk/eP6Y16LR16IzMv0pQxLRaZLHlap9E4H8ACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：         &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和         &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-15-r-history-rstudio-r-tools-for-studio-ide-setting.html"&gt;[15]R是什麼？準備開發R的環境 - RStudio介紹&lt;/a&gt;)了解了R的歷史和準備好了接下來的開發環境之後，就可以開始用R來做分析了。&lt;/p&gt;&lt;p&gt;一般來說，在學新的語言都會先看看所謂的Hello World，了解整個語言的Syntax和感覺。             &lt;/p&gt;&lt;p&gt;不過R不是一般型的程式語言，是給統計學家用的語言。因此，個人覺得如果只是看Hello World好像看不出來R特別的地方，不過如果直接學語法又太無聊。             &lt;/p&gt;&lt;p&gt;因此，這邊透過安裝和使用&lt;code&gt;quantmod&lt;/code&gt;這個套件，並且用它來簡單分析股票作為R的入門介紹。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;這篇的範例程式碼在github：&lt;a href="https://github.com/alantsai/blog-data-science-series/tree/master/src/chapter-16-r-quantmod-intro"&gt;alantsai/blog-data-science-series 裡面的 src/chapter-16-r-quantmod-intro&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;                          &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190931779" ;=""&gt;quantmod是什麼？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190931461" ;=""&gt;用quantmod分析google股票&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190931154" ;=""&gt;安裝和載入quantmod套件&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190932435" ;=""&gt;取得google股票資訊和分析得出內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190932200" ;=""&gt;畫出走勢&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190932414" ;=""&gt;畫出黃金和死亡交叉線&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190932384" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514991190932227" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;              &lt;a name='more'&gt;&lt;/a&gt;              &lt;section&gt;&lt;h2 id="WizKMOutline_1514991190931779"&gt;quantmod是什麼？&lt;/h2&gt;&lt;p&gt;quantmod是一個R的套件，全稱是&lt;code&gt;Quantitative Financial Modelling and Trading Framework for R &lt;/code&gt;，它是一個套件用來做股票相關分析。             &lt;/p&gt;&lt;p&gt;接下來將會用quantmod來分析google的股票。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514991190931461"&gt;用quantmod分析google股票&lt;/h2&gt;&lt;p&gt;接下來會分幾個階段進行：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;安裝和載入quantmod套件&lt;/li&gt;&lt;li&gt;取得google股票資訊和分析得出內容&lt;/li&gt;&lt;li&gt;畫出走勢&lt;/li&gt;&lt;li&gt;畫出黃金和死亡交叉線&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514991190931154"&gt;安裝和載入quantmod套件&lt;/h3&gt;&lt;p&gt;第一個指令是：&lt;code&gt;library("quantmod")&lt;/code&gt;&lt;/p&gt;&lt;p&gt;可以直接放在左上角的script裡面，或者左下角的console執行。&lt;/p&gt;&lt;p&gt;在之後只要看到R的script裡面有出現：&lt;code&gt;library&lt;/code&gt;，或者&lt;code&gt;require&lt;/code&gt;，表示要&lt;em&gt;&lt;strong&gt;載入套件到目前的session&lt;/strong&gt;&lt;/em&gt;。                 &lt;/p&gt;&lt;p&gt;舉例來說，如果看到&lt;code&gt;library("quantmod")&lt;/code&gt;表示需要套件&lt;code&gt;quantmod&lt;/code&gt;，這個時候如果沒有這個套件就&lt;em&gt;&lt;strong&gt;記得要安裝&lt;/strong&gt;&lt;/em&gt;。                 &lt;/p&gt;&lt;p&gt;安裝方式有兩種：                     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;透過指令 - &lt;code&gt;install.packages&lt;/code&gt;&lt;/li&gt;&lt;li&gt;透過gui&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;嚴格來說只有一種方式，就是&lt;em&gt;指令&lt;/em&gt;，因為gui其實也是呼叫指令。                     &lt;/div&gt;&lt;p&gt;使用GUI的話，有幾種做法：                     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;選擇右下角的 &lt;code&gt;install&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在package名稱輸入 &lt;code&gt;quantmod&lt;/code&gt; - 這邊會注意到會有auto complete的效果&lt;/li&gt;&lt;li&gt;最後按下安裝&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JreV_R0ucfA/WkzwQRC0fKI/AAAAAAAAXdo/Qn9eE6LAcrQNrlxE_NBaHupDyev_EyEvwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="563" height="407" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-n5GTs26mNEM/WkzwRW4-dgI/AAAAAAAAXds/YO22QhCb3Xs3m4GFDcAo-wVxcEnsjsrXQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;用gui安裝package&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;實際上，這個動作同等於在console呼叫&lt;code&gt;install.packages("quantmod")&lt;/code&gt;，這邊有件事情要注意一下，安裝的時候會出現&lt;em&gt;紅色的字&lt;/em&gt;，那個不是錯誤，只是在這個theme的情形下的訊息。                     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_G7BFr-RCLs/WkzwSxlnbKI/AAAAAAAAXdw/WxHMKtlY6IIc271OM5-o8XhSSccWF8HwQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="590" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2t1h3A6L6jE/WkzwT2vlGlI/AAAAAAAAXd0/e1NgHBK0D0Is4sRvU1poXevPbgIlQ1IGQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;安裝的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514991190932435"&gt;取得google股票資訊和分析得出內容&lt;/h3&gt;&lt;p&gt;在這個部分的指令如下：                     &lt;/p&gt;&lt;pre class="brush: plain;"&gt;# 取得google的股票，並且看看前6筆資料&lt;br /&gt;getSymbols("GOOG")&lt;br /&gt;head(GOOG)&lt;br /&gt;                    &lt;/pre&gt;&lt;p&gt;這邊用了兩個指令：                     &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;getSymbols&lt;/dt&gt;&lt;dd&gt;這個是quantmod提供的方法，GOOG是google的股票代號，這個資料是從yahoo股市來。&lt;/dd&gt;&lt;dt&gt;head&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個是r base（核心）的方法，表示看前6筆的資料。                             &lt;/p&gt;&lt;p&gt;這個會很常看到，當拿到Data不知道是什麼的時候，就會呼叫&lt;code&gt;head&lt;/code&gt;看一下內容。                             &lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dunUOztkerk/WkzwUuItX_I/AAAAAAAAXd4/l92EVlMLwxcyL4vuAwcH37T5OV5MzW5DgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="450" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tDGTz6b-nko/WkzwWe9ftnI/AAAAAAAAXd8/DLdAnpJgxvYjM24rDd_ObCygs-uHZXYFQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;執行結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;head出來的結果看到有6個欄位：                     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;GOOG.Open - 就是開盤價&lt;/li&gt;&lt;li&gt;GOOG.High - 最高價&lt;/li&gt;&lt;li&gt;GOOG.Low - 最低價&lt;/li&gt;&lt;li&gt;GOOG.Close - 收盤價&lt;/li&gt;&lt;li&gt;GOOG.Volime - 成交量&lt;/li&gt;&lt;li&gt;GOOG.Adjusted - 還原權值&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;每一列是一個日期，換句話說就是每一天。                     &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;還記得之前提到Data Science的3個圈圈嗎？其中一塊就是Domain Knowledge。如果不懂股票，那麼剛剛那些數值其實沒有任何意義。                     接下來也沒有辦法做分析。                 &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514991190932200"&gt;畫出走勢&lt;/h3&gt;&lt;p&gt;看股票的就知道，會看一個所謂的走勢圖，quantmod讓畫這個走勢圖非常的簡單，只需要呼叫：&lt;code&gt;chartSeries(GOOG)&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-xcoaS_GPiE4/WkzwXSfQlWI/AAAAAAAAXeA/BfJO4GoWVykX8pntSB1pXfcyybpnKycugCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="349" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-0q3VFgWsKVA/WkzwZFmPOBI/AAAAAAAAXeE/2Ra3l4Tss2Ak8_Tbr3C7LygFxwTcfoelACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;畫出走勢圖，從20070103到20180102&lt;/figcaption&gt;&lt;/figure&gt;                     可以把這張圖放大（放大鏡 Zoom）或者另存（圖片Export）                 &lt;p&gt;這個的區間可能非常長，可能看不太清楚，因此可以限制變成只分析進3個月的資料：                     &lt;code&gt;chartSeries(GOOG["2017-11-03::2018-01-03",])&lt;/code&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;還記得整個資料像是一個table的樣子，那麼等於我們在限制row（列）的部分，因為每一列是日期。                 &lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1jKWL8aJx0s/Wkzwap-JiGI/AAAAAAAAXeI/ra99BjCqM30Ta821CaAlXe9mbayWQd9hwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="344" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sip9uUu1ruU/WkzwbkgRQYI/AAAAAAAAXeM/USP5V1aLpdkug3La70LG38O-mkPf6sCEQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;只顯示3個月&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個是國外的軟體，所以&lt;em&gt;綠色代表漲&lt;/em&gt;，&lt;em&gt;紅色代表跌&lt;/em&gt;。又是另外一個Domain Knowledge。                 &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514991190932414"&gt;畫出黃金和死亡交叉線&lt;/h3&gt;&lt;p&gt;有了資料和走勢，接下來是做一些分析。                 &lt;/p&gt;&lt;p&gt;在股票來說，有個所謂的&lt;em&gt;黃金交叉新&lt;/em&gt;和&lt;em&gt;死亡交叉線&lt;/em&gt;。                 &lt;/p&gt;&lt;p&gt;基本上有個概念叫做移動平均數（Moving Average MA），例如如果計算3天均數就是把三天的價加總算出平均。那這個會隨著天數移動，因此叫做移動平均數。                 &lt;/p&gt;&lt;p&gt;如果一個長期的MA（例如60日季線）屬於&lt;em&gt;下降&lt;/em&gt;然後短期的MA（例如20日月線）屬於&lt;em&gt;上升&lt;/em&gt;並且&lt;em&gt;交叉&lt;/em&gt;，就稱之為&lt;em&gt;黃金交叉&lt;/em&gt;，原因是整個趨勢屬於上漲。                 &lt;/p&gt;&lt;p&gt;死亡交叉是一樣概念，只是反過來。&lt;em&gt;短期&lt;/em&gt;的MA屬於&lt;em&gt;下降&lt;/em&gt;，然後&lt;em&gt;長期&lt;/em&gt;屬於&lt;em&gt;上升&lt;/em&gt;，兩者交叉的時候就是&lt;em&gt;死亡交叉&lt;/em&gt;。                 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;還是要強調，Domain Knowledge的重要，小弟我不懂股票，了解這個概念也是花了一點時間。                 &lt;/div&gt;&lt;p&gt;有了這個概念之後，來執行以下語法：                 &lt;/p&gt;&lt;pre class="brush: plain;"&gt;# 計算 20日和60日均線&lt;br /&gt;ma20&amp;lt;-runMean(GOOG[,4],n=20)&lt;br /&gt;ma60&amp;lt;-runMean(GOOG[,4],n=60)&lt;br /&gt;head(ma20, 25)&lt;br /&gt;&lt;br /&gt;# 畫上線&lt;br /&gt;chartSeries(GOOG["2017-01-03::2018-01-03",], theme = "white")&lt;br /&gt;addTA(ma20,on=1,col="blue")&lt;br /&gt;addTA(ma60,on=1,col="red")&lt;/pre&gt;&lt;p&gt;這邊用了一個新的方法，但是大部分都是quantmod的方法，因此不介紹了，不過有三個地方做一下說明：     &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;runMean(GOOG[,4], n=20)&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;重點在&lt;code&gt;GOOG[,4]&lt;/code&gt;。                 &lt;/p&gt;&lt;p&gt;這邊有兩個部分：                     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;還記得MA的計算是用收盤價，所以我們要用所有的資料，因此逗點前面是空白，剛好和剛剛過濾日期是顛倒&lt;/li&gt;&lt;li&gt;這邊用的是第四個欄位，也就是收盤價的欄位。R裡面的index是從&lt;em&gt;1&lt;/em&gt;開始，而不是像一般從0開始&lt;/li&gt;&lt;/ol&gt;&lt;/dd&gt;&lt;dt&gt;指令：&lt;code&gt;head(ma20,25)&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt; 這邊指的是看前25筆，由於是20日均線，所以前20筆是NA因為不夠計算。         &lt;/dd&gt;&lt;dt&gt;指令：&lt;code&gt;chartSeries(GOOG["2017-01-03::2018-01-03",], theme = "white")&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;             之前只顯示前3個月沒辦法很好的畫，所以把整個時間拉長到1年，並且改成白色比較方便畫線。         &lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bliu2-M0frc/WkzwcqYQ4rI/AAAAAAAAXeQ/k-QqW9Z2AbMubMsGlzG22QhPNzPQHmljACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="349" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2185BgAlw-E/WkzwfgxtTxI/AAAAAAAAXeU/DHNSZ-GUnqo6BrO_EtO9n5C5dipipVjawCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;畫上均線&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514991190932384"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過透過這個範例可以看出R的一些特點：不管在過濾列的資料和欄的資料都可以用簡單array的感覺來做到，並且在繪圖上面和呈現非常方便。             &lt;/p&gt;&lt;p&gt;不過要注意的是，這邊很多指令都是和quantmod這個套件有關，因此在一般其他的Exploratory analysis比較沒辦法使用到。             &lt;/p&gt;&lt;p&gt;因此在接下來將會在下一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-17-r-program-basic-language-paradigm-and-data-type.html"&gt;[17]R語言基礎 上篇 - 語言特性和資料形態&lt;/a&gt;)介紹R的特性，和其他語言差別在哪別和一些特色。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514991190932227"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;quantmod官網&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://www.quantmod.com/examples/intro/#data"&gt;官網資料使用範例&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;第一次使用R語言做回測：六分鐘，就上手! &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這篇基本參考了這個部落格裡面內容做介紹，部落格還有延伸一些預測會賺多少的介紹。                     &lt;/p&gt;&lt;a href="http://www.bituzi.com/2014/12/Rbacktest6mins.html"&gt;http://www.bituzi.com/2014/12/Rbacktest6mins.html&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;                 &lt;section&gt;                     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:a742b24a-9d6c-46a7-a917-fff05100874d" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+processing" rel="tag"&gt;data processing&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/R" rel="tag"&gt;R&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6588924631878789539/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html#comment-form' title='2 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6588924631878789539'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6588924631878789539'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html' title='[Data Science 到底是什麼從一個完全外行角度來看][16]用R來看股票，透過quantmod了解R的強大'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-LAfLycNyz4I/WkzwOhIZstI/AAAAAAAAXdk/eP6Y16LR16IzMv0pQxLRaZLHlap9E4H8ACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>2</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2987422572330090173</id><published>2018-01-03T00:10:00.000+08:00</published><updated>2018-01-03T23:13:14.356+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='data processing'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='R'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][15]R是什麼？準備開發R的環境 - RStudio介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-aS71m65kscw/WkuuKwey06I/AAAAAAAAXcE/WvtU26FkHbcYfBHGfVYaLQ0T_ToIAD-YQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-BAEY0GVoaVk/WkuuMJEjG5I/AAAAAAAAXcI/7mBP7mcuHlc5oXDyjKJN2gwumNQ2H9ZgQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-14-how-to-define-good-question.html"&gt;[14]如何問對的問題？&lt;/a&gt;)了解到了如何定義一個問題，那麼下一個步奏就是收集然後分析Data以解決定義的問題。&lt;/p&gt;&lt;p&gt;收集Data有很多方式，不過一般來說收集到的Data都需要經過一些處理才有辦法使用。     &lt;/p&gt;&lt;p&gt;有什麼麼能處理這些Data？這篇將會對於幾種不同處理Data的方式做些介紹，並且為什麼選擇R和如何準備接下來會用到的環境，RStudio。     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt;         &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408551" ;=""&gt;分析Data的工具/語言&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408840" ;=""&gt;使用軟體&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408487" ;=""&gt;使用程式語言&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408751" ;=""&gt;R的歷史&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408125" ;=""&gt;安裝R&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408492" ;=""&gt;R小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408106" ;=""&gt;RStudio介紹和安裝&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408937" ;=""&gt;RStudio小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850408751" ;=""&gt;RStudio 快速介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409138" ;=""&gt;主要界面&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409357" ;=""&gt;幾個設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409458" ;=""&gt;字體和樣式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409701" ;=""&gt;預設的script儲存編碼改為utf-8&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409705" ;=""&gt;其他R IDE - Visual Studio&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409406" ;=""&gt;R Tools for Visual Studio&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514908850409268" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;     &lt;section&gt;&lt;h2 id="WizKMOutline_1514908850408551"&gt;分析Data的工具/語言&lt;/h2&gt;&lt;p&gt;基本上，要分析Data有兩種方式：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用軟體&lt;/li&gt;&lt;li&gt;使用程式語言&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514908850408840"&gt;使用軟體&lt;/h3&gt;&lt;p&gt;最常見的軟體就是Microsoft Office的Excel。可以把Data喂進去，然後透過裡面一些定義好的方法能夠產生出非常漂亮的圖表或者分析表。         &lt;/p&gt;&lt;p&gt;其他常見的還有像是tableau其實都是這種類型。         &lt;/p&gt;&lt;p&gt;這些軟體因為有GUI所以好上手，             不過這種類型有個比較大的問題，那就是&lt;em&gt;不好確保重複做會是一樣的動作&lt;/em&gt;。         &lt;/p&gt;&lt;p&gt;舉例來說，如果&lt;em&gt;定期&lt;/em&gt;會收到某些格式的資料，但是這些資料都需要經過&lt;em&gt;處理&lt;/em&gt;才有辦法做下一步的分析，請問什麼方式才能夠&lt;em&gt;確保每一次&lt;/em&gt;的處理動作都會一樣？在這種軟體類型其實並不容易，或者說如果要做到就需要寫一些比較不好維護的script，例如VBScript。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;其實GUI類型的工具都沒有辦法很容易做到&lt;em&gt;自動化或者確保重複操作會一致&lt;/em&gt;。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514908850408487"&gt;使用程式語言&lt;/h3&gt;&lt;p&gt;既然GUI在處理重複性上面比較沒辦法做到，那下一個會看的就是程式語言。         &lt;/p&gt;&lt;p&gt;在Data Science的領域裡面，有幾個語言比較流行（其實有很多，用什麼都可以）：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Python&lt;/li&gt;&lt;li&gt;Scala&lt;/li&gt;&lt;li&gt;R&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Python屬於General Purpose Language，所以本來沒有特別傾向做什麼都可以。不過因為有很大的community都用python，導致了很多package做data science非常方便。         &lt;/p&gt;&lt;p&gt;Scala夯起來主要是因為Spark是用Scala寫的，因此用Scala在處理&lt;em&gt;Big Data&lt;/em&gt;在速度上面會比R和Python來的好，因此用的很多。         &lt;/p&gt;&lt;p&gt;那R的特色呢？為什麼選擇R而不是另外兩個呢？其實不管選什麼都沒關係，重點是好不好用。所以如果已經有習慣用什麼，那就用那個。         &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850408751"&gt;R的歷史&lt;/h2&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-awofyTgXFwM/WkuuM7SAtqI/AAAAAAAAXcM/KolBeRmbR1sfB27dkZsXG2909vsbw6gnACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="237" height="186" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-6Rr_N2xksTQ/WkuuOwzrUUI/AAAAAAAAXcQ/_zeRT_VUavoCV0WzqOWxzVpRpkM7gyYIgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;R Logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;了解一個語言的歷史對於整個語言的定位和特色有幫助，因此先來看看R是怎麼誕生。     &lt;/p&gt;&lt;p&gt;R其實不是一個新的語言，它誕生至今已經有24年（從1993），而它是從S演進而來，而S當初是為了給&lt;em&gt;統計學家對Fortran的SCS Library&lt;/em&gt;開發提供便利。     &lt;/p&gt;&lt;p&gt;因此在R的血液裡面，主要是給&lt;em&gt;統計學家用的Specialized Language&lt;/em&gt;。     &lt;/p&gt;&lt;p&gt;R怎麼突然紅起來呢？個人認為主要是Big Data的興起，和另外兩個重要的推手：         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;Revolution R&lt;/dt&gt;&lt;dd&gt;在2007出現 提供commercial support的R，能夠分散運算和處理大量資料後來被Microsoft買走&lt;/dd&gt;&lt;dt&gt;RStudio&lt;/dt&gt;&lt;dd&gt;在2011出現，Open Source的R Integrated Development Environment（IDE）。讓開發R變得非常方便，並且一直持續有開發一些讓R開發更加方便的功能，像是Shiny，讓用寫R的方式建立一個互動式網站&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-t0omtGuIJXU/WkuuQD-1ZLI/AAAAAAAAXcU/_XUeIx708PIv77z9fRtcy2c-ftKy2GR8ACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="367" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-DD3jWOdW6no/WkuuRK6wZEI/AAAAAAAAXcY/4pElI7jIvRYuGrFz5LQiRVwcONMpt_o-ACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;R的歷史&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，任何一個火紅的軟體/語言都需要有個重大推手，像git其實2005年就誕生了，但是整個火紅起來是因為2011誕生的Github。     &lt;/div&gt;&lt;p&gt;從整個歷史會發現：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;R歷史悠久 - 換句話說很多人在用代表很多package（第三方套件） - 而且大部分都是免費。&lt;/li&gt;&lt;li&gt;R是專門給統計學家用的語言 - 換句話說在處理資料、視覺化非常簡單&lt;/li&gt;&lt;/ol&gt;因此，接下來會用R來入門。     &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850408125"&gt;安裝R&lt;/h2&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1514908850408492"&gt;R小檔案&lt;/h4&gt;&lt;dl&gt;&lt;dt&gt;R官網&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.r-project.org/"&gt;https://www.r-project.org/&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;最新版本&lt;/dt&gt;&lt;dd&gt;3.4.3&lt;/dd&gt;&lt;dt&gt;檔案大小&lt;/dt&gt;&lt;dd&gt;Windows約62MB&lt;/dd&gt;&lt;dt&gt;R Windows 3.4.3 直接下載&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://cran.csie.ntu.edu.tw/bin/windows/base/R-3.4.3-win.exe"&gt;台大Mirror&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;R Mac&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://cran.csie.ntu.edu.tw/bin/macosx/"&gt;台大Mirror&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;R Linux&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://cran.csie.ntu.edu.tw/bin/linux/"&gt;台大Mirror&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;p&gt;基本上，下載下來之後，一直下一步即可。     &lt;/p&gt;&lt;p&gt;最後裝好之後在桌面會有一個R的icon，執行了之後會是一個command line的界面。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RGYgDOmAphM/WkuuSOPqkfI/AAAAAAAAXcc/n6qZ7j6Qo0E09iPQcmPHtKCo0T_V5VokQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="640" height="871" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CRQmOHb5Hmw/WkuuUJmwjTI/AAAAAAAAXcg/M6OQuP5mkXMYDJDJSJ71j0LvXf-5zCWZgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;執行起來的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850408106"&gt;RStudio介紹和安裝&lt;/h2&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-loVzypjgtZI/WkuuXRsb0wI/AAAAAAAAXck/lmTnG6Fu-u4sJm9MoRYA_tp9_iyykNYQACHMYCw/s1600-h/image%255B19%255D"&gt;&lt;img width="357" height="131" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-VW3rerdtNLQ/WkuuY7gcscI/AAAAAAAAXco/BJpRYz5nNU4d73jyE4YnWyOBJxAKiiqPgCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;RStudio logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1514908850408937"&gt;RStudio小檔案&lt;/h4&gt;&lt;dl&gt;&lt;dt&gt;最新版本&lt;/dt&gt;&lt;dd&gt;1.1.383&lt;/dd&gt;&lt;dt&gt;檔案大小&lt;/dt&gt;&lt;dd&gt;Windows約85.8MB&lt;/dd&gt;&lt;dt&gt;下載頁面&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.rstudio.com/products/rstudio/download/#download"&gt;https://www.rstudio.com/products/rstudio/download/#download&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;Windows直接下載鏈接&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://download1.rstudio.org/RStudio-1.1.383.exe"&gt;RStudio 1.1.383 - Windows Vista/7/8/10&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;p&gt;command line其實就夠了，但是如果用過IDE就知道IDE開發的速度上面差異。     &lt;/p&gt;&lt;p&gt;因此，這邊也會裝Open Source的R IDE，RStudio。     &lt;/p&gt;&lt;p&gt;安裝也很簡單只需要，下一步，下一步就好了，只是要注意，RStudio &lt;em&gt;並不包含&lt;/em&gt; R，所以兩個要分開安裝。     &lt;/p&gt;&lt;p&gt;安裝好了之後，在桌面不會出現，要從Windows的「開始」裡面找。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850408751"&gt;RStudio 快速介紹&lt;/h2&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514908850409138"&gt;主要界面&lt;/h3&gt;&lt;p&gt;執行起來會看到畫面分了四個部分：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;寫Script的地方 - 寫在這邊之後可以把整個script保存下來&lt;/li&gt;&lt;li&gt;Console - 同等於R的Command LIne。因此Script內容就是執行在這邊&lt;/li&gt;&lt;li&gt;環境參數 - 以我這個例子，可以看到參數x的值&lt;/li&gt;&lt;li&gt;其他畫面 - 例如安裝package，繪圖的結果，檔案總管都在這邊&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;這邊還要注意一下箭頭的部分，如果需要縮起來（例如不需要console直接寫在script），可以按那個放大的icon，旁邊則是縮小。             所以如果沒有看到畫面注意是不是縮小了         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-luwKfbKlAGI/WkuuajuaZ7I/AAAAAAAAXcs/1khuk3v71RwpsG9N1WxB4ik6wN7IkS3dACHMYCw/s1600-h/image%255B22%255D"&gt;&lt;img width="654" height="270" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ZFkwk0TJtsE/Wkuuc3uSvHI/AAAAAAAAXcw/m0A-aUBvJt4KAme7WqkF_HNoME-LmKwtQCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;R主要界面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514908850409357"&gt;幾個設定&lt;/h3&gt;&lt;p&gt;設定的地方在&lt;code&gt;Tools &amp;gt; Global Options &lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-TYz_l0I5MjY/WkuufldjlUI/AAAAAAAAXc0/IdizkdkInakewDcWBafAo35byROTyo61ACHMYCw/s1600-h/image%255B25%255D"&gt;&lt;img width="654" height="321" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Ju_TNvXXIPY/WkuumoptbcI/AAAAAAAAXc4/48Ln3f7ROrQMRKIphhXXp6ciOD35Wc0VACHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;開啟設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;這邊提一下兩個設定:             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;字體和樣式&lt;/li&gt;&lt;li&gt;預設的script儲存編碼改為utf-8&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1514908850409458"&gt;字體和樣式&lt;/h4&gt;&lt;p&gt;一般來說要先調整一下字體和樣式以符合需求：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;切換到 &lt;code&gt;Appearance&lt;/code&gt;&lt;/li&gt;&lt;li&gt;可以改font&lt;/li&gt;&lt;li&gt;可以改字體大小&lt;/li&gt;&lt;li&gt;可以改整個的theme&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-tdvuNm7jokw/WkuunZXEypI/AAAAAAAAXc8/6bYUPdh2YWMlUQegwZapNM2hDo7mZu9-ACHMYCw/s1600-h/image%255B28%255D"&gt;&lt;img width="654" height="659" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-6NYyFXNRUIA/WkuupD0IJLI/AAAAAAAAXdA/EUKu0uaf-AEJ-PJfSedqOKxU6yiXkwvgwCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;調整樣式&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1514908850409701"&gt;預設的script儲存編碼改為utf-8&lt;/h4&gt;&lt;p&gt;這個是避免script存檔的時候如果有中文可能會亂碼的問題。             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;切換到 &lt;code&gt;Code&lt;/code&gt;&lt;/li&gt;&lt;li&gt;切換到&lt;code&gt;Saving&lt;/code&gt;頁簽&lt;/li&gt;&lt;li&gt;選擇 &lt;code&gt;Change...&lt;/code&gt;&lt;/li&gt;&lt;li&gt;Default Setting 改成 Utf-8&lt;/li&gt;&lt;li&gt;按下&lt;code&gt;OK&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WvYuUC0ToCk/WkuuqMmWzYI/AAAAAAAAXdE/pSCiSPVeIZEK1BHnXXfjaNZTR4Wpaoh7gCHMYCw/s1600-h/image%255B31%255D"&gt;&lt;img width="654" height="690" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-VeJxstMGDHo/WkuurKw-miI/AAAAAAAAXdI/1B_HzP42a-A6Uw-RWEL5ye-bYp-5l8eFwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定RStudio的預設字集&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850409705"&gt;其他R IDE - Visual Studio&lt;/h2&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1514908850409406"&gt;R Tools for Visual Studio&lt;/h4&gt;&lt;dl&gt;&lt;dt&gt;支援的VS版本&lt;/dt&gt;&lt;dd&gt;2015和2017&lt;/dd&gt;&lt;dt&gt;首頁&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.visualstudio.com/zh-hant/vs/rtvs/"&gt;https://www.visualstudio.com/zh-hant/vs/rtvs/&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;VS 2017直接下載&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.visualstudio.com/zh-hant/thank-you-downloading-visual-studio/?sku=Community&amp;amp;rel=15"&gt;Community版本&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;p&gt;R本身只是Script，所以任何自己喜歡的編輯器都可以，基本上所有編輯器都會支援R（這邊指的是例如syntax highlight等）     &lt;/p&gt;&lt;p&gt;這邊舉得例子是Visual Studio。     &lt;/p&gt;&lt;p&gt;Visual Studio有個 R Tools for Visual Studio，可以用Visual Studio來開發R，基本上RStudio的功能都有，然後在熟悉的界面（如果你用VS的話）     &lt;/p&gt;&lt;p&gt;基本上安裝和一般VS安裝畫面差不多，裝完了之後會多出：         &lt;/p&gt;&lt;ul&gt;&lt;li&gt;R Tools的選項&lt;/li&gt;&lt;li&gt;R project template&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;可以直接在&lt;code&gt;R Tools &amp;gt; Windows &amp;gt; R Interactive&lt;/code&gt;直接開啟Console。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514908850409268"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇快速介紹了兩種不同分析Data的方式：軟體和程式語言。     &lt;/p&gt;&lt;p&gt;再來介紹了一些比較流行的語言和R的介紹。     &lt;/p&gt;&lt;p&gt;最後安裝了R、RStudio和R Tool For Visual Studio。     &lt;/p&gt;&lt;p&gt;準備好了之後，在下一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html"&gt;[16]用R來看股票，透過quantmod了解R的強大&lt;/a&gt;)來跑個人認為R的Hello World程式，用quantmod看股票。透過這個快速demo能夠了解R在資料分析和資料視覺有多麼方便。     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:ba449569-ea37-4f71-a350-0a6cd9fd597a" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+processing" rel="tag"&gt;data processing&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/R" rel="tag"&gt;R&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2987422572330090173/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-15-r-history-rstudio-r-tools-for-studio-ide-setting.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2987422572330090173'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2987422572330090173'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-15-r-history-rstudio-r-tools-for-studio-ide-setting.html' title='[Data Science 到底是什麼從一個完全外行角度來看][15]R是什麼？準備開發R的環境 - RStudio介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-BAEY0GVoaVk/WkuuMJEjG5I/AAAAAAAAXcI/7mBP7mcuHlc5oXDyjKJN2gwumNQ2H9ZgQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1308439152164048349</id><published>2018-01-01T21:26:00.000+08:00</published><updated>2018-01-03T00:12:28.970+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='data processing'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][14]如何問對的問題？</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-H3bH6C4HLZE/Wko2GNyXlSI/AAAAAAAAXbk/y9P7V-3qQF0094AY3mT-9reY4vScs3_mACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-H1gyH19t3-0/Wko2H4fupqI/AAAAAAAAXbo/C58QWWCmUIE76gT3wV2NafJCpSkdAOYQACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-13-data-processing-workflow-introduction.html"&gt;[13]Data的運用 - 介紹篇&lt;/a&gt;)了解了整個Data Process Workflow會經過的每個步奏，並且了解到&lt;em&gt;&lt;strong&gt;越前面的越重要&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;因此這篇將會從最重要的部分開始，怎麼定義一個好的問題？     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908804" ;=""&gt;什麼是好問題？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908827" ;=""&gt;定義資料範圍&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908245" ;=""&gt;定義預測結果內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908174" ;=""&gt;定義預測準確度&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908114" ;=""&gt;定義使用情境&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908814" ;=""&gt;怎麼建立這個模型&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908605" ;=""&gt;看看最後定義的問題&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514812566908897" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;      &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1514812566908804"&gt;什麼是好問題？&lt;/h2&gt;&lt;p&gt;這個聽起來好像不是很難，但是定義明確的問題會讓後面的一些決定變得更加簡單。     &lt;/p&gt;&lt;p&gt;舉例來說，假設今天我們的問題是：&lt;em&gt;&lt;strong&gt;預測飛機是否會準時到達？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;感覺好像很明確了，就是要預測飛機的到達時間，但是如果深入往下想，這個其實還是他廣泛了：         &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;定義資料範圍&lt;/em&gt;：資料的範圍在哪裡？那裡的飛機？那些機場的飛機？這些問題對於收集資料非常重要&lt;/li&gt;&lt;li&gt;&lt;em&gt;定義預測的結果內容&lt;/em&gt;：最後預測是什麼類型的預測？&lt;/li&gt;&lt;li&gt;&lt;em&gt;定義預測的精準度（Accuracy）&lt;/em&gt;：怎麼樣的準確度是可以接受的？&lt;/li&gt;&lt;li&gt;&lt;em&gt;定義使用情境&lt;/em&gt;：會怎麼樣使用這個模型？&lt;/li&gt;&lt;li&gt;&lt;em&gt;怎麼建立出這個模型&lt;/em&gt;：流程是什麼？&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;接下來對於每個部分做一些說明，並且看看這個怎麼能夠調整原本的問題。     &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514812566908827"&gt;定義資料範圍&lt;/h3&gt;&lt;p&gt;全世界飛機那麼多，到底是要看哪裡到哪裡的飛機？這個非常重要，因為這個會決定第二個步奏裡面的收集資料的&lt;em&gt;方式和方向&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;舉例來說，如果今天預測的是&lt;em&gt;美國的飛機&lt;/em&gt;，那麼就可以開始找&lt;em&gt;關於美國方面&lt;/em&gt;的航班資料。             &lt;/p&gt;&lt;p&gt;這個時候，會找到美國Department Of Transport（DOT）有提供資料是美國&lt;em&gt;國內航班的實際起降時間&lt;/em&gt;&lt;/p&gt;&lt;p&gt;這個時候整個的問題變成：             &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;使用從美國DOT取得到的資料，預測美國國內飛機是否會準時到達？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514812566908245"&gt;定義預測結果內容&lt;/h3&gt;&lt;p&gt;既然找到了資料來源，這個時候可以快速看一下DOT所提供的欄位有什麼。                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bZB_Jr7VnVY/Wko2JbXzbwI/AAAAAAAAXbs/s2Tsol8hCm4hSqmxBLyI21fQh37VS-tRACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="315" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-kRk0bxUu4lk/Wko2LRyHaFI/AAAAAAAAXbw/eLChzRjhEoM45qqHH5JKVxL3G5oi26y1gCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;飛機遲到的欄位&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;從上圖會看到，其實裡面的欄位有幾個和&lt;em&gt;是否延遲(delay)&lt;/em&gt;有關係，其中指出的那個是一個&lt;em&gt;binary 欄位&lt;/em&gt;，如果延遲超過15分鐘，那麼就會是1，不然就是0。             &lt;/p&gt;&lt;p&gt;所以，整個問題變成：             &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;使用從美國DOT取得到的資料，預測美國國內飛機是否會延遲？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個其實很重要，因為知道結果是0或1這種預測值，之後在Machine Learning選擇Algorithm就可以把一些例如預測數值的Algorithm剃掉。             &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514812566908174"&gt;定義預測準確度&lt;/h3&gt;&lt;p&gt;接下來問題會變成，到底準確度到什麼程度是可以接受？也就是，多少預測失敗是可以接受？             &lt;/p&gt;&lt;p&gt;一般來說，如果簡單一點，會從大約&lt;em&gt;70%&lt;/em&gt;作為目標，因此整個的問題變成：             &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;使用從美國DOT取得到的資料，預測精準度在70%以上，美國國內飛機是否會延遲？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514812566908114"&gt;定義使用情境&lt;/h3&gt;&lt;p&gt;到目前為止其實比一開始的問題明確，但是如果沒有跟著步奏走下來看的人其實還搞不懂這個情景是什麼。例如：&lt;em&gt;怎麼樣叫做延遲？&lt;/em&gt;&lt;/p&gt;&lt;p&gt;所以整個問題可以調整變成：             &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;使用從美國DOT取得到的資料，預測精準度在70%以上，美國國內飛機的降落時間是否會比預定的降落時間晚15分鐘？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514812566908814"&gt;怎麼建立這個模型&lt;/h3&gt;&lt;p&gt;到目前為止對於最終目標和資料取得的地方都明確了，不過對於怎麼到達最終結果並沒有定義的很清楚。             &lt;/p&gt;&lt;p&gt;因此，以假設要建立Machine Learning的預測模型來做這個預測，那麼整個的問題變成：             &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;透過整個Data Processing Workflow的流程，對從美國DOT取得到的資料做清理並且透過Machine Learning建立出預測模型，預測精準度在70%以上，美國國內飛機的降落時間是否會比預定的降落時間晚15分鐘？&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514812566908605"&gt;看看最後定義的問題&lt;/h2&gt;&lt;p&gt;如果把原本的問題和最後得到的問題做比較：         &lt;/p&gt;&lt;ul&gt;&lt;li&gt;預測飛機是否會準時到達？&lt;/li&gt;&lt;li&gt;透過整個Data Processing Workflow的流程，對從美國DOT取得到的資料做清理並且透過Machine Learning建立出預測模型，預測精準度在70%以上，美國國內飛機的降落時間是否會比預定的降落時間晚15分鐘？&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;最後的問題很明確：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;資料從哪裡來&lt;/li&gt;&lt;li&gt;最後用Machine Learning建立預測模型&lt;/li&gt;&lt;li&gt;準確度目標是70%以上&lt;/li&gt;&lt;li&gt;預測結果是飛機的降落時間是否比預定時間晚15分鐘&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;可以想象，有了這些明確目標，對於接下來Workflow的每個步奏有問題的時候都可以回來看。     &lt;/p&gt;&lt;p&gt;例如，Exploratory Analysis階段的時候，可以盡量找可能和延遲有關的欄位，在Machine Learning的階段，會找和Supervised Learning有關的Algorithm（因為要建立的是預測模型），然後Algorithm是Binary Classification（因為結果是0或1代表延遲或沒有延遲）     &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;上面有些詞目前還看不懂沒關係，因為後面都會介紹。     &lt;/div&gt;&lt;p&gt;因此可以發現真的是&lt;em&gt;越前面&lt;/em&gt;的階段&lt;em&gt;越重要&lt;/em&gt;，因為&lt;em&gt;&lt;strong&gt;失之毫釐，差以千里&lt;/strong&gt;&lt;/em&gt;，因此也很用可能會在每個階段來來回回。     &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;如果想一下，其實任何事情都是這樣，專案成不成功一開始的系統分析很重要，事業成不成功，和自己定義的Visio很重要，但是實際上這塊是&lt;em&gt;最難做到&lt;/em&gt;的。         &lt;/p&gt;&lt;p&gt;所以，真實情況是不可能一步到位，所以Agile為什麼現在這麼夯，重點是&lt;em&gt;fail fast&lt;/em&gt;。         &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514812566908897"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇希望透過一個很簡單的例子來帶出定義一個明確的問題有多重要，並且這個幫助會有多大。     &lt;/p&gt;&lt;p&gt;當然，實際在run的過程可能沒辦法一次就定義這麼清楚，甚至有時候是模糊的，只是拿到一堆資料然後看看能不能找到什麼有趣的資訊。     &lt;/p&gt;&lt;p&gt;這個也是&lt;em&gt;Exploratory Analysis（探索性分析）&lt;/em&gt;在做的事情。     &lt;/p&gt;&lt;p&gt;不過在實際進入Exploratory Analysis之前，要先介紹會用到的工具，R語言。     &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-15-r-history-rstudio-r-tools-for-studio-ide-setting.html"&gt;[15]R是什麼？準備開發R的環境 - RStudio介紹&lt;/a&gt;)將會快速介紹一下R語言的來源和怎麼準備好開發R。並且跑一個R的Hello World程式，用R來分析股票來看看R在分析上面的威力。     &lt;/p&gt;&lt;/section&gt;     &lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:24d9656f-0048-4259-a34a-1988d7ee3cc0" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+processing" rel="tag"&gt;data processing&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1308439152164048349/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-14-how-to-define-good-question.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1308439152164048349'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1308439152164048349'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-14-how-to-define-good-question.html' title='[Data Science 到底是什麼從一個完全外行角度來看][14]如何問對的問題？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-H1gyH19t3-0/Wko2H4fupqI/AAAAAAAAXbo/C58QWWCmUIE76gT3wV2NafJCpSkdAOYQACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4902955662223164980</id><published>2017-12-31T20:50:00.000+08:00</published><updated>2018-01-01T21:39:54.738+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='data processing'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][13]Data的運用 - 介紹篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-58fEFlD9-PM/WkjbUoa1Z2I/AAAAAAAAXas/2EHpBVdZaK8M75PWWHOQde3qLWehQYpCwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sp65hGWTup8/WkjbWb-biLI/AAAAAAAAXaw/Ar3Y3jBMkQ4pPsWMvzdIEGVTcuRzk1-0QCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;還記得之前提到過，如果&lt;em&gt;Data是原油&lt;/em&gt;那麼Data Science就是&lt;em&gt;提煉成石油的技術&lt;/em&gt;。     &lt;/p&gt;&lt;p&gt;到目前為止，解決了Data的&lt;em&gt;儲存和運算&lt;/em&gt;的部分。但是就算可以處理Big Data，該&lt;em&gt;怎麼&lt;/em&gt;處理？如何把處理結果變成有&lt;em&gt;意義&lt;/em&gt;或者可以&lt;em&gt;動作的策略&lt;/em&gt;？     &lt;/p&gt;&lt;p&gt;如果說，&lt;em&gt;Big Data的儲存和運算&lt;/em&gt;在武俠小說裡面屬於&lt;em&gt;內功&lt;/em&gt;的話那麼&lt;em&gt;Data Process Workflow（資料處理流程）&lt;/em&gt;就同等於&lt;em&gt;招式&lt;/em&gt;一樣。     &lt;/p&gt;&lt;p&gt;沒有足夠的內力（Data），招式在精妙也沒有用（就像瞎子摸象，就算摸的技巧再好，也因為局限的關係摸不到全貌，一定會有偏頗）。     &lt;/p&gt;&lt;p&gt;反過來說，如果內力深厚，但是不會招式，那麼同等於英雄無用武之地。 &lt;/p&gt;&lt;p&gt;在這個系列的接下來將會著重在介紹Data Processing的部分。這篇將會是概觀介紹。 &lt;/p&gt;&lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448550" ;=""&gt;Data Processing Workflow指的是什麼？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448989" ;=""&gt;中間的Big Data&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448814" ;=""&gt;一切從解決問題開始&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448962" ;=""&gt;Exploratory Analysis階段&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448834" ;=""&gt;Machine Learning (機器學習) 階段&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448515" ;=""&gt;發佈&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448476" ;=""&gt;需要有什麼提前知識？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514723918448209" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514723918448550"&gt;Data Processing Workflow指的是什麼？&lt;/h2&gt;&lt;p&gt;Data Processing Workflow其實非常廣的一個詞，所以這邊會定義一下這裡指的是什麼。     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3tfrEIa2ixo/WkjbX7XKF1I/AAAAAAAAXa0/h4n-6_djwrUfl_iNJBrf5wlr18WVDmQ-gCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="455" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h23H4O_4uZY/WkjbYvi0KEI/AAAAAAAAXa4/c1bKZrzQ3mcCN_2a6A3h-HH7yhYHo85OACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Data Processing Workflow圖&lt;/figcaption&gt;&lt;/figure&gt;         還記不記得之前的這張圖？這次有做了一些調整。     &lt;section&gt;&lt;h3 id="WizKMOutline_1514723918448989"&gt;中間的Big Data&lt;/h3&gt;&lt;p&gt;這邊變成了灰色表示已經講完了。Big Data在中間是因為整個的核心其實是Data。如果沒有Data就算有在好的“招式”也沒有用。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514723918448814"&gt;一切從解決問題開始&lt;/h3&gt;&lt;p&gt;整個的Workflow從&lt;em&gt;想找到某個問題的解決方案&lt;/em&gt;開始。這個&lt;em&gt;&lt;strong&gt;非常重要&lt;/strong&gt;&lt;/em&gt;。因為接下來的處理方式都是依照這個問題來延伸出來。             &lt;/p&gt;&lt;p&gt;這個和開發軟體一樣，如果一開始的需求分析就錯了，那麼後面做的再好客戶一定不滿意，因為這個&lt;em&gt;不是他想解決的問題&lt;/em&gt;。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，還記得之前提到Data Scientist有提到會需要某個Domain Knowledge（領域知識） - 因為沒有這個領域知識根本問不出問題。                 &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514723918448962"&gt;Exploratory Analysis階段&lt;/h3&gt;&lt;p&gt;在這個部分，將會依照想要處理的問題去收集資料、收集完了之後需要對資料進行處理和分析，然後才會有所謂的&lt;em&gt;clean data（乾淨）&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;反過來說，如果一開始問題定義不明確，或者對於整個Domain不熟悉，那麼收集的資料一定會有偏頗，對有偏頗的資料進行處理和分析肯定就錯了。             &lt;/p&gt;&lt;p&gt;這個階段會需要：                 &lt;/p&gt;&lt;ul&gt;&lt;li&gt;資料清洗的能力 - 在不同領域有不同名稱，例如：Extract Transofrm and Load (ETL)或者Data Munging&lt;/li&gt;&lt;li&gt;統計學的概念 - 這樣才會有辦法作分析&lt;/li&gt;&lt;li&gt;Data Visualization（資料視覺化）的技能 - 這樣才更好了解資料&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;這個階段也是傳統Data Analysis在做的事情。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個階段花的時間最多 - 有做過研究，大約&lt;em&gt;80%&lt;/em&gt;的時間都是花在這個階段。             &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514723918448834"&gt;Machine Learning (機器學習) 階段&lt;/h3&gt;&lt;p&gt;傳統的Data Analysis（資料分析）是不會有Machine Learning的階段，或者準確一點說，並不會像現在Machine Learning的定義方式來產生出模型。             &lt;/p&gt;&lt;p&gt;個人覺得Machine Learning（以下簡稱ML）這個詞有點誤導傾向，因為聽到ML第一個想到的是 AI。好像是在講&lt;em&gt;AI自動進化&lt;/em&gt;的感覺。但是，實際上不是，或者說只是AI進化的&lt;em&gt;一小塊&lt;/em&gt;部分而已。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yhLX0OxenHo/WkjbZ8dKAEI/AAAAAAAAXa8/PBse_T1Gfiw8N0dviqYqefxFKTl0CoAgwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="313" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-wxl_rp_O4CA/Wkjbbh6qGkI/AAAAAAAAXbA/YmUoGtswBLAv6xs51QxEd8qVmF7ktp7OwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;ML process&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;整個Machine Learning的目的是在建立一個&lt;em&gt;Prediction Model&lt;/em&gt;。透過這個Prediction Model，只需要把資料丟進去，就會得到“準確”的預測結果。             &lt;/p&gt;&lt;p&gt;而Prediction Model其實就是 Clean Data + Algorithm最後產生出來。             &lt;/p&gt;&lt;p&gt;而Algorithm是什麼？其實就是一些Statistical Model（統計模型）定義出來。             &lt;/p&gt;&lt;p&gt;所以ML和一般程式開發很不一樣，一般程式開發寫的是&lt;em&gt;邏輯&lt;/em&gt;，但是ML其實不是寫邏輯，而是&lt;em&gt;挑選最適合目前預測內容和資料的algorithm&lt;/em&gt;。所以他在調整的是兩個東西：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Training Data (也就是Clean Data)&lt;/li&gt;&lt;li&gt;Algorithm - 使用哪個演算法和演算法本身參數的調整&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;所以最後的Prediction Model找到的&lt;em&gt;不是最終解法&lt;/em&gt;，而是找到&lt;em&gt;Data之間的關聯性&lt;/em&gt;，因此Model不會一直有效，因為假設什麼原因導致那個關聯性斷了，Model就不準確了。             &lt;/p&gt;&lt;p&gt;以上是一個非常快速的介紹ML，之後會到了ML階段會有更深入的一些介紹。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514723918448515"&gt;發佈&lt;/h3&gt;&lt;p&gt;不管有沒有走ML，最後一定會有一些分析結果或者有走ML會有Prediction Model。             &lt;/p&gt;&lt;p&gt;這些資訊如何容易的呈現給他人來看？如何把Model變成簡單方式就可以讓一般人操作？這個階段其實就是把整個結果很好的呈現出來。             &lt;/p&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;這個Workflow裡面，越前面的階段越重要，換句話說，定義問題&lt;em&gt;&lt;strong&gt;最重要&lt;/strong&gt;&lt;/em&gt;。因為，每一個階段的動作會&lt;em&gt;&lt;strong&gt;相依&lt;/strong&gt;&lt;/em&gt;上一個階段的結果，所謂 &lt;em&gt;失之毫釐，差以千里&lt;/em&gt;，因此很長會在 各個階段&lt;em&gt;往回跳來跳去&lt;/em&gt;。             &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514723918448476"&gt;需要有什麼提前知識？&lt;/h2&gt;&lt;p&gt;在接下來的內容，會需要有個前置條件，就是多多少少&lt;em&gt;有碰過&lt;/em&gt;程式開發。     &lt;/p&gt;&lt;p&gt;不需要很深入的了解，但是要有基本知識像是什麼是variable（參數）這種很簡單的概念即可。     &lt;/p&gt;&lt;p&gt;因為，接下來的一些資料處理都會使用R語言，這邊&lt;em&gt;不會一個一個語法介紹&lt;/em&gt;R。只會把整個的歷史和特色概念介紹一下，剩下都是邊操作邊說明，因此如果從來沒有碰過程式肯能會覺得不太懂（不過應該就算沒有碰過程式開發應該也會看的懂才對）     &lt;/p&gt;&lt;p&gt;至於另外一個重要的概念：&lt;em&gt;一些簡單的統計概念&lt;/em&gt;也會很有幫助，不過這個部分會有特定篇幅做一些簡單介紹，因為如果沒有這些背景在看一些Data Process的時候會看不太懂。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514723918448209"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇對於整個Data運用的整個階段做了一個簡單和快速的介紹，為接下來介紹的內容先打下一些基礎。     &lt;/p&gt;&lt;p&gt;下篇(&lt;a href="http://blog.alantsai.net/2018/01/data-science-series-14-how-to-define-good-question.html"&gt;[14]如何問對的問題？&lt;/a&gt;)將會從最終要的部分開始，怎麼定義一個問題？什麼樣的定義才是好的定義。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;         &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:b9e0a758-8bd5-46ec-9d41-083ad5c5cd8a" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+processing" rel="tag"&gt;data processing&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4902955662223164980/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-13-data-processing-workflow-introduction.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4902955662223164980'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4902955662223164980'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-13-data-processing-workflow-introduction.html' title='[Data Science 到底是什麼從一個完全外行角度來看][13]Data的運用 - 介紹篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-sp65hGWTup8/WkjbWb-biLI/AAAAAAAAXaw/Ar3Y3jBMkQ4pPsWMvzdIEGVTcuRzk1-0QCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-415562513746295753</id><published>2017-12-30T23:06:00.000+08:00</published><updated>2017-12-31T20:51:34.764+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][12]Hadoop總結(下篇) - 一切才剛剛開始</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wLUhY3IiFF4/Wkepb6h8ZBI/AAAAAAAAXZc/1BYR_z9DEtoOIR9U2mksrj9XUXokupYwQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XUS9NIlHYBU/Wkepd3JcLLI/AAAAAAAAXZg/UUdeCjFRVNwJ2sjf6cG-vMA5Jb6welCzwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-11-hadoop-conclustion-ecosystem-intro.html"&gt;11]Hadoop總結(上篇) - 一切才剛剛開始&lt;/a&gt;)介紹了Hadoop的Ecosystem之後，了解到有很多package建立在Hadoop上面。&lt;/p&gt;&lt;p&gt;不過一個問題會浮現出來，這門多package，怎麼讓他們互相溝通沒有問題？畢竟版本和版本之間很有可能會有相容性問題。                         &lt;/p&gt;&lt;p&gt;這就是Hadoop Distribution的作用，一些整理好包成一包的Hadoop Ecosystem，有些distribution還包括一些管理界面讓整個管理變得更加簡單。                         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949296" ;=""&gt;Hadoop Distribution&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949476" ;=""&gt;快速總結Distribution的差異&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949182" ;=""&gt;Cloudera's Distribution include Apache Hadoop (CDH)&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949117" ;=""&gt;Hortonworks Data Platform (HDP)&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949824" ;=""&gt;Syncfusion Big Data Platform&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949777" ;=""&gt;Azure HDInsight&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949203" ;=""&gt;一切才剛剛開始 - Data Engineer之路&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514644395949421" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1514644395949296"&gt;Hadoop Distribution&lt;/h2&gt;&lt;p&gt;當透過這系列的介紹方式把Hadoop POC做完了之後，當真的要測試的時候肯定不是用這種方式管理，而是用Hadoop Distribution。     &lt;/p&gt;&lt;p&gt;基本上Hadoop Distribution可以把它想象成一個solution package - 把多個Ecosystem套件組合在一起變成一個完整的package，讓安裝和使用變得簡單。     &lt;/p&gt;&lt;p&gt;這邊快速介紹3+1個這種Distribution：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Cloudera's Distribution include Apache Hadoop (CDH) - Linux&lt;/li&gt;&lt;li&gt;Hortonworks Data Platform (HDP) - Linux and Windows&lt;/li&gt;&lt;li&gt;Syncfusion Big Data Platform - Linux and Windows&lt;/li&gt;&lt;li&gt;Microsoft Azure HDInsight - 微軟雲端的big data solution&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514644395949476"&gt;快速總結Distribution的差異&lt;/h3&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;CDH&lt;/th&gt;&lt;th&gt;HDP&lt;/th&gt;&lt;th&gt;SBDP&lt;/th&gt;&lt;th&gt;HDInsight&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;支援的OS&lt;/th&gt;&lt;td&gt;Linux&lt;/td&gt;&lt;td&gt;Windows、Linux&lt;/td&gt;&lt;td&gt;Windows、Linux&lt;/td&gt;&lt;td&gt;NA - 在Azure雲端&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否需要收費？&lt;/th&gt;&lt;td&gt;免費&lt;/td&gt;&lt;td&gt;免費&lt;/td&gt;&lt;td&gt;符合條件免費 - 收費&lt;/td&gt;&lt;td&gt;收費&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否有客制管理界面？&lt;/th&gt;&lt;td&gt;有&lt;/td&gt;&lt;td&gt;沒有&lt;/td&gt;&lt;td&gt;有&lt;/td&gt;&lt;td&gt;有 - Azure管理界面&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;建議使用情境&lt;/th&gt;&lt;td&gt;如果在Linux環境&lt;/td&gt;&lt;td&gt;如果在Windows並且需要免費&lt;/td&gt;&lt;td&gt;&lt;p&gt;如果在Windows並且願意付費。                        &lt;/p&gt;&lt;p&gt;如果剛開始在Windows學習Hadoop，建議從這個開始，因為安裝和管理界面很容易使用，並且如果符合Community License也是免費。                        &lt;/p&gt;&lt;/td&gt;&lt;td&gt;                         如果沒有機器但是又想測試Hadoop                    &lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;接下來會在更深入一些介紹這些Distribution。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514644395949182"&gt;Cloudera's Distribution include Apache Hadoop (CDH)&lt;/h3&gt;&lt;p&gt;CDH貌似是最早做這種Distribution的機構，基本概念很簡單，整合這些Ecosystem的package在一包裡面並且提供一個管理界面方便管理cluster和這些package。         &lt;/p&gt;&lt;p&gt;從下圖可以看到整個CDH提供的服務和內容：             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-OmK1Z6XSH5M/WkepgM1D7dI/AAAAAAAAXZk/LxoWiHaZ7sQ4ZOxOSeQU8S9qx774YHobgCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="542" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-NPmVL5cxdKk/WkepiCp8iKI/AAAAAAAAXZo/ldtEuXAnxHUhp-YpUCrk4H9ZafJyzFebACHMYCw/image_thumb%255B19%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;CDH的架構。來源：https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_intro.html&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;CDH是免費的，不過cloudera也有提供Enterprise服務，也就是收費的服務。基本上就是CDH加上更多管理面和一些Technical Support。         &lt;/p&gt;&lt;p&gt;CDH &lt;em&gt;只支援&lt;/em&gt; Linux，所以如果在Windows就別想了。         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;參考資料&lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;Overview: &lt;a href="https://www.cloudera.com/documentation/enterprise/latest/topics/cdh_intro.html"&gt;CDH Overview&lt;/a&gt;&lt;/li&gt;&lt;li&gt;                         有支援的OS：&lt;a href="https://www.cloudera.com/documentation/enterprise/release-notes/topics/rn_consolidated_pcm.html"&gt;CDH 5 and Cloudera Manager 5 Requirements and Supported Versions&lt;/a&gt;&lt;/li&gt;&lt;li&gt;                         快速測試的下載鏈接：&lt;a href="https://www.cloudera.com/downloads/quickstart_vms/5-12.html"&gt;CDH 5.12 Quick Start Download&lt;/a&gt;&lt;/li&gt;&lt;li&gt;                         快速測試的文件：&lt;a href="https://www.cloudera.com/documentation/enterprise/5-6-x/topics/cm_qs_quick_start.html"&gt;Cloudera Manager and CDH QuickStart Guide&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514644395949117"&gt;Hortonworks Data Platform (HDP)&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Iv-pO0QCv9M/WkepjPQBXUI/AAAAAAAAXZs/0dFFx5d8cEICNWTtQkrKqL2aF0IFXk_FgCHMYCw/s1600-h/image%255B33%255D"&gt;&lt;img width="261" height="119" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-U36hW0FnDUY/Wkepjx71lnI/AAAAAAAAXZw/TQL_AFm53QkmBrW92SYjBOt0G5_6hggaQCHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Hortonworks Logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;HDP可以說是最早有支援Windows的Distribution，後面提到的Azure HDInsight內部執行的就是HDP。         &lt;/p&gt;&lt;p&gt;HDP可以說是把很多opensource package整合在一起的Distribution，所以不像cloudera那樣有自己的管理界面，而是用Ambari（也是一個open source的package）。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-eEAd9ubEHl0/Wkepqy9DQyI/AAAAAAAAXZ0/9gQU0Bc_BdQC26V9Fn9HHQsOcHL7aCKWQCHMYCw/s1600-h/image%255B31%255D"&gt;&lt;img width="654" height="264" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-m5Ntqqu30yE/Wkep9UhFywI/AAAAAAAAXZ8/4j7ujPWbq_YKXRIorkICoqE-UHyvhVClQCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整個架構&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;HDP支援Windows和Linux。         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;參考資料&lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;Overview介紹：&lt;a href="https://hortonworks.com/products/data-platforms/hdp/"&gt;鏈接&lt;/a&gt; - 對於每個Package有對應說明&lt;/li&gt;&lt;li&gt;下載Sandbox VM做測試：&lt;a href="https://hortonworks.com/products/sandbox/"&gt;GET STARTED WITH HORTONWORKS SANDBOX&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514644395949824"&gt;Syncfusion Big Data Platform&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yPNIweir73g/WkeqFFxFpKI/AAAAAAAAXaA/T5GjHyPYvGsXVqmLJ8iZ4IrNRaNMouyegCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="293" height="88" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-191_oP4rBG8/WkeqO0pB8LI/AAAAAAAAXaE/8x1H6I8fdiAy0PQkYoovN_eSlvesVkL5ACHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Syncfusion的logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;Syncfusion最出名應該是有提供一些免費的ebook叫做Succinctly系列，用短短篇幅介紹一些技術，同時對於Windows的開發有提供很多好用的套件可以快速上手。因此在這邊介紹的Distribution裡面以Windows開發者來說是最親民。         &lt;/p&gt;&lt;p&gt;Syncfusion Big Data Platform (下面簡稱SBDP) 是這3個裡面最年輕的Distribution，不過個人認為至少在Windows平台下是最容易操作的一個。         &lt;/p&gt;&lt;p&gt;SBDP有包含一個BigData Studio，裡面用tab的方式能夠切換不同的Package，並且有一個界面可以看到這些Package的Service是否有啟動，這個操作起來非常的直覺。             &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-BpD4fa5w1kI/WkeqWnakwqI/AAAAAAAAXaI/vtO5dIyexBgDb6oX_o1bPnbkss-K0mgEwCHMYCw/s1600-h/image%255B27%255D"&gt;&lt;img width="654" height="350" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-PDsQ7mI-ARA/WkeqX5LtaJI/AAAAAAAAXaM/WFWluLyuG3Qwswnw9JtHWTcjAZnNCUnwgCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;BigData Studio的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;SBDP支援Windows和Linux，如果需要在Windows開發個人建議從SBDP做嘗試。         &lt;/p&gt;&lt;p&gt;SBDP有提供Community的版本，所以在測試上面是免費，不過如果用在Production如果不符合Community License就會需要一筆費用。         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;參考資源&lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;首頁介紹：&lt;a href="https://www.syncfusion.com/products/big-data"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;下載鏈接（需要先註冊帳號）：&lt;a href="https://www.syncfusion.com/downloads/bigdata"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;操作手冊：&lt;a href="https://help.syncfusion.com/bigdata/overview"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514644395949777"&gt;Azure HDInsight&lt;/h3&gt;&lt;p&gt;Azure HDInsight不算是Distribution，是微軟Azure上面的一個Hadoop as Service的概念。因此，如果沒有機器但是想要測試Hadoop，可以考慮用Azure HDInsight。         &lt;/p&gt;&lt;p&gt;整個Azure HDInsight底層其實就是Hortonworks的HDP。         &lt;/p&gt;&lt;p&gt;基本上拆成了兩塊：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;HDInsight - 屬於運算的部分(可以理解MapReduce執行的部分)&lt;/li&gt;&lt;li&gt;Azure Storage - HDFS的部分&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;所以儲存和運算可以分開，由於HDInsight比較貴，因此可以&lt;em&gt;先把資料上傳到Azure Storage&lt;/em&gt;（Storage和HDInsight比相對便宜呢多），等到&lt;em&gt;需要執行運算&lt;/em&gt;的時候在啟動HDInsight。         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zLw-8llNokM/WkeqZPXX9II/AAAAAAAAXaQ/RmXWwBP-GPQsqb09x1E-m1bIP7gfzbmnQCHMYCw/s1600-h/image%255B25%255D"&gt;&lt;img width="654" height="312" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sVCUHFm0i_g/WkeqaVZDqTI/AAAAAAAAXaU/hgKTNMYpPkUlnEp6yk2VJO1VFPuiXU4CwCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;架構&lt;/figcaption&gt;&lt;/figure&gt;&lt;br /&gt;&lt;dl&gt;&lt;dt&gt;參考資料&lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;官方介紹：&lt;a href="https://azure.microsoft.com/en-us/services/hdinsight/"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;文件：&lt;a href="https://docs.microsoft.com/en-us/azure/hdinsight/"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514644395949203"&gt;一切才剛剛開始 - Data Engineer之路&lt;/h2&gt;&lt;p&gt;Data Engineer屬於Data Sciencist的分支的一個部分，主要在做的工作就是專注于在資料儲存這一塊。     &lt;/p&gt;&lt;p&gt;因此如果對於Hadoop和整個Ecosystem的管理、維護及使用非常有興趣，那麼可以繼續往下鑽研並且可以找Data Engineer相關的工作。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514644395949421"&gt;結語&lt;/h2&gt;&lt;p&gt;這個系列關於Data底層儲存就介紹到這邊了，希望對於要往下鑽研能夠提供一個足夠的基礎，至少往下看的時候不會完全看不懂。     &lt;/p&gt;&lt;p&gt;之前做的Hadoop VM先不要刪，後面介紹R的時候會介紹R如何和Hadoop接。所以如果到時候要跟著做的話會需用到。     &lt;/p&gt;&lt;p&gt;接下來將會開始到下一個階段(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-13-data-processing-workflow-introduction.html"&gt;[13]Data的運用 - 介紹篇&lt;/a&gt;)，也就是實際對資料的理解、運用到最後建立出預測模型。     &lt;/p&gt;&lt;/section&gt;&lt;section&gt;             &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:f1cdc0e9-2e2c-4777-8212-24094dee1db4" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/415562513746295753/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-12-hadoop-conclustion-hadoop-distribution-info-and-further-resource.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/415562513746295753'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/415562513746295753'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-12-hadoop-conclustion-hadoop-distribution-info-and-further-resource.html' title='[Data Science 到底是什麼從一個完全外行角度來看][12]Hadoop總結(下篇) - 一切才剛剛開始'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-XUS9NIlHYBU/Wkepd3JcLLI/AAAAAAAAXZg/UUdeCjFRVNwJ2sjf6cG-vMA5Jb6welCzwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4576371847519652819</id><published>2017-12-30T22:46:00.000+08:00</published><updated>2017-12-31T00:26:06.120+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][11]Hadoop總結(上篇)–Ecosystem介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-AFtZXWeRX9o/WkelcVZsOFI/AAAAAAAAXYo/12-GHKI4I0cZwt4XHEBZtrH2AKylW9veACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-c3mOZ-3ScYU/Wkeld0EUWUI/AAAAAAAAXYs/vfffl5JNhuIdl7aDabNXB-shNMzbTbQDwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-10-hadoop-streaming-intro-use-net-core-for-MapReduce.html"&gt;[10]用.Net Core跑Hadoop MapReduce - Streaming介紹&lt;/a&gt;)透過Hadoop Streaming的幫助，改成用.Net Core 2.0的程式作為MapReduce的邏輯，基本上這個系列裡面的Hadoop介紹也要告一個段落。&lt;/p&gt;&lt;p&gt;這一篇，將會快速回顧到目前為止所了解到關於Hadoop的部分，再來介紹Hadoop Ecosystem，和3個比較常見的package介紹。         &lt;/p&gt;&lt;/section&gt;         &lt;section&gt;             &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100960577" ;=""&gt;溫故知新&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100961193" ;=""&gt;Hadoop Ecosystem&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100961585" ;=""&gt;HIVE&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100961836" ;=""&gt;HBase&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100961587" ;=""&gt;Spark&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514643100961168" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;          &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1514643100960577"&gt;溫故知新&lt;/h2&gt;&lt;p&gt;先來快速回顧一下到目前為止看了什麼：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;從Big Data開始介紹，了解到Big Data裡面的3個V - 由於別的技術的可行性提高，Big Data成長也越來越快：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-03-big-data-intro.html"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;再來介紹了Hadoop的誕生 - 為了因應Big Data而誕生的程式：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-04-hadoop-intro.html"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;在來手動用VM建立了一個pseudo-distributed mode的hadoop：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html"&gt;上篇鏈接&lt;/a&gt;、&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html"&gt;下篇鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;有了一個可運作的hadoop之後，了解了Hadoop的核心：YARN和MapReduce：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-07-deeper-look-at-yarn-and-hdfs-in-hadoop.html"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;                 接下來把Hadoop的VM複製出來用來建立一個worker - 打造了fully-distributed mode：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-08-hadoop-fully-distributed-mode-tutorial.html"&gt;鏈接&lt;/a&gt;&lt;/li&gt;&lt;li&gt;                 最後介紹了MapReduce的程式，先介紹原理，後來介紹如何用.Net Core寫一個：&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-09-hadoop-map-reduce-java-wordcount-example.html"&gt;MapReduce原理&lt;/a&gt;、&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-10-hadoop-streaming-intro-use-net-core-for-MapReduce.html"&gt;Hadoop Streaming執行.Net Core&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;從目前了解的來看，對於整個Hadoop的核心已經有了基本的概念，馬上浮現的問題是，這樣建立和管理Hadoop不會太麻煩嗎？透過MapReduce寫不同的邏輯太難寫了吧。         &lt;/p&gt;&lt;p&gt;相信看完之後會有種感覺，&lt;em&gt;&lt;strong&gt;Hadoop感覺很"底層"&lt;/strong&gt;&lt;/em&gt;，從應用程度來說太不Friendly（友善），並且要怎麼管理這些Hadoop Cluster？         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，Hadoop給我的感覺就像程式開發裡面的Assembly，速度快，但是不好寫，因此會使用High Level Language像C#。         &lt;/div&gt;&lt;p&gt;因此，接下來看看一些在Hadoop上面的Ecosystem和所謂的&lt;em&gt;Hadoop Distribution&lt;/em&gt;。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514643100961193"&gt;Hadoop Ecosystem&lt;/h2&gt;&lt;p&gt;還記得之前提到Hadoop版本的時候介紹了2.0之後其中一個大改變就是加入了YARN。         &lt;/p&gt;&lt;p&gt;YARN的加入讓在Hadoop上面開發變得更加的簡單，因此很多Application蓋在了Hadoop的上面，達到利用Hadoop的Cluster運算和HDFS。         &lt;/p&gt;&lt;p&gt;下圖是一個Hadoop Ecosystem的幾個重要package，這邊會針對裡面的：             &lt;/p&gt;&lt;ul&gt;&lt;li&gt;HIVE - 用類似sql語法執行MapReduce的方式&lt;/li&gt;&lt;li&gt;HBase - 在HDFS上面的NoSql儲存&lt;/li&gt;&lt;li&gt;Spark - 另外一種執行工作的模式&lt;/li&gt;&lt;/ul&gt;多做一些簡單介紹             &lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-8dp6YCqVs1A/WkelffWeKRI/AAAAAAAAXYw/ry1UcQ7s4EYTTS75O3B8BSLAbiTtUACIwCHMYCw/s1600-h/image%255B7%255D"&gt;&lt;img width="654" height="316" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-pXPsK9tl11M/Wkelg-SlvEI/AAAAAAAAXY0/yyVVkEZ2qA4HHk7xaIBso5kluQm_XqlawCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;Hadoop Ecosystem，來源：http://www.dotnettricks.com/learn/hadoop/apache-hadoop-ecosystem-and-components&lt;/figcaption&gt;&lt;/figure&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514643100961585"&gt;HIVE&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-87yddDTmLxY/Wkelh3iVasI/AAAAAAAAXY4/iG6ORs8ShQkz6Sh-s_L2b3Q0MwDII3CawCHMYCw/s1600-h/image%255B10%255D"&gt;&lt;img width="269" height="161" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-xIMQI1E1fAU/WkeliyB-heI/AAAAAAAAXY8/NWc3y9wRjKgs3caEFJQPT3g3f9dJsoREgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Hive Logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;HIVE一開始是由Facebook開發，後來捐出來變成一個Open Source專案。主要目的是讓懂SQL的人能夠快速上手能從HDFS取資料。             &lt;/p&gt;&lt;p&gt;還記得之前提到要寫MapReduce感覺有點麻煩，HIVE其實就是一個使用&lt;em&gt;類似SQL語法的語言，HiveQL來和MapReduce溝通的中間層&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;換句話說，用HiveQL語法，HIVE會自動轉成MapReduce從HDFS裡面把資料取出來。             &lt;/p&gt;&lt;p&gt;因此，懂SQL就能夠快速上手從HDFS裡面撈出資料。             &lt;/p&gt;&lt;p&gt;下面是從&lt;a href="https://en.wikipedia.org/wiki/Apache_Hive"&gt;Wikipedia&lt;/a&gt;截取的WordCount範例，可以看到，基本上會sql基本上看的懂在做什麼，把這個和Java和.Net Core版本做比較，對於會sql的人來說這個簡單多了                 &lt;/p&gt;&lt;pre class="brush: plain;"&gt;DROP TABLE IF EXISTS docs;&lt;br /&gt;CREATE TABLE docs (line STRING);&lt;br /&gt;LOAD DATA INPATH 'input_file' OVERWRITE INTO TABLE docs;&lt;br /&gt;CREATE TABLE word_counts AS&lt;br /&gt;SELECT word, count(1) AS count FROM&lt;br /&gt; (SELECT explode(split(line, '\s')) AS word FROM docs) temp&lt;br /&gt;GROUP BY word&lt;br /&gt;ORDER BY word;&lt;br /&gt;                &lt;/pre&gt;&lt;p&gt;更多資訊，請參考：&lt;a href="https://hive.apache.org/"&gt;官網&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514643100961836"&gt;HBase&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-NA8UMRxLdFo/Wkelj6ivn5I/AAAAAAAAXZA/uZ_esDB39t0fqEQTXFWRXISGuqnX5SKFQCHMYCw/s1600-h/image%255B13%255D"&gt;&lt;img width="654" height="174" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-7LSW0yKajlQ/WkelkyDbRHI/AAAAAAAAXZE/stEYH3QJLFIM4NsyDNIjHF6EWWV2kGUggCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;HBase logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;聽到Big Data最長聽到的就是No Sql database，也就是不像sql先定義好每個table有什麼欄位的另外一種Database。             &lt;/p&gt;&lt;p&gt;HBase就是一個&lt;em&gt;使用HDFS的No Sql Database&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;HBase還提供吧資料儲存在Memory達到&lt;em&gt;快速讀取&lt;/em&gt;HDFS資料的一個界面，更好的能夠和其他package結合，例如&lt;em&gt;可以用HIVE去撈HBase的資料&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;因為HBase速度的關係，有些會把cold data（封存用的資料少存取）放到&lt;em&gt;HDFS&lt;/em&gt;裡面，而hot data（長存取的資料）放到&lt;em&gt;HBase&lt;/em&gt;裡面。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，HBase可以不架在YARN上面，只需要HDFS即可。             &lt;/div&gt;&lt;p&gt;更多資料請參考：&lt;a href="https://hbase.apache.org/"&gt;HBase&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514643100961587"&gt;Spark&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-gntY9dVsVRk/Wkell4L4KzI/AAAAAAAAXZI/OFQ2u5GRA181CpaLWK1FljrxxYp1-UrGgCHMYCw/s1600-h/image%255B16%255D"&gt;&lt;img width="310" height="176" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-WCXG45Rr8Lo/Wkelmk4vt9I/AAAAAAAAXZM/KAJcIDiZDz8i8B6aZCJSkUDHo8FSRl5MACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;spark logo&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;基本上Spark是整個ecosystem最夯的部分，因為他解決了Hadoop的一個很致命的問題，&lt;em&gt;過慢問題&lt;/em&gt;，官網說在最快的情況可以比Hadoop快&lt;em&gt;100倍&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;Spark的基本概念很簡單，以Hadoop來說，每一個階段的執行，都會把結果&lt;em&gt;儲存在HDFS&lt;/em&gt;，換句話說很多&lt;em&gt;IO操作&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;Spark用了另外一個方式，前面一段output會是後面一段的input - 這個的儲存&lt;em&gt;都是在Memory&lt;/em&gt;，換句話說減少了IO量，提升了速度。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;或許會說，不是都cluster了嗎，怎麼還會慢？這邊的慢指的是相對來說。要記得，這邊處理都是&lt;em&gt;ZB等級&lt;/em&gt;的資料，真的跑下去還是很花時間。             &lt;/div&gt;&lt;p&gt;更多資料請參考：&lt;a href="https://spark.apache.org/"&gt;官網&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;從Ecosystem的圖可以看到其實還有很多重要的package，而看到這個也會發現Hadoop真的變成了一個&lt;em&gt;很底層的核心&lt;/em&gt;。         &lt;/p&gt;&lt;p&gt;看到了這麼多package了之後，有個問題會浮現出來，這麼多不同package要自己安裝不是很麻煩嗎？更別說package之間可能還有相容性問題，難道沒有一個一整包包好的服務嗎？還有cluster management怎麼辦？雖然有package做整件事情，但是怎麼整合呢？         &lt;/p&gt;&lt;p&gt;這也是所謂的&lt;em&gt;Hadoop Distribution&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514643100961168"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇介紹了整個Hadoop的Ecosystem，並且挑出了3個最夯的：Hive、HBase和Spark。                 &lt;/p&gt;&lt;p&gt;本來這篇要把整個總結寫完，但是發現篇幅有點長，因此在下一篇在介紹Hadoop Distribution和相關的工作頭銜，Data Engineer介紹。                 &lt;/p&gt;&lt;/section&gt;  &lt;section&gt;     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:f10ae1af-a21d-42e3-be68-5a462692d1ea" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4576371847519652819/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-11-hadoop-conclustion-ecosystem-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4576371847519652819'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4576371847519652819'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-11-hadoop-conclustion-ecosystem-intro.html' title='[Data Science 到底是什麼從一個完全外行角度來看][11]Hadoop總結(上篇)–Ecosystem介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-c3mOZ-3ScYU/Wkeld0EUWUI/AAAAAAAAXYs/vfffl5JNhuIdl7aDabNXB-shNMzbTbQDwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3227618587688596379</id><published>2017-12-30T13:44:00.000+08:00</published><updated>2018-02-10T22:30:14.065+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='docker'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][10]用.Net Core跑Hadoop MapReduce - Streaming介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RP0Gkq3i-oE/WkcnGQeRhAI/AAAAAAAAXW0/HgFyGTkmNwE97vofL36E-suboOHJluFSQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FXkM_hkx4YI/WkcnHQOktrI/AAAAAAAAXW4/KNNuagCg9Zo9vnDzkM-8mcdYB2z4lf9KQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                 &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-09-hadoop-map-reduce-java-wordcount-example.html"&gt;[09]了解Hadoop裡的MapReduce到底是什麼？&lt;/a&gt;)了解了什麼是MapReduce，並且了解了怎麼用Java寫一個MapReduce的Hello World程式：WordCount。             &lt;/p&gt;&lt;p&gt;馬上會想到的一個問題是，難道只有Java可以寫MapReduce的程式嗎？             &lt;/p&gt;&lt;p&gt;這篇將會介紹Hadoop的Streaming服務，讓任何語言只要透過&lt;em&gt;Standard Input和Standard Output&lt;/em&gt;就可以寫出MapReduce程式。                 將會使用最熟悉的語言，.Net Core來完成這個事情。             &lt;/p&gt;&lt;p&gt;在這篇也會介紹另外一種測試Hadoop的方式，使用Docker來測試。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;這篇的範例程式碼在github：&lt;a href="https://github.com/alantsai/blog-data-science-series/tree/master/src/chapter-10-dotnet-mapreduce"&gt;alantsai/blog-data-science-series 裡面的 src/chapter-10-dotnet-mapreduce&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;                 &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012655599" ;=""&gt;什麼是Hadoop Streaming&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012656732" ;=""&gt;實際操作&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012656715" ;=""&gt;Mapper開發&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012656712" ;=""&gt;Reducer開發&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012656716" ;=""&gt;測試結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514612012656878" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;                  &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514612012655599"&gt;什麼是Hadoop Streaming&lt;/h2&gt;&lt;p&gt;當一個MapReduce的程式被執行的時候，會先被切割成為一個一個的Task，然後由那台的DataNode用Java執行那個Task。             &lt;/p&gt;&lt;p&gt;所以整個執行類似下圖，整個MapReduce都在JVM的環境下：                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-nllf8H6fyGA/WkcnIu6LLaI/AAAAAAAAXW8/TRgczukT6H8k7LcBlUe-vrO6WQrQfs8NACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="369" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bSrPZnnJg_Y/WkcnKMdzj-I/AAAAAAAAXXA/iAQNcgtWyMYsZ6ebR8nWdnyBknkOMKqPACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;JVM的MapReduce&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;不過Hadoop考量到如果外部需要執行MapReduce要怎麼辦，因此建立了一個叫做Streaming的功能。             &lt;/p&gt;&lt;p&gt;基本上，只要那台DataNode可以&lt;em&gt;&lt;strong&gt;Run的起來&lt;/strong&gt;&lt;/em&gt;都可以跑。             &lt;/p&gt;&lt;p&gt;Hadoop Streaming透過&lt;em&gt;&lt;strong&gt;Standard Input/Output/Error 3個管道&lt;/strong&gt;&lt;/em&gt; 來和被Run起來的程式溝通。             &lt;/p&gt;&lt;p&gt;MapReduce的程式只需要從Standard Input讀進來，做處理，然後在寫到Output。如果有錯誤訊息可以記錄在Error裡面。             &lt;/p&gt;&lt;p&gt;整個概念大概是：                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7aZ4PVZ1mEw/WkcwowUSYSI/AAAAAAAAXYQ/jeYjCaZDnqoYTJBUUPwdmFQHHr3Otv0TACHMYCw/s1600-h/image%255B3%255D"&gt;&lt;img width="654" height="482" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Pkp_tC_BoD0/Wkcwp8pw99I/AAAAAAAAXYU/r9lM-U8EsI4HcdtwGtDSXdW_DsCwkVBLACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Hadoop Streaming&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514612012656732"&gt;實際操作&lt;/h2&gt;&lt;p&gt;還記得整個MapReduce基本上就是在每個階段做過處理之後，會產生一個key value pair。Hadoop用&lt;em&gt;&lt;strong&gt;tab&lt;/strong&gt;&lt;/em&gt;來切割Key 和 Value。             &lt;/p&gt;&lt;p&gt;有了這個概念之後來看實際程式，以下使用的是.Net Core的console來開發，分幾個階段：                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Mapper開發&lt;/li&gt;&lt;li&gt;Reducer開發&lt;/li&gt;&lt;li&gt;測試結果&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514612012656715"&gt;Mapper開發&lt;/h3&gt;&lt;p&gt;由於是透過Standard Input/Output，因此console非常適合，所以會建立一個Mapper的.Net Core Console程式。                &lt;/p&gt;&lt;p&gt;在Mapper的階段，內容會是一行一行讀進來，所以把讀進來的內容做文字切割，                     每找到一個word，就寫到output，&lt;em&gt;word是key&lt;/em&gt;，&lt;em&gt;1是value&lt;/em&gt;（代表找到一筆）                     &lt;/p&gt;&lt;p&gt;會一直迴圈的讀，直到沒有任何檔案為止。如果把這個和之前java比照會發現邏輯一樣。                 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;class Program&lt;br /&gt;{&lt;br /&gt;    static void Main(string[] args)&lt;br /&gt;    {&lt;br /&gt;        string line;&lt;br /&gt;&lt;br /&gt;        while ((line = Console.ReadLine()) != null)&lt;br /&gt;        {&lt;br /&gt;            // 用文字切割&lt;br /&gt;            var words = Regex.Matches(line, @"[\w]+");&lt;br /&gt;&lt;br /&gt;            foreach (var word in words)&lt;br /&gt;            {&lt;br /&gt;                // 每一個找到的算1筆 - keyvalue用tab切割&lt;br /&gt;                Console.WriteLine("{0}\t1", word);&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514612012656712"&gt;Reducer開發&lt;/h3&gt;&lt;p&gt;會在建立另外一個專案用來放Reducer的程式。                 &lt;/p&gt;&lt;p&gt;Reducer一樣是讀Input然後寫到output。由於這次讀到的內容&lt;em&gt;&lt;strong&gt;是從Mapper來的&lt;/strong&gt;&lt;/em&gt;，所以會先用tab做切割，key是word，value就是筆數（也都是1）。                 &lt;/p&gt;&lt;p&gt;在這邊，有建立一個words dictionary，這個是因為在Mapper階段其實&lt;em&gt;沒有管&lt;/em&gt;word有沒有重複，反正出現就是+1。                 &lt;/p&gt;&lt;p&gt;不過在Reducer因為要加總，因此用了&lt;code&gt;words&lt;/code&gt; dictionary作為一個暫存的空間。                 &lt;/p&gt;&lt;p&gt;最後把所有結果寫到output - 也是 key value pair，key一樣是word，不過value就是word出現的總數。                 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;static void Main(string[] args)&lt;br /&gt;{&lt;br /&gt;    // 用來儲存已經出現過的字 - java版本會自動處理，不過這個stream需要手動記錄&lt;br /&gt;    Dictionary&amp;lt;string, int&amp;gt; words = new Dictionary&amp;lt;string, int&amp;gt;();&lt;br /&gt;&lt;br /&gt;    string line;&lt;br /&gt;&lt;br /&gt;    while ((line = Console.ReadLine()) != null)&lt;br /&gt;    {&lt;br /&gt;        // 傳過來的key value用tab分割（Mapper也是用tab切割key和value）&lt;br /&gt;        var keyValuePair = line.Split('\t');&lt;br /&gt;&lt;br /&gt;        string word = keyValuePair[0];&lt;br /&gt;&lt;br /&gt;        int count = Convert.ToInt32(keyValuePair[1]);&lt;br /&gt;&lt;br /&gt;        // 如果已經有這個word，和字典的加總，不然就建立新的&lt;br /&gt;        if (words.ContainsKey(word))&lt;br /&gt;        {&lt;br /&gt;            words[word] += count;&lt;br /&gt;        }&lt;br /&gt;        else&lt;br /&gt;        {&lt;br /&gt;            words.Add(word, count);&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    // 把所有結果寫出來&lt;br /&gt;    foreach (var word in words)&lt;br /&gt;    {&lt;br /&gt;        Console.WriteLine("{0}\t{1}", word.Key, word.Value);&lt;br /&gt;}&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;和Java的版本不同，java版本會自動幫忙把key一樣組成一個list比較好操作，但是透過streaming需要自己手動操作。                 &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514612012656716"&gt;測試結果&lt;/h3&gt;&lt;p&gt;當整個程式準備好了之後，接下來就可以對這個程式做測試了。                 &lt;/p&gt;&lt;p&gt;在接下來將會用一個docker版本的hadoop做測試 - 希望透過docker方式也可以了解用docker做測試有多方便。                 &lt;/p&gt;&lt;p&gt;接下來的測試都是在powershell可以直接執行。                 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;如果對docker不熟悉，那麼下面做不了。要跑docker基本上要Windows 10 Professional以上或者linux，並且有裝docker。                     &lt;/p&gt;&lt;p&gt;裡面用到的docker image是一個linux的container。                     &lt;/p&gt;&lt;p&gt;下面也可以直接在之前建立的Ubuntu環境裡面執行，不過需要先：                         &lt;/p&gt;&lt;ul&gt;&lt;li&gt;                             安裝.net core 2.0                             &lt;/li&gt;&lt;li&gt;                                 跳過前面的步奏，知道後面呼叫hadoop Streaming那段即可                             &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;接下來的指令操作都是在從github clone下來的專案裡面&lt;code&gt;src\chapter-10-dotnet-mapreduce&lt;/code&gt;的資料夾下面執行。                     &lt;/p&gt;&lt;p&gt;完整的指令是：                         &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git clone https://github.com/alantsai/blog-data-science-series.git&lt;br /&gt;cd .\blog-data-science-series\src\chapter-10-dotnet-mapreduce&lt;br /&gt;                        &lt;/pre&gt;&lt;/div&gt;&lt;dl&gt;&lt;dt&gt;先把.net core的console 發佈出來&lt;/dt&gt;&lt;dd&gt;                         在powershell執行指令：&lt;code&gt;dotnet publish -o ${pwd}\dotnetmapreduce .\DotNetMapReduceWordCount\DotNetMapReduceWordCount.sln&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7hjaKXRXqo8/WkcnNEXGaXI/AAAAAAAAXXM/hwtIMKEwJJcDVJSmiyr9Ly5lLCjqF0QHACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="171" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-eJsFLS9RF4c/WkcnOBi2BNI/AAAAAAAAXXQ/_MdMKjJy8OMdBtPKdfeoIrestW5zIUELQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;發佈結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;把hadoop用docker compose啟動&lt;/dt&gt;&lt;dd&gt;                         使用指令把hadoop啟動：&lt;code&gt;docker-compose up -d&lt;/code&gt;。                         會看到：                         &lt;ol&gt;&lt;li&gt;執行完有1個master 2個worker啟動&lt;/li&gt;&lt;li&gt;在YARN的web節點看到有兩個Node&lt;/li&gt;&lt;li&gt;在DataNode看到有兩個節點&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-aVz_W4CVO0Q/WkcnPZd6SSI/AAAAAAAAXXU/OHhWZylncDYH90c0VNdssPiBWdaaNatwACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="365" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-gTPb6ZWDZNc/WkcnQsEDhBI/AAAAAAAAXXY/yAyxudmAGbgtDvDGvz2vTUnVtWKTUzNPwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;可以看到啟動成功並且有兩個節點&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;把.Net core程式複製到master的hadoop節點裡面&lt;/dt&gt;&lt;dd&gt;                         把剛剛發佈出來的.Net core程式複製到master裡面，並且進入到master裡面的bash並且可以看到有copy進去的內容                         &lt;pre class="brush: powershell;"&gt;docker cp dotnetmapreduce hadoop-dotnet-master:/dotnetmapreduce&lt;br /&gt;docker exec -it hadoop-dotnet-master bash&lt;br /&gt;ls&lt;br /&gt;ls /dotnetmapreduce&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-15cJ7kHjBNw/WkcnSG-pnjI/AAAAAAAAXXc/BTRexfbAh7clmnNFRYw6NRazwCkhHT60wCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="171" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tAfgPX7R_oI/WkcnTsvzIcI/AAAAAAAAXXg/vNC_FTSSQzYAugqGB31VGN7gaDTv8Xn9wCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;進入到master的bash並且檢查copy是否成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;把要計算的檔案放到hadoop的HDFS&lt;/dt&gt;&lt;dd&gt;                         透過下面指令把檔案放到hadoop的HDFS的input資料夾並且檢查：                         &lt;pre class="brush: powershell;"&gt;hadoop fs -mkdir -p /input&lt;br /&gt;hadoop fs -copyFromLocal /dotnetmapreduce/jane_austen.txt /input&lt;br /&gt;hadoop fs -ls /input&lt;br /&gt;                        &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-23RRtJuVDCQ/WkcnUwQkH3I/AAAAAAAAXXk/OW3hTR1s_YwGvMIH3xnlNQJBc3FU8Y48ACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="120" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OYuzw_kfiFY/WkcnWLah5tI/AAAAAAAAXXo/kSiOu95arVs38LpAEZ_nMV8GLtZ6X1m1gCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;複製檔案到HDFS&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;用hadoop Streaming執行net core mapreduce&lt;/dt&gt;&lt;dd&gt;                         用hadoop的streaming執行：                         &lt;pre class="brush: powershell;"&gt;hadoop jar $HADOOP_HOME/share/hadoop/tools/lib/hadoop-streaming-2.7.2.jar \&lt;br /&gt;    -files "/dotnetmapreduce" \&lt;br /&gt;    -mapper "dotnet dotnetmapreduce/DotNetMapReduceWordCount.Mapper.dll" \&lt;br /&gt;    -reducer  "dotnet dotnetmapreduce/DotNetMapReduceWordCount.Reducer.dll" \&lt;br /&gt;    -input /input/* -output /output&lt;br /&gt;                        &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RYjrgOTeGK0/WkcnYo6-N8I/AAAAAAAAXXs/0bZQKz6SVPgPCmZIi2_FRfb1_o39HwcAQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="223" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Vimliibb7z8/WkcnZn-O8pI/AAAAAAAAXXw/lC7jAU3PSOMkq4pxY5dnUF8-LX9vl8OcwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;和之前執行map reduce的log一樣&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;檢查結果&lt;/dt&gt;&lt;dd&gt;                         執行完了之後，可以看到計算的每個字出現次數 &lt;pre class="brush: powershell;"&gt;hadoop fs -ls /output&lt;br /&gt;hadoop fs -cat /output/part-00000&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RhzE6QlyhKw/Wkcna6qZwKI/AAAAAAAAXX0/QFpyLLHbJcMedKAEtOkyf9EHowi4mplpQCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="413" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Tj_p8JxkloA/WkcncG_2yVI/AAAAAAAAXX4/VLXz1UsvW-Itd8e0q98ZYKhAM78nIMPsgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;執行結果&lt;/figcaption&gt; &lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;會注意到這邊的結果和java版本有點不同，因為判斷字的邏輯不同導致。                         &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果docker不需要了，可以用&lt;code&gt;docker-compose down&lt;/code&gt;把整個hadoop關掉。                         &lt;/div&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514612012656878"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇介紹了透過Hadoop Streaming達到在hadoop用.Net core 2.0的console程式做MapReduce如何。             &lt;/p&gt;&lt;p&gt;這篇也改成使用docker來做hadoop測試而不是用一直以來建立的VM。用docker和VM比較會發現到docker其實做這種事情非常方便，如果對docker不熟悉，可以考慮花點時間做些學習（之後我的部落格也會有個系列介紹docker使用，有興趣的話請持續關注）。             &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;在這個系列的後面，之前建立的VM還會用到 - 用來和R做結合。所以如果對後面操作有興趣，VM還是先保留。             &lt;/div&gt;&lt;p&gt;在這個系列的Hadoop介紹也到了一個尾聲，在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-11-hadoop-conclustion-ecosystem-intro.html"&gt;[11]Hadoop總結(上篇)–Ecosystem介紹&lt;/a&gt;)將會對目前hadoop有介紹的部分做一個總結，介紹hadoop的ecosystem，和還有什麼部分是應該繼續關注下去。             &lt;/p&gt;&lt;/section&gt;             &lt;section&gt;                 &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:85f26ad6-2c99-4be6-9f2d-59dc57c01179" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/docker" rel="tag"&gt;docker&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3227618587688596379/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-10-hadoop-streaming-intro-use-net-core-for-MapReduce.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3227618587688596379'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3227618587688596379'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-10-hadoop-streaming-intro-use-net-core-for-MapReduce.html' title='[Data Science 到底是什麼從一個完全外行角度來看][10]用.Net Core跑Hadoop MapReduce - Streaming介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-FXkM_hkx4YI/WkcnHQOktrI/AAAAAAAAXW4/KNNuagCg9Zo9vnDzkM-8mcdYB2z4lf9KQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4188806491239961295</id><published>2017-12-27T21:37:00.000+08:00</published><updated>2017-12-30T13:46:20.312+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][09]了解Hadoop裡的MapReduce到底是什麼？</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-601ygquvgt4/WkOfA6dx4eI/AAAAAAAAXV4/7HkHdeOQ9gE4Uxlbhff1CdcytjWX0QbVgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qDgM7uC_aEo/WkOfCkb2m2I/AAAAAAAAXV8/_7Q2L8IZeOkWuRSU_C8-ltYTFFzgM2PnACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：         &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和         &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-08-hadoop-fully-distributed-mode-tutorial.html"&gt;[08]Hadoop 改成完全分散模式&lt;/a&gt;)透過複製VM的方式建立出了fully-distributed mode，基本上在這個系列裡面對於Hadoop的介紹也快到了一個尾聲。&lt;/p&gt;&lt;p&gt;不過，還有一個部分被忽略了，也就是實際在Hadoop做運算的程式，也是WordCount的實際運算邏輯。&lt;/p&gt;&lt;p&gt;這篇會介紹MapReduce的概念，並且看一下WordCount的java程式是如何撰寫。&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989241590" ;=""&gt;什麼是MapReduce&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989248293" ;=""&gt;換個方式理解 - 用選舉為例&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989248724" ;=""&gt;怎麼在Hadoop寫MapReduce&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989248854" ;=""&gt;Map&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989248767" ;=""&gt;Reduce&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989248883" ;=""&gt;設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514216989249921" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514216989241590"&gt;什麼是MapReduce&lt;/h2&gt;&lt;p&gt;MapReduce其實是一種開發模式（Program Model），基本上可以把整個邏輯分成為Map階段和Reduce階段。             &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Map階段基本上會做filtering和sorting並且傳出一個key value pair做結果（以wordcount為例，每一個字會作為最後的key，而value則是1代表有一筆）&lt;/li&gt;&lt;li&gt;Reduce階段基本上會做整合（以wordcount為例，從Map傳過來的key如果一樣，表示同一個字，因此把一樣的key做加總最後的出總筆數）&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;從下圖可以看到整個的流程：                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-z9zzTpLkQV4/WkOfEqkJFJI/AAAAAAAAXWA/VhznYv1guu8MyYFTig8MiKtPjK36Sg3fgCHMYCw/s1600-h/image%255B7%255D"&gt;&lt;img width="654" height="478" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-o3uPPa-n1Ng/WkOfGQCPFBI/AAAAAAAAXWE/X1NVw_EHUTgTwvCB5Y-JSi-dAUppLYAXwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;整個WordCount的MapReduce流程。來源：https://www.mssqltips.com/sqlservertip/3222/big-data-basics--part-5--introduction-to-mapreduce/&lt;/figcaption&gt;&lt;/figure&gt;&lt;br /&gt;&lt;dl&gt;&lt;dt&gt;input&lt;/dt&gt;&lt;dd&gt;這個是要做計算的原始資料，以上圖為例其實就是一堆文字清單&lt;/dd&gt;&lt;dt&gt;split&lt;/dt&gt;&lt;dd&gt;把input資料做分散處理 - 以hadoop來說，當MapReduce工作被輸入的時候，會被切割到各個cluster裡面等待做處理&lt;/dd&gt;&lt;dt&gt;map&lt;/dt&gt;&lt;dd&gt;這個就是MapReduce裡面的Map階段 - 每一個節點會把對應切割出來的資料建立key value結果 - key是字本身，然後value是1代表找到一筆&lt;/dd&gt;&lt;dt&gt;combine&lt;/dt&gt;&lt;dd&gt;這個其實也是在map的機器裡面做 - 把每一個key一樣的先做一次加總，避免傳送多次出去&lt;/dd&gt;&lt;dt&gt;shuffle &amp;amp; sort&lt;/dt&gt;&lt;dd&gt;在進入reduce階段之前，會先被做一個排序，因此相關的key值會放在一起&lt;/dd&gt;&lt;dt&gt;reduce&lt;/dt&gt;&lt;dd&gt;這個階段會做實際的加總，因此每一個key以的的value會被加總&lt;/dd&gt;&lt;dt&gt;outpu&lt;/dt&gt;&lt;dd&gt;這個是最後得到的結果&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;這邊需要注意一下，當提到map和reduce是小寫的時候，指的會是functional programing提供的方法。MapReduce則是開發模式。                 &lt;/p&gt;&lt;p&gt;上圖雖然用了小寫，不過這邊指的還是hadoop裡面的MapReduce。                 &lt;/p&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;Map和Reduce階段回傳的結果都是一個key value pair。             &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514216989248293"&gt;換個方式理解 - 用選舉為例&lt;/h2&gt;&lt;p&gt;如果上面那個例子看了還是有點模糊，換個生活遇到的例子作說明&lt;/p&gt;&lt;p&gt;當台灣遇到選舉的時候，一般來說有選舉權的民眾會去戶籍地去做投票 - 投票完有沒有看當天新聞了解這些投票是怎麼計算的嗎？             &lt;/p&gt;&lt;p&gt;如果那個時候看新聞，會注意到，會有跑馬燈一直跑說，某某縣市目前xxx有幾票 - 這個票數是及時在變動：                 &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-OCP9dJYFTUo/WkOfKqKHqQI/AAAAAAAAXWI/gwdpJMDUoFwYmDY5XWb5PdR8Q1GGSW9rACHMYCw/s1600-h/image%255B12%255D"&gt;&lt;img width="654" height="369" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-LTYHcGMh2rw/WkOfOIt_5JI/AAAAAAAAXWQ/qfLbkt0Oy5wCo9mqYFTc_gfnJmQ6ZQtAQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figcaption&gt;&lt;figcaption&gt;選舉的時候新聞及時播放票數。來源：http://my-own-post.com/new20150116/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;整個數票的動作其實就是MapReduce。             &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;input&lt;/dt&gt;&lt;dd&gt;所有有投票的票數就是整個input&lt;/dd&gt;&lt;dt&gt;split&lt;/dt&gt;&lt;dd&gt;每個可以投票的民眾去戶籍地投票，同等於把這個input split到不同的區域&lt;/dd&gt;&lt;dt&gt;map&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;投票時間截止了之後，每一個投票站會開始從箱子取出來，然後唱名這張票屬於哪個候選人。                     &lt;/p&gt;&lt;p&gt;每一張票的候選人就是key，然後唱名1票就是value                     &lt;/p&gt;&lt;/dd&gt;&lt;dt&gt;combine&lt;/dt&gt;&lt;dd&gt;                     當每一個投票站都分好了之後，會先做一個初步的加總，得到的每個站的總票數。                 &lt;/dd&gt;&lt;dt&gt;shuffle &amp;amp; sort&lt;/dt&gt;&lt;dd&gt;在這個階段，會把每個投票站同一個候選人(key)的放在一起&lt;/dd&gt;&lt;dt&gt;reduce&lt;/dt&gt;&lt;dd&gt;做最後加總 - 把所有一樣key的值加在一起&lt;/dd&gt;&lt;dt&gt;output&lt;/dt&gt;&lt;dd&gt;最後結果就是誰當選了&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;首先，每個可以投票的會去戶籍地做投票的動作，這個其實同等於             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514216989248724"&gt;怎麼在Hadoop寫MapReduce&lt;/h2&gt;&lt;p&gt;希望透過上面的比喻方式，對於整個MapReduce有個更清楚的了解，那在Hadoop裡面怎麼寫MapReduce呢？&lt;/p&gt;&lt;p&gt;Hadoop是java的程式，因此用java寫一定是最容易，下面快速介紹一下如何用java寫MapReduce，大概會分幾個部分：                 &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Map&lt;/li&gt;&lt;li&gt;Reduce&lt;/li&gt;&lt;li&gt;設定&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514216989248854"&gt;Map&lt;/h3&gt;&lt;pre class="brush: csharp;"&gt;public static class Map extends Mapper&amp;lt;LongWritable, Text, Text, IntWritable&amp;gt; {&lt;br /&gt;    private final static IntWritable one = new IntWritable(1);&lt;br /&gt;    private Text word = new Text();&lt;br /&gt;&lt;br /&gt;    public void map(LongWritable key, Text value, Context context) throws IOException,&lt;br /&gt;        InterruptedException {&lt;br /&gt;&lt;br /&gt;            String line = value.toString();&lt;br /&gt;&lt;br /&gt;            StringTokenizer tokenizer = new StringTokenizer(line);&lt;br /&gt;&lt;br /&gt;            while (tokenizer.hasMoreTokens()) {&lt;br /&gt;                word.set(tokenizer.nextToken());&lt;br /&gt;                context.write(word, one);&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;}&lt;/pre&gt;&lt;p&gt;基本上，上面建立了一個&lt;code&gt;Map&lt;/code&gt;class繼承&lt;code&gt;Mapper&lt;/code&gt;並且定義了一個方法叫做&lt;code&gt;map&lt;/code&gt;。             &lt;/p&gt;&lt;p&gt;Hadoop會把每一段文字個用&lt;code&gt;value&lt;/code&gt;傳過來，因此用了tokenizer把裡面的word取出來。             &lt;/p&gt;&lt;p&gt;每一個取出來的word，會被寫成一組key value pair(&lt;code&gt;context.write(word,one)&lt;/code&gt;)，word是key，value是&lt;code&gt;數值1&lt;/code&gt;。             &lt;/p&gt;&lt;p&gt;會一直做，直到整個word都處理完。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514216989248767"&gt;Reduce&lt;/h3&gt;&lt;pre class="brush: csharp;"&gt;public static class Reduce extends Reducer&amp;lt;Text, IntWritable, Text, IntWritable&amp;gt; {&lt;br /&gt; public void reduce(Text key, Iterable&amp;lt;IntWritable&amp;gt; values, Context context) throws&lt;br /&gt;  IOException, InterruptedException {&lt;br /&gt;   int sum = 0;&lt;br /&gt;&lt;br /&gt;   for (IntWritable val : values) {&lt;br /&gt;    sum += val.get();&lt;br /&gt;   }&lt;br /&gt;&lt;br /&gt;   context.write(key, new IntWritable(sum));&lt;br /&gt; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Reducer和mapper類似，先定義一個class叫做&lt;code&gt;Reduce&lt;/code&gt;繼承&lt;code&gt;Reducer&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;裡面有一個&lt;code&gt;reduce&lt;/code&gt;的程式定義reduce階段要做什麼&lt;/p&gt;&lt;p&gt;在這邊，java已經有處理好把一樣的key放成一組，因此可以透過迴圈的方式把所有值加總。                     &lt;/p&gt;&lt;p&gt;最後把整個結果寫出去，一樣是key value pair，key還是原來的key，不過value是所有的加總。&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514216989248883"&gt;設定&lt;/h3&gt;&lt;p&gt;Map階段和Reduce階段的功能都定義好了之後，接下來需要做的是告訴程式執行的時候那個是Map和那個是Reduce。                     &lt;/p&gt;&lt;pre class="brush: csharp;highlight:[28]"&gt;package org.myorg;&lt;br /&gt;&lt;br /&gt;import java.io.IOException;&lt;br /&gt;import java.util.*;&lt;br /&gt;&lt;br /&gt;import org.apache.hadoop.fs.Path;&lt;br /&gt;import org.apache.hadoop.conf.*;&lt;br /&gt;import org.apache.hadoop.io.*;&lt;br /&gt;import org.apache.hadoop.mapred.*;&lt;br /&gt;import org.apache.hadoop.util.*;&lt;br /&gt;&lt;br /&gt;public class WordCount {&lt;br /&gt;&lt;br /&gt; // 剛剛定義的 Map&lt;br /&gt; ....&lt;br /&gt;&lt;br /&gt; // 剛剛定義的 Reduce&lt;br /&gt; ....&lt;br /&gt;&lt;br /&gt; public static void main(String[] args) throws Exception {&lt;br /&gt;  JobConf conf = new JobConf(WordCount.class);&lt;br /&gt;  conf.setJobName("wordcount");&lt;br /&gt;&lt;br /&gt;  conf.setOutputKeyClass(Text.class);&lt;br /&gt;  conf.setOutputValueClass(IntWritable.class);&lt;br /&gt;&lt;br /&gt;  conf.setMapperClass(Map.class);&lt;br /&gt;  conf.setCombinerClass(Reduce.class);&lt;br /&gt;  conf.setReducerClass(Reduce.class);&lt;br /&gt;&lt;br /&gt;  conf.setInputFormat(TextInputFormat.class);&lt;br /&gt;  conf.setOutputFormat(TextOutputFormat.class);&lt;br /&gt;&lt;br /&gt;  FileInputFormat.setInputPaths(conf, new Path(args[0]));&lt;br /&gt;  FileOutputFormat.setOutputPath(conf, new Path(args[1]));&lt;br /&gt;&lt;br /&gt;  JobClient.runJob(conf);&lt;br /&gt; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;這個程式應該蠻好理解，基本上就是把剛剛定義好的Map和Reduce做設定。&lt;/p&gt;&lt;p&gt;這邊比較特別是&lt;code&gt;Combiner&lt;/code&gt;的部分，因為也是加總所以和reduce是一樣的概念。&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514216989249921"&gt;結語&lt;/h2&gt;&lt;p&gt;透過這篇了解了整個MapReduce的運作機制，並且看了如何用Java寫過一個WordCount的MapReduce程式。&lt;/p&gt;&lt;p&gt;這邊會發現到，程式裡面完全沒有任何分散式處理的概念，但是Hadoop會&lt;em&gt;&lt;strong&gt;自動&lt;/strong&gt;&lt;/em&gt;以分散式的模式執行。這個讓撰寫變得非常簡單。&lt;/p&gt;&lt;p&gt;可是另外一個問題會浮現出來，難道只有Java可以寫MapReduce嗎？             &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-10-hadoop-streaming-intro-use-net-core-for-MapReduce.html"&gt;[10]用.Net Core跑Hadoop MapReduce - Streaming介紹&lt;/a&gt;)將會介紹如何用.net core寫出可以再Hadoop透過stream的方式執行的MapReduce，並且這次會改成用docker的方式來執行，提供另外一種更快速和容易測試Hadoop的方式。             &lt;/p&gt;&lt;/section&gt;&lt;section&gt;                 &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:e89abc48-c72f-427c-b156-b85bdea3eb50" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4188806491239961295/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-09-hadoop-map-reduce-java-wordcount-example.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4188806491239961295'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4188806491239961295'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-09-hadoop-map-reduce-java-wordcount-example.html' title='[Data Science 到底是什麼從一個完全外行角度來看][09]了解Hadoop裡的MapReduce到底是什麼？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-qDgM7uC_aEo/WkOfCkb2m2I/AAAAAAAAXV8/_7Q2L8IZeOkWuRSU_C8-ltYTFFzgM2PnACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-294572318723668954</id><published>2017-12-26T21:55:00.000+08:00</published><updated>2017-12-26T22:14:45.288+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][08]Hadoop 改成完全分散模式</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5ZIPrzPqaWQ/WkJSwcrrgqI/AAAAAAAAXSg/cz-miyNn8kEazSI1pROY-wI7jE8njVkbQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-iqTlX5Iecb8/WkJSyLYxqzI/AAAAAAAAXSk/xYI1E0v9zWU9IYyPK37UKa5ojxnuoPDdACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                     &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                     &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-07-deeper-look-at-yarn-and-hdfs-in-hadoop.html"&gt;[07]更深入看看Hadoop裡面的YARN和HDFS&lt;/a&gt;)了解了整個jps的process代表的意思之後，在這篇將會延續之前(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html"&gt;[05]建立Hadoop環境 -上篇&lt;/a&gt;、&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html"&gt;[06]建立Hadoop環境 -下篇&lt;/a&gt;)建立出來&lt;em style="line-height: 1.6; font-size: 15px;"&gt;pseudo-distributed mode&lt;/em&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;的hadoop改成             &lt;/span&gt;&lt;em style="line-height: 1.6; font-size: 15px;"&gt;fully-distributed mode&lt;/em&gt;&lt;/p&gt;&lt;p&gt;這篇結束之後，除了Master，會建立出一台slave。由於Master裡面也有DataNode和NodeManager，所以總共會有&lt;em&gt;2個&lt;/em&gt;DataNode。         &lt;/p&gt;&lt;/section&gt;         &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092827" ;=""&gt;建立步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092272" ;=""&gt;修改原本的VM變成Master機器&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092622" ;=""&gt;從Master建立Slave&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092931" ;=""&gt;最後設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092732" ;=""&gt;重新Format指令&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092906" ;=""&gt;啟動和驗證&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092308" ;=""&gt;執行WordCount&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514114580092413" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;          &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092827"&gt;建立步奏&lt;/h2&gt;&lt;p&gt;基本上整個的建立步奏可以分為6個部分：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;修改原本的VM變成Master機器&lt;/li&gt;&lt;li&gt;從Master建立Slave&lt;/li&gt;&lt;li&gt;最後設定&lt;/li&gt;&lt;li&gt;重新Format指令&lt;/li&gt;&lt;li&gt;啟動和驗證&lt;/li&gt;&lt;li&gt;執行WordCount&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092272"&gt;修改原本的VM變成Master機器&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;修改Hostname改成master&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;開啟Terminal（快速鍵&lt;code&gt;Ctrl+Alt+ t&lt;/code&gt;）然後輸入：&lt;code&gt;sudo gedit /etc/hosts&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在裡面的檔案把&lt;code&gt;ubuntu&lt;/code&gt;改成&lt;code&gt;master&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dtmJ5QWVKB0/WkJSz9ZbWkI/AAAAAAAAXSo/N94Z4mu9jwYREHcWIoqbqL_XA6StHFjEQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="271" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9ckWMhgI_Mo/WkJS1LeOmeI/AAAAAAAAXSs/j7_BNBUNR38iBvir0Pkd1KcO6CuXm_F5wCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;調整host&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;記得透過右上角把整個機器重啟，然後開termianl會發現@後面是&lt;em&gt;&lt;strong&gt;master&lt;/strong&gt;&lt;/em&gt; &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-xaSvW-NDM5I/WkJS1wOQvCI/AAAAAAAAXSw/QfjC08fh0JYvp2itK0o0tP7I4n6ZmW4DACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="275" height="324" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IA0PBs7umY0/WkJS4yLJ_aI/AAAAAAAAXS0/jZaEvN9vIR0m_0qVCKpUrCnqy1IwtrtJQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;a href="https://lh3.googleusercontent.com/-Mx0mSLhJn0k/WkJS7CUlbMI/AAAAAAAAXS4/jVxj6JTvExcDDHiR6WVf0ZmRK486cjORQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="234" height="102" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9bPTYx_InuE/WkJS9Npb-OI/AAAAAAAAXS8/kUEb5LfDAjsi3hMmVJGz953Iwe0sd07jwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;重啟機器和檢查terminal是不是變成master&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;重啟了之後，當輸入指令會需要&lt;em&gt;等一下&lt;/em&gt;，因為他會嘗試和master溝通 - master不存在所以要等一下他timeout才會出現                 &lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;設定host的ip&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;透過右上角的network資訊找到目前機器的ip，並且用terminal執行：&lt;code&gt;sudo gedit /etc/hosts&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在裡面加入：&lt;code&gt;{ip} master&lt;/code&gt; - ip是上面找到的ip                 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5BVOL5Sl8bM/WkJS_xeBJyI/AAAAAAAAXTA/kc-qoV8hAFckyIpYt95Yj-qTpba9IRdUACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="494" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rCsKpEO9428/WkJTCFK8mmI/AAAAAAAAXTE/FxYVIW-AZWEnbXC4xJUH_RNLxPwIUz0oQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;找到ip&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-c_kww-2gkWs/WkJTEDFgmvI/AAAAAAAAXTI/JNT0Zw3asCsVoBb8zyrLMwU4lz-Ngw3lgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="249" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-etTZsQoGYUE/WkJTGpnSRGI/AAAAAAAAXTM/SSBKWQViHGcyP6_jTruOezRERsxJY39KQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;設定master的host ip&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;修改NameNode&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在terminal執行：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/master&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在開的檔案，把裡面內容改成&lt;code&gt;master&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-IpWjf-Y2al0/WkJTINw5RLI/AAAAAAAAXTQ/XRRoPfyOu1MfOY8g9U77AMhyYCihOCNWgCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="603" height="179" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OLw2N0t1vsc/WkJTJ1kQ8II/AAAAAAAAXTU/f8EvRgvffB4WWuWnOlaWDIuIvk6SR_MqQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;改成master&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;修改cor-site.xml&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在terminal輸入：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/core-site.xml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;把&lt;em&gt;&lt;strong&gt;整個&lt;/strong&gt;&lt;/em&gt;&lt;code&gt;configuration&lt;/code&gt;內容改成：&lt;/p&gt;&lt;pre class="brush: xml;"&gt;    &amp;lt;property&amp;gt;&lt;br /&gt;     &amp;lt;name&amp;gt;fs.default.name&amp;lt;/name&amp;gt;&lt;br /&gt;     &amp;lt;value&amp;gt;hdfs://master:9000&amp;lt;/value&amp;gt;&lt;br /&gt;    &amp;lt;/property&amp;gt;&lt;/pre&gt;&lt;p&gt;這邊把localhost改成了master&lt;/p&gt;&lt;/dd&gt;&lt;dt&gt;修改hdfs-site.xml&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;用terminal開啟：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/hdfs-site.xml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在&lt;code&gt;Configuration&lt;/code&gt;最後一筆的&lt;em&gt;&lt;strong&gt;前面加上&lt;/strong&gt;&lt;/em&gt;：                     &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt;    &amp;lt;name&amp;gt;dfs.permissions&amp;lt;/name&amp;gt;&lt;br /&gt;    &amp;lt;value&amp;gt;false&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-kfUp-LTg3GY/WkJTLeL_6-I/AAAAAAAAXTY/qO7ysOHLOgUkjOxN_I95mn9im8tqzNtFwCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="534" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-A2txyXz515E/WkJTM4EcNBI/AAAAAAAAXTc/9le4-Is7MtQ4OdVRNW0SOjhZQezMqL2EwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;修改畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;修改 mapred-site.xml&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在terminal輸入：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/mapred-site.xml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;增加&lt;/em&gt;以下設定Configuration：&lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt;        &amp;lt;name&amp;gt;mapred.job.tracker&amp;lt;/name&amp;gt;&lt;br /&gt;        &amp;lt;value&amp;gt;master:54311&amp;lt;/value&amp;gt;&lt;br /&gt;    &amp;lt;/property&amp;gt;&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Eg85ZBeCxA4/WkJTPXUhZxI/AAAAAAAAXTg/v4DSStu4rL4t04ghKKl_c1lv2lLKnBczACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="579" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-5gtTYVqeeGQ/WkJTSyppA_I/AAAAAAAAXTk/zi2bXkXFMDAkcoFQuktBRCjlKF_9OzzZgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;修改yarn-site.xml&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在terminal輸入：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/yarn-site.xml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;增加&lt;/em&gt;以下設定到Configuration:&lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt;        &amp;lt;name&amp;gt;yarn.resourcemanager.resource-tracker.address&amp;lt;/name&amp;gt;&lt;br /&gt;        &amp;lt;value&amp;gt;master:8025&amp;lt;/value&amp;gt;&lt;br /&gt;        &amp;lt;/property&amp;gt;&lt;br /&gt;        &amp;lt;property&amp;gt;&lt;br /&gt;        &amp;lt;name&amp;gt;yarn.resourcemanager.scheduler.address&amp;lt;/name&amp;gt;&lt;br /&gt;        &amp;lt;value&amp;gt;master:8030&amp;lt;/value&amp;gt;&lt;br /&gt;        &amp;lt;/property&amp;gt;&lt;br /&gt;        &amp;lt;property&amp;gt;&lt;br /&gt;        &amp;lt;name&amp;gt;yarn.resourcemanager.address&amp;lt;/name&amp;gt;&lt;br /&gt;        &amp;lt;value&amp;gt;master:8050&amp;lt;/value&amp;gt;&lt;br /&gt;    &amp;lt;/property&amp;gt;&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XBbuE0gU2GA/WkJTU5JUAVI/AAAAAAAAXTo/g_4CcZOfJzApjFt6WmV3sa8WHu0mIOFmgCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="650" height="594" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-fvgGvEE6eQI/WkJTY9qafkI/AAAAAAAAXTs/Y8pmFuHOxu8eikDGrZM0la-9sVyOui7VQCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;增加yarn site設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;slaves檔案設定&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;用terminal輸入：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/slaves&lt;/code&gt;&lt;/p&gt;&lt;p&gt;改成以下設定：                 &lt;/p&gt;&lt;pre class="brush: plain;"&gt;    master&lt;br /&gt;    slave1&lt;br /&gt;&lt;/pre&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092622"&gt;從Master建立Slave&lt;/h2&gt;&lt;p&gt;先從設定找到Master VM的設定位置，並且複製一份出來         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-EtKL6jS8VAg/WkJTa4aMEGI/AAAAAAAAXTw/2OGqSoO4liQsT6RNpI-ll3zzfNoVCNsMACHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="307" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-owDYa5UxcCU/WkJTfRQ1v1I/AAAAAAAAXT0/mAmsJuSCqbcwK7ZV3889MPOG0xJTxtJPQCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href="https://lh3.googleusercontent.com/-clvz72QaEFs/WkJTjuuml3I/AAAAAAAAXT4/vyuRU8Pi9h4_XRWKTHLqpc1APUVCdyYJgCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="439" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-JJOuzP6q01c/WkJTsbyakyI/AAAAAAAAXT8/FrrO8nOhqSoEA8IYYKHYi1xVQhW1En2EwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;透過設定找到VM檔案位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;用開啟VM的方式打開&lt;em&gt;&lt;strong&gt;複製&lt;/strong&gt;&lt;/em&gt;出來的VM             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HVcCZvvJdgw/WkJTuG0hJ7I/AAAAAAAAXUA/xBaYQbHOXeQA1d8TX3oWmzUMns-ZaX0KgCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="370" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-_Zivd8Rekd0/WkJTv9EH4nI/AAAAAAAAXUE/PmZN9-ac6foQEoN0Nmp49ZznS7UgDUhmQCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;開啟VM並且改成hadoop-slave&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;對開啟的VM做出：             &lt;/p&gt;&lt;ol&gt;&lt;li&gt;選擇剛剛開啟的VM&lt;/li&gt;&lt;li&gt;選擇設定&lt;/li&gt;&lt;li&gt;切換&lt;code&gt;Options&lt;/code&gt;的頁簽&lt;/li&gt;&lt;li&gt;修改VM名稱為hadoop-slave&lt;/li&gt;&lt;li&gt;按下 &lt;code&gt;ok&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-h4NtixYgLbM/WkJTxlGstLI/AAAAAAAAXUI/Wurdb6sq58cahypxijuDmRjqXinqr3_TACHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="357" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-d8UqyGBt16g/WkJTy5J2MCI/AAAAAAAAXUM/_rH0LNG1e6cLr9GxTjsh-1U-Vr87kvgNACHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定VM名稱&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;把slave那台啟動起來，當出現選擇的時候，記得選擇&lt;em&gt;&lt;strong&gt;I Copied It&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9UspAMrBGSM/WkJTztn5BwI/AAAAAAAAXUQ/xm4-eUK_A6MRVdK0_KEMhVTf4FX4qDohQCHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="475" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FyE8Fg6j4c4/WkJT1neSuYI/AAAAAAAAXUU/I10kRNhD_T44OiwB79vpx0fyCj1elpnMQCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇I Copied It&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;最後把兩個VM都啟動起來，可以再上面的title看到那一台是master和那台是slave             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jbzVY5PTph8/WkJT28qJC3I/AAAAAAAAXUY/89SnoWPofR8D5-iJ3tJlK0fmAkxR492CwCHMYCw/s1600-h/image%255B47%255D"&gt;&lt;img width="654" height="336" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-TU_C2WDueNQ/WkJT47x7cpI/AAAAAAAAXUc/R7LL6TUrNOUkd1PaM4T1cvt6MGZ97NWmgCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;兩台機器啟動起來&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092931"&gt;最後設定&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;修改slave那台的hostname改成slave1&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;開啟Terminal（快速鍵                 &lt;code&gt;Ctrl+Alt+ t&lt;/code&gt;）然後輸入：                 &lt;code&gt;sudo gedit /etc/hosts&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在裡面的檔案把                 &lt;code&gt;master&lt;/code&gt;改成                 &lt;code&gt;slave1&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-KBOKFk4LxhE/WkJT62jXFnI/AAAAAAAAXUg/B3CFpgJ9s9QipRsiQ-oJjQ9qHGKW4QBfgCHMYCw/s1600-h/image%255B50%255D"&gt;&lt;img width="413" height="174" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sD5BIlE-zuM/WkJT-xjJEdI/AAAAAAAAXUk/vIHx9U1MI20keyBcaQ3SW6vZyCS0syFkwCHMYCw/image_thumb%255B16%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;調整host&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;記得一樣要重啟機器才會有作用             &lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;設定slave的ip&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;透過右上角的network資訊找到&lt;em&gt;slave&lt;/em&gt;機器的ip，並且在&lt;em&gt;&lt;strong&gt;master和slave&lt;/strong&gt;&lt;/em&gt;的機器terminal執行：&lt;code&gt;sudo gedit /etc/hosts&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在裡面加入：&lt;code&gt;{ip} slave1&lt;/code&gt; - ip是上面找到的ip                         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Jm3sT99wDMc/WkJUAGq0W-I/AAAAAAAAXUo/_XEQrJVQJ6we1glsPedR4wa3qkueBX_mgCHMYCw/s1600-h/image%255B53%255D"&gt;&lt;img width="654" height="300" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-5rIeJNfmui4/WkJUCt9I87I/AAAAAAAAXUs/Brx9piJULjsiVWiOkLgR_G_cuY1z3TFfQCHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;兩台都要修改&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;確認master和slave 1可以互動&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;分別從&lt;em&gt;master&lt;/em&gt;那台的terminal呼叫：&lt;code&gt;ping slave1&lt;/code&gt;和&lt;em&gt;slave&lt;/em&gt;那台機器的terminal呼叫：&lt;code&gt;ping master&lt;/code&gt;&lt;/p&gt;&lt;p&gt;確保兩台之間溝通沒有問題&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0BiBsQkQULQ/WkJUEVZFhTI/AAAAAAAAXUw/qrBjaTL--zgV2ZuHx0I6bNE2efDXNBZuQCHMYCw/s1600-h/image%255B56%255D"&gt;&lt;img width="654" height="172" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bKDTdPyreB8/WkJUFVsK51I/AAAAAAAAXU0/uPqw4VVvea0bJpmoBiXgWLJnU4yYi10VACHMYCw/image_thumb%255B18%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;兩台互相ping&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;在master那台設定slave的sh key&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在master的機器把slave ssh key建立出來然後做出測試，在terminal執行：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;cat ~/.ssh/id_rsa.pub &amp;gt;&amp;gt; ~/.ssh/authorized_keys&lt;br /&gt;    scp -r ~/.ssh slave1:~/&lt;br /&gt;    ssh slave1&lt;br /&gt;    exit&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-i5VZDexm6R0/WkJUGH-LZTI/AAAAAAAAXU4/ofGAef-y3Z0rbv25CJtv7pd_SoJqU3NOACHMYCw/s1600-h/image%255B59%255D"&gt;&lt;img width="654" height="403" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1_Gb4z9nc38/WkJUIKWW9xI/AAAAAAAAXU8/2ciP40Ke2wYu3YASHlzNW3TQPzxcGQwKQCHMYCw/image_thumb%255B19%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;測試ssh畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092732"&gt;重新Format指令&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;建立DataNode和NameNode資料夾&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在&lt;em&gt;master&lt;/em&gt;輸入以下來重建資料夾：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;sudo rm -rf /usr/local/hadoop/hadoop_data/hdfs&lt;br /&gt;mkdir -p /usr/local/hadoop/hadoop_data/hdfs/namenode&lt;br /&gt;mkdir -p /usr/local/hadoop/hadoop_data/hdfs/datanode&lt;br /&gt;sudo chown -R hduser:hduser /usr/local/hadoop&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;在&lt;em&gt;slave&lt;/em&gt;輸入以下來重建對應資料夾：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;sudo rm -rf /usr/local/hadoop/hadoop_data/hdfs&lt;br /&gt;mkdir -p /usr/local/hadoop/hadoop_data/hdfs/datanode&lt;br /&gt;sudo chown -R hduser:hduser /usr/local/hadoop&lt;br /&gt;&lt;/pre&gt;&lt;/dd&gt;&lt;dt&gt;格式化hdfs&lt;/dt&gt;&lt;p&gt;在&lt;em&gt;master&lt;/em&gt;輸入以下來format hdfs：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;hadoop namenode -format&lt;br /&gt;hadoop datanode -format&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;在&lt;em&gt;slave&lt;/em&gt;輸入以下來format hdfs：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;hadoop datanode -format&lt;br /&gt;&lt;/pre&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092906"&gt;啟動和驗證&lt;/h2&gt;&lt;p&gt;在master呼叫&lt;code&gt;start-all.sh&lt;/code&gt;(這邊偷懶了，其實比較建議呼叫start-yarn和start-hdfs)來啟動整個hadoop。        &lt;/p&gt;&lt;p&gt;啟動了之後可以再兩台的jps看到服務都出現：            &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-C3DIifvOQHg/WkJUKP6W7rI/AAAAAAAAXVA/OWIvnQEQmX4PfXGAhfGclk4_y3kQ1BVxgCHMYCw/s1600-h/image%255B62%255D"&gt;&lt;img width="654" height="283" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IZkfcVgOgBE/WkJUL0WHUcI/AAAAAAAAXVI/Q_PVw9kvXnMU2agb6WOvUQsiULOJXF7dwCHMYCw/image_thumb%255B20%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;master同時也是slave&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;檢查ResourceManager，在Firefox輸入：http://localhost:8088            &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-8p9r0JwwhIg/WkJUN9XvHAI/AAAAAAAAXVM/ZrcH4oe6cCgMHxbPPx408d1tWEMk6y0cgCHMYCw/s1600-h/image%255B65%255D"&gt;&lt;img width="654" height="476" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bl8GOYf1yTY/WkJUPFTJiTI/AAAAAAAAXVQ/CQ3K9aFpeCQrxbJmY-fpaLRs6kxMRfRWgCHMYCw/image_thumb%255B21%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到有兩個Node&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;檢查DataNode，在Firefox輸入：http://localohost:50070            &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-kl-3zbf1GoE/WkJUQ2hHFYI/AAAAAAAAXVU/i73nJgztvQMiF3rY-tb0GUsZgA-BVcABwCHMYCw/s1600-h/image%255B68%255D"&gt;&lt;img width="654" height="810" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-pZMvs8FU7nY/WkJUTuk2GbI/AAAAAAAAXVY/gQHrpAtUGpg6nhulV_RHzyqzIYMVqWNWACHMYCw/image_thumb%255B22%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到有兩個DataNode&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092308"&gt;執行WordCount&lt;/h2&gt;&lt;p&gt;執行方式和之前一模一樣：&lt;/p&gt;&lt;pre class="brush: plain;"&gt;cd ~/Downloads&lt;br /&gt;hadoop fs -mkdir -p /user/hduser/input&lt;br /&gt;hadoop fs -copyFromLocal jane_austen.txt /user/hduser/input&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;執行WordCount程式：&lt;code&gt;hadoop jar wordcount2.jar WordCount /user/hduser/input/jane_austen.txt /user/hduser/output&lt;/code&gt;&lt;/p&gt;&lt;p&gt;檢查執行結果：&lt;code&gt;hadoop fs -cat /user/hduser/output/part-r-00000&lt;/code&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;如果要在執行一次計算，需要先把hdfs裡面的output&lt;em&gt;砍掉&lt;/em&gt;，要不然會執行不了。指令是：&lt;code&gt;hadoop fs -rm -r /user/hduser/output&lt;/code&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;如果執行有問題，或者run不起來，可以試試重開機，然後從&lt;em&gt;測試Hadoop&lt;/em&gt;裡面的&lt;em&gt;格式化HDFS&lt;/em&gt;開始重新做一次。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514114580092413"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇，透過之前建立的VM轉換成為Master，並且在從這個Master複製出來變成slave。    &lt;/p&gt;&lt;p&gt;可以想象，如果要串聯多台電腦可以用這種方式達到分散式運算和分散式檔案儲存。只不過這邊用VM來模擬這個情況。&lt;/p&gt;&lt;p&gt;基本上，到目前為止對於整個Hadoop應該已經有個比較完整的感覺，並且了解如何建立一個測試來玩玩看。&lt;/p&gt;&lt;p&gt;不過有一個部分還沒有介紹，就是MapReduce裡面執行的WordCount程式是怎麼建立出來。&lt;/p&gt;&lt;p&gt;在下一篇將會介紹MapReduce執行的概念和WordCout是怎麼寫出來。&lt;/p&gt;&lt;/section&gt;    &lt;section&gt;     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:10e0057c-84bf-4737-891e-81a0daf24ed1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/294572318723668954/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-08-hadoop-fully-distributed-mode-tutorial.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/294572318723668954'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/294572318723668954'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-08-hadoop-fully-distributed-mode-tutorial.html' title='[Data Science 到底是什麼從一個完全外行角度來看][08]Hadoop 改成完全分散模式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-iqTlX5Iecb8/WkJSyLYxqzI/AAAAAAAAXSk/xYI1E0v9zWU9IYyPK37UKa5ojxnuoPDdACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7578800992152531237</id><published>2017-12-25T21:26:00.001+08:00</published><updated>2018-02-10T22:31:45.789+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][07]更深入看看Hadoop裡面的YARN和HDFS</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dflngrHE-qU/WkD7gIKzbnI/AAAAAAAAXRM/JMY1-HAtKg0Logv3MixEX1Qx7PY2CrqNACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-35u5PA2wW3c/WkD7hJooNpI/AAAAAAAAXRQ/sQf2gPcjnogwDzO37UnWyepcaIYD31RBQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：                     &lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和                     &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇（&lt;a style="line-height: 1.6; font-size: 15px;" href="http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html"&gt;[06]建立Hadoop環境 -下篇&lt;/a&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;）把hadoop             &lt;/span&gt;&lt;em style="line-height: 1.6; font-size: 15px;"&gt;pseudo-distributed mode&lt;/em&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;整個建立了起來，在這個過程中有透過             &lt;/span&gt;&lt;em style="line-height: 1.6; font-size: 15px;"&gt;jps&lt;/em&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;看到啟動的時候有5個process：&lt;/span&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;NameNode&lt;/li&gt;&lt;li&gt;SecondaryNameNode&lt;/li&gt;&lt;li&gt;ResourceManager&lt;/li&gt;&lt;li&gt;NodeManager&lt;/li&gt;&lt;li&gt;DataNode&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;這些process分別是yarn和HDFS執行起來的process，其中Master會有前             &lt;em&gt;&lt;strong&gt;3個&lt;/strong&gt;&lt;/em&gt;而slave有後             &lt;em&gt;&lt;strong&gt;2個&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;這篇將會對於這幾個問題做一些介紹。&lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;這篇提到的架構屬於Hadoop 2.x 版本的內容，Hadoop 3 之後有所變動。         &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863565" ;=""&gt;Hadoop Cluster架構&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863148" ;=""&gt;JobTracker和TaskTracker&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863617" ;=""&gt;YARN - ResourceManager&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863599" ;=""&gt;localhost:8088&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863306" ;=""&gt;NameNode、DataNode和Secondary NameNode&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863621" ;=""&gt;Secondary NameNode呢？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863991" ;=""&gt;localhost:50070&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514094423863980" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514094423863565"&gt;Hadoop Cluster架構&lt;/h2&gt;&lt;p&gt;在介紹幾個jps之前，需要了解Hadoop Clusted的架構。         &lt;/p&gt;&lt;p&gt;Hadoop屬於Client/Server架構，基本上會有             &lt;em&gt;&lt;strong&gt;一個Master&lt;/strong&gt;&lt;/em&gt;，             &lt;em&gt;&lt;strong&gt;多個slave&lt;/strong&gt;&lt;/em&gt;。         &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;因為Master很重要，所以2.x版本可以為master做High Availability和Federation。         &lt;/div&gt;&lt;p&gt;在上一篇建立的屬於             &lt;em&gt;pseudo-distributed mode&lt;/em&gt;，換句話說Master和Slave都是同一台，所以才看到了5個process。&lt;/p&gt;&lt;p&gt;以下圖來說，是一個Master配上兩個Slave。master和slave裡面又可以分開兩層：MapReduce 和 HDFS 層             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-osWsuhxwLUk/WkD7ihTM6FI/AAAAAAAAXRU/bMMJFU-Nk1gsTbwmg0C_Oznwcep4CEpVACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="455" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-F-qIJn-j9oE/WkD7kci7WmI/AAAAAAAAXRY/SvTG9ALXBrYRKEH1uGqCSxs59ahvHif_wCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;不同層的內容。來源：http://saphanatutorial.com/how-yarn-overcomes-mapreduce-limitations-in-hadoop-2-0/&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;注意，這邊的MapReduce層用的是Hadoop 1.x 的名稱。以2.0來說應該是YARN層。             &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514094423863148"&gt;JobTracker和TaskTracker&lt;/h2&gt;&lt;p&gt;先來看看上面那層，可以看到：             &lt;/p&gt;&lt;ul&gt;&lt;li&gt;JobTracker - 在Master&lt;/li&gt;&lt;li&gt;TaskTracker - 在Slave&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;當一個工作被記錄的時候（例如呼叫WordCount.jar），會先進入到             &lt;em&gt;JobTracker&lt;/em&gt;，再由JobTracker去             &lt;em&gt;切割&lt;/em&gt;分派給 slave的             &lt;em&gt;TaskTracker&lt;/em&gt;去做執行。最後TaskTracker在回報結果到JobTracker裡面。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UrnsOJFhDi0/WkD7ljjVlHI/AAAAAAAAXRc/g0o-P30tPbEkjQSbxkd6eu-wKq19TuwSACHMYCw/s1600-h/image%255B13%255D"&gt;&lt;img width="489" height="386" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-w2gMEePiFmk/WkD7m4euZlI/AAAAAAAAXRg/n52Ac3T2JmUltazMPOvULmmLQROlpd9agCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;job分派情況，來源：http://saphanatutorial.com/mapreduce/&lt;/figcaption&gt;&lt;/figure&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514094423863617"&gt;YARN - ResourceManager&lt;/h3&gt;&lt;p&gt;看到這邊，或許會奇怪，為什麼jps裡面沒有JobTracker和TaskTracker？原因是，JobTracker和TaskTracker是                 &lt;em&gt;MapReduce Layer&lt;/em&gt;層的內容，而Hadoop 2.0加上了YARN，因此在jps看到的是                 &lt;em&gt;&lt;strong&gt;ResourceManager&lt;/strong&gt;&lt;/em&gt;和                 &lt;em&gt;&lt;strong&gt;NodeManager&lt;/strong&gt;&lt;/em&gt;。             &lt;/p&gt;&lt;p&gt;簡單來說，可以理解成為:                 &lt;/p&gt;&lt;ol&gt;&lt;li&gt;JobTracker - ResourceManager&lt;/li&gt;&lt;li&gt;TaskTracker - NodeManager&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514094423863599"&gt;localhost:8088&lt;/h3&gt;&lt;p&gt;Port 8088是ResourceManager的UI界面&lt;/p&gt;&lt;p&gt;因此可以用瀏覽器看到目前：                 &lt;/p&gt;&lt;ul&gt;&lt;li&gt;有幾個cluster - 幾個slave&lt;/li&gt;&lt;li&gt;有哪些工作&lt;/li&gt;&lt;li&gt;工作的執行情況&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;因此，run起來之後可以用這個來檢查目前情況。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-hFcMOQHySVo/WkD7oR8vRrI/AAAAAAAAXRk/g5l-TDrkl0clTidOzc3KvTZWfxblYFmFgCHMYCw/s1600-h/image%255B16%255D"&gt;&lt;img width="654" height="332" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-s85nilB4pJk/WkD7qKavOBI/AAAAAAAAXRo/s_T84VMpJ_E11nyYrhL4koQCODgJcOy2gCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;8088的呈現畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514094423863306"&gt;NameNode、DataNode和Secondary NameNode&lt;/h2&gt;&lt;p&gt;基本上HDFS層和MapReduce層有一樣概念，不過這一次變成是儲存資料層的分散式儲存。         &lt;/p&gt;&lt;ul&gt;&lt;li&gt;NameNode - 在Master&lt;/li&gt;&lt;li&gt;DataNode - 在Slave&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;NameNode會記錄檔案&lt;em&gt;&lt;strong&gt;分散&lt;/strong&gt;&lt;/em&gt;在那幾個DataNode裡面。並且會透過&lt;em&gt;&lt;stron&gt;replicate&lt;/stron&gt;的方式把資料分成N份（一般是3份）儲存在不同DataNode達到檔案高可用性。             &lt;/em&gt;&lt;/p&gt;&lt;p&gt;以下圖來說，檔案被拆成了兩份：&lt;em&gt;A&lt;/em&gt;和&lt;em&gt;C&lt;/em&gt;，會自動被儲存在DataNode1~3，因此如果DataNode2掛掉了，NameNode會知道，並且             變成由DataNode1和DataNode3來處理。             &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-KQ8VD1R9V2M/WkD7rubV1ZI/AAAAAAAAXRs/qe-p0PBz8ME_-IcH9M6U_wmnWVIXbO7dgCHMYCw/s1600-h/image%255B21%255D"&gt;&lt;img width="606" height="214" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-s2YGszg2_xQ/WkD7uYvbw9I/AAAAAAAAXRw/O0H0nIkfHIE_jT_TvKDDG_grVCtvfOCiQCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;NameNode和DataNode的關係。來源：https://www.quora.com/Explain-what-is-NameNode-in-Hadoop&lt;/figcaption&gt;&lt;/figure&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514094423863621"&gt;Secondary NameNode呢？&lt;/h3&gt;&lt;p&gt;上面介紹了NameNode和DataNode，那麼Secondary NameNode呢？             &lt;/p&gt;&lt;p&gt;Secondary NameNode用來提供一個&lt;em&gt;Checkpoint&lt;/em&gt;輔助NameNode處理資料。             &lt;/p&gt;&lt;p&gt;因此Secondary NameNode不是備份用，因此為了避免誤會有時候會成為&lt;em&gt;Checkpoint Node&lt;/em&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514094423863991"&gt;localhost:50070&lt;/h3&gt;&lt;p&gt;Port 50070是NameNode的一個web UI界面&lt;/p&gt;&lt;p&gt;在這個界面裡面可以看到DataNode有幾台，並且有幾台死掉了等資訊。&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-AOxHKKnWdNM/WkD7xf4pWdI/AAAAAAAAXR0/UHEhY-UT7QUB30G0yPcd1QcAJD6nCBM0wCHMYCw/s1600-h/image%255B24%255D"&gt;&lt;img width="654" height="412" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-uT1vQ9ANzFg/WkD72cuROOI/AAAAAAAAXR4/L2antyZl0gwI3A4atubgsyS8o6dHANBAwCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;50070的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514094423863980"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過這篇對於底層的jps process有些了解，並且對於hadoop的cluster更有感覺。         &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-08-hadoop-fully-distributed-mode-tutorial.html"&gt;[08]Hadoop 改成完全分散模式&lt;/a&gt;)，將會回到實際操作的部分，不過這次實際建立一個完整的cluster。Master那台本身是一台slave然後建立另外一台純粹是slave的機器。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;             &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:6ba9b4fb-981d-4c19-91be-174db59bfd7f" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7578800992152531237/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-07-deeper-look-at-yarn-and-hdfs-in-hadoop.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7578800992152531237'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7578800992152531237'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-07-deeper-look-at-yarn-and-hdfs-in-hadoop.html' title='[Data Science 到底是什麼從一個完全外行角度來看][07]更深入看看Hadoop裡面的YARN和HDFS'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-35u5PA2wW3c/WkD7hJooNpI/AAAAAAAAXRQ/sQf2gPcjnogwDzO37UnWyepcaIYD31RBQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-756983034897698211</id><published>2017-12-24T08:54:00.000+08:00</published><updated>2017-12-25T21:32:48.443+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][06]建立Hadoop環境 -下篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-CJ0uihAhLFo/Wj74iyCdZTI/AAAAAAAAXOs/EYVw6iPpjkMYdw6v2RB52eIX-QEZrCqGgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sA2nwBYGciQ/Wj74kUtMrmI/AAAAAAAAXOw/LkY3v9DGRR0E_Rw8Lwp89xrMAvXTHu3IwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：&lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;上一篇（&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html"&gt;[05]建立Hadoop環境 -上篇&lt;/a&gt;）透過VMWare Player把Ubuntu裝好並且一些相關環境設定到，等於把hadoop的基礎環境建立好了。   &lt;/p&gt;&lt;p&gt;這篇將延續上篇的環境，把Hadoop建立上去，並且讓Hadoop跑一個hello world的範例。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt;   &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638700" ;=""&gt;環境準備&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638645" ;=""&gt;建立Hadoop測試環境&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638964" ;=""&gt;安裝和設定Hadoop&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638833" ;=""&gt;測試Hadoop&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638738" ;=""&gt;執行Hadoop的Hello World - WordCount&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514075612638726" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1514075612638700"&gt;環境準備&lt;/h2&gt;&lt;p&gt;這邊的清單和上一篇一樣，如果上篇已經有抓過，可以跳過：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     主機環境    &lt;/dt&gt;&lt;dd&gt;     接下來使用到的機器規格如下：     &lt;ul&gt;&lt;li&gt;OS - Windows 10 1703&lt;/li&gt;&lt;li&gt;CPU - i7-6500U 雙核&lt;/li&gt;&lt;li&gt;Memory - 16GB&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     VMWare Player 14    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;任何虛擬機器軟體都可以，只是剛好用的是VMWare Player 14。    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://my.vmware.com/en/web/vmware/free#desktop_end_user_computing/vmware_workstation_player/14_0|PLAYER-1410|product_downloads"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;檔案大小約 90MB &lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     Ubuntu 16.04.3    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;其他版本的Ubuntu也沒問題 - 如果用的是Ubuntu 14，那麼只有等一下安裝openjdk的部分會有問題，其他都一樣。     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://www.ubuntu.com/download/desktop"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.ubuntu.com/download/desktop/thank-you?version=16.04.3&amp;amp;architecture=amd64"&gt;直接下載（約1.4GB）&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     Hadoop v2.7.4    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;基本上 v2.x 的都沒有問題，只是剛好手上有2.7.4所以沒有在下載新的。如果是v3.0那麼設定會不同     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://www.apache.org/dyn/closer.cgi/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://apache.stu.edu.tw/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz"&gt;直接下載（約254 MB）&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     MapReduce的Hello World程式 - WordCount    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個是用來測試map reduce的hello world程式：     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://1drv.ms/u/s!Am-7OXCiIo1Lh9EaLbZsQyArJyYZ6Q"&gt;WordCount2.jar&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://1drv.ms/t/s!Am-7OXCiIo1Lh9EbxkNiZl1d7ERYtQ"&gt;jane_austen.txt&lt;/a&gt; - pride and prejudice 前三章 - 測試算字數用&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514075612638645"&gt;建立Hadoop測試環境&lt;/h2&gt;&lt;p&gt;基本上整個的環境建立大概可以分幾個部分：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;安裝Ubuntu VM&lt;/li&gt;&lt;li&gt;設定Ubuntu環境&lt;/li&gt;&lt;li&gt;安裝和設定Hadoop&lt;/li&gt;&lt;li&gt;測試Hadoop&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;這篇會介紹&lt;em&gt;第三步和第四部&lt;/em&gt;的部分   &lt;/div&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514075612638964"&gt;安裝和設定Hadoop&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      下載和解壓縮Hadoop     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;先用firefox下載（&lt;a href="http://apache.stu.edu.tw/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz"&gt;直接下載&lt;/a&gt;）hadoop到&lt;em&gt;&lt;strong&gt;Downloads&lt;/strong&gt;&lt;/em&gt;資料夾      &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oweprqnd6Dc/Wj74lGMOExI/AAAAAAAAXO0/vmKK4rpueWgiiORjsVeTK-EhlQ_uzr9WACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="518" height="461" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-x57nNkUp34E/Wj74mOSaRRI/AAAAAAAAXO4/743JC7tfxeEgnBJUVbsCvxWlVFnEMRtEwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;下載最後位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;在Terminal（快速鍵 &lt;code&gt;Ctrl + Alt + t&lt;/code&gt;）裡面執行以下指令：      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;cd Downloads&lt;br /&gt;sudo tar -zxvf ./hadoop-2.7.4.tar.gz -C /usr/local&lt;br /&gt;cd /usr/local&lt;br /&gt;sudo mv ./hadoop-2.7.4/ ./hadoop&lt;br /&gt;sudo addgroup hadoop&lt;br /&gt;sudo chown -R hduser:hadoop hadoop&lt;/pre&gt;這個的作用是把它解壓縮出來，放到&lt;code&gt;/usr/local/hadoop&lt;/code&gt;的位置，並且設定執行權限      &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZKp5Roo5qng/Wj74niNqNAI/AAAAAAAAXO8/HqSjgT_mEk8j-Oc4z5YXxcR1sBYV6JDQACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="366" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9Bh-Ukb4d7w/Wj74pfbBzBI/AAAAAAAAXPA/_12y2sz_g98P1nkKpIKNMAIiJThZqTPSACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;解壓縮完成看到hadoop資料夾&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      設定 hadoop/etc/hadoop/core-site.xml     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;用Terminal執行：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/core-site.xml&lt;/code&gt;&lt;/p&gt;&lt;p&gt;在 &lt;code&gt;Configuration&lt;/code&gt;裡面輸入：      &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt;&amp;lt;name&amp;gt;fs.default.name&amp;lt;/name&amp;gt;&lt;br /&gt;&amp;lt;value&amp;gt;hdfs://localhost:9000&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;/pre&gt;&lt;p&gt;這個是在設定&lt;em&gt;&lt;strong&gt;NameNode&lt;/strong&gt;&lt;/em&gt;位置在哪裡 - NameNode之後會介紹，但是基本上就是主控HDFS的Master。      &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-AWpG-rty1OI/Wj74qs3Zc7I/AAAAAAAAXPE/EhFHm3KeSGwBqSrqCr-HrqGtGlDaK1LrQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="674" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mTsXv4QiEj4/Wj74tP5hSaI/AAAAAAAAXPI/hdQmwof_Qf0NExiZ1t6tW9h4aLbEWrqHwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;修改core-site.xml的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      修改hadoop-env.sh     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這邊要把&lt;code&gt;${JAVA_HOME}&lt;/code&gt;的值寫進去（理論上應該不需要才對，因為我們之前有設定參數，但是好像吃不進去，所以要寫死進去）      &lt;/p&gt;&lt;p&gt;在Terminal執行：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/hadoop-env.sh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;找到：&lt;code&gt;export JAVA_HOME=${JAVA_HOME}&lt;/code&gt;然後把它改成&lt;code&gt;export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9Lq7ai8kwRc/Wj74t2heJsI/AAAAAAAAXPM/1U1JZaaWG8IVqTejPWjgNG4Zo0GjTK7QQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="547" height="400" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h6_bPa5jOHc/Wj74wR02LaI/AAAAAAAAXPQ/Fa0C2ula1qAnCM0SlU9fM81yqBAwDpthQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;修改之後的結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      設定hdfs-site.xml     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這邊設定的是：      &lt;/p&gt;&lt;ul&gt;&lt;li&gt;每一個在HDFS的檔案要replicate幾份 - 預設都是3&lt;/li&gt;&lt;li&gt;NameNode儲存位置&lt;/li&gt;&lt;li&gt;DataNode儲存位置&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;在Terminal執行：&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/hdfs-site.xml&lt;/code&gt;，然後在&lt;code&gt;Configuration&lt;/code&gt;裡面加入： &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;dfs.replication&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;3&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;dfs.namenode.name.dir&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt; file:/usr/local/hadoop/hadoop_data/hdfs/namenode&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;dfs.datanode.data.dir&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt; file:/usr/local/hadoop/hadoop_data/hdfs/datanode&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cA4L9F97mac/Wj74yxoopqI/AAAAAAAAXPU/SP2aJt2wKkIDlMIg0JxzeXi6gASXT0pSACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="737" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Q5uYNvA6XiA/Wj743Ngd-kI/AAAAAAAAXPY/GGZ22S5BedIuuxGb-uvr_Dion3SFZz-_QCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;修改畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      修改yarn-site.xml     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這邊修改的是yarn的設定，在Terminal執行&lt;code&gt;gedit /usr/local/hadoop/etc/hadoop/yarn-site.xml&lt;/code&gt;，在&lt;code&gt;Configuration&lt;/code&gt;裡面加入：      &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;yarn.nodemanager.aux-services&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;mapreduce_shuffle&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;org.apache.hadoop.mapred.ShuffleHandler&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;yarn.nodemanager.resource.cpu-vcores&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;1&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;br /&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;yarn.nodemanager.resource.memory-mb&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;2048&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;/pre&gt;&lt;p&gt;這邊後面兩個，&lt;code&gt;yarn.nodemanager.resource.cpu-vcores&lt;/code&gt; 和 &lt;code&gt;yarn.nodemanager.resource.memory-mb&lt;/code&gt; 是設定使用到的資源，如果後面執行不太起來要注意這個值和VM給的資源。      &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-2PEhHzm6Mr0/Wj745LhaZcI/AAAAAAAAXPc/gG79UvtJrm4Jgo6iErNHMzg3PYXXnk7jQCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="737" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-r9-iQmzKfTE/Wj749UxSt6I/AAAAAAAAXPg/q4ylYnPvC_0Ui5TN2PR7bSMLBkp66ptEQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;修改完的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      修改marped-site.xml     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個檔案預設不存在，所以要從template把它先復製出來。       &lt;/p&gt;&lt;p&gt;在Terminal輸入：       &lt;/p&gt;&lt;pre class="brush: plain;"&gt;cd /usr/local/hadoop/etc/hadoop&lt;br /&gt;sudo cp mapred-site.xml.template mapred-site.xml&lt;br /&gt;cd ~&lt;br /&gt;sudo gedit /usr/local/hadoop/etc/hadoop/mapred-site.xml&lt;/pre&gt;&lt;p&gt;打開了之後，把&lt;code&gt;configuration&lt;/code&gt;改成：       &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;property&amp;gt;&lt;br /&gt; &amp;lt;name&amp;gt;mapreduce.framework.name&amp;lt;/name&amp;gt;&lt;br /&gt; &amp;lt;value&amp;gt;yarn&amp;lt;/value&amp;gt;&lt;br /&gt;&amp;lt;/property&amp;gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-opld-kD0iIw/Wj74-ErWZ4I/AAAAAAAAXPk/PvEgkhtVQBM89YE-06j6QMwlqugaFHw-gCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="560" height="513" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-8Ai0n4VfG00/Wj75BT67PvI/AAAAAAAAXPo/Jv2PplAcPHY6m_CJtek8qpMkcgHYMjZxgCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;完成設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      建立HDFS用到的目錄     &lt;/dt&gt;&lt;dd&gt;      在Terminal輸入：      &lt;pre class="brush: plain;"&gt;sudo rm -rf /usr/local/hadoop/hadoop_data/hdfs&lt;br /&gt;mkdir -p /usr/local/hadoop/hadoop_data/hdfs/namenode&lt;br /&gt;mkdir -p /usr/local/hadoop/hadoop_data/hdfs/datanode&lt;br /&gt;sudo chown -R hduser:hduser /usr/local/hadoop&lt;/pre&gt;&lt;p&gt;這個將會建立hdfs的相關資料夾      &lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514075612638833"&gt;測試Hadoop&lt;/h3&gt;&lt;p&gt;以上就是hadoop的安裝和設定，接下來只需要把它run起來即可。    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      格式化HDFS     &lt;/dt&gt;&lt;dd&gt;      在Terminal執行：      &lt;pre class="brush: plain;"&gt;hadoop namenode -format&lt;br /&gt;hadoop datanode -format &lt;/pre&gt;&lt;div class="bs-callout bs-callout-warning"&gt;中間可能會問是否確定繼續執行，記得要輸入&lt;code&gt;yes&lt;/code&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;      啟動yarn和hdfs     &lt;/dt&gt;&lt;dd&gt;      在Terminal輸入：      &lt;pre class="brush: plain;"&gt;start-yarn.sh&lt;br /&gt;start-dfs.sh&lt;/pre&gt;&lt;p&gt;這個是在&lt;em&gt;Master上面&lt;/em&gt;執行，會自動透過ssh的方式把所有Slave也一起啟動。      &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;還有兩種啟動方式：       &lt;ul&gt;&lt;li&gt;&lt;code&gt;start-all.sh&lt;/code&gt; 和 &lt;code&gt;stop-all.sh&lt;/code&gt; - 這個已經被deprecated 不過同等於上面兩個在一起執行&lt;/li&gt;&lt;li&gt;&lt;code&gt;hadoop-daemon.sh namenode/datanode&lt;/code&gt; 和 &lt;code&gt;yarn-deamon.sh resourcemanager&lt;/code&gt; - 這個是手動在&lt;em&gt;各個&lt;/em&gt;節點裡面手動啟動對應服務&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;      確認啟動process是否正常     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;在Terminal上面執行：&lt;code&gt;jps&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DKYiOi2CdwI/Wj75EU8N6JI/AAAAAAAAXP0/pns4S7r4W9U5r-5XYK--2Lm0syBb2AIHACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="295" height="132" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MsAjRD0SKxE/Wj75GK-GO_I/AAAAAAAAXP4/9rebiGU-edc5XU3eXv0BD_PaoW3L_S-MQCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;檢查執行的服務&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;這邊會看到5個服務：      &lt;/p&gt;&lt;ol&gt;&lt;li&gt;NameNode&lt;/li&gt;&lt;li&gt;SecondaryNameNode&lt;/li&gt;&lt;li&gt;ResourceManager&lt;/li&gt;&lt;li&gt;NodeManager&lt;/li&gt;&lt;li&gt;DataNode&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;在真的分散式架構，前3個只會在Master出現，後面兩個只會在Slave出現      &lt;/div&gt;&lt;/dd&gt;&lt;dt&gt;      確認Web UI是否正常     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;服務啟動成功之後可以在Firefox輸入：      &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://localhost:8088"&gt;http://localhost:8088&lt;/a&gt; - 這個是ResourceManager的web界面&lt;/li&gt;&lt;li&gt;&lt;a href="http://localhost:50070"&gt;http://localhost:50070&lt;/a&gt;- 這個是NameNode的web界面 - 換句話說是hdfs的畫面&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-CxdC5sF6C9M/Wj75HOT5EII/AAAAAAAAXP8/v97Z3G6HdvkJxItq2BajlUucD7nD6HoewCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="332" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mO-F6d24JFI/Wj75I9T6hcI/AAAAAAAAXQA/M542v0alLegzThHAi8sMYOHxg5XlyOsSgCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;ResourceManager的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-R_tSLQgS1-8/Wj75KtkmNqI/AAAAAAAAXQE/XllmWKDY8B8mZvqQStAwWt9muDHar9jZQCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="412" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-V8RRKiwltlw/Wj75M8wPHaI/AAAAAAAAXQI/yGKXz0CvZbweERnPKDn6aHWEWVNl_kAsACHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;NameNode的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514075612638738"&gt;執行Hadoop的Hello World - WordCount&lt;/h2&gt;&lt;p&gt;首先先把 &lt;a href="https://1drv.ms/u/s!Am-7OXCiIo1Lh9EaLbZsQyArJyYZ6Q"&gt;WordCount2.jar&lt;/a&gt;和&lt;a href="https://1drv.ms/t/s!Am-7OXCiIo1Lh9EbxkNiZl1d7ERYtQ"&gt;jane_austen.txt&lt;/a&gt;下載到&lt;code&gt;Downloads&lt;/code&gt;裡面。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7xSrWxuljkM/Wj75QraE9TI/AAAAAAAAXQM/wa9euY0Zc64aN5fwPS0qEUHgwt2BNUnswCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="256" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-_QdZx02-ay0/Wj75SCA2G7I/AAAAAAAAXQQ/XKePhB7ukD8Hp3WlEEIKmUvM3awhihNVwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;下載完的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;把檔案複製到 hadoop的HDFS裡面，在Terminal輸入： &lt;/p&gt;&lt;pre class="brush: plain;"&gt;cd ~/Downloads&lt;br /&gt;hadoop fs -mkdir -p /user/hduser/input&lt;br /&gt;hadoop fs -copyFromLocal jane_austen.txt /user/hduser/input&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;可以用&lt;code&gt;hadoop fs -ls /user/hduser/inpu&lt;/code&gt;檢查複製進去的檔案。   &lt;/div&gt;&lt;p&gt;執行WordCount的程式，&lt;code&gt;hadoop jar wordcount2.jar WordCount /user/hduser/input/jane_austen.txt /user/hduser/output&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-T2PAMILtwSU/Wj75T-Gw2bI/AAAAAAAAXQU/i1hd2owz9HcRqJhHHn5cwxR_doTQXDQhACHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="138" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mvqjWNcap0c/Wj75VWGWbPI/AAAAAAAAXQY/TeGINEkgheUjQyjL45l6QseCB5u6-tncgCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;執行WordCount&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;檢查執行結果：&lt;code&gt;hadoop fs -cat /user/hduser/output/part-r-00000&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_QFg6YIxN2A/Wj75WHNveAI/AAAAAAAAXQc/isF8Pa2HIdI2UXqH5xhJBXz1IRGfuVVsQCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="296" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-5638G93kYGU/Wj75W0F49AI/AAAAAAAAXQg/-SuCUBjT7DQBVNsOHsskd8r-RMifnr1-QCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;看到最後計算結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;如果要在執行一次計算，需要先把hdfs裡面的output&lt;em&gt;砍掉&lt;/em&gt;，要不然會執行不了。指令是：&lt;code&gt;hadoop fs -rm -r /user/hduser/output&lt;/code&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;如果執行有問題，或者run不起來，可以試試重開機，然後從&lt;em&gt;測試Hadoop&lt;/em&gt;裡面的&lt;em&gt;格式化HDFS&lt;/em&gt;開始重新做一次。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514075612638726"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇把整個Hadoop建立完成，並且執行了一個map reduce的word count程式計算出pride and prejudice前3章的字數計算。   &lt;/p&gt;&lt;p&gt;在這篇建立出來的hadoop是所謂的&lt;em&gt;&lt;strong&gt;pseudo-distributed mode&lt;/strong&gt;&lt;/em&gt;，換句話說Master和Slave在&lt;em&gt;&lt;strong&gt;同一台機器&lt;/strong&gt;&lt;/em&gt;，但是實際運作上會有Master對上多個Slave。   &lt;/p&gt;&lt;p&gt;不過在進入這種分散式模式之前，需要在了解一些hadoop細節。   &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-07-deeper-look-at-yarn-and-hdfs-in-hadoop.html"&gt;[07]更深入看看Hadoop裡面的YARN和HDFS&lt;/a&gt;)，將會在針對hadoop裡面的分散式模式在做更詳細一點介紹，包含yarn和hdfs裡面對應的process。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&amp;nbsp;&amp;nbsp; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:72592fa7-81a9-47e5-b1d2-ba2f92822336" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/756983034897698211/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/756983034897698211'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/756983034897698211'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html' title='[Data Science 到底是什麼從一個完全外行角度來看][06]建立Hadoop環境 -下篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-sA2nwBYGciQ/Wj74kUtMrmI/AAAAAAAAXOw/LkY3v9DGRR0E_Rw8Lwp89xrMAvXTHu3IwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8384731421236637317</id><published>2017-12-23T19:24:00.000+08:00</published><updated>2017-12-24T08:56:53.646+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][05]建立Hadoop環境 -上篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-TVWd5UeyrC8/Wj47ExLZKvI/AAAAAAAAXMg/jRP-EzPHFesU9CLaix1S4YpkH6n8L7nnQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-O5olxioUCso/Wj47GSDDRiI/AAAAAAAAXMk/q-uftf2XjOE69vD6ZXJAxUmUcwVaGachwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;span&gt;圖片來源：&lt;a href="https://pixabay.com/en/books-spine-colors-pastel-1099067/"&gt;https://pixabay.com/en/books-spine-colors-pastel-1099067/&lt;/a&gt; 和 &lt;a href="https://pixabay.com/en/math-blackboard-education-classroom-1547018/"&gt;https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/a&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;上一篇（&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-04-hadoop-intro.html"&gt;[04]Hadoop是什麼？&lt;/a&gt;）以一個非常高的overview看了Hadoop是什麼，在接下來將會把理論轉成實際操作，將建立一個Ubuntu 的 VM上面架設hadoop並且跑一個MapReduce的hello world程式，WordCount（算字數）。&lt;/p&gt;&lt;p&gt;等到跑完範例之後，將會在深入一點看hadoop的MapReduce和HDFS運作模式。   &lt;/p&gt;&lt;p&gt;首先，從建立環境開始。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514026901216988" ;=""&gt;環境準備&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514026901223166" ;=""&gt;建立Hadoop測試環境&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514026901223379" ;=""&gt;安裝Ubuntu VM&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514026901223970" ;=""&gt;設定Ubuntu環境&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1514026901223140" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1514026901216988"&gt;環境準備&lt;/h2&gt;&lt;p&gt;整個操作會是在VM（虛擬機器）上面執行，並且因為Hadoop在linux世界比在Windows來的穩定，因此，會建立一個Ubuntu的環境，並且把Hadoop架設在裡面。   &lt;/p&gt;&lt;p&gt;在接下來的lab將會用到以下幾個軟體/環境：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     主機環境    &lt;/dt&gt;&lt;dd&gt;     接下來使用到的機器規格如下：     &lt;ul&gt;&lt;li&gt;OS - Windows 10 1703&lt;/li&gt;&lt;li&gt;CPU - i7-6500U 雙核&lt;/li&gt;&lt;li&gt;Memory - 16GB&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     VMWare Player 14    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;任何虛擬機器軟體都可以，只是剛好用的是VMWare Player 14。    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://my.vmware.com/en/web/vmware/free#desktop_end_user_computing/vmware_workstation_player/14_0|PLAYER-1410|product_downloads"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;檔案大小約 90MB &lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     Ubuntu 16.04.3    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;其他版本的Ubuntu也沒問題 - 如果用的是Ubuntu 14，那麼只有等一下安裝openjdk的部分會有問題，其他都一樣。     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://www.ubuntu.com/download/desktop"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.ubuntu.com/download/desktop/thank-you?version=16.04.3&amp;amp;architecture=amd64"&gt;直接下載（約1.4GB）&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     Hadoop v2.7.4    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;基本上 v2.x 的都沒有問題，只是剛好手上有2.7.4所以沒有在下載新的。如果是v3.0那麼設定會不同     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://www.apache.org/dyn/closer.cgi/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz"&gt;下載頁面&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://apache.stu.edu.tw/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz"&gt;直接下載（約254 MB）&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dt&gt;     MapReduce的Hello World程式 - WordCount    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個是用來測試map reduce的hello world程式：     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://1drv.ms/u/s!Am-7OXCiIo1Lh9EaLbZsQyArJyYZ6Q"&gt;WordCount2.jar&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://1drv.ms/t/s!Am-7OXCiIo1Lh9EbxkNiZl1d7ERYtQ"&gt;jane_austen.txt&lt;/a&gt; - pride and prejudice 前三章 - 測試算字數用&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;以上就是整個會用到的程式和環境，接下來就來看看如何建立hadoop環境。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514026901223166"&gt;建立Hadoop測試環境&lt;/h2&gt;&lt;p&gt;基本上整個的環境建立大概可以分幾個部分：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;安裝Ubuntu VM&lt;/li&gt;&lt;li&gt;設定Ubuntu環境&lt;/li&gt;&lt;li&gt;安裝和設定Hadoop&lt;/li&gt;&lt;li&gt;測試Hadoop&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;由於截圖比較多，所以這篇會先介紹&lt;em&gt;第一步和第二部&lt;/em&gt;的部分，hadoop安裝和測試將會在下一篇做介紹   &lt;/div&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514026901223379"&gt;安裝Ubuntu VM&lt;/h3&gt;&lt;p&gt;首先先把VMWare Player安裝起來（&lt;a href="https://my.vmware.com/en/web/vmware/free#desktop_end_user_computing/vmware_workstation_player/14_0|PLAYER-1410|product_downloads"&gt;下載頁面&lt;/a&gt;）    &lt;/p&gt;&lt;p&gt;把VMWare Player執行起來，先建立VM：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-75cWRoboxMU/Wj47HWFFhBI/AAAAAAAAXMo/c2pHdFg7F3k0UCcmXNzN4pJ68mnckJpQQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="253" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Q2-0ISv842k/Wj47IAI7DbI/AAAAAAAAXMs/YfPdr1VhfGcNgYSQBfpv-FPuL-6T_XNOACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立VM&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;選擇下載的Ubuntu iso檔案位置（&lt;a href="https://www.ubuntu.com/download/desktop/thank-you?version=16.04.3&amp;amp;architecture=amd64"&gt;直接下載&lt;/a&gt;）    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0EGERhxXBF4/Wj47JC6gtsI/AAAAAAAAXMw/33_54YZ54koP-g9NoA5VI1IdewbiMvpjACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="645" height="638" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-xZz65gua1XE/Wj47K1mgz0I/AAAAAAAAXM0/Nc7P0O_0vaA-HlAAwD02r47x20DWl8EKQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇iso檔案的路徑&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;設定帳號的部分，建議設定&lt;code&gt;hduser&lt;/code&gt;，如果設定不同，在下面的修改需要作出對應修改。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yoCvFbfeMbE/Wj47LztRqtI/AAAAAAAAXM4/HtZQXE7HyFsPAvCSwdB6Mz5uEJKbikKpgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="645" height="638" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Z5gJ8Rkxu0c/Wj47NQCq6NI/AAAAAAAAXM8/ekowg3AFz68M0aztYSlWBJoobsJHp7zOgCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;帳號設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;機器的名稱和儲存位置就隨意，只要可以識別即可    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Dtd3sJf9FbE/Wj47O5FadZI/AAAAAAAAXNA/9vcPTTm2Arc5qMRXBOyHjVrxkTGuEyuoQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="645" height="638" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qkz7kk0My_E/Wj47QdI_CQI/AAAAAAAAXNE/m1DTjS5_eBwTCUNcwVKUBAAnIW_sTMdigCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;VM名稱&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;VM硬碟的部分，20GB不用動，下面那個選項建議改成&lt;code&gt;第一個選項&lt;/code&gt;，原因是之後要複製比較方便。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-m8nx_bLBxw8/Wj47Sr054xI/AAAAAAAAXNI/lSg3ZF8qkvE88sOyYDWBmdxn6fF2yvJ4ACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="645" height="638" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h6n7HUde7iU/Wj47UXUaSdI/AAAAAAAAXNM/6MwsPUp_EBcbkjVyb_VYvGRAe1JA9RabgCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定硬碟&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;設定CPU和memory的部分需要透過：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;選擇 &lt;kbd&gt;Customize Hardware&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;選擇 Memory&lt;/li&gt;&lt;li&gt;最好至少要有&lt;em&gt;2048MB&lt;/em&gt;&lt;/li&gt;&lt;li&gt;按下&lt;kbd&gt;close&lt;/kbd&gt;即可，修改就會儲存&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;最好 CPU 能夠給到 &lt;em&gt;2+&lt;/em&gt;，Memory最好可以到&lt;em&gt;4096 MB+&lt;/em&gt; - 後面執行比較不會有問題（要不然需要在手動調整一些使用資源避免執行不起來）。    &lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--4-cvhsK6rI/Wj47VLHu9KI/AAAAAAAAXNQ/KvIs4EXS0qUki6xefH7OPIX2o1KEsWeLgCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="356" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-PwCcDnX9Zms/Wj47XTCZ_NI/AAAAAAAAXNU/xznldCtuJ0o2gHR2Whj0uQLJ7HqWMUD-wCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定資源&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;接下來VMWare Player會自動安裝，如果有出現要不要安裝 &lt;code&gt;VMWare Tool for linux&lt;/code&gt;，建議裝    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-X9TtiV6yT9M/Wj47ajXpjNI/AAAAAAAAXNY/-jb1D2CY7zA8WYB-kmyYBa505FuZFeGyACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="423" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sBkUOrlrcbY/Wj47cPAXSiI/AAAAAAAAXNc/iXLkZm_yIBMk5hiYGuwPx2b6jX5widY7ACHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;安裝畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;最後，安裝好之後，出現的就是登入畫面，直接輸入當初設定的密碼即可。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oF8DiaFS-Eo/Wj47dVKNw8I/AAAAAAAAXNg/GmXeWgWmdQEv2Q-XgN2QnGSw0-aqeLvuwCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="633" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h-sneWfTxBs/Wj47kclPNxI/AAAAAAAAXNk/zeWkf9Gu2401zxbJuhgzeStM6At2R8vWQCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;登入系統&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1514026901223970"&gt;設定Ubuntu環境&lt;/h3&gt;&lt;p&gt;Hadoop是java的程式，因此需要先安裝Java - 正常來說Java 7就夠了，不過這邊會裝Java 8。    &lt;/p&gt;&lt;p&gt;再來，要設定一些環境參數讓後面用到。    &lt;/p&gt;&lt;p&gt;最後，會需要安裝ssh，因為啟動服務的時候會用ssh來溝通避免需要一台一台去啟動服務。    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      開啟Terminal     &lt;/dt&gt;&lt;dd&gt;      登入Ubuntu之後，開啟Terminal（快速鍵 &lt;kbd&gt;Ctrl + Alt + t&lt;/kbd&gt;）。基本上後面會一直用到，所以記得這個快速鍵     &lt;/dd&gt;&lt;dt&gt;      更新package     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;先更新目前package的情況，使用指令：&lt;code&gt;sudo apt-get update&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4LD_udQ0wSY/Wj47lAbgXZI/AAAAAAAAXNo/Lf7CcfHgjyMKgQiJXplKJpkCM6UnsXLGACHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="358" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MuP_0g8bwlE/Wj47mHMZU9I/AAAAAAAAXNw/TbfUcVXE8fYRDq4K6q6Xm4GOM_7jQKYkQCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;update畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      安裝Java 8     &lt;/dt&gt;&lt;dd&gt;      在terminal執行：&lt;code&gt;sudo apt-get install openjdk-8-jre openjdk-8-jdk&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1tuKsdQ4n24/Wj47pMPqG1I/AAAAAAAAXN0/ivqNko7vUpkRHzDbCjkbXq_JcitZ0W-6wCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="478" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9yz_SaQuF24/Wj47qPmvs0I/AAAAAAAAXN4/J-w2wsaxFZ8Yjf5a8alvZ8LMIMtuOCffwCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;中間有需要&lt;em&gt;輸入 y&lt;/em&gt; 才會繼續執行&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      設定環境參數     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;現在terminal執行：&lt;code&gt;gedit ~/.bashrc&lt;/code&gt;，然後在檔案最後面加上：      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64&lt;br /&gt;export HADOOP_HOME=/usr/local/hadoop&lt;br /&gt;export PATH=$PATH:$HADOOP_HOME/bin&lt;br /&gt;export PATH=$PATH:$HADOOP_HOME/sbin&lt;br /&gt;export HADOOP_MAPRED_HOME=$HADOOP_HOME&lt;br /&gt;export HADOOP_COMMON_HOME=$HADOOP_HOME&lt;br /&gt;export HADOOP_HDFS_HOME=$HADOOP_HOME&lt;br /&gt;export YARN_HOME=$HADOOP_HOME&lt;br /&gt;export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native&lt;br /&gt;export HADOOP_OPTS="-Djava.library.path=$HADOOP_HOME/lib"&lt;br /&gt;export JAVA_LIBRARY_PATH=$HADOOP_HOME/lib/native:$JAVA_LIBRARY_PATH&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mU1U2HUIrcY/Wj47rFkgC3I/AAAAAAAAXN8/b3OmbrQTmb8eMi6_X2IBuzmkOv8ke6aDwCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="266" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dtDvF7RBUZk/Wj47sBGgXtI/AAAAAAAAXOA/Lp4SRsLK9jonw5O5AA3FHZAop6TWb1LdgCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;最後確認一下參數有沒有進入：      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;source ~/.bashrc&lt;br /&gt;echo $JAVA_HOME&lt;br /&gt;java -version&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zKIBTxFQhPU/Wj47tsDDFlI/AAAAAAAAXOE/WiK62Y1hFU0wV_jmWwyU1CYLDbPI40EHACHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="302" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-knTT1p4jxxw/Wj47vc3jjkI/AAAAAAAAXOI/pE0KOx1h-G8P1lcjUQNj-uJJEqA1EFpVgCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;參數確認，並且java版本是1.8&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dt&gt;      安裝ssh server     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;為了能夠讓master和多個slave溝通，需要安裝ssh，再來設定ssh的key：      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;sudo apt-get install openssh-server&lt;br /&gt;cd ~/.ssh/&lt;br /&gt;su - hduser&lt;br /&gt;ssh-keygen -t rsa&lt;/pre&gt;&lt;p&gt;在產生key的部分，正常是&lt;em&gt;要設定一個密碼&lt;/em&gt;比較安全，不過這個是測試用，所以就&lt;kbd&gt;enter&lt;/kbd&gt;3次下去即可      &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mM2yCusWHmI/Wj47wwyJZVI/AAAAAAAAXOM/twIlhAWJhCALkohOO00ccXu2vxdDNwZKQCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="616" height="466" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MymcFcUVA4A/Wj47yltrrAI/AAAAAAAAXOQ/5YYUqrxCeXgr_RbebTKCuggWiT4TsNUGQCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;產生key的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;key產生了之後，要把它寫出來並且測試ssh是否正常：      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;cat $HOME/.ssh/id_rsa.pub &amp;gt;&amp;gt; $HOME/.ssh/authorized_keys&lt;br /&gt;ssh localhost&lt;br /&gt;exit&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Oc8FBVwDCWA/Wj47zQaBuMI/AAAAAAAAXOU/8SdXx91YWMI-T8J1oiNaqF3zf3JrYAXhwCHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="707" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rMUL4FRCRuo/Wj471a44yXI/AAAAAAAAXOY/ZcuUlUE0udMOjlY2Xt7h14hXee8_4_ohgCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt; &lt;figcaption&gt;測試和退出的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1514026901223140"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇介紹了建制測試環境的一些設定，由於圖片比較多因此把後半段hadoop的安裝/設定和測試放在下一篇。   &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-06-install-and-test-hadoop-part2.html"&gt;[06]建立Hadoop環境 -下篇&lt;/a&gt;)將會接著這篇目前VM的情況，並且把整個hadoop建制完成。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:12724c2f-cead-45ab-b1df-e8a3374543de" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/hadoop" rel="tag"&gt;hadoop&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8384731421236637317/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8384731421236637317'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8384731421236637317'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html' title='[Data Science 到底是什麼從一個完全外行角度來看][05]建立Hadoop環境 -上篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-O5olxioUCso/Wj47GSDDRiI/AAAAAAAAXMk/q-uftf2XjOE69vD6ZXJAxUmUcwVaGachwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2676467943708658479</id><published>2017-12-22T22:30:00.000+08:00</published><updated>2017-12-23T19:25:20.087+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='hadoop'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][04]Hadoop是什麼？</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JvGVjQKkStM/Wj0WEEvnw8I/AAAAAAAAXLc/7IY0rL8Ds2ABhQJndi3E0rjnJtdAD_L9gCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-6THpWWNF8-0/Wj0WFTR6qyI/AAAAAAAAXLg/IQALieVFoy8aUN26p3Y7uR0Cnn-i9QnsQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇（&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-03-big-data-intro.html"&gt;[03]Big Data到底是有多Big？&lt;/a&gt;）了解到了Big Data的3個V，也就是量、增長速度和多元格式的挑戰，這篇來看看讓管理一切變得有可能的軟體：Hadoop。   &lt;/p&gt;&lt;p&gt;這篇將介紹Hadoop的由來，為什麼這麼重要，不同版本之間的差異，和基本架構。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426247202" ;=""&gt;Hadoop的歷史&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426248502" ;=""&gt;Hadoop的特色&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426249243" ;=""&gt;Hadoop的版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426249384" ;=""&gt;0.x 和 1.x 版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426249870" ;=""&gt;2.x版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426249442" ;=""&gt;3.x版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513952426250703" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1513952426247202"&gt;Hadoop的歷史&lt;/h2&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-g0RN6sBPOmI/Wj0WHZbvuPI/AAAAAAAAXLk/bTp4g-IHQd8FaDlFfQ20jS3vFI3knIIcgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="248" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XpiqUzK3B7U/Wj0WJeNEh7I/AAAAAAAAXLo/66uFmJ_HtqUDs_wRLGWNA4ZnYA0y-AT6gCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;hadoop的logo - 黃色大象&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;相信對於Hadoop這個詞應該不會陌生，畢竟Hadoop不算是新的東西，自2006誕生以來已經有11年的時間，因為Big Data的關係，多多少少都會提到它。   &lt;/p&gt;&lt;p&gt;Hadoop的誕生是因為Google release了一份paper，裡面描述了Google內部的&lt;em&gt;MapReduce&lt;/em&gt;（運算）和&lt;em&gt;Google File System&lt;/em&gt;（儲存）的運作概念，然後由&lt;em&gt;Doug Cutting&lt;/em&gt;用Java把它實作出來，並且用他兒子的   黃色大象玩具的名字命名，因此Hadoop就誕生了。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513952426248502"&gt;Hadoop的特色&lt;/h2&gt;&lt;p&gt;基本上，Hadoop提供了一個用串聯&lt;em&gt;一般&lt;/em&gt;電腦來達到處理Big Data所需要的&lt;em&gt;儲存&lt;/em&gt;和&lt;em&gt;運算&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;這邊，&lt;em&gt;&lt;strong&gt;一般電腦&lt;/strong&gt;&lt;/em&gt;非常重要，因為意味著&lt;em&gt;不需要&lt;/em&gt;超級電腦就可以裝。一般來說，Scale up（把單一硬體加大）永遠是比Scale Out（平行擴展多台串聯）還要來的貴很多。   &lt;/p&gt;&lt;p&gt;因此，當提到Big Data的時候，都會提到Hadoop，因為Hadoop讓儲存大資料量和運算大資料量變得親民。   &lt;/p&gt;&lt;p&gt;Hadoop，有兩個重要的核心：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Hadoop Distributed File System（HDFS） - 分散式儲存資料&lt;/li&gt;&lt;li&gt;MapReduce - 分散式運算&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513952426249243"&gt;Hadoop的版本&lt;/h2&gt;&lt;p&gt;基本上Hadoop有3個版本：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;0.x 和1.x 版本 - 基本上應該沒人再用了&lt;/li&gt;&lt;li&gt;2.x 版本&lt;/li&gt;&lt;li&gt;3.x 版本&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;除了大版號的差異之外，小版本之間也是有在maintain，下面可以看到光2.x版本就有4個不同branch。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zKT6Xm9aQwc/Wj0WKc5-z2I/AAAAAAAAXLs/SGKgXknExwsPrrhH1OfSs6_bn-oMDOaewCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="392" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-GULdInUTCws/Wj0WM30dcII/AAAAAAAAXLw/P5qzY4rhYx4DcW72tw2x-l13bp4u_Pg8gCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;目前有在maintain的版本&lt;/figcaption&gt;&lt;/figure&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513952426249384"&gt;0.x 和 1.x 版本&lt;/h3&gt;&lt;p&gt;最早出來的版本基本結構如下：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-nHcBOfmPH9o/Wj0WOaS7P7I/AAAAAAAAXL0/Wt7ufLdqzUwKRbg1U2WHPlhGPNcYHUrZwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="260" height="294" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-LQkTSRuKOUc/Wj0WQLMa5qI/AAAAAAAAXL4/1fB59oHxpMYAF-j1RCvjI81NT1Al6yAGwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;0.x和1.x版本的架構&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;可以看到，當初只有兩個最重要的核心：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;HDFS&lt;/li&gt;&lt;li&gt;MapReduce&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;其他第三方的應用，例如HIVE（hadoop上面的SQL）則需要&lt;em&gt;自己處理&lt;/em&gt;和底層Hadoop的溝通。換句話說，假設別的套件之間要溝通，基本上做不到，或者要花很多工，因為兩者之間&lt;em&gt;沒有一個共通的頻道&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;還有另外一個問題是，Hadoop屬於一個Master多個Slave的架構，換句話說，當Master掛掉了，整個就掛掉了，因此有&lt;em&gt;Single Point Of Failure&lt;/em&gt;的問題。    &lt;/p&gt;&lt;p&gt;因此2.x出現了。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513952426249870"&gt;2.x版本&lt;/h3&gt;&lt;p&gt;因為互相之間溝通困難的問題，因此在2.x版本多出了所謂的&lt;strong&gt;&lt;em&gt;Yet Antoher Resource Manager (YARN)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;因此架構變成了：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ef-HQcFkX10/Wj0WRG2aYvI/AAAAAAAAXL8/AyxKfsokDrYp8iFZSlwQ2vHF-bCiQlCPwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="328" height="427" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-3fET3TdVTZ4/Wj0WS5brwII/AAAAAAAAXMA/9L0Oi5WSxuMrBnYaU9O1ujViXOz4VVFLgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;2.x的架構&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;在2.x之後，可以看到，MapReduce不直接架在HDFS上面，而是在YARN的上面，其他的軟體例如HIVE也是在YARN上面，這個時候如果兩邊需要溝通，YARN提供這個渠道。    &lt;/p&gt;&lt;p&gt;在2.x也增加了所謂的Hig Availability和Federation的模式，避免第一版的single failure的問題。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513952426249442"&gt;3.x版本&lt;/h3&gt;&lt;p&gt;3.x版本最近剛剛正式版release（2017/12/13），因此屬於非常新的版本。    &lt;/p&gt;&lt;p&gt;這個版本要求JDK版本一定要在8以上，並且YARN和HDFS的部分都有做出了改變，例如本來HDFS預設會儲存3份提供可靠的Storage，這個已經改成了另外一種模式稱為Erasure Coding不止可以維持本來的容錯機制，並且需要的空間更少。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個部分了解的不算太多，在接下來的操作也會主要focus在2.x版本，因此有興趣可以去官網看到最新的調整。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513952426250703"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇，用一個overview的方式快速介紹了Hadoop，了解了幾個重要的元素和Hadoop的幾個特色。   &lt;/p&gt;&lt;p&gt;在下一篇（&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-05-install-and-test-hadoop-part1.html"&gt;[05]建立Hadoop環境 -上篇&lt;/a&gt;）要進入動手的階段（終於不是只有理論了），將會建立Ubuntu的VM並且把Hadoop架設起來，了解如何快速測試玩玩看Hadoop。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:e4e6902a-ee32-4841-b32a-5d6811c7c272" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2676467943708658479/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-04-hadoop-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2676467943708658479'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2676467943708658479'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-04-hadoop-intro.html' title='[Data Science 到底是什麼從一個完全外行角度來看][04]Hadoop是什麼？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-6THpWWNF8-0/Wj0WFTR6qyI/AAAAAAAAXLg/IQALieVFoy8aUN26p3Y7uR0Cnn-i9QnsQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-491663907913828878</id><published>2017-12-21T22:52:00.001+08:00</published><updated>2017-12-22T22:37:41.012+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][03]Big Data到底是有多Big？</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-pYlP49Q-jHM/WjvJRsktg6I/AAAAAAAAXKg/ScvJthAijqQ6lTX_tCbBWutFajCvEL5wwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-UU-bChrb_PU/WjvJV4Oy9KI/AAAAAAAAXKk/eZ5rm5mS2rUneUhCWkSlR2jJ9rJ742aFQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-02-what-is-data-science--what-skill-is-needed-and-what-do-they-do.html"&gt;[02]Data Science 是什麼？&lt;/a&gt;)了解了整個Data Science包含的內容，這篇將會看看源頭，Data本身。   &lt;/p&gt;&lt;p&gt;這篇先了解到什麼是Big Data？有什麼特性？到底是有多Big？   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078132" ;=""&gt;什麼是Big Data&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078510" ;=""&gt;3V 之 Volume - 量&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078556" ;=""&gt;3V 之 Velocity - 增長速度&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078611" ;=""&gt;3V 只 Variety - 資料的多元性&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078260" ;=""&gt;Big Data帶來的挑戰&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513867192078291" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078132"&gt;什麼是Big Data&lt;/h2&gt;&lt;p&gt;目前階段在介紹整個Data Scientist日常的中心，Big Data   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-lUHh6v2CXtc/WjvJXymrPtI/AAAAAAAAXKo/JD3DzBzSg3cuzim0x6dnvkVaMPxUBxNgQCHMYCw/s1600-h/image%255B6%255D"&gt;&lt;img width="545" height="530" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-aN7ZfkASXVM/WjvJaJ4aXXI/AAAAAAAAXKs/H_uXod8yLqUX90_WdEtCBSVz0GE0WoFJgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Big Data的處理&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;Big Data 在台灣翻譯成為 &lt;em&gt;巨量資料&lt;/em&gt;，但是因為中國那邊反而實際用的比較多，因此&lt;em&gt;大數據&lt;/em&gt;反而是比較耳熟能詳的詞。   &lt;/p&gt;&lt;p&gt;Big Data其實是個相對詞，對於我們來說是「Big」Data，可能兩年後只是幾天的量而已，事實上，從數據&lt;em&gt;&lt;strong&gt;產生&lt;/strong&gt;&lt;/em&gt;出到2003年的&lt;em&gt;&lt;strong&gt;資料綜合&lt;/strong&gt;&lt;/em&gt; = 我們&lt;em&gt;&lt;strong&gt;2天&lt;/strong&gt;&lt;/em&gt;的產生量而已；   &lt;/p&gt;&lt;p&gt;IDC更研究指出，現今&lt;em&gt;&lt;strong&gt;90%&lt;/strong&gt;&lt;/em&gt;的資料，都是這&lt;em&gt;&lt;strong&gt;2年&lt;/strong&gt;&lt;/em&gt;產生出來。      &lt;/p&gt;&lt;p&gt;這個資料量非常的恐怖，更別說我們還沒完全進入全IoT（Internet Of Things 物聯網）時代，如果到了那個時候估計光每一秒說不定都是現在1天的綜合（這個是個人亂猜，不過估計不久將來應該很快會發生）。   &lt;/p&gt;&lt;p&gt;所以Big Data是一個相對詞，不過當描述Big Data的時候，一般來說會有3個特性，因為都是英文字母V開頭，因此也稱為&lt;em&gt;&lt;strong&gt;3V&lt;/strong&gt;&lt;/em&gt;:   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Volume&lt;/li&gt;&lt;li&gt;Velocity&lt;/li&gt;&lt;li&gt;Variety&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;img alt="Big Data - What is Big Data - 3 Vs of Big Data - Volume, Velocity and Variety - Day 2 of 21 3vs " src="https://blog.sqlauthority.com/i/b/3vs.png"&gt;&lt;br /&gt;3V的含義，資料來源：https://blog.sqlauthority.com/2013/10/02/big-data-what-is-big-data-3-vs-of-big-data-volume-velocity-and-variety-day-2-of-21/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078510"&gt;3V 之 Volume - 量&lt;/h2&gt;&lt;p&gt;Big Data的其中一個特性就是量很大，因此3V裡面的Volume指的就是產生的量。   &lt;/p&gt;&lt;p&gt;既然提到量，那麼就要提到儲存量的單位：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-fkmYo8g6a4o/WjvJbl6z0OI/AAAAAAAAXKw/Gikgq_rF3jEuzwQO5rLJ3VtNtIaJBOdvwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="204" height="370" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-J6c2vITOiv0/WjvJdGW9lSI/AAAAAAAAXK0/GlgUovxruvkj5UghtRB7EWlW_z8vO28gQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;換句話說，1 ZB = 10^21 Byte。來源：https://en.wikipedia.org/wiki/Zettabyte&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;了解了單位，來看看每天產生的量：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ntlA1eXpuow/WjvJeiNEw6I/AAAAAAAAXK4/fE0z_d3PQ2Yk6bgYbd1UF0STSp2eqxPDgCHMYCw/s1600-h/image%255B19%255D"&gt;&lt;img width="654" height="652" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-YQIiLjrUo_w/WjvJhVVunxI/AAAAAAAAXK8/vxNhLQdkwfcbIxix45EIRzXB2gC0qM1uQCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到光2002年的每秒產量就和1992年的每天一樣，來源：http://www.vcloudnews.com/every-day-big-data-statistics-2-5-quintillion-bytes-of-data-created-daily/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;這個量非常恐怖，那麼，如果我們說Big Data到底在說什麼等級呢？   &lt;/p&gt;&lt;p&gt;基本上，當國外在說Big Data分析的時候，一般來說講的都是&lt;em&gt;&lt;strong&gt;PB&lt;/strong&gt;&lt;/em&gt;等級。   &lt;/p&gt;&lt;p&gt;大家可以想象一下，要能夠儲存PB並且做運算的電腦要多高級？   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078556"&gt;3V 之 Velocity - 增長速度&lt;/h2&gt;&lt;p&gt;Velocity指的是量的增長速度。從本來批次的增加，到最後的及時增加。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-lwDssrilaLs/WjvJjtFRWmI/AAAAAAAAXLA/ZYWu6LiY8EQl6AjnT4WzUZ9FTPnEuw_agCHMYCw/s1600-h/image%255B24%255D"&gt;&lt;img width="654" height="440" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ZkGFBaE96eM/WjvJlXpY16I/AAAAAAAAXLE/u90uKWhXeBcc8F_ca0hy27qDBcENdeWDgCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到，每分鐘會有72小時影片上傳到Youtube：來源：http://www.vcloudnews.com/every-day-big-data-statistics-2-5-quintillion-bytes-of-data-created-daily/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;當IoT完全進入的時候，資料增長一定會是Real Time。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078611"&gt;3V 只 Variety - 資料的多元性&lt;/h2&gt;&lt;p&gt;資料不再是像關聯性資料庫這種結構性資料（Structure Data），其他非結構性（Unstructure Data）資料 - 例如影片，相片等等。   &lt;/p&gt;&lt;p&gt;這種不同類型的資料讓處理起來也變得更加複雜。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078260"&gt;Big Data帶來的挑戰&lt;/h2&gt;&lt;p&gt;可以看到，Big Data不僅代表資料量很大，增長速度很快並且資料結構非常多元，那這些資料到底如何儲存和運算呢？   &lt;/p&gt;&lt;p&gt;把硬體一直加大（Scale Up）所損耗的錢是倍數成長，因此更好的情況是平行擴展（Scale out）的方式。因此&lt;em&gt;Hadoop&lt;/em&gt;的誕生讓一切變得有可能。   &lt;/p&gt;&lt;p&gt;Hadoop做到讓&lt;em&gt;一般性電腦&lt;/em&gt;能夠透過&lt;em&gt;連在一起&lt;/em&gt;的方式達到儲存大量資料，並且平行運算。舉例來說，如果我要儲存1TB的資料，但是我沒有TB硬碟，那麼可以透過2個500GB的硬碟把那1TB的資料儲存在Hadoop的HDFS。   &lt;/p&gt;&lt;p&gt;因此Hadoop把處理Big Data變得可行。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513867192078291"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇介紹了Big Data的基本特性，和所謂的3V。   &lt;/p&gt;&lt;p&gt;了解了Big Data的狀況之後，會發現到面臨的挑戰是，要儲存和計算這麼大量的資料靠一台超級電腦根本不可能，因此Hadoop的誕生導致了使用Big Data變得可能。   &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-04-hadoop-intro.html"&gt;[04]Hadoop是什麼？&lt;/a&gt;)，將會介紹讓Big Data處理變得可能，Hadoop。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:00a02f0c-6696-4d22-b80e-e9b49e35ec4c" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/491663907913828878/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-03-big-data-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/491663907913828878'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/491663907913828878'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-03-big-data-intro.html' title='[Data Science 到底是什麼從一個完全外行角度來看][03]Big Data到底是有多Big？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-UU-bChrb_PU/WjvJV4Oy9KI/AAAAAAAAXKk/eZ5rm5mS2rUneUhCWkSlR2jJ9rJ742aFQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3680244173585834820</id><published>2017-12-20T23:02:00.000+08:00</published><updated>2017-12-22T22:36:49.965+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][02]Data Science 是什麼？</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-MRG7JDhh1u8/Wjp63b9gmUI/AAAAAAAAXJg/iIdn9Rp8k7YvvxioHbrDjWr3sF6rMMHMgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-eVtvulNYoJ8/Wjp65CWk3UI/AAAAAAAAXJk/s2q74xOPAL89CZ_hzF5o_4JEbE7P_0yjwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;  &lt;section&gt;&lt;p&gt;如果說資料（data）和石油一樣是最有價值的資源，那麼Data Science就同等於從原油提煉出石油的技術。   &lt;/p&gt;&lt;p&gt;上篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-01-introduction.html"&gt;[01]開篇&lt;/a&gt;)了解了整個系列的內容之後，這篇來了解一下 Data Science 到底是什麼？需要什麼技能/技術？和到底怎麼把data提煉出來變成可以用來做使用的資訊（變成石油）。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738864" ;=""&gt;Data為什麼可以變成和石油一樣有價值的資源？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738105" ;=""&gt;以孫子兵法為例&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738302" ;=""&gt;Data Science 為什麼會夯起來？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738562" ;=""&gt;推動Data Science的幾個技術？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738159" ;=""&gt;Data Science 需要有哪方面的知識？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738925" ;=""&gt;Data Scientist 的日常工作&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513781600738978" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738864"&gt;Data為什麼可以變成和石油一樣有價值的資源？&lt;/h2&gt;&lt;p&gt;在介紹Data Science之前，要先了解的是最後的成果是什麼？像原油變成石油一樣，最後石油是最主要能源之一，因此非常有價值，那麼Data最後到底變成什麼可以和石油一樣價值？   &lt;/p&gt;&lt;p&gt;依我的理解，Data提煉出來搭配Machine Learning最後的結果是建立出一個&lt;em&gt;&lt;strong&gt;預測模型（Predict Model）&lt;/strong&gt;&lt;/em&gt;。想象一下，我們常常說，世上沒有後悔藥，為什麼需要後悔藥，因為你&lt;em&gt;看不到&lt;/em&gt;未來會發生什麼事情。   &lt;/p&gt;&lt;p&gt;如果你可以看到呢？或者說不需要很明確只需要把你的選擇正確的幾率提升幾個百分比，那優勢已經是無法估計。   &lt;/p&gt;&lt;p&gt;所以，決策者可以依照Predict Model制定自己的策略，把優勢抓在自己這邊，打敗&lt;em&gt;&lt;strong&gt;不確定性（Uncertainty）&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513781600738105"&gt;以孫子兵法為例&lt;/h3&gt;&lt;p&gt;如果對於Predict Model還是有點模糊，那麼換個角度來看這個事情。   &lt;/p&gt;&lt;p&gt;大家都聽過孫子兵法，在我來看，簡單來說，孫子兵法就是一個基於經驗總結（Data），經過孫子處理過而得到的一個作戰守則（Predict Model衍生出的策略）。   &lt;/p&gt;&lt;p&gt;其實孫子兵法&lt;em&gt;不是&lt;/em&gt;在教大家如何&lt;em&gt;以少勝多&lt;/em&gt; - 畢竟當你是少的時候就算贏也是慘勝，他其實教的是如何在各個小戰役裡面&lt;em&gt;以多勝少&lt;/em&gt;，等到次數多了，優勢的傾斜會越來越大直到最後勝利。   &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738302"&gt;Data Science 為什麼會夯起來？&lt;/h2&gt;&lt;p&gt;其實從Data提煉可用的資訊出來並不是一個新的概念，一直以來都有相關研究在這方面。例如 統計，data mining等等，都是想要用現用資料來了解情況或者預測未來。   &lt;/p&gt;&lt;p&gt;那既然已經有了，為什麼現在會多出那麼一個詞呢？   &lt;/p&gt;&lt;p&gt;其實一切會夯起來，完全是因為&lt;em&gt;Big Data （大數據）&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;舉個簡單例子，大家都知道瞎子摸象的故事，一些人看不到，加上大象太大，所以他們依據&lt;em&gt;自己摸到的部分&lt;/em&gt;來&lt;em&gt;&lt;strong&gt;推論&lt;/strong&gt;&lt;/em&gt;大象是什麼。   &lt;/p&gt;&lt;p&gt;摸到身體的說，它是一面墻壁，有些人摸到耳朵，然後說它是像一面扇子等等。但是沒有一個人摸到&lt;em&gt;全部&lt;/em&gt;，所以&lt;em&gt;沒有&lt;/em&gt;一個人對大象的&lt;em&gt;描述&lt;/em&gt;是對的。   &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-781eDOpfkzk/Wjp67Pk68oI/AAAAAAAAXJo/SxHeghAl7VM1B53KTvlz1NjHTSs_6vhAQCHMYCw/s1600-h/image%255B7%255D"&gt;&lt;img width="644" height="376" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-NoR1TtcQn7E/Wjp68QaDjhI/AAAAAAAAXJs/mY9GQvxfHCIGPuSFS5J0NlWxSR6F3YyugCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;瞎子摸象，資料來源：https://kknews.cc/news/pq4oqaj.html&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;如果停一下，想想這個故事，因為大家&lt;em&gt;沒辦法看到整個大象&lt;/em&gt;，因此大家的解讀&lt;em&gt;都有偏差&lt;/em&gt;，如果反過來說，假設大家&lt;em&gt;可以看到整個大象&lt;/em&gt;，那麼是否解讀就會&lt;em&gt;正確&lt;/em&gt;（至少從相對的角度來說）呢？   &lt;/p&gt;&lt;p&gt;學過統計的知道，有個概念叫做sampling（隨機抽樣），為什麼要做sampling呢？因為整個母體（全部的資料=整個大象）太過於&lt;em&gt;大量無法&lt;/em&gt;處理（瞎子無法摸到），所以多多少少都有失偏頗（就像有些人覺得大象是面墻一樣）。   &lt;/p&gt;&lt;p&gt;因為現在技術&lt;em&gt;有辦法&lt;/em&gt;處理大量資料（就像如果瞎子突然看得到了），那麼對於整個預估是否會更準確呢？   &lt;/p&gt;&lt;p&gt;所以，Data Science 會夯起來，完全是因為 一直有需求，而直到現在才有技術有辦法支持達到效果。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738562"&gt;推動Data Science的幾個技術？&lt;/h2&gt;&lt;p&gt;既然知道為什麼Data Science會夯起來，來看看整個為什麼會夯起來。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zMvHD497t7E/Wjp69QvPxzI/AAAAAAAAXJw/2JSF_1wqnn8JNtunLI6AzmLG0z5aNfj4ACHMYCw/s1600-h/image%255B10%255D"&gt;&lt;img width="654" height="598" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-L3ndozjD40Y/Wjp6-dpPcVI/AAAAAAAAXJ0/6p-OT-EXkOERRjCHe9zRxTPYRJRAuhDQQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;幾個推動Data Science的技術&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;首先，在中間的部分是資料分析的部分，也是實際的核心，因為我們要用資料分析來了解資料。   &lt;/p&gt;&lt;p&gt;如上面提到，當數據大起來的時候，越能夠看到整個全貌，因此Big Data非常重要。   &lt;/p&gt;&lt;p&gt;能夠處理大數據之後，可以把大數據清理乾淨，搭配Machine Learning可以建立出準確的predict model。這些Predict Model可以放在Internet Of Things（IoT）讓這些IoT的機器做出更好決策，也由於有這些IoT，可以收集到更多數據。   &lt;/p&gt;&lt;p&gt;數據更多，用Machine Learning建立更好的模型，IoT越方便 - 這個是一個一直循環的過程，到最後如果&lt;em&gt;完全可以自動化&lt;/em&gt;，是不是Predict Model會越來越準確？   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738159"&gt;Data Science 需要有哪方面的知識？&lt;/h2&gt;&lt;p&gt;到目前為止，看到了為什麼Data Science會夯起來，整個的整體環境讓整個資料分析處於一個正循環的狀況，那接下來就是，要當一個Data Science需要什麼能力？   &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-x01Gd4JmoDI/Wjp7AnuDhPI/AAAAAAAAXJ4/9FzgrlwFSkAp68RSIiN4F5cVdlJ_E-VTgCHMYCw/s1600-h/image%255B15%255D"&gt;&lt;img width="654" height="604" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-kkpPPMkq50g/Wjp7Bl-Is8I/AAAAAAAAXJ8/SC2KZhZtrNYbePVRgtmQfUnYoapdh6IuACHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;Data Science Venn Diagram。來源：https://ion.icaew.com/itcounts/b/weblog/posts/theaccountinganddatascienceworldsmeet&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;網路上有個非常有名的Data Science Venn Diagram，告訴我們Data Science需要什麼能力，基本上需要3個領域：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     Computer Science    &lt;/dt&gt;&lt;dd&gt;     稱之為技術能力。畢竟，要處理Big Data，要讓電腦執行一些運算都需要一些資訊的技術能力，例如Programming，或者建立Big Data環境    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Maths &amp;amp; Statistics    &lt;/dt&gt;&lt;dd&gt;     稱之為數學能力。畢竟，一些預測模型和資料處理技術其實都是數學公式和統計學的模型。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Domain Knowledge    &lt;/dt&gt;&lt;dd&gt;     某個領域的知識。舉例來說，假設你不是寫web的，可能400、404、500對你們無感，但是對於寫web的很清楚知道這個代表頁面呈現情況，因此可以用來計算整個網站的穩定度。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;這些能力&lt;em&gt;不代表&lt;/em&gt;都要很精通，但是至少要有一定水準才有辦法做。因此，很多都是不同的人&lt;em&gt;一起&lt;/em&gt;通力合作來建立Predict Model。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話：這個其實和我們說的通才或者pie 人才是一樣概念，只是專才是不夠的......   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738925"&gt;Data Scientist 的日常工作&lt;/h2&gt;&lt;p&gt;做Data Science的人稱為 Data Scientist （資料科學家），而基本上都是和資料打交道，整個流程大概如下：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7WLJKg9f1tw/Wjp7DC4mBnI/AAAAAAAAXKA/Uuew3TTUS2U8A89YfuRJAFbh5xAT4_DhwCHMYCw/s1600-h/image%255B18%255D"&gt;&lt;img width="654" height="636" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-3vcw7EkOHNk/Wjp7FrmEZgI/AAAAAAAAXKE/jZzQlpxOjG0WnYvZ3Z1KBkCT30OvkwTOQCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Data Scientist的日常&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;首先都是有一個問題（需求）的產生&lt;/li&gt;&lt;li&gt;開始收集相關data&lt;/li&gt;&lt;li&gt;data基本上都需要經過處理，例如轉型、清理髒資料等&lt;/li&gt;&lt;li&gt;依照這些資料建立predict model&lt;/li&gt;&lt;li&gt;驗證predict model是否準確&lt;/li&gt;&lt;li&gt;沒問題就發佈出去實際使用&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;基本上 百分之80%的時間都是都是在&lt;em&gt;資料收集&lt;/em&gt;和&lt;em&gt;資料處理&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;machine learning基本上就是第4步和第5步。   &lt;/p&gt;&lt;p&gt;這些步奏不一定是順序執行，很有可能會跳來跳去，甚至直接就放棄某個問題而直接換一個問題。   &lt;/p&gt;&lt;p&gt;接下來這個系列會把每個步奏都和大家介紹一下。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513781600738978"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇把整個Data Science做了一個簡單的介紹。   &lt;/p&gt;&lt;p&gt;希望透過這篇能夠了解到為什麼Data Science很重要，需要的技術和日常主要在處理什麼事情。   &lt;/p&gt;&lt;p&gt;在下一篇(&lt;a href="http://blog.alantsai.net/2017/12/data-science-series-03-big-data-intro.html"&gt;[03]Big Data到底是有多Big？&lt;/a&gt;)將會介紹最底層的推手，讓一起別的更加準確的技術，最重要的資源 Big Data。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:239397a4-e22e-4754-972e-a841d1538acf" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3680244173585834820/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-02-what-is-data-science--what-skill-is-needed-and-what-do-they-do.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3680244173585834820'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3680244173585834820'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-02-what-is-data-science--what-skill-is-needed-and-what-do-they-do.html' title='[Data Science 到底是什麼從一個完全外行角度來看][02]Data Science 是什麼？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-eVtvulNYoJ8/Wjp65CWk3UI/AAAAAAAAXJk/s2q74xOPAL89CZ_hzF5o_4JEbE7P_0yjwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6756971588231756223</id><published>2017-12-19T21:59:00.000+08:00</published><updated>2017-12-20T07:55:24.029+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「Data Science 到底是什麼從一個完全外行角度來看」'/><category scheme='http://www.blogger.com/atom/ns#' term='data science'/><title type='text'>[Data Science 到底是什麼從一個完全外行角度來看][01]開篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-x_2UFLRBL_w/WjkatV5BKiI/AAAAAAAAXI8/UL17aIuG_wcxJ-COgkcuAfCR9ZEbULiMACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-15xUKKdBrrw/WjkaueNtf7I/AAAAAAAAXJA/teYBH1Iz4HABZqwEWuqTmjDtuZwyTup9wCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://pixabay.com/en/math-blackboard-education-classroom-1547018/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;又到了新的一屆鐵人賽，這次和之前不一樣的是，多了團隊模式。然後，不知不覺就組成了一個團隊.... 失敗的話應該會永遠被釘死吧。   &lt;/p&gt;&lt;p&gt;所以，為了不被釘死，要好好努力來寫啦，已經被警告，別像去年那樣，待補，結果和卡債一樣，永遠翻不了生（雖然到目前為止還在努力的補當中）。   &lt;/p&gt;&lt;p&gt;那今年的主題是什麼呢？不是新的程式環境（OS: .Net core哪去了？)，不是延伸去年內容打造更完整的建制環境（OS: 整合docker的DevOps哪去了？），而是一個完全不熟悉的領域，Data Science（資料科學）。 （如果你是工程師，那麼別錯過 1/6 在台大的 &lt;a href="http://study4.tw/Activity/Details/12"&gt;Study4.TW Study4Love - 與大師對談&lt;/a&gt;）  &lt;/p&gt;&lt;p&gt;今年的題目是：&lt;em&gt;&lt;strong&gt;Data Science 到底是什麼 - 從一個完全外行角度來看&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513691477636652" ;=""&gt;為什麼想寫這個主題？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513691477636647" ;=""&gt;這個系列的主要程度和內容？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513691477636377" ;=""&gt;需要準備什麼環境？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513691477636428" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;同步發佈於第九屆 2018iT 邦幫忙鐵人賽：&lt;a href="https://ithelp.ithome.com.tw/articles/10192297"&gt;https://ithelp.ithome.com.tw/articles/10192297&lt;/a&gt;&lt;br /&gt;&lt;/div&gt;&lt;br /&gt;&lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1513691477636652"&gt;為什麼想寫這個主題？&lt;/h2&gt;&lt;p&gt;先給各位我的背景，我其實是一個一般的Web Developer，主要使用微軟的技術，所以都是.Net、Asp .Net這些東西。從我這幾年參加過的鐵人賽可以看出，算是剛脫離junior的階段：&lt;a href="https://ithelp.ithome.com.tw/users/20083151/ironman/556"&gt;第六屆跑去寫了java&lt;/a&gt;：，&lt;a href="https://ithelp.ithome.com.tw/users/20083151/ironman/856"&gt;第七屆寫了如何自定自己的框架&lt;/a&gt;，   &lt;a href="https://ithelp.ithome.com.tw/users/20083151/ironman/1235"&gt;第八屆寫了建制Devops&lt;/a&gt; （也是滑鐵盧的一屆，努力還債中....），今年本來是想延續去年的主題，然後進入到Docker整合DevOps。   &lt;/p&gt;&lt;p&gt;不過剛好在最近，因為想了解大數據（Big Data），然後有去上課（如果大家有興趣，然後在台中，可以參考看看，   最近1月也會開課：&lt;a href="https://www.uuu.com.tw/Public/content/Edm/170825_TC.htm"&gt;鏈接&lt;/a&gt;），剛好認識了Data Science的整個big picture。   &lt;/p&gt;&lt;p&gt;不得不說，我有點&lt;em&gt;震撼&lt;/em&gt;到，因為雖然一直以來都有聽到：Hadoop、Big Data、Machine Learning、Internet Of Things這些詞，然後也模模糊糊知道在做什麼，但是並不知道整個&lt;em&gt;組合&lt;/em&gt;起來對&lt;em&gt;世界正在造成什麼改變&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;雖然大家可能常常聽到，我們實在經歷&lt;em&gt;&lt;strong&gt;工業4.0&lt;/strong&gt;&lt;/em&gt;的工業革命。但是可能我們比較沒有意識到的是，每一工業革命其實都是對整個世界的&lt;em&gt;巨大改變&lt;/em&gt;。而Data Science正是&lt;em&gt;推動&lt;/em&gt;工業4.0的其中一個主要的推手。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-iZMD6WhkT2Y/WjkaweNmrqI/AAAAAAAAXJE/0QgNa7xVRLYZPPE3qnu6sPR7prYr6P0hwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="368" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://buzzorange.com/techorange/wp-content/uploads/sites/2/2017/01/e6adb7e58fb2e6bc94e980b2.png" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;工業革命的大事記。來源：&lt;a style="line-height: 1.6;" href="https://buzzorange.com/techorange/2017/01/23/industry-4-0-2/"&gt;台灣轉不動工業 4.0，如果企業經營者不丟棄成本思維&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;既然這麼重要，那麼正經歷變革的我們難道不需要有些了解嗎？大變革就像大海的巨浪來襲，是要準備好能在裡面游泳存活下來，還是因為措手不及而淹死？   &lt;/p&gt;&lt;p&gt;所以，雖然對於這個領域完全是外行，而且對於我的工作上面也沒有什麼直接幫助（反而要花時間去了解），但是不記錄的話估計一個月就忘光了，因此想要借這個機會把學習到的做一個整理，方便以後回來看。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513691477636647"&gt;這個系列的主要程度和內容？&lt;/h2&gt;&lt;p&gt;這個系列是給完全不了解這個領域的人看的，所以假設你有聽過Data Science（沒聽過更好）但是不知道在做什麼，那麼這個很適合。會從底層的資料到上面的Machine Learning做一個入門總覽介紹。   &lt;/p&gt;&lt;p&gt;如果你是大神級人物（對我來說任何懂Data Science都是大神 XD），那麼也麻煩不吝指教。   &lt;/p&gt;&lt;p&gt;整個 Data Science 其實就是在建立一個 &lt;em&gt;預測模型&lt;/em&gt;，讓決策者可以依照這個模型去制定策略。Data Science工作就是讓這個&lt;em&gt;預測模型&lt;/em&gt;能夠非常準確。要達到這個效果，有好多知識和技能一起組合使用才能達到。   &lt;/p&gt;&lt;p&gt;這個系列大概會拆幾個部分：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     Data Science的概觀    &lt;/dt&gt;&lt;dd&gt;     了解什麼是Data Science、到底在做什麼、為什麼很重要和怎麼改變世界。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Big Data的概念和Hadoop    &lt;/dt&gt;&lt;dd&gt;     整個的浪潮會掀起其實是因為Big Data能夠有辦法用&lt;em&gt;一般電腦&lt;/em&gt;來做處理。因此，會先從這個部分先介紹，包含：     &lt;ul&gt;&lt;li&gt;Big Data是什麼&lt;/li&gt;&lt;li&gt;Hadoop是什麼&lt;/li&gt;&lt;li&gt;如何架設Hadoop&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Data Processing - R 語言介紹    &lt;/dt&gt;&lt;dd&gt;     有了資料了之後，接下來就是對資料做處理。這邊會用R來介紹：     &lt;ul&gt;&lt;li&gt;R的基本介紹&lt;/li&gt;&lt;li&gt;一些統計學的介紹 - 預測其實都是統計模型，因此需要了解一些統計知識&lt;/li&gt;&lt;li&gt;用R做資料處理&lt;/li&gt;&lt;li&gt;視覺化資料 - 找出資料的關係&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Machine Learning - 做出預測模型    &lt;/dt&gt;&lt;dd&gt;     有了乾淨的資料，可以來了解如何透過machine learning建立模型做出預測：     &lt;ul&gt;&lt;li&gt;Machine Learning到底是什麼&lt;/li&gt;&lt;li&gt;幾種模型的介紹&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     總結    &lt;/dt&gt;&lt;dd&gt;     一些參考資料和如何繼續下去。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513691477636377"&gt;需要準備什麼環境？&lt;/h2&gt;&lt;p&gt;基本上只需要一般電腦就好，這邊範例會使用一般的Windows 10的電腦做操作，如果要在Hadoop也跟著做的話，那麼電腦記憶體要高一點，因為會用建立VM的方式架設Ubuntu。   &lt;/p&gt;&lt;p&gt;至於後面用到的R基本上一般電腦都可以裝，所以沒有特殊要求。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513691477636428"&gt;結語&lt;/h2&gt;&lt;p&gt;希望這篇讓大家有個概念，&lt;em&gt;Data Science 很重要&lt;/em&gt;，&lt;em&gt;Data Science 很重要&lt;/em&gt;，&lt;em&gt;Data Science 很重要&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;想想，如果在做決定的時候，透過預測模型，可以讓你本來成功幾率，從-11%到+6%有利，那麼翻個幾次不就整個成功了。   &lt;/p&gt;&lt;p&gt;下一篇，從Data Science開始介紹 - 先來了解什麼是Data Science。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:d7b057c6-129b-4239-870d-3a89e2cae351" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cData+Science+%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e9%ba%bc%e5%be%9e%e4%b8%80%e5%80%8b%e5%ae%8c%e5%85%a8%e5%a4%96%e8%a1%8c%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8b%e3%80%8d" rel="tag"&gt;「Data Science 到底是什麼從一個完全外行角度來看」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/data+science" rel="tag"&gt;data science&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6756971588231756223/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-01-introduction.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6756971588231756223'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6756971588231756223'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/data-science-series-01-introduction.html' title='[Data Science 到底是什麼從一個完全外行角度來看][01]開篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-15xUKKdBrrw/WjkaueNtf7I/AAAAAAAAXJA/teYBH1Iz4HABZqwEWuqTmjDtuZwyTup9wCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7603476486181284698</id><published>2017-12-16T10:16:00.000+08:00</published><updated>2018-02-11T10:14:32.891+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 25]在Visual Studio Team Services執行Build Script和CI Server總結</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-F0eQpjkMr4g/WjSBckzq-OI/AAAAAAAAXHw/qWznbo6H1sUhmLgbsXMRxNca7xYgdhF6QCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-yiG9Nse9Rt0/WjSBeH-jwTI/AAAAAAAAXH0/zAeDIzzE-m4RVwN07mC0qfWWQG-QEm1dQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇（&lt;a href="http://blog.alantsai.net/2017/12/devopsSeries-intro-to-free-ci-service-visual-studio-team-services.html"&gt;[從.Net工程師的角度來看DevOps 24]免費build私人Repo的CI Service - Visual Studio Team Service介紹&lt;/a&gt;&lt;span style="line-height: 1.6;"&gt;）了解了如何用Visual Studio Team Services（VSTS）的內建Template來build範例專案；在設定的過程，其實沒辦法直接使用內建template，會需要調整一些參數。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;這些調整的內容和AppVeyor要調整的非常不一樣，造成了如果要換CI Server會花一些時間在這些瑣碎的細節上面。   &lt;/p&gt;&lt;p&gt;這篇將會看看，如果要把VSTS改成用build script來build專案，會需要做些什麼。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt;    &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513390188874937" ;=""&gt;調整VSTS來執行build script&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513390188874477" ;=""&gt;簡單總結CI Server和build script的關係&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513390188874300" ;=""&gt;每個CI Server設定方式都不同&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513390188874403" ;=""&gt;拿不到build完的內容 - Artifact&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513390188874907" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1513390188874937"&gt;調整VSTS來執行build script&lt;/h2&gt;&lt;p&gt;首先，先建立一個新的build definition，這次在template的部分選擇empty template：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7AKTaUVB4wU/WjSBe_HtgrI/AAAAAAAAXH4/IAUI6utc4fEqKL7Vgy1AK5KOY98mOMF5wCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="312" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-yzU421Faet8/WjSBf6OSbfI/AAAAAAAAXH8/tSAz2fvPj78ZEDPBTv7AX0svPIxSnMlQwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇emptytemplate&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;進來了之後，只需要加入一個powershell script的step並且指向專案裡面的build script，並且選擇&lt;code&gt;Save &amp;amp; Queue&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vApS2e2K6yE/WjSBg9unUyI/AAAAAAAAXIA/11fO-OBYxx85shUap2HirvXJ_3H-ieaLgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="269" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IssWNzyuSX0/WjSBiaPMLRI/AAAAAAAAXIE/MG-Ggcj1T8AT-lMUAarZg7wJf8H6wbXMwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定powershell script&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;這邊要注意在step前面的&lt;code&gt;Get Sources&lt;/code&gt;需要設定和github連上。   &lt;/div&gt;&lt;p&gt;之後build就會開始，並且跑完了之後可以看到log資訊和我們在local執行的時候是一樣的內容：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--EO_gAymUEY/WjSBjLn4m4I/AAAAAAAAXII/kDWO7o726X0TeLhC39CVqmEe5vR8yCYVQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="374" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-a3_3jiyYc9k/WjSBkB9A30I/AAAAAAAAXIM/H_-Cac93P-IIUALZq6P3tK3K9IJAVIjrwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;執行完的結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513390188874477"&gt;簡單總結CI Server和build script的關係&lt;/h2&gt;&lt;p&gt;目前為止，看了兩個CI Server：AppVeyor和VSTS。在這裡面會發現2個問題：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;每個CI Server設定方式都不同&lt;/li&gt;&lt;li&gt;拿不到build完的內容 - Artifact&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513390188874300"&gt;每個CI Server設定方式都不同&lt;/h3&gt;&lt;p&gt;在AppVeyor，已經幫使用者區分好build、test、deploy等等階段，只需要設定這些階段要執行什麼，AppVeyor就會建制完。    &lt;/p&gt;&lt;p&gt;在VSTS則是用step的概念，由使用者自己定義每一個階段要執行什麼，然後有一些已經定義好符合某些專案的template，方便快速設定。    &lt;/p&gt;&lt;p&gt;可以想象每一種CI Server有自己的設計理念，如果今天沒有build script要設定每一個CI Server其實很麻煩，尤其是當CI Server更新版本的時候，位置和內容可能都會不一樣，需要花時間再去研究。    &lt;/p&gt;&lt;p&gt;反過來說，如果把build邏輯都整合到build script，&lt;em&gt;不止不會被綁到某一個CI Server&lt;/em&gt;，並且不管在哪一個CI Server只需要執行那個build script即可，並且build script在做什麼非常清楚，    不像如果依賴CI Server，不能夠肯定裡面到底執行了什麼操作。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513390188874403"&gt;拿不到build完的內容 - Artifact&lt;/h3&gt;&lt;p&gt;當程式碼build完之後，一定會有一個產出，例如library會是一個dll，這種產出在CI有個名稱叫做&lt;em&gt;&lt;strong&gt;Artifact&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;如果眼尖的朋友，會注意到，如果用CI內建的方法，&lt;em&gt;會產生出Artifact&lt;/em&gt;，但是執行build script &lt;em&gt;會沒有&lt;/em&gt;。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HTF9yNAf8d8/WjSBlyZ7ttI/AAAAAAAAXIQ/i9xABTVSLhMq1lmsvrDvjlULylIkBsi_gCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="285" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qU-RYZc1A78/WjSBmrmKODI/AAAAAAAAXIU/UguicZz7rrMGOvnVqDFIaR3CGLw3xq-4QCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;VSTS內建template build的結果，artifact有東西&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;並且build過程有些資訊，像是測試情況、測試涵蓋率（Code Coverage）這些在自己的build script也會看不到。這是因為目前build script還沒有結合CI Server，這也是接下來需要補強的部分。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513390188874907"&gt;結語&lt;/h2&gt;&lt;p&gt;目前build script基本已經完成了，但是如果沒辦法自動打包產出結果，對於發佈和整個CI效用就大打折扣了。   &lt;/p&gt;&lt;p&gt;因此，接下來將會開始進入另外一個階段，&lt;em&gt;&lt;strong&gt;Package&lt;/strong&gt;&lt;/em&gt;的階段。   &lt;/p&gt;&lt;p&gt;而在package裡面，有個非常重要的概念是版號（Version），因此下篇將會介紹版號的重要性。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;    &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:cc7172eb-09ca-44fd-a0ad-a88c5c1580fa" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7603476486181284698/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-in-visual-studio-team-service.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7603476486181284698'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7603476486181284698'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-in-visual-studio-team-service.html' title='[從.Net工程師的角度來看DevOps 25]在Visual Studio Team Services執行Build Script和CI Server總結'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-yiG9Nse9Rt0/WjSBeH-jwTI/AAAAAAAAXH0/zAeDIzzE-m4RVwN07mC0qfWWQG-QEm1dQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8694571884343336842</id><published>2017-12-13T23:33:00.000+08:00</published><updated>2017-12-13T23:35:17.445+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 24]免費build私人Repo的CI Service - Visual Studio Team Service介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-MqYttQdQUIQ/WjFG_fsnnJI/AAAAAAAAXGU/_LGfn-y9R9A8KdIgXk6Nj5J_JOc9VIqTwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-EQv9POraQhM/WjFHAwZNkfI/AAAAAAAAXGY/WKpwhLy5g8YPrsynn2f08Cp0T9trh8uaQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;br&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-to-appveyor-set-badge-status-in-github.html"&gt;[從.Net工程師的角度來看DevOps 23]在AppVeyor執行Build Script - 整合build資訊到github&lt;/a&gt;&lt;span style="line-height: 1.6;"&gt;）介紹完了如何用AppVeyor執行我們定義的build script，不過有時候我們有私人的repo也希望做CI，這個時候免費版本的AppVeyor就不夠了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;  這邊將會介紹另外一個能夠build私人repo，由Microsoft提供的免費CI服務，Visual Studio Team Service（VSTS）。   &lt;/p&gt;&lt;p&gt;  這篇先看內建VSTS所提供的方式來建制範例專案，在下篇在改成執行我們的build script。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513178356211824" ;=""&gt;VSTS小檔案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513178356211438" ;=""&gt;用VSTS內建的build task來做CI&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513178356211540" ;=""&gt;檢查執行結果&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513178356211784" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-info"&gt;   題外話，假設之前已經有VSTS帳號，想要移動Region到East Asia，可以參考這篇：&lt;a href="http://blog.alantsai.net/2017/12/vsts-how-to-change-account-region-to-east-asia.html"&gt;[VSTS]如何調整Visual Studio Team Service的區域(Region)&lt;/a&gt;&lt;/div&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513178356211824"&gt;VSTS小檔案&lt;/h2&gt;&lt;p&gt;  VSTS是微軟提供的一個免費的Team Foundation Server（TFS）的雲端版本，build只是他其中一部分的功能（也是這個系列唯一會用到的部分）。   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;網址：&lt;a href="https://www.visualstudio.com/zh-hant/team-services/?rr=https%3A%2F%2Fwww.google.com.tw%2F"&gt;https://www.visualstudio.com/zh-hant/team-services/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;免費版本build有：1個月240分鐘&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513178356211438"&gt;用VSTS內建的build task來做CI&lt;/h2&gt;&lt;p&gt;  和AppVeyor一樣，先了解如果沒有build script的情況下，VSTS如何設定build步奏。   &lt;/p&gt;&lt;p&gt;  在開始之前，先需要在VSTS的帳號建立一個專案：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_fH7qfjosUU/WjFHCLrSdbI/AAAAAAAAXGc/w6mqRbxlXgQpGoxo_Fiqy73OzbbWOr7LACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="502" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-29VVCply-rk/WjFHDAwTW4I/AAAAAAAAXGg/6s81uZb4nwkRM6-gxK7-l2CiL8-jV0eawCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;建立專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  因為只使用到build，可以捲動到下面，直接選&lt;code&gt;Setup Build&lt;/code&gt;：   &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-wrh-uMxEfJc/WjFHEmss7nI/AAAAAAAAXGk/HIHPcsW9r7MNAzPhFke3K4y6Tor_BartgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="525" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-LI43CkIR4eI/WjFHItD_swI/AAAAAAAAXGo/hg3coeNYCEcUmnABnBqtqfvHPsOd3NxhACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figcaption&gt;&lt;figcaption&gt;建立一個build definition&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  這個會把我們帶到Build的頁簽，選擇&lt;code&gt;New Definition&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UpNttGMFWBA/WjFHKjiKcYI/AAAAAAAAXGs/lWKBHVYGf6Yb54eUd-Ln4YPANRhoaGb_QCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="358" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-hWNCHBZxai8/WjFHNMHd43I/AAAAAAAAXGw/phlPE_sv2_Ar2cWmtiV0EREgnfzzk0VAACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;建立build definition&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  可以選擇一個微軟定義好用來建立&lt;code&gt;.Net Desktop&lt;/code&gt;的template：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UgIZDt_pC9A/WjFHT-FFDFI/AAAAAAAAXG0/03_swm57liAqeWvk84Z-hR3XLT1Oht27gCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="272" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mgnbaXLpgJA/WjFHYJgm4WI/AAAAAAAAXG4/Op15oUlzKXMABe-MqKgQHhTeAuq8cGJ8QCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;選擇template&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  再來要設定source的位置：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;選擇左邊的&lt;code&gt;Get Source&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;Github&lt;/code&gt;&lt;/li&gt;&lt;li&gt;做驗證 - 可以用OAuth或者github的personal token&lt;/li&gt;&lt;li&gt;選擇要build的repo&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oipbzRcJnmo/WjFHcCdxRgI/AAAAAAAAXG8/W8EEWcKK8-wlpIWCv_QCswWkU1nZfutUQCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="354" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1dakw0NattI/WjFHdGjpkaI/AAAAAAAAXHA/xeDGPj_UD00HPgtTaUhM06SnlmK5qJAvACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定source&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  選擇右上角的&lt;code&gt;Save &amp;amp; Queue&lt;/code&gt;然後設定這個build definition的名稱之後儲存：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-enTRW4nKu-E/WjFHfHUgOpI/AAAAAAAAXHI/Mc6TyEL3qToaMtRANBkvZjX-ElyF_xRXACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="365" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-AadAAllbrSw/WjFHgSiFb7I/AAAAAAAAXHM/w3roEs9Pc1sLdfyIzvWz8HWwYK2rdaKwACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;儲存並且執行build&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;   如果依照上面的步奏直接建立build definition其實會build不起來，需要調整設定檔案裡面的sln檔案位置的設定（要給完整檔案路徑）。這也告訴我們如果沒有自己的build script，    從一個build server到另外一個其實會有些工，更別說無法local執行和CI Server一樣的動作。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513178356211540"&gt;檢查執行結果&lt;/h2&gt;&lt;p&gt;  過了一些時間之後，可以看到build成功：   和AppVeyor比較起來，可以看到VSTS在呈現的畫面比較漂亮一些，左邊是那些定義過的steps執行結果，右邊則是一個簡單的summary。因為內建step有執行test（不過是MSTest），所以有看到test結果（但是只有一筆）。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-IU4tN-TWQ5g/WjFHhRvyGVI/AAAAAAAAXHQ/-oaKDhf1_fARwD811OE-jqbS7RpJaYp9ACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="278" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-69sf9OLpc0U/WjFHj3-aCPI/AAAAAAAAXHU/hqKaEpRzEUUrTUwGRcK5DvWE6e0K-ZIegCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;build成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513178356211784"&gt;結語&lt;/h2&gt;&lt;p&gt;  這篇介紹了VSTS的build服務，並且用內建的Template來建立出build definition的檔案。   &lt;/p&gt;&lt;p&gt;  透過這篇的操作，也會發現設定build definition和AppVeyor非常不一樣，因此在沒有build script的情況下，要從AppVeyor移動到VSTS有一些工要做（以我們這個範例來說，其實內建的template不做任何事情是沒有辦法build起來），   因此build script非常重要。   &lt;/p&gt;&lt;p&gt;  下篇將會調整VSTS使用我們的build script做build。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;    &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:32c6298b-420b-46d4-b7fe-af5954dfefad" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8694571884343336842/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-intro-to-free-ci-service-visual-studio-team-services.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8694571884343336842'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8694571884343336842'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-intro-to-free-ci-service-visual-studio-team-services.html' title='[從.Net工程師的角度來看DevOps 24]免費build私人Repo的CI Service - Visual Studio Team Service介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-EQv9POraQhM/WjFHAwZNkfI/AAAAAAAAXGY/WKpwhLy5g8YPrsynn2f08Cp0T9trh8uaQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8985852925824016561</id><published>2017-12-13T07:46:00.000+08:00</published><updated>2017-12-13T07:47:45.123+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 23]在AppVeyor執行Build Script - 整合build資訊到github</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-BFTeq-4VvVk/WjBp3vNt4WI/AAAAAAAAXE8/Qdz4poPd07Ewc2mlfbR7J-c3S64LWrNtQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-uJOiQGNYkXg/WjBp41upBnI/AAAAAAAAXFA/qScvn8XpxB01Zu6cPgZL918HiFEj9dfPACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;br&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;/section&gt;&lt;section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/12/devopsSeries-ci-server-appveyor-intro.html" target="_blank"&gt;[從.Net工程師的角度來看DevOps 22]免費的CI Server - AppVeyor介紹&lt;/a&gt;&lt;span style="line-height: 1.6;"&gt;）了解到了如何把專案關聯到AppVeyor裡面，然後可以很簡單利用AppVeyor裡面內建的一些設定來build專案。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;  在這篇，我們將完全拋棄AppVeyor的內建機制，改成用我們建立出來的build script來執行。   &lt;/p&gt;&lt;p&gt;  有自己的build script不止在設定上變得更簡單，local跑的和CI Server跑的會一樣，並且如果要整合到另外一個CI Server也不會有什麼問題。   &lt;/p&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-default"&gt;  sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter23"&gt;github devops-psake sample/chapter23&lt;/a&gt;&lt;/div&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513121856654609" ;=""&gt;調整AppVeyor來執行build script&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513121856655592" ;=""&gt;查看執行結果&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513121856655437" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513121856654609"&gt;調整AppVeyor來執行build script&lt;/h2&gt;&lt;p&gt;  任何CI Server基本上都會有地方讓我們關掉內建的執行方式，改成直接執行我們指定的檔案，AppVeyor當然也不例外。做法很簡單，首先：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;切換到&lt;code&gt;Settings&lt;/code&gt;&lt;/li&gt;&lt;li&gt;然後左邊menu的&lt;code&gt;build&lt;/code&gt;&lt;/li&gt;&lt;li&gt;上面的部分直切換到&lt;code&gt;SCRIPT&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;PS&lt;/code&gt;代表powershell&lt;/li&gt;&lt;li&gt;內容輸入框指向build script的位置： &lt;kbd&gt;src\BuildProject\build.ps1&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;最後保存修改&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-LaUgTn2eMb8/WjBp60oFgNI/AAAAAAAAXFE/Ki-z6xqTTRIG1uB9meqYHIw-7PT6QjTrgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="289" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-thMgwUcFySk/WjBp7w80qZI/AAAAAAAAXFI/3m7eup1rRYMU9RDIkvR3j7Zk_3wYD9uXACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;修改build的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  再來他內建會自動去找Test相關的dll並且做執行。由於我們的build script&lt;em&gt;已經會做Test&lt;/em&gt;，因此可以直接把內建機制&lt;em&gt;關掉&lt;/em&gt;節省時間：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;切換左邊menu的&lt;code&gt;TEST&lt;/code&gt;&lt;/li&gt;&lt;li&gt;設定改成&lt;code&gt;off&lt;/code&gt;表示不要跑&lt;/li&gt;&lt;li&gt;最後儲存&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-e-UqSDRjZx8/WjBp9B0M_0I/AAAAAAAAXFM/HQiqGVnQsFcaI3zHmtgUKsDF79u2WZL6ACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="313" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1p7fV7n6sZ8/WjBp-Fd5e9I/AAAAAAAAXFQ/2eUEnwP7XiMrrD3usQf0lvQc4Q00kx0GwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;把Test關掉&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513121856655592"&gt;查看執行結果&lt;/h2&gt;&lt;p&gt;  上面設定好了之後，就可以切回到&lt;code&gt;LATEST BUILD&lt;/code&gt;的畫面去手動觸發我們的build：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UAA4ClL8zLA/WjBqAU1l2zI/AAAAAAAAXFU/AWS-wwAuQlEl3hCALAZCgl5Rj3DhfJgWgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="470" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-sgNDamztFDU/WjBqDaFCgHI/AAAAAAAAXFY/1ArMcJWy42sDt_4EtpNP4jwwyiaRCLDzgCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;build結果，可以看到和我們localbuild的output內容一樣&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;   由於我們是public專案，所以可以直接看到我們的build log：&lt;a href="https://ci.appveyor.com/project/alantsai/devops-psake/build/1.0.4"&gt;https://ci.appveyor.com/project/alantsai/devops-psake/build/1.0.4&lt;/a&gt;&lt;/div&gt;&lt;p&gt;  設定好了之後，如果能夠一目了然在專案上面看到目前build情況會很好，因此，我們可以設定一個Badge（徽章）放在我們repo的readme裡面。設定方式就是：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;左邊menu切換到&lt;code&gt;Badges&lt;/code&gt;&lt;/li&gt;&lt;li&gt;找到要顯示的那段，並且貼到&lt;code&gt;ReadMe.md&lt;/code&gt;&lt;/li&gt;&lt;li&gt;push了之後github就會看到&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-K_l8Vdfx9K8/WjBqEqzktHI/AAAAAAAAXFc/jNCL5BxhSAQz0LMTmy-afgUTr5fk1D6cwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="477" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-_K5dUfh33iQ/WjBqFQ8QgkI/AAAAAAAAXFg/N1xem9rZhtkG77m3LWQUih24hJSzxRoLwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;取得badge，放到readme在github看到&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;   這邊會注意到一件事情，當我把放badge的commit push到git了之後，AppVeyor會透過WebHook自動觸發。換句話說，每一個push就會build一次。這就是Continus Integration。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513121856655437"&gt;結語&lt;/h2&gt;&lt;p&gt;  透過這篇希望對於為什麼建立自己的Build Script更加有感，雖然CI Server上面設定很方便，但是透過我們build script執行也很方便（只是建立比較麻煩），並且local執行起來的樣子和CI Server執行的一樣。   &lt;/p&gt;&lt;p&gt;  再來看到了如何整合我們的build狀況到Github，並且AppVeyor會自動在我們push的時候執行build，形成了Continus Integration（CI）   &lt;/p&gt;&lt;p&gt;  在下篇，我們將會看另外一個免費的CI Server，Visual Studio Team Service（VSTS），並且了解一下和AppVeyor的差異和內建VSTS提供的build方法。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:8e11b467-24b1-4b13-85ab-69694d7469a6" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8985852925824016561/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-to-appveyor-set-badge-status-in-github.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8985852925824016561'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8985852925824016561'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-to-appveyor-set-badge-status-in-github.html' title='[從.Net工程師的角度來看DevOps 23]在AppVeyor執行Build Script - 整合build資訊到github'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-uJOiQGNYkXg/WjBp41upBnI/AAAAAAAAXFA/qScvn8XpxB01Zu6cPgZL918HiFEj9dfPACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-490113770113340110</id><published>2017-12-12T23:35:00.000+08:00</published><updated>2017-12-12T23:36:55.466+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 22]免費的CI Server - AppVeyor介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Hqy_fIdCFAM/Wi_1WP2OPOI/AAAAAAAAXAg/BORHmFVxd6kzd5pkQ0EUefHLMLruA3UFACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zjdjj5h1LMg/Wi_1ZW9EuGI/AAAAAAAAXAk/4LPLOVN9KkMtHWnTPnJkhDtNkY27Nb2JwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;span style="line-height: 1.6; font-size: 15px;"&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/span&gt;&lt;br&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;		在上一篇(&lt;a href="http://blog.alantsai.net/2017/07/devopsSeries-refactorScriptAndBuildServerIntro.html" target="_blank"&gt;[從.Net工程師的角度來看DevOps 21]Build階段的總結和重構 - Build Server介紹&lt;/a&gt;&lt;span style="line-height: 1.6;"&gt;)對我們的build script在做了一次重構之後，這篇我們來看看一個佛心的CI Server：Appveyor。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;		CI Server不是什麼新的概念，一直以來有一些免費的CI Server可以使用，例如Travis CI - 不過多是Linux base的Server。 		但是由於Windows版權的問題，.Net沒有什麼免費（至少從Open Source專案角度來看）的CI Server 可以用，直到AppVeyor的出現，和後來的Visual Studio Team Service。 		&lt;/p&gt;&lt;p&gt;		在這篇，將會簡單介紹AppVeyor，並且如何把我們的專案準備好，在下一篇在介紹如何整合AppVeryor執行我們的build script。 		&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513091861004651" ;=""&gt;AppVeyor小檔案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513091861004485" ;=""&gt;加入要自動建制的專案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513091861004920" ;=""&gt;用AppVeryor內建的方式來build專案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6;" href="#WizKMOutline_1513091861004674" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513091861004651"&gt;AppVeyor小檔案&lt;/h2&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;ul&gt;&lt;li&gt;官方網站：&lt;a href="https://www.appveyor.com/"&gt;https://www.appveyor.com/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;收費方式：Open Source專案免費，私人專案最低 每個月 29 美金。詳細請看：&lt;a href="https://www.appveyor.com/pricing/"&gt;https://www.appveyor.com/pricing/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;使用手冊：&lt;a href="https://www.appveyor.com/docs/"&gt;https://www.appveyor.com/docs/&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;		會需要先註冊一個帳號，註冊完之後會進入到&lt;code&gt;Projects&lt;/code&gt;的畫面，這邊我們就可以建立要CI執行的專案。 		&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513091861004485"&gt;加入要自動建制的專案&lt;/h2&gt;&lt;p&gt;		選擇&lt;code&gt;New Project&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jbcsgO3QHcs/Wi_1cOAICtI/AAAAAAAAXAo/8UUY1xgd1PUZCmYdpyou-kQ8uIRFm9aUwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="102" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MjC3PubPyYM/Wi_1fFR19MI/AAAAAAAAXAs/p3KKi7dR1Mo9mNxdhj8blykpQXb5ctyLgCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;選擇New Project&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;		這個專案在Github，所以要先授權讀取Github repo： 		&lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-4I8iJeA_SJE/Wi_1gW8qMzI/AAAAAAAAXAw/gs0xTT8Na5g6bUFDAigUm3NTYlJiprR5gCHMYCw/s1600-h/image%255B13%255D"&gt;&lt;img width="460" height="229" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-xT3_DApeqeo/Wi_1hhae-OI/AAAAAAAAXA0/vHIxKCUkotY5q2NVC72ZAw9pVwy6wswCwCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-qUwD6Wxhh80/Wi_1kSz4YhI/AAAAAAAAXA4/yHfjXfnHJrATGL5H4jrni7_ZEhGCzVvSwCHMYCw/s1600-h/image%255B12%255D"&gt;&lt;img width="372" height="417" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Uj0pOLRFjCg/Wi_1nFC6NbI/AAAAAAAAXA8/_KvWMoP1Cy4wsw42-jywCBKuDk5GZnAegCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;選擇授權github，在確認畫面記得如果專案在Organization要記得勾選&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;		確認之後，會回到AppVeyor的畫面，找到要自動建制的專案並且按下&lt;code&gt;Add&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jdyjPSwBW9E/Wi_1reqPDXI/AAAAAAAAXBA/PiCCOvYtQtgbRv3zml-C_ZdR81RdnCY8ACHMYCw/s1600-h/image%255B16%255D"&gt;&lt;img width="654" height="306" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Th8yQyb_iAU/Wi_1v3i2wgI/AAAAAAAAXBE/zYcsc6AtGkYEVK-9ZS98QV0CmG_j1JXqQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;加入要建制的專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;		加入了之後，會進入到這個專案的最新的build畫面（因為還沒有build過，所以是空的） 		&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9UqSmwtZ8tE/Wi_11SrTbHI/AAAAAAAAXBI/K58X9EM0UboCgiQ-Vrl7bGYUK94T1NlNACHMYCw/s1600-h/image%255B19%255D"&gt;&lt;img width="654" height="156" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OEb1SDGRzvg/Wi_16pTA4wI/AAAAAAAAXBM/mudHOp2AUu41HmKq7sKL2ir_8e1WX1qYwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;加入成功的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513091861004920"&gt;用AppVeryor內建的方式來build專案&lt;/h2&gt;&lt;p&gt;		先來試試看沒有build script的情況下如何直接用Appveyor來build專案。 		&lt;/p&gt;&lt;p&gt;		什麼都不設定直接按下build，發現有出現一個錯誤，從訊息來看是缺少nuget restore。 		&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WXeUfYRSxBA/Wi_1_F-eL9I/AAAAAAAAXBQ/EJehmmC6bxs42-8WOL9ZqucWUXOvjROYwCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="502" height="112" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zcyBkgISH84/Wi_2Cb77ZxI/AAAAAAAAXBU/IH3vaEC81ooAngIWRqbgVvc3N_FZymzZgCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-x2BS3MHFJzM/Wi_2ERZatJI/AAAAAAAAXBY/jEA_GIg4KfYtXXKfGOc-DiQYwIHFaWf6wCHMYCw/s1600-h/image%255B27%255D"&gt;&lt;img width="511" height="276" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rwDmLAmmpcw/Wi_2JgIbTOI/AAAAAAAAXBc/MUxsGSzQlucuaop6Tyr5JrbR79vnzR8zgCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;執行build之後，出現錯誤&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;		因此我們可以做一些設定： 		&lt;/p&gt;&lt;ol&gt;&lt;li&gt;切換到&lt;code&gt;Settings&lt;/code&gt;頁簽&lt;/li&gt;&lt;li&gt;選擇左邊&lt;code&gt;Build&lt;/code&gt;的選項&lt;/li&gt;&lt;li&gt;在&lt;code&gt;Visual Studio solution or project file&lt;/code&gt;先設定我們的sln位置，要不然AppVeryor會因為太多專案不知道建制那個而出錯。我們這邊輸入：&lt;kbd&gt;src\DevOpsUsingPsake.sln&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;再來要設定build之前要先restore，因此在&lt;code&gt;Before Build Script&lt;/code&gt;選擇&lt;code&gt;CMD&lt;/code&gt;&lt;/li&gt;&lt;li&gt;這個VM裡面已經設定好有nuget在path裡面，所以可以直接呼叫&lt;kbd&gt;nuget restore src\DevOpsUsingPsake.sln&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;最後把修改做了儲存&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-R-CrXpvxT5E/Wi_2NAz5dVI/AAAAAAAAXBg/ZRl5ZUNv794h29-__LVMGEH1Yn_znJUvwCHMYCw/s1600-h/image%255B30%255D"&gt;&lt;img width="654" height="564" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-6kXiLzanMyg/Wi_2lvlcg6I/AAAAAAAAXBk/ObjUv8pSQZ8GUGxDiCBmpEquUETpvjn0wCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;		設定完之後，在build一次，這次就會成功，可以再&lt;code&gt;Test&lt;/code&gt;頁簽看到我們的3個Test Dll。 		&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rhqiqUXiI_o/Wi_2nOA26XI/AAAAAAAAXBo/LhdhMlgTSjsDI_g4K3HRVLXKrstKu-BoQCHMYCw/s1600-h/image%255B33%255D"&gt;&lt;img width="654" height="267" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-3xdBXsbdvcA/Wi_2oMLvSCI/AAAAAAAAXBs/CHea2VfYoUwfJEpUWrk09mBlKjl1bOwtgCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;出現綠色表示建制成功，並且看到Test dll有出現&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;			直接用build server定義好的方式去建制CI其實非常容易，只是設定幾個值就建立好了。是不是有點覺得花那麼多時間來打造自己的script好像沒什麼意義？ 			&lt;/p&gt;&lt;p&gt;			用build server的方式是很容易，但是： 			&lt;/p&gt;&lt;ol&gt;&lt;li&gt;沒辦法local跑，換句話說本地跑的build和build server跑的可能不同&lt;/li&gt;&lt;li&gt;每家build server語法不同，如果有天要換要重新設定&lt;/li&gt;&lt;li&gt;假設設定改壞了，根本無法了解是誰改了設定&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513091861004674"&gt;結語&lt;/h2&gt;&lt;p&gt;		這篇是一個快速介紹如何使用Appveyor，並且看了如何用Appveyor的內建設定快速定義出如何build我們專案。 		&lt;/p&gt;&lt;p&gt;		雖然用Appveyor的設定方式很方便就設定好了建制設定，但是有一個local script還是非常有必要。 		&lt;/p&gt;&lt;p&gt;		因此，在下篇，將會看如何用Appveyor執行我們的Build Script。 		&lt;/p&gt;&lt;/section&gt;&lt;section&gt;			&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:1172fb07-5389-48a7-9844-7972b0461284" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag"&gt;「從.Net工程師的角度來看DevOps」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome 第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;&lt;/div&gt;		&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/490113770113340110/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-ci-server-appveyor-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/490113770113340110'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/490113770113340110'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/devopsSeries-ci-server-appveyor-intro.html' title='[從.Net工程師的角度來看DevOps 22]免費的CI Server - AppVeyor介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-zjdjj5h1LMg/Wi_1ZW9EuGI/AAAAAAAAXAk/4LPLOVN9KkMtHWnTPnJkhDtNkY27Nb2JwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4997983410084834705</id><published>2017-12-11T22:51:00.000+08:00</published><updated>2017-12-11T22:51:31.024+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='visual studio team service'/><title type='text'>[VSTS]如何調整Visual Studio Team Service的區域(Region)</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JZ8c6tkNVg8/Wi6aj9pe0GI/AAAAAAAAW_Q/Vb3oNvucAzUWv8FQlb5DIYv4O4-EXcrtwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9e4rgFpk4zU/Wi6almoH-xI/AAAAAAAAW_U/_DNC5dWWcGIlyTL3LR1Ex4y8O1BvZ_2DgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  Visual Studio Team Services (VSTS) 可以簡單理解成為雲端版的Team Foundation Server (TFS)，而且微軟很佛心的讓5人以下團隊免費使用。   &lt;/p&gt;&lt;p&gt;  在建立VSTS的時候，有個選項是VSTS的資料要放在哪個區域（Region）。早期的時候，只有在美國，現在的話在東亞（East Asia）也有辦法建立了。   &lt;/p&gt;&lt;p&gt;  不過如果是早期建立在美國的VSTS是否能夠移動到East Asia呢？這篇將會介紹如何透過寫VSTS的support ticket來達到這個轉換。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1513002513768575" ;=""&gt;檢查目前的VSTS所在Region&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1513002513769260" ;=""&gt;透過VSTS support來改Region&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1513002513769348" ;=""&gt;建立一個support ticket&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1513002513769369" ;=""&gt;回答相關email&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1513002513769181" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513002513768575"&gt;檢查目前的VSTS所在Region&lt;/h2&gt;&lt;p&gt;  在移動之前，要先檢查一下目前自己帳號的所在Region。檢查方式很簡單，直接進入到VSTS的&lt;em&gt;設定&lt;/em&gt;即可，也可以透過下面的網址直接進入到正確的位置（注意要把&lt;code&gt;{你的VSTS帳號}&lt;/code&gt;改成你的帳號）：   &lt;/p&gt;&lt;code&gt;https://{你的VSTS帳號}.visualstudio.com/_admin/_home/settings&lt;/code&gt;&lt;p&gt;  在上面的部分會看到你的Region，譬如我的之前是North Central US：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3MqhLm3Cl9c/Wi6amxRfGwI/AAAAAAAAW_Y/PYB6XHibDjYvLbSZ21qPmsPENMYy9otXACHMYCw/s1600-h/1%255B5%255D"&gt;&lt;img width="404" height="275" title="1" style="display: inline; background-image: none;" alt="1" src="https://lh3.googleusercontent.com/-citw2Yw0HYw/Wi6aoCOW8AI/AAAAAAAAW_c/hLrLQDC7p44uayc0UfZncNmT8iG1Y955gCHMYCw/1_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;檢查目前的region&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513002513769260"&gt;透過VSTS support來改Region&lt;/h2&gt;&lt;p&gt;  要改VSTS的region只能透過寫support給微軟的人，整個流程大概如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;建立一個support ticket&lt;/li&gt;&lt;li&gt;回答相關email&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513002513769348"&gt;建立一個support ticket&lt;/h3&gt;&lt;p&gt;  首先，先到&lt;a href="https://www.visualstudio.com/team-services/support/#vsts-support"&gt;https://www.visualstudio.com/team-services/support/#vsts-support&lt;/a&gt;然後選擇：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Technical Report&lt;/li&gt;&lt;li&gt;Basic Support&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rO5i38R_qEE/Wi6apRBjMFI/AAAAAAAAW_g/tsX3xcrGbcAGiYPS1vHkW2L7Hpjk8IE9ACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="441" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-TBsNFHTimk0/Wi6aqnT_o5I/AAAAAAAAW_k/odb4hlABscUCk77BD3b3ralgk3DSAdQ-wCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;選擇Basic Support&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  在選擇問題類型裡面：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Configuring Team Services&lt;/li&gt;&lt;li&gt;Changing Account Region&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WLseJgTkTEU/Wi6atiAC8gI/AAAAAAAAW_o/eExCKWMuDGQ9rm6CyF1NVO8F7eNPmodGQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="614" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-iyxlA7rG0DA/Wi6axS28OeI/AAAAAAAAW_s/3vGKZSstC6gB2ke9EkQh4zBHxozlkTyBwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;選擇要調整account region&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  要填入一些聯絡資訊，如果已經有登入微軟帳號，那麼會自動帶入一些資訊。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   要注意，email和電話都是聯絡的到，因為之後微軟的support會用這些資訊來聯絡。   &lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6qeI7__SGJg/Wi6azUeAp_I/AAAAAAAAW_w/VOt9XPp-1ngqabGmEfxb3NXTTWVIGZMGACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="499" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-PTcvh_FwPH4/Wi6a3bzqWXI/AAAAAAAAW_0/rYaDJgWF04sI5_9uVezXYbpj2uTCkMqBQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;填入聯絡的到的資訊&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  有幾個資訊要輸入：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;第一個輸入的是&lt;em&gt;標題&lt;/em&gt;，我輸入的是：&lt;code&gt;Would like to change the account region&lt;/code&gt;&lt;/li&gt;&lt;li&gt;第二個輸入的是&lt;em&gt;你的VSTS網址&lt;/em&gt;：這邊注意一下，只輸入&lt;em&gt;1個&lt;/em&gt;VSTS帳號&lt;/li&gt;&lt;li&gt;第三個輸入的是&lt;em&gt;詳細描述&lt;/em&gt;：記得要提到想要換到那個region。我這邊輸入的是：&lt;code&gt;I am the owner of the above 5 account I would like to change the region to East Asia Thank you&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-hXQYfGT0gMc/Wi6a5SA5lyI/AAAAAAAAW_4/frU1A1YNk54QqyPcOvTYn_xA0Y19097SACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="566" height="871" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-aDlUXY7sOJU/Wi6a8f06ARI/AAAAAAAAW_8/620yQj2DqiUIZXpjInqOTZKjfEj2xHuzwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;輸入相關問題資訊&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;   這邊注意一下，我手邊有5個帳號，本來想說一起處理，但是一張單只能&lt;em&gt;處理一個帳號&lt;/em&gt;，所以假設有5個帳號，要建立&lt;em&gt;5個獨立的單&lt;/em&gt;。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1513002513769369"&gt;回答相關email&lt;/h3&gt;&lt;p&gt;  稍等一段時間之後，會有一封mail寄送到當初聯絡資訊所填的email，會請你確認5個事情：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;本來VSTS的原始Region - 他的問題裡面有把答案寫在裡面，以我的例子是：&lt;code&gt;NCUS&lt;/code&gt;&lt;/li&gt;&lt;li&gt;要轉換過去的Region - 他的問題裡面有把答案寫在裡面，以我的例子是：&lt;code&gt;East Asia&lt;/code&gt;&lt;/li&gt;&lt;li&gt;要告訴他什麼時候可以轉移，轉移期間無法連到你的帳號，而轉移時間差不多要&lt;em&gt;~5個小時&lt;/em&gt;，因此要告訴他用UTC的時間什麼時候可以。例如：&lt;code&gt;Anytime on Weekends&lt;/code&gt;（週末任意時間）&lt;/li&gt;&lt;li&gt;說明當初為什麼沒有選East Asia作為region，以我的例子是：&lt;code&gt;East Asia was not available by the time I sign up.&lt;/code&gt;&lt;/li&gt;&lt;li&gt;最後問到有沒有用到hosted xaml build controller - 直接就是&lt;code&gt;NO&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;   這封email也有提到，有些資料是移轉不過去的，這些資料比較偏meta類型，例如帳號的profile資訊。   &lt;/div&gt;&lt;p&gt;  之後就會開始轉移，轉移完成之後會有一封請你確認是否有問題，沒有的話就完成了。   &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1513002513769181"&gt;結語&lt;/h2&gt;&lt;p&gt;  修改VSTS的region其實沒有很困難，只是整個流程並沒有非常明確，希望透過這篇能夠讓希望換VSTS region的人了解整個流程。   &lt;/p&gt;&lt;p&gt;  至於換到East Asia差異有沒有很大，個人覺得速度好像有比較快，但是也有可能是心理作用。到底要不要換就看個人了。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:dd9a0b1b-621c-48bb-9f68-d9731b8cb19b" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/visual+studio+team+service" rel="tag"&gt;visual studio team service&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4997983410084834705/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/vsts-how-to-change-account-region-to-east-asia.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4997983410084834705'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4997983410084834705'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/vsts-how-to-change-account-region-to-east-asia.html' title='[VSTS]如何調整Visual Studio Team Service的區域(Region)'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-9e4rgFpk4zU/Wi6almoH-xI/AAAAAAAAW_U/_DNC5dWWcGIlyTL3LR1Ex4y8O1BvZ_2DgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5652348508769011891</id><published>2017-12-10T23:23:00.000+08:00</published><updated>2017-12-10T23:23:10.435+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[faq]解決C#呼叫有ssl憑證問題的網站出現遠端憑證是無效的錯誤問題</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JYd3W8Ook2Y/Wi1QcHlRr7I/AAAAAAAAW-s/biOWa3XejEQJyP9rC-ZA521hbEt8ZLWewCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-mlITbC1NRKc/Wi1QdHm9yKI/AAAAAAAAW-w/zdMy8P__aQAQLHQgpASXjp8NQScVCrQxACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  有時候需要在C#的程式裡面發出request和內部或者外部的服務溝通，如果內部或者外部的服務&lt;em&gt;只允許https連線&lt;/em&gt;，而且的ssl憑證&lt;em&gt;並沒有經過認證&lt;/em&gt;（有可能是用self signed certifcate），那麼C#會直接出錯：   &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Zppc3bujlHs/Wi1QhO4A1zI/AAAAAAAAW-0/O1O1FJq8p8M4ki9uUA7QIOPaY-F151A7ACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="275" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dsSLVwhu-Wk/Wi1Qj9_iKwI/AAAAAAAAW-4/1GkNKUWfdcQ22In15KkfHn0yRaRb6HKhwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;錯誤訊息範例畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   system.security.authentication.authenticationexception the remote certificate is invalid according to the validation procedure    &lt;/p&gt;&lt;p&gt;   System.Net.Http.HttpRequestException: 傳送要求時發生錯誤。 ---&amp;gt; System.Net.WebException: 基礎連接已關閉: 無法為 SSL/TLS 安全通道建立信任關係。&lt;br /&gt;---&amp;gt; System.Security.Authentication.AuthenticationException: 根據驗證程序，遠端憑證是無效的。    &lt;/p&gt;&lt;/div&gt;&lt;p&gt;  一般來說要解決這個問題有兩個做法：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;把self sign的certificate裝到程式的機器上面並且信任那個憑證&lt;/li&gt;&lt;li&gt;在送出request的時候做一些特殊處理&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  這篇將會對於第二個做法，調整程式讓發出request遇到這種問題的時候能夠處理這種問題。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512918951204683" ;=""&gt;問題發生原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512918951204650" ;=""&gt;解決方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512918951204652" ;=""&gt;.Net Framework裡面的處理方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512918951204800" ;=""&gt;.Net Core裡面的處理方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512918951204346" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512918951204683"&gt;問題發生原因&lt;/h2&gt;&lt;p&gt;  基本上合法的ssl憑證一定會是由一個可信任的機構發出，不過有時候有些服務只是要&lt;em&gt;把通訊的管道加密&lt;/em&gt;，為了節省成本（或者其他什麼原因）而使用了self sign certificate (自我簽章的憑證)。   &lt;/p&gt;&lt;p&gt;  理論上任何會對外被呼叫到的https網站都不應該用self sign certificate，因此，從C#發出的https request（不管是用&lt;code&gt;WebClient&lt;/code&gt;還是&lt;code&gt;HttpClient&lt;/code&gt;）都會&lt;em&gt;檢查ssl憑證是否合法&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;  也就是因為這個檢查導致出現錯誤。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512918951204650"&gt;解決方式&lt;/h2&gt;&lt;p&gt;  取決於你的target platform是什麼，有兩種解決方式：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;.Net Framework裡面的處理方式&lt;/li&gt;&lt;li&gt;.Net Core裡面的處理方式&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512918951204652"&gt;.Net Framework裡面的處理方式&lt;/h3&gt;&lt;p&gt;   基本上有個&lt;em&gt;全域&lt;/em&gt;的事件叫做&lt;code&gt;ServicePointManager.ServerCertificateValidationCallback&lt;/code&gt;會在ssl憑證驗證的時候被觸發，因此假設不管檢查結果是如何，&lt;em&gt;都要通過&lt;/em&gt;的情況下，可以再&lt;em&gt;系統啟動的時候&lt;/em&gt;呼叫：    &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;ServicePointManager.ServerCertificateValidationCallback +=&lt;br /&gt; (sender, cert, chain, sslPolicyErrors) =&amp;gt; true;&lt;/pre&gt;&lt;p&gt;   不過這個有點太大，因此建議還是&lt;em&gt;針對性&lt;/em&gt;的去通過比較好，舉例來說，假設有ssl憑證的host是：&lt;code&gt;problem.com&lt;/code&gt;，那麼可以只當host是&lt;code&gt;problem.com&lt;/code&gt;的情況下有驗證錯誤在過，範例如下： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;ServicePointManager&lt;br /&gt;   .ServerCertificateValidationCallback +=&lt;br /&gt;  (sender, cert, chain, sslPolicyErrors) =&amp;gt;&lt;br /&gt;   {&lt;br /&gt;    if (sslPolicyErrors == SslPolicyErrors.None)&lt;br /&gt;    {&lt;br /&gt;     return true;&lt;br /&gt;    }&lt;br /&gt;    var request = sender as HttpWebRequest;&lt;br /&gt;    if (request != null)&lt;br /&gt;    {&lt;br /&gt;     var result = request.RequestUri.Host == "problem.com";&lt;br /&gt;&lt;br /&gt;     return result;&lt;br /&gt;    }&lt;br /&gt;    return false;&lt;br /&gt;   };&lt;/pre&gt;&lt;p&gt;   程式應該還蠻好理解：    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;如果ssl驗證沒有錯誤，直接回傳過(true)&lt;/li&gt;&lt;li&gt;判斷request的host是不是符合我們已知有問題憑證的host - 如果是就回傳過(true)&lt;/li&gt;&lt;li&gt;要不然都不過(false)&lt;/li&gt;&lt;/ul&gt;&lt;div class="bs-callout bs-callout-info"&gt;    或許你會說幹嘛這麼麻煩，何不都過就好？這個其實是為了明確定義那些是特例可以通過，那些不可以。     要記得，這個修改是&lt;em&gt;全域&lt;/em&gt;都有作用，換句話說所有送出的request，包含像是Xml Web Service這種reference都會吃，因此明確一點比較好。    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512918951204800"&gt;.Net Core裡面的處理方式&lt;/h3&gt;&lt;p&gt;   在.Net Core裡面會發現沒有&lt;code&gt;ServicePointManager&lt;/code&gt;，只有在&lt;code&gt;HTTPClient 4.1&lt;/code&gt;的版本以上有支援可以再request裡面設定（其實.Net Framework如果用的也是HttpClient 4.1 以上也可以用這種方式）：    &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;var handler = new HttpClientHandler();&lt;br /&gt;handler.ClientCertificateOptions = ClientCertificateOption.Manual;&lt;br /&gt;handler.ServerCertificateCustomValidationCallback = &lt;br /&gt;    (httpRequestMessage, cert, cetChain, policyErrors) =&amp;gt;&lt;br /&gt; {   &lt;br /&gt;  return true;&lt;br /&gt; };&lt;br /&gt;var client = new HttpClient(handler);&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;    因為這個設定是和某一個client有關，因此直接全部return true比較不會有問題 - 不像上面是一個全域的事件。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512918951204346"&gt;結語&lt;/h2&gt;&lt;p&gt;  基本上這個問題透過google就能夠找到，不過比較少有提到判斷host的部分（都是直接return true），因此這邊做一個記錄方便以後找到。   &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:c2375ff5-6582-4564-b6b9-51284622d184" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/C%23" rel="tag"&gt;C#&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5652348508769011891/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/csharp-ssl-remote-validation-error.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5652348508769011891'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5652348508769011891'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/csharp-ssl-remote-validation-error.html' title='[faq]解決C#呼叫有ssl憑證問題的網站出現遠端憑證是無效的錯誤問題'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-mlITbC1NRKc/Wi1QdHm9yKI/AAAAAAAAW-w/zdMy8P__aQAQLHQgpASXjp8NQScVCrQxACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2533921755865525922</id><published>2017-12-06T01:25:00.000+08:00</published><updated>2017-12-06T01:29:11.343+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='tool'/><title type='text'>[tool]沒有mail server怎麼測試寄送email？快放過你的gmail來看看有那些可以測試用的smtp mail server</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-VrTxp3T_ihA/WibUaWxcEuI/AAAAAAAAW4w/Hj6LaShB_BEIN9Q56DQudHAoMq9Q7nzgwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-3iuRgH1PUEU/WibUb0AAadI/AAAAAAAAW40/NnFvDrOliscxqY8hk7hpjICyOnWLS_GAACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  不管什麼系統，只要需要通知使用者基本上都是使用email(電子郵件)方式通知，因此寄送email基本上是大部分系統都會需要的功能。   &lt;/p&gt;&lt;p&gt;  雖然正式環境一定會有mail server給我們使用，但是當我們在開發階段的時候，有時候需要測試寄送出來的mail內容是不是正確、有沒有跑版等問題，這個時候有一個測試用的mail server變得非常重要。   &lt;/p&gt;&lt;p&gt;  以前最常見應該就是借用gmail的mail server來測試發信，不過那個設定有些步奏，並且gmail也有做出一些限制，因此放過你的gmail吧，來看看有什麼工具可以讓我們測試email寄送。   &lt;/p&gt;&lt;p&gt;  關鍵字：測試mail server、測試smtp、mailtrap、smtp4dev、papercut、直接寫道檔案系統   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;   測試機送mail的sample程式在github：&lt;a href="https://github.com/alantsai-samples/dotnet-sendmail-smtp-server-review"&gt;dotnet-sendmail-smtp-server-review&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;  &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810434" ;=""&gt;比較表 - TL;DR&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810327" ;=""&gt;MailTrap&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810256" ;=""&gt;準備使用&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810445" ;=""&gt;測試結果&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810298" ;=""&gt;smtp4dev&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810946" ;=""&gt;準備環境&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810913" ;=""&gt;測試結果&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810155" ;=""&gt;papercut&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810819" ;=""&gt;準備環境&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810886" ;=""&gt;測試結果&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810316" ;=""&gt;直接寫到檔案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810783" ;=""&gt;準備環境&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810606" ;=""&gt;測試結果&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810303" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;  &lt;a name='more'&gt;&lt;/a&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810434"&gt;比較表 - TL;DR&lt;/h2&gt;&lt;p&gt;  這邊將會像大家介紹4個工具：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;MailTrap&lt;/li&gt;&lt;li&gt;Smtp4Dev&lt;/li&gt;&lt;li&gt;papercut&lt;/li&gt;&lt;li&gt;直接寫到檔案&lt;/li&gt;&lt;/ol&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;&lt;a href="#WizKMOutline_1512493572810327"&gt;&lt;font color="#0000ff"&gt;MailTrap&lt;/font&gt;&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href="#WizKMOutline_1512493572810298"&gt;&lt;font color="#0000ff"&gt;Smtp4dev&lt;/font&gt;&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href="#WizKMOutline_1512493572810155"&gt;&lt;font color="#0000ff"&gt;papercut&lt;/font&gt;&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href="#WizKMOutline_1512493572810316"&gt;&lt;font color="#0000ff"&gt;直接寫到檔案&lt;/font&gt;&lt;/a&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否需要連網?&lt;/th&gt;&lt;td&gt;✔&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✖&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✖&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✖&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否需要執行程式?&lt;/th&gt;&lt;td style="background-color: yellow;"&gt;✖&lt;/td&gt;&lt;td&gt;✔&lt;/td&gt;&lt;td&gt;✔&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✖&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否能直接看到html呈現結果?&lt;/th&gt;&lt;td style="background-color: yellow;"&gt;✔&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✔&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;是否提供轉寄功能?&lt;/th&gt;&lt;td&gt;✖(付費版有)&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;td style="background-color: yellow;"&gt;✔&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;檢查html和css是否合法和垃圾郵件分數?&lt;/th&gt;&lt;td style="background-color: yellow;"&gt;✔&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;td&gt;✖&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;運作機制&lt;/th&gt;&lt;td&gt;Online服務提供測試的smtp server&lt;/td&gt;&lt;td&gt;建立local samtp server&lt;/td&gt;&lt;td&gt;建立local samtp server&lt;/td&gt;&lt;td&gt;把寄送mail內容寫到檔案&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;  一般來說，我的使用順序會是：&lt;em&gt;MailTrap &amp;gt; smtp4dev &amp;gt; 直接寫到檔案 &amp;gt; papercut&lt;/em&gt;&lt;/p&gt;&lt;p&gt;  Mailtrap能夠直接看到html內容，並且可以檢查html和css是否合法，最後能夠檢查出spam（垃圾郵件）指數。   &lt;/p&gt;&lt;p&gt;  不過有時候開發沒有網路的話，那麼就沒辦法用mailtrap，這個時候會改成使用smtp4dev只是用來收mail。   &lt;/p&gt;&lt;p&gt;  如果是在&lt;em&gt;正式機器&lt;/em&gt;需要測試mail寄送，這個時候就會使用&lt;em&gt;直接寫到檔案&lt;/em&gt;的方式來達到 - 因為在正式機器不一定能夠架設一個暫時的smtp server，因此smtp4dev無法使用。   &lt;/p&gt;&lt;p&gt;  只有當沒有網路並且要測試檢視html內容的時候才會考慮使用papercut。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810327"&gt;MailTrap&lt;/h2&gt;&lt;p&gt;  Mailtrap是一個網路的服務，最主要的好處是能夠直接看到html內容並且能夠檢查html和vss是否都合法，最後裡面也有一個檢查spam指數。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810256"&gt;準備使用&lt;/h3&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;ul&gt;&lt;li&gt;服務網址：&lt;a href="https://mailtrap.io/"&gt;https://mailtrap.io/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;      免費版提供了一個mail box裡面最多可以放50封email。如果需要其他功能例如收到的mail轉寄等功能可以參考不同費用的差異：&lt;a href="https://mailtrap.io/pricing"&gt;https://mailtrap.io/pricing&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;  基本上和一般註冊服務沒什麼兩樣，註冊完了之後，可以直接建立一個&lt;em&gt;inbox&lt;/em&gt;：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vUCfKYxedM0/WibUct6Ht0I/AAAAAAAAW44/g1Ybqs7_goo2wvQAFTCPPVt7GB8Ee7vAgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="175" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-yVOaHqw3Kzo/WibUeLD8woI/AAAAAAAAW48/dv3zahtgwq0eeSmXEH6pzU7GTjQJtzkpQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;建立一個box&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  建立出來了之後，可以直接點進去會看到：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;smtp的host&lt;/li&gt;&lt;li&gt;smtp的帳號&lt;/li&gt;&lt;li&gt;smtp的密碼&lt;/li&gt;&lt;li&gt;可以切換到C#&lt;/li&gt;&lt;li&gt;直接看到如何使用的範例程式碼&lt;/li&gt;&lt;li&gt;可以直接重新產生帳號和密碼&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-nHcQM5n6XPo/WibUfS8dlzI/AAAAAAAAW5A/TCLp_DRJT8EBaPviHMruy_I0z-E-ouopgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="415" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-opIxmhgWcAE/WibUhUgj5AI/AAAAAAAAW5E/Syaf6edaB9EEcMN2cMmVuDV6PyORhE4gACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;取得mailtrap相關的資訊&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  有了這些資訊之後，可以再&lt;code&gt;App.config&lt;/code&gt;裡面設定成為：   &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;system.net&amp;gt;&lt;br /&gt;    &amp;lt;mailSettings&amp;gt;&lt;br /&gt;      &amp;lt;smtp from="test@test.com"&amp;gt;&lt;br /&gt; &amp;lt;network enableSsl="true" userName="{你的帳號}" password="{你的密碼}"&lt;br /&gt;                  host="smtp.mailtrap.io"/&amp;gt;&lt;br /&gt;      &amp;lt;/smtp&amp;gt;&lt;br /&gt;    &amp;lt;/mailSettings&amp;gt;&lt;br /&gt;&amp;lt;/system.net&amp;gt;&lt;/pre&gt;這邊把帳號和密碼改成你帳號裡面的值。   &lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810445"&gt;測試結果&lt;/h3&gt;&lt;p&gt;   在inbox裡面會多出一封mail，點下去之後：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-LvoLHYVUcS0/WibUifjdDUI/AAAAAAAAW5I/DMeteoRSPAYeRlUP6N__drTfQBRyl_1wACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="270" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-JK0-sK9usCQ/WibUkRFt7II/AAAAAAAAW5M/02xDl9pQIQEAwGEdfbXCLrwwk6OJCDKcACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;第一個頁簽可以看到html呈現的結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   切換到&lt;code&gt;Analysis&lt;/code&gt;頁簽可以看到：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Spam Score - 被歸到垃圾郵件的可能性分數 - 以我們這個為例子看起來還好&lt;/li&gt;&lt;li&gt;右邊有詳細每一個分數說明，並且如果對於每一個規則有疑問可以點下去會到wikpedia看到更多資訊&lt;/li&gt;&lt;li&gt;下面還會分析寄送來源的domain是不是屬於被黑名單&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-uyGgTSU1Hq4/WibUmMnWWfI/AAAAAAAAW5Q/Ruf_cwNfnsUZH5K61rxGh7IbHQV4ktelwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="373" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tbMxCGfFkt0/WibUpf4eTzI/AAAAAAAAW5U/5yf6oJFy7-AuNq2iGTgFd_Z-2WV9JhrnACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;Analysis指數說明&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    這邊注意一下，Spam Score還是屬於一個參考值，低不代表就不會被歸類在垃圾郵件，畢竟還是要看收的client端的設定。    &lt;/div&gt;&lt;p&gt;   切換到&lt;code&gt;Check Html&lt;/code&gt;的頁簽，可以看到檢查email的html和css是否符合規範。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-VmILhxXTHI0/WibUrNgxFOI/AAAAAAAAW5Y/3z5chtqmHnITort0rAbqpdPgkeR0k0OUACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="228" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-o0A0sZ0iDXo/WibUuckTSoI/AAAAAAAAW5c/WLnQvhJoOcAB2xDp1pwNpDQrKdenfwY0gCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;這筆email的html和css沒有問題&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;p&gt;  以上就是mailtrap的使用方式，和特色的部分，接下來看看&lt;em&gt;smtp4dev&lt;/em&gt;。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810298"&gt;smtp4dev&lt;/h2&gt;&lt;p&gt;  這個工具是一個windows程式，開啟之後會建立一個smtp server在指定的port，因此mail寄送到這個工具裡面。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810946"&gt;準備環境&lt;/h3&gt;&lt;div class="bs-callout bs-callout-info"&gt;    程式小檔案：     &lt;ul&gt;&lt;li&gt;github官網：&lt;a href="https://github.com/rnwood/smtp4dev"&gt;https://github.com/rnwood/smtp4dev&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載：&lt;a href="https://github.com/rnwood/smtp4dev/releases/download/v2.0.10/smtp4dev-2.0.10-binaries.zip"&gt;smtp4dev 2.0.10&lt;/a&gt;&lt;/li&gt;&lt;li&gt;目前版本：v 2.0.10&lt;/li&gt;&lt;li&gt;檔案大小：約444 kb&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;    smtp4dev最新版本是v3，這個版本用的是.Net Core並且改成使用web界面在瀏覽，這邊使用的還是v2的版本，因為windows程式很小run起來也不佔資源。    &lt;/div&gt;&lt;p&gt;   下載好之後，直接run起來，一開始會有一個防火墻規則要開通：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-AecQYN0g3YE/WibUvn2unAI/AAAAAAAAW5g/Pz3PaPVi0eoW_GbtogmBqDg8Xt7tWddXgCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="474" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Wf6njuCPriM/WibUyPEiliI/AAAAAAAAW5k/zu6qWtrszwQRsHjQFDjP7Z3fwbLwcMhRQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;開通防火墻&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   預設聽的是port 25，假設要改可以透過&lt;code&gt;options&lt;/code&gt;裡面的&lt;code&gt;server&lt;/code&gt;頁簽，然後修改&lt;code&gt;port numbers&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-nJtCz9ScWfw/WibUz6uv0hI/AAAAAAAAW5o/zEENUZt1fxUrmc3fGPmcWwnP691eLLtoQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="390" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Rv5A4U4skMQ/WibU3XNsyII/AAAAAAAAW5s/ELCFRTPgnwUTN8LKMha5THaREMLChXA3QCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;預設聽的port&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   調整&lt;code&gt;App.config&lt;/code&gt;如下：    &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;system.net&amp;gt;&lt;br /&gt;    &amp;lt;mailSettings&amp;gt;&lt;br /&gt;      &amp;lt;smtp from="test@test.com"&amp;gt;&lt;br /&gt;        &amp;lt;network host="localhost"/&amp;gt;&lt;br /&gt;      &amp;lt;/smtp&amp;gt;&lt;br /&gt;    &amp;lt;/mailSettings&amp;gt;&lt;br /&gt;&amp;lt;/system.net&amp;gt; &lt;br /&gt;   &lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810913"&gt;測試結果&lt;/h3&gt;&lt;p&gt;   用和上一封一樣的mail內容，寄送出去之後，會看到清單會有一筆資料，可以點下&lt;code&gt;Inspect&lt;/code&gt;來看內容：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Rl_43wwDfhE/WibU7CcNpUI/AAAAAAAAW5w/ysc0bbd2Bzcn4H2y8cUkMVenHdB15ekTACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="143" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Qm0AEMhf9e8/WibU_JMHCtI/AAAAAAAAW50/OvehBoA4Ns4WJ_Y7-gdyEgliLDmEpLN0ACHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;看mail內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   無法看到html的render內容，如果要看到，需要有一個mail的工具（例如outlook或者thunderbird），然後按下&lt;code&gt;View&lt;/code&gt;就可以。    &lt;/p&gt;&lt;/section&gt;&lt;p&gt;  smtp4dev和mailtrap比起來的好處是&lt;em&gt;不需要網路&lt;/em&gt;，但是看html內容不方便。如果需要看html的呈現結果，但是又不想聯網，可以使用papercut。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810155"&gt;papercut&lt;/h2&gt;&lt;p&gt;  papercut和smtp4dev是同一種類型的軟體，都是建立一個stmp的server。   &lt;/p&gt;&lt;p&gt;  papercut比smtp4dev的功能還來得豐富，例如轉寄出去等，不過這邊比較關注的是html呈現的部分。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810819"&gt;準備環境&lt;/h3&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1512493572810569"&gt;程式小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;Github官網：&lt;a href="https://github.com/ChangemakerStudios/Papercut"&gt;https://github.com/ChangemakerStudios/Papercut&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載：&lt;a href="https://github.com/ChangemakerStudios/Papercut/releases/download/5.0.9/Papercut.5.0.9.zip"&gt;Papercut 5.0.9&lt;/a&gt;&lt;/li&gt;&lt;li&gt;目前版本：v5.0.9&lt;/li&gt;&lt;li&gt;檔案大小：約8.9MB&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;   和smtp4dev一樣，啟動的時候會需要開啟防火墻：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-TUITnrzIons/WibVBOlsQ9I/AAAAAAAAW54/QlFWTFM34-ENp_Fsr-panRWHdwVTMciuACHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="498" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-n-pOvLH9ln0/WibVDIYcbqI/AAAAAAAAW58/Cb3nQKoLcRcTBZ0Z6O4g32TEg_3MMYuvACHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定防火墻&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   預設port是25，如果要改可以透過&lt;code&gt;option&lt;/code&gt;裡面的&lt;code&gt;port來調整&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HDz9sCjt_8A/WibVEKZYJ8I/AAAAAAAAW6A/W4DuUB4UW3w2DumdwRLpyYHetU4iRt2CQCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="308" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-iNj_knUQBt4/WibVFs62DAI/AAAAAAAAW6E/tTT_zV1Syc8OhF2XoiDHslFWDI1cbxPggCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定port&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810886"&gt;測試結果&lt;/h3&gt;&lt;p&gt;   mail內容和設定可以和smtp4dev一樣，因此可以不用改，直接把程式run起來即可。    &lt;/p&gt;&lt;p&gt;   執行出來的結果如下：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-V1H__Tk7ElY/WibVGmAIdFI/AAAAAAAAW6I/m5YOTiifBLU0lhDDs50oN6pQ7UkdRl66QCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="521" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2I_3fhPseUU/WibVHhEG5NI/AAAAAAAAW6M/ku-autMtMIskMJdhSWuZHLP1_lEfymdrQCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;mail內容&lt;/figcaption&gt;&lt;/figure&gt;    可以看到html內容會直接呈現出來。    &lt;/section&gt;&lt;p&gt;  papercut和smtp4dev除了html的部分還有就是轉寄(forward)的功能 - 這個轉寄功能還可以透過設定規則(rule)的方式來自動接到特定mail的時候自動轉寄出去。   &lt;/p&gt;&lt;p&gt;  一般來說papercut是當&lt;em&gt;沒有網路&lt;/em&gt;的時候，要看email的&lt;em&gt;html呈現&lt;/em&gt;才會使用。   &lt;/p&gt;&lt;p&gt;  有時候在正式機器需要測試寄送mail的內容，但是又沒辦法執行程式建立暫時的smtp server，這個時候就可以使用把mail寫到檔案的方式。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810316"&gt;直接寫到檔案&lt;/h2&gt;&lt;p&gt;  如果沒有網路，並且沒有上面提到的兩個程式（或者因為權限的關係無法執行起來），那麼就可以用直接寫道檔案的方式。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810783"&gt;準備環境&lt;/h3&gt;&lt;p&gt;   這個方式不需要安裝或者註冊什麼，只需要調整設定&lt;code&gt;App.config&lt;/code&gt;即可：    &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;system.net&amp;gt;&lt;br /&gt;    &amp;lt;mailSettings&amp;gt;&lt;br /&gt;      &amp;lt;smtp from="test@test.com" deliveryMethod="SpecifiedPickupDirectory"&amp;gt;&lt;br /&gt;        &amp;lt;specifiedPickupDirectory pickupDirectoryLocation="d:\temp\mail" /&amp;gt;&lt;br /&gt;      &amp;lt;/smtp&amp;gt;&lt;br /&gt;    &amp;lt;/mailSettings&amp;gt;&lt;br /&gt;&amp;lt;/system.net&amp;gt;&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;這邊主要設定會把mail內容寫到資料夾：&lt;code&gt;d:\temp\mail&lt;/code&gt;下面。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt; 這邊注意一下，資料夾是要存在的位置，如果不存在會出錯。 &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1512493572810606"&gt;測試結果&lt;/h3&gt;&lt;p&gt;   直接把測試軟體run起來寄送email，會在資料夾&lt;code&gt;d:\temp\mail&lt;/code&gt;多出一個guid名稱的檔案：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-tZx6jVrRhr0/WibVIrUx_qI/AAAAAAAAW6Q/HbqFnxRdBuIoPkFCAr3EmBVq4dbBIaaQwCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="394" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OKipA1nW-Os/WibVKdW1_mI/AAAAAAAAW6U/icqpe7Er3XcXXHGev7-KePKSlXSgngX0ACHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;呈現結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;p&gt;  這個方式非常簡單，不需要任何服務或者任何軟體，隨時都可以設定，因此非常適合&lt;em&gt;比較無法控制的環境&lt;/em&gt;測試的時候使用。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512493572810303"&gt;結語&lt;/h2&gt;&lt;p&gt;  寄送mail是個很常見的功能，因此在開發或者測試的時候能夠測試寄送mail變得很重要。   &lt;/p&gt;&lt;p&gt;  希望透過這篇能夠讓未來要測試寄送mail的時候變得更加方便和容易。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:b7d2b3cb-4fa6-4cb1-bae2-b6a644325ca4" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/tool" rel="tag"&gt;tool&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2533921755865525922/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/12/test-smtp-server-for-sending-mail-in-development.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2533921755865525922'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2533921755865525922'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/12/test-smtp-server-for-sending-mail-in-development.html' title='[tool]沒有mail server怎麼測試寄送email？快放過你的gmail來看看有那些可以測試用的smtp mail server'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-3iuRgH1PUEU/WibUb0AAadI/AAAAAAAAW40/NnFvDrOliscxqY8hk7hpjICyOnWLS_GAACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4085407163155335866</id><published>2017-11-30T23:47:00.000+08:00</published><updated>2017-11-30T23:47:36.208+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='tool'/><category scheme='http://www.blogger.com/atom/ns#' term='iis'/><title type='text'>[iis]為什麼ssl cipher suite關閉了檢查還是有出現問題 - 如何local檢查ssl和cipher suite</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zIxFefLwkvQ/WiAmwU4mjmI/AAAAAAAAW3I/wh0SnylO9T8vh9xXLbfFSgsA-8bmyb9dwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-KPjS6gF75PI/WiAmx-fcEII/AAAAAAAAW3M/qiHrJmG244AdDdAJWWVtDOiO7HF5AxGpQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  之前有介紹透過使用IISCrypto來快速設定SSL相關的資安設定。正常來說只要重啟以後禁用的ssl和cipher suite應該就不會出現。   &lt;/p&gt;&lt;p&gt;  不過如果用一些檢測工具，例如透過&lt;a href="https://www.ssllabs.com/ssltest/"&gt;Qualys SSL Lab的SSL ServerTest&lt;/a&gt;，那麼有可能還是會&lt;em&gt;看到已經禁用的cipher suite&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;  這是為什麼呢？這樣到底如何驗證設定是否有成功？這篇將會介紹如何透過local檢測的方式確認修改是否有成功。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 kmcontenthide="1"&gt;相關文章&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/iis-security-set-correct-schannel-and-cipher-suite-using-iis-crypto.html" target="_blank"&gt;[iis]每個Server都應該做的資安防護 - 使用IIS Crypto一鍵設定該啟用和停用的SChannel (如SSL 3.0)和Cipher Suite (如MD5)&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951114" ;=""&gt;發生原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951620" ;=""&gt;解決方式 - 使用TestSSLServer工具做local測試&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951344" ;=""&gt;TestSSLServer工具檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951223" ;=""&gt;TestSSLServer的使用方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951821" ;=""&gt;TestSSLServer cipher suite強度介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512056126951625" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512056126951114"&gt;發生原因&lt;/h2&gt;&lt;p&gt;  有時候web的機器本身是我們管理，但是整個架構並不是，因此並不知道是不是還有什麼在Server外面，   以我遇到的例子來看，很有可能是在Server外面還有一層Web Application Framework（WAF）導致。   &lt;/p&gt;&lt;p&gt;  所以就算Server那台透過IISCrypto設定好了，但是假設外面那台沒有設定，那麼當使用網路的服務像是ssl labs的測試，檢測到的其實是&lt;em&gt;外面那台&lt;/em&gt;，而不是Server本身。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-PXz4cUfuz8M/WiAmyy1JLvI/AAAAAAAAW3Q/Lz781lHQm-g-T-wcV4ifz5PCCp3sPW-UwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="361" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-pJa60D8h9n8/WiAm2ZhzP4I/AAAAAAAAW3U/YGIA5qfwJKcmzltjrZyXgFgNVi3_buH3gCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;線上測試不通過&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512056126951620"&gt;解決方式 - 使用TestSSLServer工具做local測試&lt;/h2&gt;&lt;p&gt;  既然不知道Server外面有什麼可能導致線上測試不準確，那麼可以使用工具local直接測試機器是否設定成功。   &lt;/p&gt;&lt;p&gt;  一開始使用的工具是：&lt;em&gt;nmap&lt;/em&gt; - 但是我自己在測試的時候並沒有成功，並且這個需要安裝的東西比較多（都是檢測用的），因此就放棄使用。   &lt;/p&gt;&lt;p&gt;  最後使用的是：&lt;em&gt;TestSSLServer&lt;/em&gt;。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1512056126951344"&gt;TestSSLServer工具檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://www.bolet.org/TestSSLServer/"&gt;官方網站&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://github.com/pornin/TestSSLServer/"&gt;Github&lt;/a&gt;&lt;/li&gt;&lt;li&gt;直接下載鏈接：&lt;a href="https://www.bolet.org/TestSSLServer/TestSSLServer2.exe"&gt;.Net 2.0版本&lt;/a&gt;、&lt;a href="https://www.bolet.org/TestSSLServer/TestSSLServer4.exe"&gt;.Net 4.0版本&lt;/a&gt; &lt;br /&gt;(兩個版本執行起來沒有差異，只是看電腦有那.net framework就用那個版本）&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512056126951223"&gt;TestSSLServer的使用方式&lt;/h2&gt;&lt;p&gt;  這個是一個command line的工具，下載下來之後，使用cmd執行即可。   &lt;/p&gt;&lt;p&gt;  最簡單的使用方式就是輸入：&lt;kbd&gt;TestSSLServer4.exe localhost&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UjMZUEySLVA/WiAm3h2SXEI/AAAAAAAAW3Y/6gnm9Y-UvoYmRtfh3RaRxIk7onSnkLzUQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="573" height="548" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-cjSTjOaszAw/WiAm4327JoI/AAAAAAAAW3c/1sgA9CicHuMgchbM8uyMNWPR8aaLPOElACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;執行出來的結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  從上面的截圖可以看出其實3DES相關的cipher沒有了，但是網路的測試還是又出現。   &lt;/p&gt;&lt;p&gt;  如果想要把結果儲存起來，可以使用&lt;kbd&gt;TestSSLServer4.exe -text result.txt localhost&lt;/kbd&gt; - 這個就是把結果匯出到檔案&lt;code&gt;result.txt&lt;/code&gt;。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512056126951821"&gt;TestSSLServer cipher suite強度介紹&lt;/h2&gt;&lt;p&gt;  這個工具其實也可以看出目前允許使用的cipher suite強度如何。   &lt;/p&gt;&lt;p&gt;  在第一欄（Server）有三個值：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;第一個值有三種值（&lt;em&gt;0&lt;/em&gt;代表非加密，&lt;em&gt;1&lt;/em&gt;代表非常弱，&lt;em&gt;2&lt;/em&gt;代表弱，&lt;em&gt;3&lt;/em&gt;代表強）&lt;/li&gt;&lt;li&gt;第二個值如果是&lt;em&gt;f&lt;/em&gt;表示支援&lt;em&gt;前向安全性(Forward Secrecy)&lt;/em&gt;，如果不支援則是&lt;em&gt;-&lt;/em&gt;&lt;/li&gt;&lt;li&gt;第三個值如果是&lt;em&gt;A&lt;/em&gt;表示anonymous，要不然就是&lt;em&gt;-&lt;/em&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  理論上&lt;em&gt;3f-&lt;/em&gt;是最強的suite。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-IStF1LsVPO0/WiAm6ka4VPI/AAAAAAAAW3g/HfhBEkLJLasoIldYftVwx4LTJLwX44mewCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="582" height="500" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-WSRVvxrias4/WiAm-JGcYAI/AAAAAAAAW3k/vsMvRhJfhe0FhRgdvzATamr5bHx_wriwwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;機器的檢測結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  從截圖裡面可以看出這台的強度都至少在3，因此強度來說應該都沒有問題。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1512056126951625"&gt;結語&lt;/h2&gt;&lt;p&gt;  有時候明明設定好了，但是測試不通過的原因是因為&lt;em&gt;被測試的並不是你改的機器&lt;/em&gt;，因此用local的工具來測試比較準確。   &lt;/p&gt;&lt;p&gt;  以這個例子來說，至少有證據表示local看起來設定沒問題，至於線上測試有問題可能就是別的系統（非我們可以控制的部分）導致。   &lt;/p&gt;&lt;/section&gt;    &lt;section&gt;    &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:c25d648d-657d-43be-b708-4a8fed8fc49d" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/iis" rel="tag"&gt;iis&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/tool" rel="tag"&gt;tool&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4085407163155335866/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/11/iis-why-online-test-still-show-disabled-cipher-suite-use-TestSSLServer-for-local-cipher-suite-test.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4085407163155335866'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4085407163155335866'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/11/iis-why-online-test-still-show-disabled-cipher-suite-use-TestSSLServer-for-local-cipher-suite-test.html' title='[iis]為什麼ssl cipher suite關閉了檢查還是有出現問題 - 如何local檢查ssl和cipher suite'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-KPjS6gF75PI/WiAmx-fcEII/AAAAAAAAW3M/qiHrJmG244AdDdAJWWVtDOiO7HF5AxGpQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2104594365605430449</id><published>2017-11-30T00:28:00.000+08:00</published><updated>2017-12-01T00:30:22.067+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='best practices'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='sql'/><title type='text'>[SQL]為什麼連不到MSSQL資料庫 - 故障排除指南</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Vri5PPU3064/Wh7eklfGoQI/AAAAAAAAW1o/I56Jd3b4yPwaUVllhRgEee0-tf027QjHwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Q2ybxMZSGxg/Wh7elwqpFeI/AAAAAAAAW1s/u4eaVTJJVWU5CGzKlSRuR3Dx8O4Fv6y8QCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  任何一個比較大一點的系統都會需要使用到SQL，而以.Net開發為主最長用的資料庫基本上都是MSSQL。   &lt;/p&gt;&lt;p&gt;  不過MSSQL不一定是我們裝的，因此常遇到的問題就是給的&lt;em&gt;資訊不夠完整&lt;/em&gt;，或者&lt;em&gt;裝的時候缺少一些步奏&lt;/em&gt;，導致花費很多時間在找出為什麼MSSQL連線不到。   &lt;/p&gt;&lt;p&gt;  這篇希望提供一個故障排除指南，方便未來如果又連不到的時候可以依照這個項目來排除問題。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   關鍵字：troubleshooting guide for MSSQL Database connection problem.  &lt;/section&gt;    &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415364" ;=""&gt;排除清單 - TL;DR&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415293" ;=""&gt;排除問題的詳細步奏&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415203" ;=""&gt;檢查服務是否有啟動？&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415437" ;=""&gt;確定連線的DB Server Name&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415381" ;=""&gt;Network:用local檢查tcp是否有通&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415166" ;=""&gt;Network: 用local檢查Database的port&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415579" ;=""&gt;用local檢查sql帳號登入是否通過&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415730" ;=""&gt;用remote測試連線 - 防火墻&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415313" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1511971691415874" ;=""&gt;參考資料&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1511971691415364"&gt;排除清單 - TL;DR&lt;/h2&gt;&lt;p&gt;  以下清單提供一步一步的排除步奏，基本上如果都做完之後連線基本上沒有什麼問題。   &lt;/p&gt;&lt;table class="table"&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;       檢查項目      &lt;/th&gt;&lt;th&gt;       檢查方式      &lt;/th&gt;&lt;th&gt;       是否通過？      &lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415203"&gt;檢查服務是否有啟動？&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;       透過&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt; -&amp;gt; &lt;code&gt;Sql Server Services&lt;/code&gt; 確認狀態是&lt;em&gt;Running&lt;/em&gt;。      &lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415437"&gt;確定連線的DB Server Name&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;&lt;p&gt;      有兩種Instance名稱：       &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Instance - &lt;code&gt;MSSQLSERVER&lt;/code&gt; - 連線就是 &lt;code&gt;{computername}&lt;/code&gt;&lt;/li&gt;&lt;li&gt;Named Instance - 例如 &lt;code&gt;SQLEXPRESS&lt;/code&gt; - 連線就是 &lt;code&gt;{computername}\SQLEXPRESS&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415381"&gt;用local檢查tcp是否有通&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;&lt;p&gt;      使用Sql Server Management Studio（以下簡稱SSMS）連線的時候，在&lt;code&gt;Server Name&lt;/code&gt;之前加上&lt;kbd&gt;tcp:&lt;/kbd&gt;。       &lt;/p&gt;&lt;p&gt;      例如：假設Server Name是&lt;code&gt;localhost\SQLEXPRESS&lt;/code&gt;，那麼連線就是用&lt;code&gt;tcp:localhost\SQLEXPRESS&lt;/code&gt;。       &lt;/p&gt;&lt;p&gt;      如果連線不到，&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt; -&amp;gt; &lt;code&gt;SQL Server Network Configuration&lt;/code&gt; - 確定&lt;code&gt;TCP/IP&lt;/code&gt;是啟動的       &lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415166"&gt;用local檢查Database的port&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;&lt;p&gt;可以先透過local連線過去（不要用tcp模式），然後檢查log看看目前在聽那個port  如果要調整port可以透過：&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt; -&amp;gt; &lt;code&gt;SQL Server Network Configuration&lt;/code&gt; -&amp;gt; &lt;code&gt;TCP/IP&lt;/code&gt; &lt;kbd&gt;右鍵&lt;/kbd&gt; -&amp;gt; &lt;code&gt;內容&lt;/code&gt;確認       &lt;code&gt;IP Addresses&lt;/code&gt;頁簽裡面最後一項 &lt;code&gt;IP All&lt;/code&gt;的&lt;code&gt;TCP Port&lt;/code&gt;數字。       &lt;/p&gt;&lt;p&gt;      如果不是&lt;code&gt;1433&lt;/code&gt;，就在&lt;code&gt;DB Server Name&lt;/code&gt;後面加上&lt;code&gt;,{port}&lt;/code&gt;，例如假設port是50021，那麼整個就是&lt;code&gt;tcp:localhost\SQLEXPRESS,50021&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415579"&gt;用local檢查sql帳號登入是否通過&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;       有幾個部分可以檢查：       &lt;ol&gt;&lt;li&gt;如果出現18456 - 表示沒有開啟&lt;code&gt;Mixed mode&lt;/code&gt;（允許sql帳號和windows帳號登入）&lt;/li&gt;&lt;li&gt;如果出現 預設db 開啟不了 - 檢查這個使用者的權限&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;       &lt;a href="#WizKMOutline_1511971691415730"&gt;用remote測試連線 - 防火墻&lt;/a&gt;      &lt;/td&gt;&lt;td&gt;&lt;p&gt;      使用遠端要連到db的那台測試 - 可以使用&lt;code&gt;.udl&lt;/code&gt;檔案來做       &lt;/p&gt;&lt;p&gt;      注意防火墻設定，要開啟上面找到的port       &lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1511971691415293"&gt;排除問題的詳細步奏&lt;/h2&gt;&lt;p&gt;  接下來將會對於每一個步奏會有更加詳細的介紹。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415203"&gt;檢查服務是否有啟動？&lt;/h3&gt;&lt;p&gt;   從&lt;code&gt;開始&lt;/code&gt;裡面找到安裝的SQL Server版本，展開之後選擇&lt;code&gt;Configuration Tools&lt;/code&gt; -&amp;gt;&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Rm3hVTlbP6s/Wh7em_X7vkI/AAAAAAAAW1w/wzsXel8StjkmQr9R1xYt_CDPud_zpdLKACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="267" height="501" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zdsUkLtq744/Wh7en5y9VLI/AAAAAAAAW10/L0VE2eevxi0VH22iHMD5-6PHNlsMN-uYwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;開啟Sql Server Configuration Manager&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   從左邊選取&lt;code&gt;SQL Server Services&lt;/code&gt;，然後檢查右邊&lt;code&gt;SQL Server&lt;/code&gt;的狀態處於&lt;code&gt;Running&lt;/code&gt;。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Q6ui-4bT4oY/Wh7eo_Q9ogI/AAAAAAAAW14/X-NcR8Vp_gQJ_poNLLJekaHY3OojHrYYwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="120" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ozm-PEECaSE/Wh7eqYRSh3I/AAAAAAAAW18/-uXQ-lPc05s0zL645xDY1ybS6d7ndO6YACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;確認Sqlexpress這個instance狀態處於Running&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415437"&gt;確定連線的DB Server Name&lt;/h3&gt;&lt;p&gt;   需要先確認DB的Instance名稱。    &lt;/p&gt;&lt;p&gt;   從上一個步奏確認服務是否有啟動的部分，可以看到在括弧裡面的就是DB的Instance名稱。以剛剛那個為例子，就是&lt;code&gt;SQLEXPRESS&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;   Instance名稱有分為2種：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Default Instance - &lt;em&gt;MSSQLSERVER&lt;/em&gt; 是Default Instance&lt;/li&gt;&lt;li&gt;Named Instance - 其他設定都是Named Instance&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;   如果是&lt;em&gt;Default Instance&lt;/em&gt;，那麼連線的DB Server Name就是&lt;code&gt;{電腦名稱}&lt;/code&gt;，如果是&lt;em&gt;Named Instance&lt;/em&gt;，那麼就是&lt;code&gt;{電腦名稱}\{Instance名稱}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   以剛剛那個instance為例，因為它是Named Instance，因此它的Server Name是&lt;code&gt;localhost\SQLEXPRESS&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZgkGZAJK3e0/Wh7erd0nDGI/AAAAAAAAW2A/3gGIrdDlNYAuhz5dOmNzXl9p1_BEQnu_QCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="430" height="387" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-NwxzIpdfQMw/Wh7et_P3CpI/AAAAAAAAW2E/Qb_Ylq_7NUkBJzq0_Trthpysr2O-cTc8QCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;測試的連線畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415381"&gt;Network:用local檢查tcp是否有通&lt;/h3&gt;&lt;p&gt;   當上面步奏連線成功的時候，走的是&lt;em&gt;Shared Memory&lt;/em&gt;的通道，因此&lt;em&gt;不表示tcp連線&lt;/em&gt;（因為從另外一台連過來走的通道）是可以通。    &lt;/p&gt;&lt;p&gt;   為了避免其他network的問題，可以先在local（DB在的那台）測試tcp通道是否有問題。    &lt;/p&gt;&lt;p&gt;   做法很簡單，就是把上一步取得的DB Server Name的前面加上&lt;code&gt;tcp:&lt;/code&gt;即可，因此最後的結果是：&lt;code&gt;tcp:localhost\SQLEXPRESS&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5ASKlvE1pZY/Wh7euxKf75I/AAAAAAAAW2I/N1UIbnaSKsMMVcmdQ89X-bLZeEyPoV9MgCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="416" height="237" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-QJxf2k4WVQw/Wh7exWng8cI/AAAAAAAAW2M/NZMiisJY2WcyAR9XTPvyxld-vXCLEjG_QCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;測試tcp連線的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   如果連線失敗，用&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt; -&amp;gt; &lt;code&gt;Sql Server Network Configuration&lt;/code&gt; 裡面的 &lt;code&gt;Protocols for {instance name}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   確定&lt;code&gt;TCP/IP&lt;/code&gt;處於&lt;code&gt;Enabled&lt;/code&gt;的狀態。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4CGVDI6gO3g/Wh7eyXYRElI/AAAAAAAAW2Q/WQbhK8GAZCoZ5c5ddnvFJuMvpoMeJV_twCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="550" height="275" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-f9Up6w380P0/Wh7e09xAKpI/AAAAAAAAW2U/8akAc1fr20cWSsRo1v2Mz7J33TEeAQ4vgCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;確認TCP/IP是啟用的狀態&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415166"&gt;Network: 用local檢查Database的port&lt;/h3&gt;&lt;p&gt;   如果上一個步奏&lt;code&gt;TCP/IP&lt;/code&gt;已經是&lt;code&gt;Enabled&lt;/code&gt;的情況但是還是連不到，檢查一下port是否正確。    &lt;/p&gt;&lt;p&gt;   預設port是&lt;code&gt;1433&lt;/code&gt;，如果DB不在預設port，那麼連線的時候需要打上port號。    &lt;/p&gt;&lt;p&gt;			先用local的方式連到DB（不要加上tcp的部分）去檢查log看看目前在聽那個port： 			&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-c1Hr5pA5ME0/WiAw54c_YpI/AAAAAAAAW30/UWfnS-dgdTs5FK7Y2-hozhVA2HiBldJAQCHMYCw/s1600-h/image%255B3%255D"&gt;&lt;img width="654" height="459" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OiLvzE5JtuA/WiAw7Efz58I/AAAAAAAAW34/3s46ZVeI_ckfua6zWdBBgJn1rGK3MHxpACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;檢查步奏&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;選擇&lt;code&gt;Management&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;SQL Server Log&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇最新的一筆&lt;/li&gt;&lt;li&gt;從跳出的畫面選擇&lt;code&gt;Filter&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在&lt;code&gt;Message Contains Text&lt;/code&gt;輸入：server is listening on&lt;/li&gt;&lt;li&gt;勾起來&lt;code&gt;Apply Filter&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇ok&lt;/li&gt;&lt;li&gt;檢查結果，可以看到這個聽的port是50021&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;			修改port號可以透過&lt;code&gt;Sql Server Configuration Manager&lt;/code&gt; 工具的：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;Sql Server Network Configuration&lt;/code&gt; -&amp;gt; &lt;code&gt;Protocols for {instance name}&lt;/code&gt;&lt;/li&gt;&lt;li&gt;對&lt;code&gt;TCP/IP&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;然後選擇&lt;code&gt;內容&lt;/code&gt;&lt;/li&gt;&lt;li&gt;切換到頁簽&lt;code&gt;IP Address&lt;/code&gt;，並且卷到做下面，檢查&lt;code&gt;IP All&lt;/code&gt;的TCP port是不是1433。&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-fWktlreWAzg/Wh7e2H6icaI/AAAAAAAAW2Y/w2f0lpUjuO4s2VlaRYXs7s1ugmjSJHyIgCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="342" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zkkfbzhQkk0/Wh7e5e30QPI/AAAAAAAAW2c/SaUAC2dAW0MHcfeakMI5LccRG7TYWzfHwCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;檢查port的方式&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;    如果有改TCP Port，記得要重啟DB Service才會有作用。    &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;    假設port有修改，連線的時候在後面加上&lt;code&gt;,{port號}&lt;/code&gt;即可使用哪個port做連線。例如假設port號是&lt;code&gt;50021&lt;/code&gt;，那麼連線就是：&lt;code&gt;tcp:localhost\SQLEXPRESS,50021&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-QdpBXvP9ZM8/Wh7e8w5nrBI/AAAAAAAAW2g/Z5S1DiW8oAQIwEdBEcMALioUJQNJf_zCQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="422" height="191" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-x_2fLRQfdis/Wh7e_eVeKBI/AAAAAAAAW2k/MnBLMOtuUEAUiquuUDVlHbFKpXBNOxK_QCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;連線畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415579"&gt;用local檢查sql帳號登入是否通過&lt;/h3&gt;&lt;p&gt;   一般來說連線的時候都是使用Sql帳號（而不是Windows驗證），因此要用local測試使用Sql帳號是否能夠登入。    &lt;/p&gt;&lt;p&gt;   假設出現了登入錯誤，Sql Error 18456，表示沒有開啟&lt;code&gt;Mixed Mode&lt;/code&gt;，解決方式：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;先用Windows驗證連到DB並且對DB點&lt;kbd&gt;右鍵&lt;/kbd&gt;，選擇&lt;code&gt;Properties&lt;/code&gt;&lt;/li&gt;&lt;li&gt;切換到&lt;code&gt;Security&lt;/code&gt;的左邊menu&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;Sql Server and Windows Authentication Mode&lt;/code&gt; - 並且記得&lt;em&gt;重啟DB的Service&lt;/em&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-o6ecWsWaCWM/Wh7fA9zbGwI/AAAAAAAAW2o/B-KzQs8-OZciYAHrlIgHArijMDSkMk4MQCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="354" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-QTXbhxbm4o8/Wh7fCkchSNI/AAAAAAAAW2s/CM14EjozgMEZp5qEHY3qVdGAD9gqd5HbgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br&gt;&lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415730"&gt;用remote測試連線 - 防火墻&lt;/h3&gt;&lt;p&gt;   基本上如果上面都做完，基本上連線就不會有什麼問題，剩下可能會擋的部分就剩下防火墻。    &lt;/p&gt;&lt;p&gt;   可以先嘗試把DB那台和需要連到DB的那台的防火墻&lt;em&gt;先關掉&lt;/em&gt;做測試，如果可以連，在把它打開，然後設定允許DB的port連線。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;    如果AP那台沒有連線工具可以連到DB做測試，那麼可以建立&lt;code&gt;udl&lt;/code&gt;檔案做連線測試。     &lt;/p&gt;&lt;p&gt;    詳細做法可以參考：&lt;a href="https://dotblogs.com.tw/alantsai/2013/12/04/testdbconnection"&gt;使用udl檔案測試DB連線是否成功&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1511971691415313"&gt;結語&lt;/h2&gt;&lt;p&gt;  DB連線不到的問題可能牽扯到很多不同部分的設定，因此希望透過這一篇提供的一步一步排除步奏能夠在未來如果遇到連線不到的情況能夠快速找到問題。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1511971691415874"&gt;參考資料&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;     官方的troubleshooting guide    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/troubleshoot-connecting-to-the-sql-server-database-engine"&gt;Troubleshoot Connecting to the SQL Server Database Engine&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     介紹設定防火墻    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access"&gt;Configure a Windows Firewall for Database Engine Accessä&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     另外一個的troubleshooting guide    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://blogs.msdn.microsoft.com/sql_protocols/2008/04/30/steps-to-troubleshoot-sql-connectivity-issues/"&gt;Steps to troubleshoot SQL connectivity issues&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:155fdce1-321a-49f1-acd6-03f61f587ccd" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/best+practices" rel="tag"&gt;best practices&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/sql" rel="tag"&gt;sql&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2104594365605430449/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/11/sql-troubleshooting-guide-mssql-connection-problem.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2104594365605430449'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2104594365605430449'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/11/sql-troubleshooting-guide-mssql-connection-problem.html' title='[SQL]為什麼連不到MSSQL資料庫 - 故障排除指南'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-Q2ybxMZSGxg/Wh7elwqpFeI/AAAAAAAAW1s/u4eaVTJJVWU5CGzKlSRuR3Dx8O4Fv6y8QCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3089546753730664349</id><published>2017-10-31T00:31:00.000+08:00</published><updated>2017-10-31T00:31:06.033+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>[.Net]Dll明明有在，為什麼出現找不到DLL錯誤 - 一次搞懂如何處理Dll版本問題(Dll Hell)</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-kMrPxEIXwSc/WfdSVvS0u2I/AAAAAAAAWw8/9C_4leKHXkwy9Q8m84NLAlh4atK2t71iQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-b2H9mJyYuqE/WfdSW9iGluI/AAAAAAAAWxA/JDAxUX9dxEg9cbt0_KDNPnKQx7AFlm02wCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  當系統越來越模組化，大量library開始透過nuget方式組成的時候，開始會遇到一個情況，那就是Dll版本問題（Dll Hell）。   &lt;/p&gt;&lt;p&gt;  如果對於Dll版本問題沒有一些了解的情況下，常常會遇到明明Dll存在bin下面，但是還是出現找不到的錯誤訊息：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-s7uuxXOnVgI/WfdSYxWJnPI/AAAAAAAAWxE/tW04O4nVww0toPr_bPTp_5XxxJ8YTpzVwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="117" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bPlIM6B1dc0/WfdSZhpwoOI/AAAAAAAAWxI/BOgKmks9NzoGYOMMfsKVxSRd_p9jmG6dQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;System.IO.FileLoadException: Could not load file or assembly 'Newtonsoft.Json, Version=6.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference.&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  這篇將對於.Net如何處理Dll Hell的問題做一些介紹。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;   範例程式碼在：&lt;a href="https://github.com/alantsai-samples/dotnet-dll-hell-problem"&gt;https://github.com/alantsai-samples/dotnet-dll-hell-problem&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152601237" ;=""&gt;解決方式 - 手動設定config - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602718" ;=""&gt;解決方式 - 自動設定 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602610" ;=""&gt;Console自動設定binding&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602192" ;=""&gt;Web自動設定binding&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602830" ;=""&gt;問題發生的原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602676" ;=""&gt;問題重現&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602967" ;=""&gt;Console&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602263" ;=""&gt;Web&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602658" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1509380152602860" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152601237"&gt;解決方式 - 手動設定config - TL;DR&lt;/h2&gt;&lt;p&gt;  要解決這個問題基本上是透過在config設定&lt;code&gt;bindingRedirect&lt;/code&gt;，以上面為例子是找不到&lt;code&gt;Newtonsoft.Json 6.0.0.0版本&lt;/code&gt;，因此設定：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     打開config - 如果是web就是&lt;code&gt;web.config&lt;/code&gt;，如果是console就是&lt;code&gt;app.config&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;    加入以下在&lt;code&gt;configuration&lt;/code&gt; -&amp;gt;下&lt;code&gt;runtime&lt;/code&gt;面：     &lt;pre class="brush: xml;"&gt;&amp;lt;assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"&amp;gt;&lt;br /&gt; &amp;lt;dependentAssembly&amp;gt;&lt;br /&gt;   &amp;lt;assemblyIdentity name="Newtonsoft.Json" culture="neutral" publicKeyToken="30ad4fe6b2a6aeed"/&amp;gt;&lt;br /&gt;   &amp;lt;bindingRedirect oldVersion="0.0.0.0-6.0.0.0" newVersion="6.0.0.0"/&amp;gt;&lt;br /&gt; &amp;lt;/dependentAssembly&amp;gt;&lt;br /&gt;&amp;lt;/assemblyBinding&amp;gt;&lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     每一個dll版號就加入一個&lt;code&gt;dependentAssembly&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;assemblyIdentity&lt;/code&gt; - 用來設定那個dll要對應。其他還蠻直覺，不過&lt;code&gt;publicKeyToken&lt;/code&gt;可以透過:       &lt;ol&gt;&lt;li&gt;Google 搜索&lt;/li&gt;&lt;li&gt;         用powershell - 例如 &lt;kbd&gt;([system.reflection.assembly]::loadfile("c:\Newtonsoft.Json.dll")).FullName&lt;/kbd&gt; 會取得          &lt;code&gt;Newtonsoft.Json, Version=7.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/code&gt;&lt;/li&gt;&lt;li&gt;使用 &lt;code&gt;sn&lt;/code&gt;工具 - &lt;kbd&gt;sn -T "c:\Newtonsoft.Json.dll"&lt;/kbd&gt; - 會取得 &lt;code&gt;Public key token is 30ad4fe6b2a6aeed&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;bindingRedirect&lt;/code&gt;設定版號對應       &lt;ol&gt;&lt;li&gt;&lt;code&gt;oldVersion&lt;/code&gt; - 那些版號要對應 - 可以用 &lt;code&gt;-&lt;/code&gt; 來包含版號區間。&lt;/li&gt;&lt;li&gt;&lt;code&gt;newVersion&lt;/code&gt; - 在&lt;code&gt;oldVersion&lt;/code&gt;符合的版號要&lt;em&gt;對應&lt;/em&gt;到那個版號&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-warning"&gt;       注意，&lt;code&gt;newVersion&lt;/code&gt;不代表一定比&lt;code&gt;oldVersion&lt;/code&gt;&lt;strong&gt;&lt;em&gt;高&lt;/em&gt;&lt;/strong&gt;。換句話說也有可能高版本全部要用低版本的dll（不過這種情景比較少        ，因為一般都是高版本會向下兼容）       &lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;       注意版號取得的方式，用Powershell最準，如果用 檔案總管 點 右鍵 檢查的版號不一定準。       &lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152602718"&gt;解決方式 - 自動設定 - TL;DR&lt;/h2&gt;&lt;p&gt;  Visual Studio (簡稱VS) 可以幫忙自動設定正確的binding，這邊又有分console和web差異。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1509380152602610"&gt;Console自動設定binding&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;     把console的csproj unload並且開啟修改畫面    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-BEUKwSUPs78/WfdSapUJMyI/AAAAAAAAWxM/ZpBfpH9V_Y4JoTm8Pv5KvqBYvq4YBSomACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="457" height="420" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-48iGnO9H13k/WfdScfO9TzI/AAAAAAAAWxQ/Z4LpDBWYbWEOAZ20s0-doEK0tB5gqk4qACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;開啟csproj修改&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     加入 &lt;code&gt;AutoGenerateBindingRedirects&lt;/code&gt;到&lt;code&gt;PropertyGroup&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    直接加入&lt;code&gt;&amp;lt;AutoGenerateBindingRedirects&amp;gt;true&amp;lt;/AutoGenerateBindingRedirects&amp;gt;&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-OIc8LuTdLvI/WfdSeuFMcWI/AAAAAAAAWxU/OtP3dxVBZtYh_IDNG7_eXuPBGZOErvzdgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="292" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-SO_GG27u5Mg/WfdSh1FPLiI/AAAAAAAAWxY/umCeY3hbBP0TJfGt2nN49CT3ifg77NNTACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;加完方式&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     重新rebuild專案    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-QQ6IZeYTrXk/WfdSkab5JlI/AAAAAAAAWxc/3lBXmtDkib81gyRTRT9xkredsDQGEKNnQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="214" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-N7D0cLKDclc/WfdSmFjKkEI/AAAAAAAAWxg/VYKUPnX4xQ8WQGpQTiLHsdXtl6pYt6_8ACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;bin下面的&lt;code&gt;app.config&lt;/code&gt;自動加入&lt;code&gt;bindingRedirect&lt;/code&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;   target 4.5.2的.net framework 之後的專案預設都有幫忙加入了，所以應該不用手動設定。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1509380152602192"&gt;Web自動設定binding&lt;/h3&gt;&lt;p&gt;   和console不同，VS不會自動調整&lt;code&gt;Web.config&lt;/code&gt;，但是VS會有提示。    &lt;/p&gt;&lt;p&gt;   當build完之後，檢查&lt;code&gt;Warning&lt;/code&gt;頁簽    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dY9nhBJyJQw/WfdSoF7XMyI/AAAAAAAAWxk/aRzD89F2ckwaBv-c4DwmVf70LR-ooddwQCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="171" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-5ODg1-0xml0/WfdSp2S5xhI/AAAAAAAAWxo/_4PHwOCbRwA-Q2Es0eZmStB7d269OZ-TgCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到有告知版本問題&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   可以直接對warning點兩下，會自動問說要不要加入，如果要加入，會自動修改Web.confi。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-PDp8VQZoUBA/WfdSsL1RGTI/AAAAAAAAWxs/Wsla9XCptpEy_BTobwrI73Me_Z8yikY_ACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="331" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IZGQq2oyf1E/WfdStfA7jmI/AAAAAAAAWxw/77xY4qj5zVMBTDICzfLnUkwjE_KgVFJBgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;是否自動加入的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;   以上就是解決Dll版本問題的處理方式，如果對於如何重現問題有興趣可以往下看。  &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152602830"&gt;問題發生的原因&lt;/h2&gt;&lt;p&gt;  我們都知道同一個版本的dll同一時間只能夠有一個版本。   &lt;/p&gt;&lt;p&gt;  假設專案A使用library C的1.0版本，然後專案B使用library C的2.0版本，當build的時候，坑定只會剩下一個library C。換句話說要嘛是1.0要嘛是2.0.   &lt;/p&gt;&lt;p&gt;  那麼問題來了，假設留下來的是1.0，而專案B需要的是library 2.0版本，.Net runtime怎麼run的起來，2.0不存在啊！因為這樣所以炸掉。   &lt;/p&gt;&lt;p&gt;  因此我們需要有個東西告訴runtime，到底要用什麼版本。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   dll Reference那個版本的dll其實是寫在dll裡面的，如果我們用工具像是 justDecompile 可以看到 Reference的版號資訊是寫在manifest裡面的。    &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mMgwBOci5RM/WfdSuPh1d7I/AAAAAAAAWx0/UCEav1Kg_yg0Jy3pIfOqryKpVVrYqXQTQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="541" height="340" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CIFGAwuy_gE/WfdSuy3JIpI/AAAAAAAAWx4/ykukzL-Nry4Fl_9uqd0ko2teKI_2LDvbQCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;看到library使用6.0.8的json.net&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152602676"&gt;問題重現&lt;/h2&gt;&lt;p&gt;  要能夠了解問題和如何解決就要有一個能夠重現問題的專案，因此接下來要打造一個有問題的專案。會分廠兩個部分，console和web。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1509380152602967"&gt;Console&lt;/h3&gt;&lt;p&gt;  console的部分大概是：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     建立個console專案    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wLQCCu3pJMQ/WfdSwaa0wrI/AAAAAAAAWx8/WavEO7XUoDkduH-g56Eadslb-OZWGSr_ACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ep2x66EidVo/WfdS2YErLXI/AAAAAAAAWyE/v174ZFCjRKod0MLIk5t7Y-F3YFvqm_DawCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;建立出一個console專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     使用&lt;code&gt;Newtonsoft.Json&lt;/code&gt;7.0版本    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZqHu1pso40s/WfdS4EgCVMI/AAAAAAAAWyI/R57Lub2-9p0cQiIIbeyaxIA4wjyghOatACHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="221" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-BJumcubjvt8/WfdS54dAMuI/AAAAAAAAWyM/PBZqxrxqwPgKg0gPDmYHoXgMQ-L09F-7wCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;加入nuget專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     建立一個library專案    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-TAYbOsw5c1I/WfdS64GETjI/AAAAAAAAWyQ/UumiiIw7F1kMSsf9ZL06uoKVKZgLmMK3ACHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-xdrWroKn6qM/WfdS9R9X-GI/AAAAAAAAWyU/7XCDNKYM4H0g8ZBI09WZrWSK52EXAv80gCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;建立一個library專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     在library專案使用&lt;code&gt;Newtonsoft.Json&lt;/code&gt;6.0版本 - 並且建立一個方法    &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cagAiTXQcOs/WfdS-g0pNBI/AAAAAAAAWyY/gPq32c5lwzEY3-jCY8VOauhxhp-1MvNsQCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="188" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h3tq1yJVfr0/WfdTBNWdENI/AAAAAAAAWyc/BIenwECGGPIBanxMoFLLNxHq99ErZtxNwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;加入json.net 6.0.8&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;    在&lt;code&gt;Class1&lt;/code&gt;加入一個&lt;code&gt;Convert&lt;/code&gt;的方法：     &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public string Convert()&lt;br /&gt;{&lt;br /&gt; return JsonConvert.SerializeObject(new { From = "Lib"});&lt;br /&gt;}&lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     在console使用library並且run起來    &lt;/dt&gt;&lt;dd&gt;     console的main邏輯如下： &lt;pre class="brush: csharp;"&gt;static void Main(string[] args)&lt;br /&gt;{&lt;br /&gt; Console.WriteLine(JsonConvert.SerializeObject(new { From = "Console"}));&lt;br /&gt; Console.WriteLine(new Class1().Convert());&lt;br /&gt; Console.ReadLine();&lt;br /&gt;}&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Ho0IUQaNgfA/WfdTCREv5TI/AAAAAAAAWyg/DwFkV1hljEYiDG7qUVTQWbl1zDNep7iTwCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="357" height="145" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Oq2hSO4Ap_I/WfdTEoT4JTI/AAAAAAAAWyk/A7va-dguKxUjWJRlBny2rFLQ0GMi4x6VwCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;執行沒有問題&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     拿掉&lt;code&gt;AutoGenerateBindingRedirects&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     檢查產出的&lt;code&gt;bin\DllHellProblem.exe.config&lt;/code&gt;發現有自動產生&lt;code&gt;bindingRedirect&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    還記得上面自動設定提到VS專案會自動加入的部分，因此我們直接修改&lt;code&gt;DllHellProblem.csproj&lt;/code&gt;，然後把&lt;code&gt;AutoGenerateBindingRedirects&lt;/code&gt;拿掉。     &lt;/p&gt;&lt;p&gt;    記得先&lt;kbd&gt;clean&lt;/kbd&gt;在&lt;kbd&gt;run&lt;/kbd&gt;，發現直接出錯：     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-snl-vcJNg-o/WfdTHWnIvAI/AAAAAAAAWyo/yxjbgFZ0bVsl3uiy6y-NvSGnfTyY0o84gCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="137" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-AT32LPZufKM/WfdTI_5jiLI/AAAAAAAAWys/WuRMOH8ws6U4VVy7YoRSbIl6Utazch-DgCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;出現找不到dll&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;    發現bin下面的config，&lt;code&gt;bindingRedirect&lt;/code&gt;沒有自己產生所以出錯。手動加入就對了。     &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;   console範例完成可以再githu看到：&lt;a href="https://github.com/alantsai-samples/dotnet-dll-hell-problem/tree/sample/console"&gt;https://github.com/alantsai-samples/dotnet-dll-hell-problem/tree/sample/console&lt;/a&gt;&lt;/p&gt;&lt;p&gt;   git標籤：&lt;code&gt;sample/console&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   兩種方式取得：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;git clone https://github.com/alantsai-samples/dotnet-dll-hell-problem.git&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;git checkout sample/console&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;      從github release下載：&lt;a href="https://github.com/alantsai-samples/dotnet-dll-hell-problem/releases/tag/sample%2Fconsole"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1509380152602263"&gt;Web&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      加入一個Asp .net Mvc的專案     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-KlExdCeo2LI/WfdTKkI7ygI/AAAAAAAAWyw/6IrZhVNEWcE4vzvaKS6G1pQaWUF-QlT0ACHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="428" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-eo9kP1W1pVQ/WfdTNKugiTI/AAAAAAAAWy0/nOXRJSTScdM6nFgOH0MwovVKBIV75493gCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;加入一個Mvc專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在&lt;code&gt;HomeController&lt;/code&gt;使用class library並且把web.config的bindingRedirect拿掉     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     在&lt;code&gt;HomeController&lt;/code&gt;的&lt;code&gt;Index&lt;/code&gt;加入&lt;code&gt;new ClassLibrary1.Class1().Convert();&lt;/code&gt;&lt;/p&gt;&lt;p&gt;     在&lt;code&gt;Web.config&lt;/code&gt;先把&lt;code&gt;Newtonsoft.json&lt;/code&gt;的&lt;code&gt;bindingRedirect&lt;/code&gt;拿掉。      &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      build專案並且檢查Error List     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     build專案，檢查&lt;code&gt;Error List&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-AJEOcVlJrGw/WfdTPujMz6I/AAAAAAAAWy4/5HYeeLk2vvI5RZOir2B_8SKoz1IbrIiUACHMYCw/s1600-h/image%255B47%255D"&gt;&lt;img width="654" height="333" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Bx4Ic4CaSs4/WfdTRu53-KI/AAAAAAAAWy8/aWy0JZ7mvbIga2OODvGGU5plXW4aFkOQgCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;點兩下自動加入bindingRedirect&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;   console範例完成可以再githu看到：&lt;a href="https://github.com/alantsai-samples/dotnet-dll-hell-problem/tree/sample/web"&gt;https://github.com/alantsai-samples/dotnet-dll-hell-problem/tree/sample/web&lt;/a&gt;&lt;/p&gt;&lt;p&gt;   git標籤：&lt;code&gt;sample/web&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   兩種方式取得：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;git clone https://github.com/alantsai-samples/dotnet-dll-hell-problem.git&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;git checkout sample/web&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;      從github release下載：&lt;a href="https://github.com/alantsai-samples/dotnet-dll-hell-problem/releases/tag/sample%2Fweb"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152602658"&gt;結語&lt;/h2&gt;&lt;p&gt;  在Console其實非常方便，因為VS會自動幫忙處理bindingRedirect，但是web不會。   &lt;/p&gt;&lt;p&gt;  不過web會在&lt;code&gt;Error List&lt;/code&gt;裡面以warning的方式告訴，並且方便自動加入。   &lt;/p&gt;&lt;p&gt;  這個故事告訴我們，&lt;em&gt;要好好看Warning資訊&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;  希望透過這篇對於如何處理不同library使用到相同&lt;em&gt;但是版號&lt;/em&gt;不同的套件不會出現找不到dll的錯誤。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1509380152602860"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     官方介紹    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/redirect-assembly-versions"&gt;https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/redirect-assembly-versions&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     官方介紹自動binding Redirect    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection"&gt;https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     黑大介紹用檔案總管檢查版號的小陷阱 - 建議還是用Powershell比較不會有問題    &lt;/dt&gt;&lt;dd&gt;&lt;a href="http://blog.darkthread.net/post-2015-11-25-assemblyinformationversion.aspx"&gt;http://blog.darkthread.net/post-2015-11-25-assemblyinformationversion.aspx&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;    &lt;section&gt;     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:4909a989-fa3a-40cd-9b1c-622067bfc1ea" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3089546753730664349/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/donet-dll-hell-problem-how-to-use-bindingredirect.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3089546753730664349'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3089546753730664349'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/donet-dll-hell-problem-how-to-use-bindingredirect.html' title='[.Net]Dll明明有在，為什麼出現找不到DLL錯誤 - 一次搞懂如何處理Dll版本問題(Dll Hell)'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-b2H9mJyYuqE/WfdSW9iGluI/AAAAAAAAWxA/JDAxUX9dxEg9cbt0_KDNPnKQx7AFlm02wCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8856075978326174667</id><published>2017-10-25T01:00:00.000+08:00</published><updated>2017-10-25T01:00:17.800+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='「net framework工程師看net core」'/><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.net framework 工程師看.net core][04]真跨平台.Net Core介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-z-6V1TDmMEY/We9xAHkzkaI/AAAAAAAAWvc/mQ1hI7801FwRtawhej6iPUxO6qa_Lq4DwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CN-yxFUiR8o/We9xBpvnW0I/AAAAAAAAWvg/NFnk-SGifk88QPh0Xa9nNrR_2k7neXipgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;  在上一篇介紹完C#之後(&lt;a href="http://blog.alantsai.net/2017/10/net-framework-see-new-core-03-csharp-programmer-language.html"&gt;工程師的語言 C#&lt;/a&gt;)，基本上對於.Net Framework的整個開發環境也是有個基本的了解和概念之後，在這篇將會對新的framework：.net core做個基本介紹。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt;    &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519473" ;=""&gt;.Net Core的組成&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519623" ;=""&gt;.Net Core和.Net Framework的不同之處&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519196" ;=""&gt;.Net Core安裝位置和內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519863" ;=""&gt;.Net Core可以安裝的模式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519933" ;=""&gt;.Net Core的可安裝版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519662" ;=""&gt;.Net Core的安裝路徑&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519418" ;=""&gt;.Net Core的版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519905" ;=""&gt;.Net Core的執行方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508863798519553" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519473"&gt;.Net Core的組成&lt;/h2&gt;&lt;p&gt;  和.Net Framework一樣，當提到.Net Core的時候，這個平台提供了三個重要功能：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     編譯/建制程式碼的工具    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    .Net core和.Net framework不同在於提供了一個所謂的&lt;code&gt;dotnet&lt;/code&gt; cli工具(也可以稱為app host)，這個工具提供了一個統一的api方便對專案做一些調整，並且提供像是build或者restore package的指令。    &lt;/p&gt;&lt;p&gt;&lt;code&gt;dotnet&lt;/code&gt; cli提供的還是一個wrapper，以compiler來說，底層其實用的也是Roslyn (.net Compiler platform)    &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     .Net Core Base Class Library (BCL)    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    .Net Core和.Net Framework一樣，有提供了所謂的BCL。不過這個BCL其實從api的角度來說是少於.Net Framework，畢竟為了跨平台有些和Windows綁的很死的像是Windows Form就不包括在.Net Core的BCL。     &lt;/p&gt;&lt;p&gt;    CoreBCL也稱為CoreFx，有個&lt;a href="https://github.com/dotnet/corefx"&gt;github repo&lt;/a&gt;&lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Core Common Language Runtime (CoreCLR)    &lt;/dt&gt;&lt;dd&gt;     同.Net Framework一樣，也是有個CLR用來執行.Net Core的程式，不過這個CLR和.Net Framework不同，因此稱為&lt;em&gt;CoreCLR&lt;/em&gt;。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-tjrgktdSWpw/We9xCg3M6lI/AAAAAAAAWvk/gDYuJ8wgjEIPRJ2vwUhlbC4cSsXfiHAPgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="520" height="563" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-PVejzWhw5Mg/We9xDlV9nSI/AAAAAAAAWvo/V1riyCioY5gBurN-g1YD-VlBRMMacgRoACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;一樣CoreBCL和CoreCLR組成通常稱為runtime，也就是.Net Core。不過比較不一樣的是，這個runtime是由一個app host run起來的 (也就是所謂的&lt;code&gt;dotnet&lt;/code&gt;的工具)&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519623"&gt;.Net Core和.Net Framework的不同之處&lt;/h2&gt;&lt;p&gt;  .Net Core基本上是.Net Framework的重寫，最主要目的/差異是：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     達到真的跨平台    &lt;/dt&gt;&lt;dd&gt;     雖然理論上只要能夠run IL的CLR .Net 的程式就可以跨平台(例如 Mono就是一個這樣的CLR)，但是微軟並沒有support。.Net Core的CLR則是有真的提供由微軟support的跨平台版本。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     更“小”的程式組合    &lt;/dt&gt;&lt;dd&gt;     基本上.Net Core是一個更加模組化的平台，換句話說整體的速度和使用的資源更少。因此更符合現代化的Microservice的架構和Container模式執行的結構。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     CLR執行方式的不同    &lt;/dt&gt;&lt;dd&gt;     .Net Core使用app host (dotnet cli)來吧 CoreCLR執行起來，而.Net Framework則不是用app host run起來。因此，.Net Core的console 程式發佈出來是.dll做結尾而不是.exe    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     發佈模式的不同    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    .Net Core有     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;Framework Dependent Deployment(FDD)&lt;/em&gt;&lt;/li&gt;&lt;li&gt;&lt;em&gt;Self-contained Deployment(SCD)&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;兩種模式。       &lt;p&gt;   FDD和以前.Net Framework一樣，只有程式本身，需要執行的話那台電腦&lt;em&gt;需要&lt;/em&gt;先安裝好.Net Core runtime。     &lt;/p&gt;&lt;p&gt;   SCD則是把.Net core runtime和程式包在一起，達到不需要有安裝.Net Core runtime就可以執行。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;    FDD和SCD的差異可以參考     &lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-1-net-core-console-with-FDD-publish.html"&gt;[.Net Core 與 .Net Standard 實戰教學][Lab][02-1]了解Framework Dependent Deployment(FDD)執行(發佈)模式&lt;/a&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;  因此.Net Core在定義上面和.Net Framework不同，.Net Framework還是以Windows為主的架構並且提供豐富的api，而.Net Core則是更偏向以microservice跨平台的程式開發。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519196"&gt;.Net Core安裝位置和內容&lt;/h2&gt;&lt;p&gt;  這個部分有：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;.Net Core可以安裝的模式&lt;/li&gt;&lt;li&gt;.net Core的可安裝版本&lt;/li&gt;&lt;li&gt;.Net Core的安裝路徑&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1508863798519863"&gt;.Net Core可以安裝的模式&lt;/h3&gt;&lt;p&gt;  和.Net Framework不同，.Net Core在安裝的時候分了兩個模式：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;.Net Core SDK&lt;/li&gt;&lt;li&gt;.Net Core Runtime&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;   .Net Core SDK包含了.Net Core Runtime的所有內容，並且多了一些和開發有關的工具。因此，如果&lt;em&gt;要開發&lt;/em&gt;，就安裝&lt;em&gt;SDK&lt;/em&gt;模式，如果只是&lt;em&gt;要執行&lt;/em&gt;.Net Core的程式，那麼&lt;em&gt;安裝 runtime&lt;/em&gt;即可。   &lt;/p&gt;&lt;p&gt;  這個和Java的JDK vs Runtime是一樣的概念。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   關於準備.Net Core開發環境可以參考：&lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-01-install-net-core-sdk.html"&gt;[.Net Core 與 .Net Standard 實戰教學][Lab][01]準備環境&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1508863798519933"&gt;.Net Core的可安裝版本&lt;/h3&gt;&lt;p&gt;   .Net Core和.Net Framework不同，每一個版本都可以&lt;em&gt;同時&lt;/em&gt;裝在一台電腦上面，因此更加容易使用和開發一樣的版本來run程式。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-sLgCzbUTVus/We9xFAEDWCI/AAAAAAAAWvs/NGU5wQzdHpQRa3aZRuxdBK5UEeYkMzhqgCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="333" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-4cpVj2QlEyM/We9xHGnIfiI/AAAAAAAAWvw/BECILvHmviUVVZ-NL0eOYcgbVycLEgYxwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;一台電腦可以安裝多個版本，並且Self Contained Deployment可以再沒有裝runtime的電腦執行起來&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;    .Net Core發佈模式裡面的Self Contained Deployment可以包含runtime來發佈，可以達到電腦沒有裝runtime的情況下也可以跑程式    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1508863798519662"&gt;.Net Core的安裝路徑&lt;/h3&gt;&lt;p&gt;   預設安裝的路徑在：&lt;code&gt;%programfiles%\dotnet\sdk&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-403n6GfoNEU/We9xIr2QSOI/AAAAAAAAWv0/G5Y3UHFKuy8QnXZ7RUZ5mVlVSX6va2FaACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="553" height="282" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-UFSGZtyrGdc/We9xLkN3COI/AAAAAAAAWv4/utU28aKf3bQJ4qcnDZk0VSwOjNAmBp5iwCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;這台電腦裝了3個版本的.Net Core，1.0、1.1和2.0&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519418"&gt;.Net Core的版本&lt;/h2&gt;&lt;p&gt;  目前.Net Core進入到了2.0的時代，在這個版本裡面有個很重要.Net Standard也進入了2.0的版本。因此開發.Net Core變得更加容易（.net Standard在之後會在介紹）。   &lt;/p&gt;&lt;p&gt;  .Net Core 1.x的時代基本上處於一個比較不穩定的狀態，因為一切都還在確認中，假設有早期進入的就會發現一個很大的改變就是從csproj換到了project.json，然後又從project.json在換回了csproj。   &lt;/p&gt;&lt;p&gt;  因此如果有幸沒有碰過1.x時代，那麼基本上可以忽略直接從2.0進場。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519905"&gt;.Net Core的執行方式&lt;/h2&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9aus9mRfCIo/We9xNmsiBAI/AAAAAAAAWv8/_YJc801DxmsNMnLhlE8hX6zhKIfJT2cAACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="372" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-21mn80Mfo6U/We9xSymrFqI/AAAAAAAAWwA/vilW944EMPsCH1pD2SucCviZpGOCObkogCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;從source code到執行起來的過程&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;編譯程式碼 - .Net Core使用的compiler和.Net Framework一樣(至少是後來版本的一樣)，都是使用.Net Compiler Platform (Roslyn)&lt;/li&gt;&lt;li&gt;編譯出來的結果是IL程式碼 - 如果包含exe的模式（SCD），exe會是app host&lt;/li&gt;&lt;li&gt;執行起來的時候，會搭配.Net Core的base library - CoreBCL&lt;/li&gt;&lt;li&gt;透過CoreCLR run 起來會用RyuJIT做及時編譯 並且變成機器碼被執行 - RyuJIT和.Net Framework的JIT在效能上面有加強&lt;/li&gt;&lt;li&gt;如果是UWP的程式，可以再編譯的時候透過AOT-Compiler直接變成機器碼，來達到執行速度的提升&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508863798519553"&gt;結語&lt;/h2&gt;&lt;p&gt;  這篇介紹了.Net Core的一些基本情況，並且和.Net Framework做一些比較。希望透過這一篇能夠對.Net Core的整個環境有更加的了解。   &lt;/p&gt;&lt;p&gt;  是否目前就應該直接轉.Net Core?是否.Net Framework未來就會死掉呢？   &lt;/p&gt;&lt;p&gt;  基本上.Net Framework和.Net Core的對象不同因此不用擔心.Net Framework會死掉。至於是否進入.Net Core.....   &lt;/p&gt;&lt;p&gt;  在下一篇會對和.Net Core 2.0一起發佈的.Net Standard 2.0作介紹，如果還不確定是否要進入.Net Core，那麼可以先從擁抱.Net Standard 2.0開始。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:baf9e59b-74c7-4ad6-aa9e-2d04e514a311" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cnet+framework%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9c%8bnet+core%e3%80%8d" rel="tag"&gt;「net framework工程師看net core」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8856075978326174667/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-04-net-core2-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8856075978326174667'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8856075978326174667'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-04-net-core2-intro.html' title='[.net framework 工程師看.net core][04]真跨平台.Net Core介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-CN-yxFUiR8o/We9xBpvnW0I/AAAAAAAAWvg/NFnk-SGifk88QPh0Xa9nNrR_2k7neXipgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3069117639950191942</id><published>2017-10-21T08:28:00.000+08:00</published><updated>2017-10-21T08:28:48.596+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='「net framework工程師看net core」'/><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><title type='text'>[.net framework 工程師看.net core][03]工程師的語言 C#</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XZCvIWLVmVI/WeqThY7WDII/AAAAAAAAWuM/ul9fWilCOuk9u8EzhIhRn2J3IA6kyHHRgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2WrOb5oGWWA/WeqTjxJrp2I/AAAAAAAAWuQ/3YuF66WWLB8XuMmPUv3_DnWTHru7NS2GACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇介紹完了.Net Framework的概觀(&lt;a href="http://blog.alantsai.net/2017/10/net-framework-see-new-core-02-net-framework-overview.html"&gt;起源.Net Framework&lt;/a&gt;) - 在這一篇將會介紹和.Net Framework一起誕生的語言：C#   &lt;/p&gt;&lt;p&gt;  將會了解到C#版本的歷史、主要版本之間的功能差異和.Net Compiler Platform (Roslyn) 帶來的差異   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429115" ;=""&gt;C#是什麼&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429322" ;=""&gt;C#版本功能&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429432" ;=""&gt;.Net Framework如何執行C#程式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429312" ;=""&gt;除了C#以外的其他.Net Framework語言&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429752" ;=""&gt;compiler的進化&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508544321429933" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429115"&gt;C#是什麼&lt;/h2&gt;&lt;p&gt;  C#（唸法：C Sharp）是一個語法結構類似Java的OO語言。和.Net Framework一起誕生出來，可以說C#是.Net 開發的第一語言。   &lt;/p&gt;&lt;p&gt;  目前組新的版本是 C# 7.1   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429322"&gt;C#版本功能&lt;/h2&gt;&lt;p&gt;  基本上C#會和某一個.Net Framework版本搭配，並且也會搭配某一個Visual Studio (VS) 版本一起release。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;   和VS一起release的原因是有些語法糖的修改，舉例來說VS 2015就不支援C# 7.0的語法 - 在VS 2015上面會出現好像錯誤，但是可以透過更新.Net Compiler Platform來達到&lt;em&gt;編譯成功&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;   相關可以參考：&lt;a href="http://blog.alantsai.net/2017/03/visualstudio2015-build-Csharp7.html"&gt;[Visual Studio]如何在Visual Studio 2015使用C#7的功能？&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-83fiVsAoOrw/WeqTlqxDhvI/AAAAAAAAWuU/rhGFse99oIQFCpTuk9uYFhezPhHOwVdIACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="333" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-f4HcfMEtv-s/WeqTmimQ9JI/AAAAAAAAWuY/G7KhyLaHaEYa4MBe9gVwHp5Yxrz4GfmZACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;figcaption&gt;C# 和 .Net 版本對應和版號。     來源：http://www.webdevelopmenthelp.net/2015/06/new-features-in-csharp-6.html&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  每一個Release基本上都會有一個主要的主題：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;2.0 - 加入 泛型(Generic)因為如此1和2不兼容&lt;/li&gt;&lt;li&gt;3.0 - 加入 Linq&lt;/li&gt;&lt;li&gt;4.0 - 加入 dynamic&lt;/li&gt;&lt;li&gt;5.0 - 加入 async await&lt;/li&gt;&lt;li&gt;6.0 - 比較偏語法糖(syntax sugar)類型的修改&lt;/li&gt;&lt;li&gt;7.0 - 比較偏語法糖(syntax sugar)類型的修改&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;   更多版本之間的差異可以參考：&lt;a href="https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-version-history"&gt;The history of C#&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429432"&gt;.Net Framework如何執行C#程式&lt;/h2&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HLC_MGnUUQo/WeqTpGyUWSI/AAAAAAAAWuc/rwuAzjSdBa0dxKwZuZuGmgbDWkFtVXyKACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="285" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-kcvX_Ydx5w4/WeqTsJ5U9KI/AAAAAAAAWug/KwAyLZkT8C4jI7bZ2ySmPARF7ZjoaZffgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整個編譯和執行過程&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  C#經過編譯器(compiler)編譯之後產生的是所謂的Intermediate Language (IL)，最後當使用者執行的時候，CLR在把 IL run 起來透過及時編譯(JIT compile)變成機器碼(machine code)執行在機器上面。   &lt;/p&gt;&lt;p&gt;  由於run 起來的CLR會幫忙管理底層的一些資源，例如memory的管理，因此C# 又稱之為managed code。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429312"&gt;除了C#以外的其他.Net Framework語言&lt;/h2&gt;&lt;p&gt;  精準一點說，.Net Framework (CLR) 支援的語言只有一種，那就是 IL。   &lt;/p&gt;&lt;p&gt;  不過.Net Framework一起帶來的工具裡面包含compiler支援3種語言編譯成為IL：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;C#&lt;/li&gt;&lt;li&gt;VB .Net - 語法類似VB6，當初.Net剛出來希望鼓勵大家轉.Net因此提供&lt;/li&gt;&lt;li&gt;F# - 偏Functional Programing的語言，Serverless的服務Azure Function就有支援&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  不管是這三種語言的那種，最後compile之後(不管是exe還是dll)都是IL - 因此3種語言的結果是可以&lt;em&gt;互相使用&lt;/em&gt;。換句話說，VB .Net寫的Library，可以直接在C#的console使用。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429752"&gt;compiler的進化&lt;/h2&gt;&lt;p&gt;  在早期版本的C# compiler是和.Net Framework一起安裝的，這個compiler的程式名稱是&lt;code&gt;csc.exe&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;  不過因為很多原因(例如更容易做meta programing等好處)，後來compiler被獨立出來，變成一個自己的專案叫做.Net Compiler Platform (aka Roslyn) (&lt;a href="https://github.com/dotnet/roslyn"&gt;官方repo&lt;/a&gt;)。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-eJQSw67lBF0/WeqTuxdZj4I/AAAAAAAAWuk/nw3JHxmHjZ8ZcUTYWSFJnKatYeA1iYMzgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="159" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-DYvm6XpXmjc/WeqTxTRMc1I/AAAAAAAAWuo/wgTZBZFrWpA7GjOYh4koWgLSwmYcUX5cwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;.Net Framework的csc只有支援到C# 5&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  因為這個原因，所以&lt;em&gt;C# 6.0&lt;/em&gt;以上的compiler使用的都是Roslyn。   &lt;/p&gt;&lt;p&gt;  Roslyn的一個好處是，能夠用nuget package安裝並且在編譯的時候自動使用&lt;em&gt;nuget裝的版本&lt;/em&gt;，而不是電腦安裝的版本。這個在CI建制上也更加方便。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3Zl25ms05nI/WeqTyHP3NXI/AAAAAAAAWus/-UgCQf88L88-VtVmB0c9d09yZU73HRVbgCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="532" height="506" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-unA48SY9F98/WeqT04LVeCI/AAAAAAAAWuw/rzd8fyAj5OEyz0mq0dUj3Cbb8LxYE3xCQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到Roslyn和bin包在了一起，並且Roslyn還是保留了&lt;code&gt;csc.exe&lt;/code&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508544321429933"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇對於C#的基本功能有做了基本的介紹，並且也對Roslyn - 新的compiler做了基本介紹。   &lt;/p&gt;&lt;p&gt;  對於整個.Net平台和開發的語言C#應該有了一些基本的概念了之後，接下來就可以看一下.Net Core的平台概觀和.Net Framework有什麼不同。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;    &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:5dcb682f-9746-4220-954c-73a0c4d855f5" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cnet+framework%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9c%8bnet+core%e3%80%8d" rel="tag"&gt;「net framework工程師看net core」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/C%23" rel="tag"&gt;C#&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3069117639950191942/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-03-csharp-programmer-language.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3069117639950191942'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3069117639950191942'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-03-csharp-programmer-language.html' title='[.net framework 工程師看.net core][03]工程師的語言 C#'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-2WrOb5oGWWA/WeqTjxJrp2I/AAAAAAAAWuQ/3YuF66WWLB8XuMmPUv3_DnWTHru7NS2GACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6721371209230633973</id><published>2017-10-18T23:49:00.000+08:00</published><updated>2017-10-18T23:49:10.991+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='「net framework工程師看net core」'/><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>[.net framework 工程師看.net core][02]起源.Net Framework</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5x47vkxuicQ/Wed3NadT7NI/AAAAAAAAWpw/uUSepdebmNE2TzhE_G8KxeWhlzimdL_FgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-D5QRYO08BlU/Wed3Pb4ULyI/AAAAAAAAWp0/3clk9ZfCYIIJDvLPkSp55lefDxk7lAHAgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在這一篇，將會從起源，介紹.Net Framework作為開始。   &lt;/p&gt;&lt;p&gt;  先了解.Net Framework到底包含了什麼，再來介紹一下版本和Runtime之間的關係，最後在介紹一下CLR如何和C#搭配然後整個run起來。   &lt;/p&gt;&lt;p&gt;  這篇結束之後，會對於整個.Net Framework有個基本的概念並且方便之後和.Net Core和Xamarin做個比對。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612914757" ;=""&gt;.Net Framework組成&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612915279" ;=""&gt;.Net Framework安裝位置和內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612915669" ;=""&gt;.Net Framework版本組成&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612915464" ;=""&gt;.Net Framework執行方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612915898" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508340612915825" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612914757"&gt;.Net Framework組成&lt;/h2&gt;&lt;p&gt;  基本上.Net Framework提供了3個重要功能：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     編譯/建制程式碼的工具    &lt;/dt&gt;&lt;dd&gt;     這個包含工具像是&lt;code&gt;csc.exe&lt;/code&gt;(用來編譯C#的編譯器 後面提到C#會在更深入介紹)等用來建制專案用的工具。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Base Class Library (BCL)    &lt;/dt&gt;&lt;dd&gt;     由framework提供的library，包含一些常見的像是&lt;code&gt;System.IO&lt;/code&gt;等等的方法。依照版本不同也會提供不同功能，因此組成不同的Workload。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Common Language Runtime (CLR)    &lt;/dt&gt;&lt;dd&gt;     用來執行編譯出來的dll或者exe    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-c7xNbwsrCFY/Wed3QuoW5aI/AAAAAAAAWp4/a9YRUfIofzYLlYkzWwPf9znSnv3OUXHswCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="526" height="522" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rpCoL3zbFck/Wed3SDhIu2I/AAAAAAAAWp8/u_kqVmy56KYeVFODL6TZyt27yaKs04FagCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;BCL和CLR組合在一起通常稱為Runtime，當提到版本指的都是這個 - 這邊沒有包含建制工具的部分&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  一般來說，當提到.Net Framework版本的時候，其實指的都是&lt;code&gt;Runtime&lt;/code&gt;。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612915279"&gt;.Net Framework安裝位置和內容&lt;/h2&gt;&lt;p&gt;  基本上在安裝.Net Framework的時候就是更新&lt;em&gt;BCL&lt;/em&gt;和&lt;em&gt;CLR&lt;/em&gt;，而大版號的CLR 1臺電腦只能夠裝&lt;em&gt;3&lt;/em&gt;個版本：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;CLR 1&lt;/li&gt;&lt;li&gt;CLR 2&lt;/li&gt;&lt;li&gt;CLR 4&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  基本上應該沒有人在用CLR 1，大家應該都在CLR 4，而只能有一個大版號的意思是，假設有臺電腦裝的是&lt;code&gt;4.5.2&lt;/code&gt;，如果他更新&lt;code&gt;4.6.1&lt;/code&gt;，那麼這台電腦只&lt;em&gt;剩下&lt;/em&gt;&lt;code&gt;4.6.1&lt;/code&gt;。沒辦法   &lt;em&gt;&lt;strong&gt;4.5.2和4.6.1並存&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DJEKYcKyI3w/Wed3TuSYCtI/AAAAAAAAWqA/NYhM2CXnwfwlIwEMbgYM5r7FGU0RcFkdgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="274" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OFhzuNysyxc/Wed3VSnHprI/AAAAAAAAWqE/IuFApAkgKfkW0yMtNV3zQN0SPmD0hJQXgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;電腦只能夠裝最多3個大版號的CLR&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  .Net Framework的安裝路徑在&lt;code&gt;%WINDIR%\Microsoft.NET\Framework&lt;/code&gt;，不過實際那個CLR版本有裝要看&lt;em&gt;註冊表(regedit)&lt;/em&gt;(詳細請參考：   &lt;a href="https://docs.microsoft.com/en-us/dotnet/framework/migration-guide/versions-and-dependencies"&gt;.NET Framework Versions and Dependencies&lt;/a&gt;)   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612915669"&gt;.Net Framework版本組成&lt;/h2&gt;&lt;p&gt;  了解了.Net Framework包含了什麼之後，接下來了解一下當提到XXX版本的時候，到底指的是什麼？   &lt;/p&gt;&lt;p&gt;  還記得上面提到.Net Framework的版本指的是&lt;code&gt;Runtime&lt;/code&gt;（CLR+BCL），所以有些版本&lt;em&gt;更新的是&lt;strong&gt;BCL&lt;/strong&gt;&lt;/em&gt;但是&lt;code&gt;CLR&lt;/code&gt;沒有&lt;em&gt;大版本更新&lt;/em&gt;。因為這樣很容易造成   &lt;em&gt;&lt;strong&gt;版本混搖的情況&lt;/strong&gt;&lt;/em&gt; - 舉例來說 初學者很容易以為有3.5版本的CLR。   &lt;/p&gt;&lt;p&gt;  版號相關資訊請參考：   &lt;/p&gt;&lt;figure&gt;&lt;table class="wikitable" style="border-color: rgb(162, 169, 177); text-align: center; color: rgb(34, 34, 34); font-family: sans-serif; font-size: 14px; margin-top: 1em; margin-bottom: 0px; orphans: 2; widows: 2; background-color: rgb(248, 249, 250);"&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;figcaption&gt;&lt;table class="wikitable" style="border-color: rgb(162, 169, 177); text-align: center; color: rgb(34, 34, 34); font-family: sans-serif; font-size: 14px; margin-top: 1em; margin-bottom: 0px; orphans: 2; widows: 2; background-color: rgb(248, 249, 250);"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;Version&lt;br /&gt;number&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;&lt;a title="Common Language Runtime" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Common_Language_Runtime"&gt;CLR&lt;/a&gt;&lt;br /&gt;version&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;Release&lt;br /&gt;date&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;Support&lt;br /&gt;ended&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;Development tool&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" colspan="2"&gt;Included in&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);" rowspan="2"&gt;Replaces&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);"&gt;Windows&lt;/th&gt;&lt;th style="padding: 0.2em 0.4em; border: 1px solid rgb(162, 169, 177); border-image: none; background-color: rgb(234, 236, 240);"&gt;Windows Server&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_1.0"&gt;1.0&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;1.0&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2002-02-13&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2009-07-14&lt;sup class="reference" id="cite_ref-MS_DotNET_EoL_23-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="color: rgb(11, 0, 128); background-image: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-MS_DotNET_EoL-23"&gt;[22]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio .NET" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_.NET"&gt;Visual Studio .NET&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2003_24-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2003-24"&gt;[23]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows XP" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_XP"&gt;XP&lt;/a&gt;&lt;sup class="reference" id="ref_a1none" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#endnote_a1none"&gt;[a]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_1.1"&gt;1.1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;1.1&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2003-04-24&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio .NET 2003" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_.NET_2003"&gt;Visual Studio .NET 2003&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2003_24-1" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2003-24"&gt;[23]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2003" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2003"&gt;2003&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;1.0&lt;sup class="reference" id="cite_ref-25" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-25"&gt;[24]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_2.0"&gt;2.0&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2.0&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2005-11-07&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2011-07-12&lt;sup class="reference" id="cite_ref-MS_DotNET_EoL_23-1" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-MS_DotNET_EoL-23"&gt;[22]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2005" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2005"&gt;Visual Studio 2005&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2005_26-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2005-26"&gt;[25]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2003" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2003"&gt;2003&lt;/a&gt;, &lt;a title="Windows Server 2003 R2" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2003_R2"&gt;2003 R2&lt;/a&gt;,&lt;sup class="reference" id="cite_ref-27" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-27"&gt;[26]&lt;/a&gt;&lt;/sup&gt;&amp;nbsp;&lt;a title="Windows Server 2008 SP2" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2008_SP2"&gt;2008 SP2&lt;/a&gt;, &lt;a title="Windows Server 2008 R2 SP1" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2008_R2_SP1"&gt;2008 R2 SP1&lt;/a&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_3.0"&gt;3.0&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2.0&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2006-11-06&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2011-07-12&lt;sup class="reference" id="cite_ref-MS_DotNET_EoL_23-2" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-MS_DotNET_EoL-23"&gt;[22]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Microsoft Blend" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Microsoft_Blend"&gt;Expression Blend&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-blend_28-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-blend-28"&gt;[27]&lt;/a&gt;&lt;/sup&gt;&lt;sup class="reference" id="ref_b1none" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#endnote_b1none"&gt;[b]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Vista" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Vista"&gt;Vista&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2008 SP2" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2008_SP2"&gt;2008 SP2&lt;/a&gt;, &lt;a title="Windows Server 2008 R2 SP1" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2008_R2_SP1"&gt;2008 R2 SP1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_3.5"&gt;3.5&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2.0&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2007-11-19&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2011-07-12&lt;sup class="reference" id="cite_ref-MS_DotNET_EoL_23-3" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-MS_DotNET_EoL-23"&gt;[22]&lt;/a&gt;&lt;/sup&gt;&lt;br /&gt;(except 3.5 SP1)&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2008" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2008"&gt;Visual Studio 2008&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2008_29-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2008-29"&gt;[28]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 7" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_7"&gt;7&lt;/a&gt;, &lt;a title="Windows 8" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_8"&gt;8&lt;/a&gt;&lt;sup class="reference" id="ref_c1none" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#endnote_c1none"&gt;[c]&lt;/a&gt;&lt;/sup&gt;, &lt;a title="Windows 8.1" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_8.1"&gt;8.1&lt;/a&gt;&lt;sup class="reference" id="ref_c2none" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#endnote_c2none"&gt;[c]&lt;/a&gt;&lt;/sup&gt;, &lt;a title="Windows 10" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_10"&gt;10&lt;/a&gt;&lt;sup class="reference" id="ref_c3none" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#endnote_c3none"&gt;[c]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2008 R2 SP1" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2008_R2_SP1"&gt;2008 R2 SP1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2.0, 3.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4"&gt;4.0&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2010-04-12&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2016-01-12&lt;sup class="reference" id="cite_ref-451-support_30-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-451-support-30"&gt;[29]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2010" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2010"&gt;Visual Studio 2010&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2010_31-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2010-31"&gt;[30]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5"&gt;4.5&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2012-08-15&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2016-01-12&lt;sup class="reference" id="cite_ref-451-support_30-1" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-451-support-30"&gt;[29]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2012" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2012"&gt;Visual Studio 2012&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2012_32-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2012-32"&gt;[31]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 8" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_8"&gt;8&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2012" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2012"&gt;2012&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5.1"&gt;4.5.1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2013-10-17&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2016-01-12&lt;sup class="reference" id="cite_ref-451-support_30-2" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-451-support-30"&gt;[29]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2013" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2013"&gt;Visual Studio 2013&lt;/a&gt;&lt;sup class="reference" id="cite_ref-new-vs2013_33-0" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-new-vs2013-33"&gt;[32]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 8.1" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_8.1"&gt;8.1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2012 R2" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2012_R2"&gt;2012 R2&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0, 4.5&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5.2"&gt;4.5.2&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2014-05-05&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0–4.5.1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6"&gt;4.6&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2015-07-20&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2015" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2015"&gt;Visual Studio 2015&lt;/a&gt;&lt;sup class="reference" id="cite_ref-34" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-34"&gt;[33]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 10" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_10"&gt;10&lt;/a&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0–4.5.2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6.1"&gt;4.6.1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2015-11-30&lt;sup class="reference" id="cite_ref-35" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-35"&gt;[34]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2015" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2015"&gt;Visual Studio 2015 Update 1&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 10" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_10#Threshold_2"&gt;10 v1511&lt;/a&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0–4.6&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6.2"&gt;4.6.2&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2016-08-02&lt;sup class="reference" id="cite_ref-36" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-36"&gt;[35]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 10" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_10#Redstone_1"&gt;10 v1607&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows Server 2016" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_Server_2016"&gt;2016&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0–4.6.1&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title=".NET Framework version history" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.7"&gt;4.7&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;2017-04-05&lt;sup class="reference" id="cite_ref-37" style="line-height: 1; font-size: 11.2px; white-space: nowrap;"&gt;&lt;a style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/.NET_Framework#cite_note-37"&gt;[36]&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Visual Studio 2017" class="mw-redirect" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Visual_Studio_2017"&gt;Visual Studio 2017&lt;/a&gt;&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;&lt;a title="Windows 10" style="background: none; color: rgb(11, 0, 128); text-decoration: none;" href="https://en.wikipedia.org/wiki/Windows_10#Redstone_2"&gt;10 v1703&lt;/a&gt;&lt;/td&gt;&lt;td class="table-na" style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em; color: rgb(44, 44, 44); font-size: smaller; vertical-align: middle; background-color: rgb(236, 236, 236);" data-sort-value=""&gt;N/A&lt;/td&gt;&lt;td style="border-color: rgb(162, 169, 177); padding: 0.2em 0.4em;"&gt;4.0–4.6.2&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figcaption&gt;&lt;figcaption&gt;來源：&lt;a href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#Overview"&gt;.NET Framework version history&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;   可以看到.Net Framework每一個版本新增的部分：    &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-YoMuclcaW6k/Wed3Wy_yHlI/AAAAAAAAWqI/tAapohWCro4QbzFcMi3Sm34-OXSj8l_uQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="304" height="404" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--J069R58vPg/Wed3bDRaEuI/AAAAAAAAWqM/IWJWTzedcREQMlZlOv9hm-6w4Zkth5zqACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;wikipedia：&lt;a href="https://en.wikipedia.org/wiki/.NET_Framework"&gt;.Net Framework&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;   .Net Framework 3.5這個版本最特別：&lt;br /&gt;&lt;dl&gt;&lt;dt&gt;      Framework版本號和CLR版本號不一樣     &lt;/dt&gt;&lt;dd&gt;      因此不了解的很容易以為有CLR 3.5     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      只有CLR 2.0的電腦可以用LINQ     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     曾經有一些舊案，無法升級.Net Framework，所以無法用LINQ。（還怎麼寫code，沒LINQ等於沒了google的工程師）     &lt;/p&gt;&lt;p&gt;     解決方式是另開一個LIbrary target .Net Framework 3.5並且用LINQ，main使用這個lib run起來不會有問題。原因是底層用的是CLR 2.0     &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612915464"&gt;.Net Framework執行方式&lt;/h2&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3JqHY9XxpkE/Wed3dc3Xt3I/AAAAAAAAWqQ/Kig6pjcNbiQaohl5H8iVWJTOsZjLOVaAgCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="278" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-SyzkFOUuDuA/Wed3fsJ6peI/AAAAAAAAWqU/CVr3kOQTFDwtkk3s0RYayA0D4e3jbX4IACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;從source code到run起來的經過&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;編譯程式碼&lt;/li&gt;&lt;li&gt;建立出dll或者exe（IL）&lt;/li&gt;&lt;li&gt;run起來的時候透過CLR及時編譯&lt;/li&gt;&lt;li&gt;BCL會一起執行&lt;/li&gt;&lt;li&gt;變成機器碼並且run起來&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612915898"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇把.Net Framework做了一個基本介紹，了解了安裝包含那些內容、版號的含義和如何把程式執行起來。基本上對於.Net Framework會有一個基本的概念。   &lt;/p&gt;&lt;p&gt;  在進入.Net Core之前，下篇會對C#做一些基本介紹，不同版號的功能差異、和.Net Framework的對應關係，和.Net Compiler Platform (aka Roslyn)到來的原因。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508340612915825"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     Wiki 介紹 .Net Framework    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://en.wikipedia.org/wiki/.NET_Framework"&gt;https://en.wikipedia.org/wiki/.NET_Framework&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     檢查安裝的.Net Framework    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed"&gt;https://docs.microsoft.com/en-us/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;     &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:13f56fa9-cbc5-4285-a728-f0db570443a1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cnet+framework%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9c%8bnet+core%e3%80%8d" rel="tag"&gt;「net framework工程師看net core」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6721371209230633973/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-02-net-framework-overview.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6721371209230633973'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6721371209230633973'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core-02-net-framework-overview.html' title='[.net framework 工程師看.net core][02]起源.Net Framework'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-D5QRYO08BlU/Wed3Pb4ULyI/AAAAAAAAWp0/3clk9ZfCYIIJDvLPkSp55lefDxk7lAHAgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2266231975058843859</id><published>2017-10-15T08:21:00.000+08:00</published><updated>2017-10-15T08:21:32.549+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='「net framework工程師看net core」'/><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.net framework工程師看.net core][01]開篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vcbsVV46QTM/WeKpoY_4yUI/AAAAAAAAWpQ/2qgHjgzNZ4E7kWcsMhQdLpZ7R9ERPmv-QCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-F__nMDn6gIo/WeKppw-8_nI/AAAAAAAAWpU/thWbEvif7HQ4Wup0gPGTIIfjBjs_NcJiwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  作為.net 工程師來說，最近最夯的應該就是.net core 2.0的正式發佈。   &lt;/p&gt;&lt;p&gt;  如果你和我一樣，是一個從頭到尾只使用Windows並且以開發C# .net為主的工程師，那麼.net core最明顯的&lt;em&gt;真&lt;/em&gt;跨平台可能沒什麼吸引力，畢竟只用Windows還需要夸平台嗎？   &lt;/p&gt;&lt;p&gt;  那麼是否.net core就不重要了呢？是否應該花時間學習呢？在這個系列希望能夠給目前.net為主的工程師節省一些查資料的時間，並且了解.net core的重要性。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt;   &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508026429086247" ;=""&gt;為什麼要寫這個系列&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508026429086964" ;=""&gt;這個系列會包含什麼內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1508026429086244" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1508026429086247"&gt;為什麼要寫這個系列&lt;/h2&gt;&lt;p&gt;  首先，先給各位一點我的背景，我正式寫.net (專案上面使用.net) 至少有了4~5年的時間，如果加上從大學時代開始學習並且寫.net，那麼也可以說快10年了。   &lt;/p&gt;&lt;p&gt;  我只會使用Windows的作業系統，並且很習慣使用地表上最強的IDE：Visual Studio。   &lt;/p&gt;&lt;p&gt;  因此對於我來說，.net core的跨平台好處對我個人來說吸引力並不大，畢竟都用.net了，那麼架設在Windows Server裡面的IIS不是很一般的事情嗎？那麼是否有必要花時間去學習呢？   &lt;/p&gt;&lt;p&gt;  其實答案非常明確，那就是&lt;strong&gt;&lt;em&gt;要&lt;/em&gt;&lt;/strong&gt;。原因是.net Core的目的和組成方式和.net Framework不同，因此使用情境也不同。   &lt;/p&gt;&lt;p&gt;  如果有接觸過.net core 1.x就會知道一件事情，和所有專案一樣，不變的事情就是&lt;em&gt;一直在變&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;  那麼.net core 2.0是否也會如此呢？   &lt;/p&gt;&lt;p&gt;  基本上.net core 2.0相較於.net core 1.x來說，成熟很多因此可以考慮進場了。   &lt;/p&gt;&lt;p&gt;  這系列的文章將會以一個.net framework工程師的角度，來了解.net core對一個現行的.net framework工程師來說到底帶來了什麼變換，並且如何讓我們的code更future proof。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508026429086964"&gt;這個系列會包含什麼內容&lt;/h2&gt;&lt;p&gt;  這個系列會包含我自己對於.net Framework的一個重新檢視先了解歷史，在了解未來，所以內容大約包含：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Review一下在沒有.net core之前，.net framework是個什麼情況，並且做一個簡單的總結&lt;/li&gt;&lt;li&gt;介紹一些.net core所帶來執行上面的差異&lt;/li&gt;&lt;li&gt;介紹一下.net Standard 2.0的到來 - 擁抱.net core先從擁抱.net standard做起&lt;/li&gt;&lt;li&gt;介紹tooling 部分的改變 - 其中template模式會和之前另外一個系列接上      (&lt;a href="http://blog.alantsai.net/search/label/%E3%80%8C%E6%89%93%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84template-%E5%BB%BA%E7%AB%8B%E4%B8%80%E8%87%B4%E6%80%A7%E7%A8%8B%E5%BC%8F%E7%A2%BC%E3%80%8D"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;)&lt;/li&gt;&lt;li&gt;介紹一下asp .net core - 不過不會太多，這個應該會是另外一個系列&lt;/li&gt;&lt;li&gt;介紹一下UWP - 一樣不會太多，詳細應該會是另外一個系列&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1508026429086244"&gt;結語&lt;/h2&gt;&lt;p&gt;  作為程式設計師的好處是，永遠有新的東西可以學，作為程式設計師的壞處也是&lt;em&gt;永遠&lt;/em&gt;有新東西可以學。因此，什麼&lt;em&gt;時候&lt;/em&gt;學和學&lt;em&gt;什麼&lt;/em&gt;非常重要。   &lt;/p&gt;&lt;p&gt;  我相信.net core是肯定值得投資時間的技術，並且現在時間點比之前適合很多，因為2.0相比1.0穩定了很多，並且.net standard也基本上涵蓋了所有.net Framework的api。   &lt;/p&gt;&lt;p&gt;  在下篇將會從review開始，所謂知己知彼，百戰百勝，先了解現有有什麼，並且有什麼問題，再來了解.net core的出現就會變得比較簡單。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:c22e86bb-24fd-481e-9e5b-65a5bbbbec0a" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8cnet+framework%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9c%8bnet+core%e3%80%8d" rel="tag"&gt;「net framework工程師看net core」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/.net" rel="tag"&gt;.net&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2266231975058843859/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core01-introduction.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2266231975058843859'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2266231975058843859'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/net-framework-see-new-core01-introduction.html' title='[.net framework工程師看.net core][01]開篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-F__nMDn6gIo/WeKppw-8_nI/AAAAAAAAWpU/thWbEvif7HQ4Wup0gPGTIIfjBjs_NcJiwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7491081839329919879</id><published>2017-10-13T20:45:00.000+08:00</published><updated>2017-10-13T20:45:48.323+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='net-standard'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][03-3].Net Standard 2.0能夠直接Reference .Net Framework Library</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WZ_-oZFJ2cM/WeCzcZhAm6I/AAAAAAAAWng/ZK5XZmEI82IWFPRGCoPavarAlHEznqn2ACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-RoEuaScvFJw/WeCzi5owEEI/AAAAAAAAWnk/W8jn4lnYxpg5nQ-1QrnMBPSktc5xkjNPACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  透過上一個lab： 了解到了如何更容易評估把.net framework程式碼port到.net Standard之後，接下來的問題就是，可是有些第三方.net framework library&lt;em&gt;沒有&lt;/em&gt;source code但是&lt;em&gt;又要用&lt;/em&gt;怎麼辦？   &lt;/p&gt;&lt;p&gt;  在這個lab將會介紹.Net Standard 2.0帶來的一大優勢，能夠直接reference .net framework的library。將會使用一個2012的library：&lt;code&gt;NQuery&lt;/code&gt;，主要目的是可以用sql語法來查詢資料。將會調整改成這種方式來查資料。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    上個lab的最後成果的程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab3%2F1-port-net-standard-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;     &lt;section&gt;     &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507897775595875" ;=""&gt;操作步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507897775596521" ;=""&gt;修改Net Standard Library使用NQuery&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507897775596281" ;=""&gt;測試net core console結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507897775596601" ;=""&gt;測試WinForm&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507897775595875"&gt;操作步奏&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;修改Net Standard Library使用NQuery&lt;/li&gt;&lt;li&gt;測試net core console結果&lt;/li&gt;&lt;li&gt;測試WinForm&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507897775596521"&gt;修改Net Standard Library使用NQuery&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      以NQuery這個套件為例子，最後更新是2012年 肯定不是.net core     &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.nuget.org/packages/NQuery/"&gt;https://www.nuget.org/packages/NQuery/&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HFqPEhNcdVk/WeCzndX7dQI/AAAAAAAAWno/QLmtEIIlb5Yqz_IxbMkmpWXURXveIuc9wCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="372" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-c-qZqzUyuEk/WeCzqQE8VzI/AAAAAAAAWns/I3W_4mM1GFcLCOgmqf1UUeTUwjrOBksYQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      準備加入Nquery     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;對 &lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;Manage Nuget Package..&lt;/code&gt;&lt;/li&gt;&lt;li&gt;搜索&lt;code&gt;NQuery&lt;/code&gt;&lt;/li&gt;&lt;li&gt;安裝&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-640gGImj7LQ/WeCzs3UGbFI/AAAAAAAAWnw/dnNYzXhQTpIqZMLh3hrvzB6S8C0Vrbk3QCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="189" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tsYRJMlK0HQ/WeCzv4TLqgI/AAAAAAAAWn0/WV-sXvCigiwrG2Ou41Vh_FDUynvf6JPLwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      調整 &lt;code&gt;NorthwindDalNetStandard.NorthwindDal.cs&lt;/code&gt;的&lt;code&gt;GetEmployeeFromCountry&lt;/code&gt;方法內容，改成用&lt;code&gt;NQuery&lt;/code&gt;來過濾     &lt;/dt&gt;&lt;dd&gt;      改成以下程式碼： &lt;pre class="brush: csharp;"&gt;public static string GetEmployeeFromCountry(string filterCountry = "UK")&lt;br /&gt;{&lt;br /&gt; DataSet dataSet = new DataSet();&lt;br /&gt; dataSet.ReadXml("northwind.xml");&lt;br /&gt;&lt;br /&gt; var dataContext = new DataContext();&lt;br /&gt; dataContext.AddTablesAndRelations(dataSet);&lt;br /&gt;&lt;br /&gt; var sql = @"&lt;br /&gt;  SELECT  e.FirstName + ' ' + e.LastName&lt;br /&gt;  FROM    Employees e&lt;br /&gt;  WHERE   e.Country = '" + filterCountry + "'";&lt;br /&gt;&lt;br /&gt; var query = new Query(sql, dataContext);&lt;br /&gt; var results = query.ExecuteDataTable();&lt;br /&gt; var values = results.Rows.Cast&amp;lt;DataRow&amp;gt;().Select(r =&amp;gt; (string)r[0]);&lt;br /&gt; var result = string.Join(Environment.NewLine, values);&lt;br /&gt;&lt;br /&gt; return result;&lt;br /&gt;}&lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507897775596281"&gt;測試net core console結果&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      build專案，並且用dotnet執行     &lt;/dt&gt;&lt;dd&gt;      用&lt;code&gt;cmd&lt;/code&gt;執行：&lt;code&gt;dotnet NetCoreConsole.dll&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5iohtkEZu9s/WeCzzu5MhRI/AAAAAAAAWn4/ny5MajQKVfwDc0xShwcwOZ1fnBpjHl6xQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="103" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-_WqjVdfyE48/WeCz22zWnbI/AAAAAAAAWn8/Zp__Xo8R_okUNDn5uC5tBoUeqhYb1LolACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;   執行結果和未修改前一致，換句話說使用沒有問題    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507897775596601"&gt;測試WinForm&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      如果用 WinForm來執行會出錯     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     會出現說 Nquery 這個 dll 找不到      &lt;/p&gt;&lt;pre class="brush: plain;"&gt;System.IO.FileNotFoundException: Could not load file or assembly &lt;br /&gt;'NQuery, Version=0.9.5.0, Culture=neutral, PublicKeyToken=c65c4087e4cc0612' &lt;br /&gt;or one of its dependencies. The system cannot find the file specified.&lt;br /&gt;     &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oKF4459O3Wk/WeCz5CZqhPI/AAAAAAAAWoA/TvdoIXrQIroPbK05AsAJ5ddVeB5OOpAnwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="297" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CIlO_vy6E0E/WeCz61XE9aI/AAAAAAAAWoE/p1WzH1x9RzADTfzFc5WitleirlhFuxcrwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     這個是一個已知的bug，只有以前的程式（.Net Framework）的會發生，需要手動改csproj     &lt;/dt&gt;&lt;dd&gt;      先對&lt;code&gt;LegacyApplication.View&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;然後選擇&lt;code&gt;Unload Project&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-PkDuRC_Io24/WeCz_BQ301I/AAAAAAAAWoM/A0aHV1nz_VQ6EIASJ0MOhrlH9_6TMrShACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="419" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OZpnwdI-kO8/WeC0DTx_eXI/AAAAAAAAWoU/UCK_TZBlf2Eg-UjGvWZgcmfY338Bfr4BwCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;      這個bug目前沒有任何預計解決辦法，只有改csproj檔案而已。相關issue請看：&lt;a href="https://github.com/dotnet/sdk/issues/901"&gt;https://github.com/dotnet/sdk/issues/901&lt;/a&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在來對csproj做修改     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;對&lt;code&gt;LegacyApplication.View&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;，然後選擇 &lt;code&gt;Edit LegacyApplication.View.csproj&lt;/code&gt;&lt;/li&gt;&lt;li&gt;加入&lt;code&gt;&amp;lt;RestoreProjectStyle&amp;gt;PackageReference&amp;lt;/RestoreProjectStyle&amp;gt;&lt;/code&gt;&lt;/li&gt;&lt;li&gt;確定也有&amp;lt;AutoGenerateBindingRedirects&amp;gt;true&amp;lt;/AutoGenerateBindingRedirects&amp;gt;&lt;/li&gt;&lt;li&gt;好了 之後 &lt;code&gt;Reload Project&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-kEOuJ2CkBE0/WeC0LW45LLI/AAAAAAAAWoY/x6Z5wUio4vsvovAng_WpGi6JfM4Ixm_bwCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="209" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-ejDAOoOXiGM/WeC0OMmAnJI/AAAAAAAAWoc/dhpHZpiuPKovgpzwHOrS2N-8X1EGFUjiACHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;       設定 為起始專案 之後嘗試執行     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4Vg5PM7__Fc/WeC0Py3ULoI/AAAAAAAAWog/2Pzz7_56f2ASZegqaW-9dG96i1-91JxnwCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="431" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-KJkezPW-hzM/WeC0QlQGaKI/AAAAAAAAWok/22lZ3yTeD5o0d0HGtoCtl8696WxBAq39wCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;p&gt;  透過以上方式，據說&lt;em&gt;70%&lt;/em&gt;的nuget net Framework api net standard 2.0 都能夠支援，換句話說能夠減少整合成本。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   雖然說.Net standard 2.0可以直接reference，但是如果是可以控制的lib，建議還是統一改成net standard，更容易和未來接軌。   &lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    完整程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab3/3-use-net-framework-lib-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab3/3-use-net-framework-lib-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab3%2F3-use-net-framework-lib-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:b73daaf7-7a90-4368-9fc5-71d5ed3f267e" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-standard" rel="tag"&gt;net-standard&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7491081839329919879/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-3-use-net-framework-lib-from-net-standard-2-lib.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7491081839329919879'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7491081839329919879'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-3-use-net-framework-lib-from-net-standard-2-lib.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][03-3].Net Standard 2.0能夠直接Reference .Net Framework Library'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-RoEuaScvFJw/WeCzi5owEEI/AAAAAAAAWnk/W8jn4lnYxpg5nQ-1QrnMBPSktc5xkjNPACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3892088295819663269</id><published>2017-10-13T20:25:00.000+08:00</published><updated>2017-10-13T20:25:33.592+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='net-standard'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][03-2]使用.NET API Portability分析API支援程度</title><content type='html'>&lt;section&gt;&lt;figure&gt;    &lt;a href="https://lh3.googleusercontent.com/-SAI-zrf-1sk/WeCqBZESxQI/AAAAAAAAWmU/ijOJJthNygQNTOsdKCYUNAP5ECGrJbV8QCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-AhDe8of7Nfc/WeCqK_BCY1I/AAAAAAAAWmY/Nd7N66EyA_cED6rt5hzQseQEybvHRMB8gCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一個lab：&lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-1-port-net-framework-lib-to-net-standard.html"&gt;[03-1]現有.Net Framework Lib 改成 .Net Standard&lt;/a&gt; 了解了如何把一個現行的.Net Framework邏輯移轉到Target .Net Standard以達到最大跨平台共用邏輯的需求。在操作的過程中有特意轉成.Net Standard 1.6來模擬不支援的api &lt;code&gt;DataSet&lt;/code&gt;，   並且了解如何使用 Api Browser來查看api支援度。   &lt;/p&gt;&lt;p&gt;  不過，難道沒有工具能夠分析現行程式碼是否支援那些target嗎？   &lt;/p&gt;&lt;p&gt;  在這一個lab將會使用&lt;em&gt;&lt;strong&gt;.NET API Portability&lt;/strong&gt;&lt;/em&gt;來達到分析支援度的情況。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    上個lab的最後成果的程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab3%2F1-port-net-standard-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507895436907717" ;=""&gt;操作步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507895436907350" ;=""&gt;安裝.NET API Portability&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507895436908951" ;=""&gt;設定和對專案進行分析&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507895436908217" ;=""&gt;檢視結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507895436908248" ;=""&gt;相關資源&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507895436907717"&gt;操作步奏&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;安裝&lt;code&gt;.NET API Portability&lt;/code&gt;&lt;/li&gt;&lt;li&gt;設定和對專案進行分析&lt;/li&gt;&lt;li&gt;檢視結果&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507895436907350"&gt;安裝.NET API Portability&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      下載並且安裝套件 .NET API Portability     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     可以再這個鏈接下載到：      &lt;a href="https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer"&gt;https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    目前支援：     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Visual Studio 2015&lt;/li&gt;&lt;li&gt;Visual Studio 2017&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;    先把所有Visual Studio關掉。     &lt;/p&gt;&lt;p&gt;    然後對下載下來的vsix點兩下。     &lt;/p&gt;&lt;p&gt;    安裝和一般VS套件一樣，就是下一步到底。     &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507895436908951"&gt;設定和對專案進行分析&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      對&lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;專案 點 &lt;kbd&gt;右鍵&lt;/kbd&gt; -&amp;gt; 選擇 &lt;code&gt;Portability Analyzer Settings&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-j2fqCt-_puU/WeCqO2O_E5I/AAAAAAAAWmc/P6p5WfkdRwogHM0OaApsJEECpQg-JJ39wCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="331" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-cf9IBMv19yw/WeCqSuHRMEI/AAAAAAAAWmg/agVH2UOuAl8nnkz8spk-0GSF26l65MejACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在打開的視窗，能夠 設定：     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;分析結果的檔案格式&lt;/li&gt;&lt;li&gt;要對那個platform分析&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-CUv9GViF130/WeCqYo1moeI/AAAAAAAAWmk/VswZTPlVa3QVIb6T0sT98BMJCRrfG81_QCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="457" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Ql44leBlqDk/WeCqcTzDJoI/AAAAAAAAWmo/ElDA1AfAA8MQYEY1BCz8OkklB0AWxAXfQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      設定好了之後，對 &lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;點 &lt;kbd&gt;右鍵&lt;/kbd&gt; -&amp;gt; &lt;code&gt;Analyze Project Portability&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-qr57225X4jk/WeCqkNOIPEI/AAAAAAAAWms/f3CPYuoDgYohhbJpusKdzxTSTya0xM3GgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="394" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-w9XQyJjaomw/WeCqoVgyY9I/AAAAAAAAWm0/W6TpAWMK1PIZjVP96JVrqkBCOpjAAKR4QCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      執行完了之後，會跳出一個視窗，可以點產生出來的excel     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-oMYt0qzrfZ0/WeCqsG6vdCI/AAAAAAAAWm4/F7fzqk51ndUKLvyEGFh9JyzjkEk-XKDMACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="184" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-UM7ZctoC8QA/WeCqu0z6EOI/AAAAAAAAWm8/ZmjVREnYetQvtOXy1imfvqLhQlgWDiv1QCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507895436908217"&gt;檢視結果&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      第一頁簽是結論，可以看出來 .Net Standard 1.6有部分不支援     &lt;/dt&gt;&lt;dd&gt;      格子有被標黃，並且數字不是100，表示只有 75.93 的api在.Net Standard 1.6是有支援      &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Q8dRMbveMyc/WeCq2m70ZoI/AAAAAAAAWnA/HvWE3zlrYX4AzuYYeruordQFY97Vv333QCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="137" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-I1wID4Za81E/WeCq4ylA9XI/AAAAAAAAWnE/XVh6IQVbKhsLlhq50TSnxtPtapc36NteQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      切換下面的頁簽到&lt;code&gt;Details&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;      可以看到詳細的API，並且有問題的都是&lt;code&gt;DataSet&lt;/code&gt;的部分 - 這個分析結果甚至能夠告訴你 .Net Standard 2.0就有支援了      &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4og_pPl3078/WeCq9PcSYdI/AAAAAAAAWnI/IluFTXJNIQIK2R4_mQOfoMkPC6ydk6j0wCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="170" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-fX5oEpaa77I/WeCq-Y1desI/AAAAAAAAWnM/IEaOVGOGy2AY3VVeNMAz5i6KAG4xIbCigCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;p&gt;  透過.NET API Portability 工具能夠分析的出一個粗略轉到.Net Standard會需要花的工，因此可以用來做一個事前的工作量評估工具。   &lt;/p&gt;&lt;p&gt;  不過還是要注意，這個只是一個參考值，有些問題可能會是runtime才遇到，那這個工具就無能為力。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507895436908248"&gt;相關資源&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     官方github repo    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://github.com/microsoft/dotnet-apiport"&gt;https://github.com/microsoft/dotnet-apiport&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Visual Studio Marketplace 下載    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer"&gt;https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     官方文件介紹    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/standard/portability-analyzer"&gt;https://docs.microsoft.com/zh-tw/dotnet/standard/portability-analyzer&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:41b796a4-c1e0-4661-8cc9-88ea22ed07b9" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-standard" rel="tag"&gt;net-standard&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3892088295819663269/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-2-use-net-api-portability-analyze-platform-support.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3892088295819663269'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3892088295819663269'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-2-use-net-api-portability-analyze-platform-support.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][03-2]使用.NET API Portability分析API支援程度'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-AhDe8of7Nfc/WeCqK_BCY1I/AAAAAAAAWmY/Nd7N66EyA_cED6rt5hzQseQEybvHRMB8gCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3903266438706167184</id><published>2017-10-13T07:45:00.000+08:00</published><updated>2017-10-13T07:45:14.473+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='net-standard'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][03-1]現有.Net Framework Lib 改成 .Net Standard</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ObswyaamZvo/Wd_7urb8UAI/AAAAAAAAWjs/_Qjlxin5W3ULo8Z6meNTFjc2MWQgZlx5wCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-D_27VfRzhlI/Wd_8Nqw_IgI/AAAAAAAAWjw/yYtWbZ1qBncCxck_39adKtfG7BNtqzcuQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在前兩個lab 2裡面(&lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-1-net-core-console-with-FDD-publish.html"&gt;[Lab2-1]了解Framework Dependent Deployment(FDD)執行(發佈)模式&lt;/a&gt;、   &lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-2-net-core-console-with-SCD-publish.html"&gt;[Lab2-2]了解Self Contained Deployment(SCD)執行(發佈)模式&lt;/a&gt;)了解了.Net Core和.Net Framework 不同執行模式以後。   &lt;/p&gt;&lt;p&gt;  在lab 3將會切換到另外一個很重要的部分，&lt;em&gt;&lt;strong&gt;.Net Standard 2.0&lt;/strong&gt;&lt;/em&gt;的到來。   &lt;/p&gt;&lt;p&gt;  這個lab將會介紹如何移轉現有target .net Framework的程式改成.Net Standard以達到多runtime使用重複邏輯。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   一般來說會先port test程式碼，在port實際的業務程式碼，不過做法都類似，以這個範例就直接port業務程式碼。   &lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507850726674357" ;=""&gt;操作步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507850726675855" ;=""&gt;取得一個WinForm的ap模擬一個要轉移的AP&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507850726675573" ;=""&gt;建立一個.Net Standard 1.6的lib，嘗試轉移出現錯誤 - 了解如何檢查api版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507850726675745" ;=""&gt;建立一個.net core console使用建立出來的.Net Standard Lib&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507850726675682" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507850726674357"&gt;操作步奏&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;取得一個WinForm的ap模擬一個要轉移的AP&lt;/li&gt;&lt;li&gt;建立一個.Net Standard 1.6的lib，嘗試轉移出現錯誤 - 了解如何檢查api版本&lt;/li&gt;&lt;li&gt;建立一個.net core console使用建立出來的.Net Standard Lib&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507850726675855"&gt;取得一個WinForm的ap模擬一個要轉移的AP&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      先取得模擬舊ap的.net framework程式     &lt;/dt&gt;&lt;dd&gt;      可以兩個方式取得：      &lt;ol&gt;&lt;li&gt;&lt;ul&gt;&lt;li&gt;用git &lt;code&gt;clone&lt;/code&gt;：&lt;code&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop.git&lt;/code&gt;&lt;/li&gt;&lt;li&gt;用 git &lt;code&gt;checkout&lt;/code&gt;切換到branch：&lt;code&gt;lab3/1-port-net-standard-start&lt;/code&gt;&lt;/li&gt;&lt;li&gt;          瀏覽到：&lt;code&gt;src\lab3-port-to-net-standard&lt;/code&gt; - 複製這個資料夾出來          &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6Es8X4XyzKQ/Wd_8Q3HHD7I/AAAAAAAAWj0/B3pi_zuxEjcKiirhwbt9nNk0EZxJeisTgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="173" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qGOTw-58Usg/Wd_8SdBAtsI/AAAAAAAAWj4/sTSirOkfTw8dTtP4s7mhj-kY4TvQx1N-gCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;看到：LegacyApplication.sln&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;       可以使用 &lt;a href="http://kinolien.github.io/gitzip/"&gt;http://kinolien.github.io/gitzip/&lt;/a&gt;來下載，做法如下：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;網址輸入：&lt;code&gt;http://kinolien.github.io/gitzip/&lt;/code&gt;&lt;/li&gt;&lt;li&gt;鏈接輸入：&lt;code&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop/tree/lab3/1-port-net-standard-start/src/lab3-port-to-net-standard&lt;/code&gt;&lt;/li&gt;&lt;li&gt;按下 &lt;kbd&gt;Download&lt;/kbd&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3JaH2SwEfzU/Wd_8WC638NI/AAAAAAAAWj8/IvvKdWLi8IYMfiRECJ3lCuaaVpaJv2lNACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="150" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bAJbl7gOZ8s/Wd_8b0bbhjI/AAAAAAAAWkE/sXy-YdBvx-cy0r132rf-Vue4igENHHTXACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figure&gt;&lt;p&gt;       或者使用&lt;a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/alantsai-samples/2017-10-14-net-core-workshop/tree/lab3/1-port-net-standard-start/src/lab3-port-to-net-standard"&gt;https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/alantsai-samples/2017-10-14-net-core-workshop/tree/lab3/1-port-net-standard-start/src/lab3-port-to-net-standard&lt;/a&gt; 來直接下載開始檔案。        &lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      測試現行AP     &lt;/dt&gt;&lt;dd&gt;      直接run起來，這是一個模擬找出所有在&lt;code&gt;英國&lt;/code&gt;的員工並且列出來。      &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UlWNNgul9cY/Wd_8e7hkGRI/AAAAAAAAWkI/Jc6weyfQIE0Ba0pj7Azeam2PKJhyM1eUQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="298" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XNSFrCGFuUc/Wd_8f23tAMI/AAAAAAAAWkM/RUERoRxXbH0ekmEZnlVFyUyKO_5sx5wJwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507850726675573"&gt;建立一個.Net Standard 1.6的lib，嘗試轉移出現錯誤 - 了解如何檢查api版本&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      在&lt;code&gt;LegacyApplication&lt;/code&gt;的sln點 &lt;kbd&gt;右鍵&lt;/kbd&gt; -&amp;gt; &lt;code&gt;New Project&lt;/code&gt;，然後在彈出的畫面輸入：     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;先選擇 &lt;code&gt;.Net Standard&lt;/code&gt;&lt;/li&gt;&lt;li&gt;再選&lt;code&gt;Class Library（.net Standard)&lt;/code&gt;&lt;/li&gt;&lt;li&gt;輸入框Name：&lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XLCA73SZV_A/Wd_8h2L2ZJI/AAAAAAAAWkQ/AIzAH6FBooYj6qtN_hZxsw-Uv2_3CRX-gCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="454" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-bTLolETcBXQ/Wd_8l0M8E7I/AAAAAAAAWkU/7Aj1Nbhclmck2pWOUkU-uIG5oZRwVVuLACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      這個時候會建立出一個.net standard的library專案     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;對&lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;點 &lt;kbd&gt;右鍵&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;選擇 &lt;code&gt;Properties&lt;/code&gt;&lt;/li&gt;&lt;li&gt;把 &lt;code&gt;Target Framework&lt;/code&gt;改成&lt;code&gt;.Net Standrd 1.6&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-L8PX7G5ownE/Wd_8nxIeLaI/AAAAAAAAWkY/VOE6PynREPoZOa4S4xLnCqD0XYh3vGkbgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="341" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-y7p2tUxKuFA/Wd_8qE6JQ4I/AAAAAAAAWkc/FEiiAeRwQtYOClLJmeIjX84HgmJuIk5LwCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;模擬建立出來的是.Net Standard 1.6的lib&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      從&lt;code&gt;LegacyApplication.View&lt;/code&gt;專案裡面把&lt;code&gt;northwind.xml&lt;/code&gt;和&lt;code&gt;NorthwindDal.cs&lt;/code&gt;複製一份到&lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;專案底下，最後結果如下     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cz0J5w7CUB8/Wd_8sMUHWuI/AAAAAAAAWkg/ZTTiHSZI6H4rzY1XBK2kc2cmPP8AbJzfQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="636" height="646" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Z5-C0UKDvP4/Wd_8vpG8IoI/AAAAAAAAWkk/Rh18HVdpmXoo4HFfjMKumLPq21mfiZBwQCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      把專案 Build，會出現錯誤，發生DataSet找不到的情況     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WZx4IrMzOhY/Wd_8zERW3LI/AAAAAAAAWko/CyIn-vRT8b837fqavo8bD6IMdlv1MUqzQCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="478" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-T8ujCp-3M8c/Wd_815jVYyI/AAAAAAAAWks/90N2K7WZJXEVL3J7Px2-fyumU69SniDygCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      可以使用 .Net Api Browser來檢查api支援度     &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/api/?view=netstandard-1.6"&gt;https://docs.microsoft.com/zh-tw/dotnet/api/?view=netstandard-1.6&lt;/a&gt; - 會發現&lt;code&gt;DataSet&lt;/code&gt;並不存在      &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5I8w-LIVIK0/Wd_86z3JoTI/AAAAAAAAWkw/X0JF7pGm8jcR3RjWTyk6mYh8ZVzLWqbPgCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="371" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-y3a0Npq5z1k/Wd_88L8ZdtI/AAAAAAAAWk0/8IooPH8Wengur4vrcWrXGsKkoO_Qr2rVACHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      而在 .Net Standard 2.0 有     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;點選 .Net Standard 1.6&lt;/li&gt;&lt;li&gt;選擇.Net Standard&lt;/li&gt;&lt;li&gt;選擇版本為2.0&lt;/li&gt;&lt;li&gt;可以看到就有支援DataSet&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-uKQLk4mINMk/Wd_897HH5iI/AAAAAAAAWk8/jbZaqM9qfucYze_on70hMhz96TWq0rQnQCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="441" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qM4TvJqHo3g/Wd_9Cwq6ZuI/AAAAAAAAWlA/np_A9_J4cxQa24zTU5vhbn044RTV9K6SwCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      把Target從1.6轉回到2.0 在build就沒有問題了     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-qFfDFutC2xM/Wd_9GdBFtPI/AAAAAAAAWlE/5s9DtNXVV_QUq5vlVfvumHfpzuvLEDlXwCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="286" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-eLFKJeJ9eMI/Wd_9K1N0JZI/AAAAAAAAWlI/_JK0qyLS-MEHuqDyV69dFcpuXssby0hSwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      把 &lt;code&gt;northwind.xml&lt;/code&gt;和&lt;code&gt;NorthwindDal.cs&lt;/code&gt;從&lt;code&gt;LegacyApplication.View&lt;/code&gt;專案刪掉，並且把&lt;code&gt;NorthwindDalNetStandard&lt;/code&gt;加入到reference，最後樣子如下：     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Brev4xJaZdE/Wd_9NY43oqI/AAAAAAAAWlM/KUJ9TiScCWMT1HDiVUqlGfg_Afr0oF2zgCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="870" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dBO4D31XgH4/Wd_9QvZiazI/AAAAAAAAWlQ/6amiG1pi9os8lz7UKJ3tV4SupnDDCXKMACHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      最後，把&lt;code&gt;LegacyApplication.View&lt;/code&gt;專案調整&lt;code&gt;target framework&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;對 &lt;code&gt;LegacyApplication.View&lt;/code&gt;點右鍵&lt;/li&gt;&lt;li&gt;選擇&lt;code&gt;Properties&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;Target Framework&lt;/code&gt;改成&lt;code&gt;.Net Framework 4.6.2&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DScco-tdyRE/Wd_9UK5Ge9I/AAAAAAAAWlU/jKpK4KbpcQwdMh67I2LhJzWTln0wz5qXwCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="333" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-L9vAorccfxs/Wd_9VyIbGjI/AAAAAAAAWlY/_r83h19XjYoApJr0bjS1KKREWfj5I3yRwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;      記得.Net Framework 4.6.2才有支援 .Net Standard 2.0嗎：&lt;a href="http://immo.landwerth.net/netstandard-versions/#"&gt;http://immo.landwerth.net/netstandard-versions/#&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      把程式run起來，發現執行結果和之前一樣     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yFLhchvlrSs/Wd_9YXz5JPI/AAAAAAAAWlc/XWVsw51nFuwpOZbmWkTsSQc_Zy05rKZWACHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="431" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MEYbSxV8w1c/Wd_9bDkhekI/AAAAAAAAWlg/WSq-xsZ8zssp6s7u_NrtVFZB8-0frrSqQCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507850726675745"&gt;建立一個.net core console使用建立出來的.Net Standard Lib&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;      建立一個 .net core console 程式並且 reference 剛剛的 standard library     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ekMhHJh3m2U/Wd_9dLkcf2I/AAAAAAAAWlk/hDLF8W4RZo46i2iR5qm6ifZ2mC2khsg7ACHMYCw/s1600-h/image%255B47%255D"&gt;&lt;img width="618" height="808" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-aS839aklO18/Wd_9f4UnCOI/AAAAAAAAWlo/OQ2kPzgL2tgxgxVLVeEaFlyGv_1enIEVwCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      最後執行結果 - 出現&lt;em&gt;錯誤&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--IrV_4yV68M/Wd_9jeytziI/AAAAAAAAWlw/hWac1SpIXFIFkdf_b100yovlLBgC2BYzQCHMYCw/s1600-h/image%255B50%255D"&gt;&lt;img width="654" height="249" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CHMAwyp3ZCA/Wd_9mTCaSxI/AAAAAAAAWl0/WBta1fuIYCkUDsXKvzp-YW48sEGUTvXlACHMYCw/image_thumb%255B16%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;     這個錯誤是Visual Studio已知的一個bug，原因是VS在執行的時候Working Directory放在了sln的位置，而不是bin的路徑，造成相對路徑檔案會找不到      &lt;/p&gt;&lt;p&gt;     預計 VS 2017.6會修正。相關issue： &lt;a href="https://github.com/dotnet/project-system/issues/2239"&gt;https://github.com/dotnet/project-system/issues/2239&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      改成用&lt;code&gt;dotnet&lt;/code&gt;執行     &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;切換到bin下面&lt;/li&gt;&lt;li&gt;cmd執行：&lt;code&gt;dotnet NetCoreConsole.dll&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0OQd1EtVxKs/Wd_9orVJHHI/AAAAAAAAWl4/4CvYLygGNb8tsP5QLHF2vgRaU5jORECRQCHMYCw/s1600-h/image%255B53%255D"&gt;&lt;img width="654" height="127" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Z8BqfxcgRUo/Wd_9qW9RcOI/AAAAAAAAWl8/96qmPa1vhr007h9a52R416A6H9nS_uwPwCHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    完整程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab3/1-port-net-standard-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab3%2F1-port-net-standard-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507850726675682"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     .Net Standard和Runtime版本對應    &lt;/dt&gt;&lt;dd&gt;&lt;a href="http://immo.landwerth.net/netstandard-versions/#"&gt;http://immo.landwerth.net/netstandard-versions/#&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     .Net Api Browser - 檢查api支援度    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/api/?view=netstandard-2.0"&gt;https://docs.microsoft.com/zh-tw/dotnet/api/?view=netstandard-2.0&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     官方介紹port到standard建議執行方式    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/core/porting/"&gt;https://docs.microsoft.com/en-us/dotnet/core/porting/&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:76204883-3d49-406b-9f7e-7ed32c1b684e" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-standard" rel="tag"&gt;net-standard&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3903266438706167184/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-1-port-net-framework-lib-to-net-standard.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3903266438706167184'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3903266438706167184'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-03-1-port-net-framework-lib-to-net-standard.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][03-1]現有.Net Framework Lib 改成 .Net Standard'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-D_27VfRzhlI/Wd_8Nqw_IgI/AAAAAAAAWjw/yYtWbZ1qBncCxck_39adKtfG7BNtqzcuQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2872869917813689419</id><published>2017-10-13T06:27:00.000+08:00</published><updated>2017-10-13T06:27:32.461+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][02-2]了解Self Contained Deployment(SCD)執行(發佈)模式</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-2DMr45Etvj8/Wd-4ISwZ1ZI/AAAAAAAAWhs/n-cyXU52adMnl-8C_CzbWx_XLHxuTclwACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-L0KtGxDgkbM/Wd-4J12kWrI/AAAAAAAAWhw/blhfV_nN-GMB-0LLb1GJjfgxDo9IOIUawCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一個Lab：&lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-1-net-core-console-with-FDD-publish.html"&gt;了解Framework Dependent Deployment(FDD)執行(發佈)模式&lt;/a&gt;建立了一個.Net Core Console程式，   並且用發佈看產出的結果 - 最後得到的是FDD的執行模式。   &lt;/p&gt;&lt;p&gt;  在這一個lab將會沿用上一個lab的Solution接下去建立另外一種執行模式，Self Contained Deployment (SCD)。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    上個lab的最後成果的程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab2/1-fdd-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab2/1-fdd-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab2%2F1-fdd-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;     &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507833474916916" ;=""&gt;操作步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507833474917565" ;=""&gt;建立另外一個Net Core Console&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507833474917956" ;=""&gt;修改csproj變成SDC模式並且發佈Windows版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507833474917242" ;=""&gt;修改發佈設定 - 建立linux版本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507833474917455" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507833474916916"&gt;操作步奏&lt;/h2&gt;&lt;p&gt;  這個lab裡面會切分以下幾個階段：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;建立另外一個Net Core Console&lt;/li&gt;&lt;li&gt;修改csproj變成SDC模式並且發佈Windows版本&lt;/li&gt;&lt;li&gt;修改發佈設定 - 建立linux版本&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507833474917565"&gt;建立另外一個Net Core Console&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      直接在上一個lab建立出來的solution點 &lt;kbd&gt;右鍵&lt;/kbd&gt;，然後選擇 &lt;code&gt;Add&lt;/code&gt; -&amp;gt; &lt;code&gt;New Project&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yHYGkrY4AeI/Wd-4LB0HXjI/AAAAAAAAWh0/Odet_F6CTSs8YyWEQxwvKREwSXRArB27gCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="452" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XwYxC8O4ygA/Wd-4M-vLgPI/AAAAAAAAWh4/FUOrnD_aJz4JEDyB28mAH8UBv6XbfVw3ACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在 新增視窗 裡面 選擇 &lt;code&gt;.Net Core&lt;/code&gt; -&amp;gt;&lt;code&gt;Console App (.Net Core)&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;name&lt;/code&gt;&lt;code&gt;SCD&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-YOdPs6IQ3aQ/Wd-4N8ANnrI/AAAAAAAAWh8/0Vw7vvNIj8sA-sxmQ9WEwvBiba_LYBTBgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="310" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zpIoxsE7xDw/Wd-4PFKfFaI/AAAAAAAAWiA/kieFAEYXyNgzsc2FKs9oDYpSLGXWs5jawCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      為了 更好區分我們之前建立的&lt;code&gt;FDD&lt;/code&gt;專案，打開&lt;code&gt;Program.cs&lt;/code&gt;，然後調整 一下輸出的內容 改成     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;&lt;code&gt;Console.WriteLine("Hello World From SCD!");&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    最後內容如下：     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cayD1r1evPw/Wd-4QKO1gGI/AAAAAAAAWiE/RFaf4BbPCL8nn14m70VYZrv-CTv88zlQACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="269" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Pnj4bsLx5aI/Wd-4Rmj1DrI/AAAAAAAAWiI/HCHUwrjFV2oQd0gsp8Sktr59mQ8bumhuACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507833474917956"&gt;修改csproj變成SDC模式並且發佈Windows版本&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      對 &lt;code&gt;SCD&lt;/code&gt;的專案點 &lt;kbd&gt;右鍵&lt;/kbd&gt;然後選擇 &lt;kbd&gt;Edit SCD.csproj&lt;/kbd&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-xffa73m3UZQ/Wd-4UH_Wx0I/AAAAAAAAWiM/18rGSzh3YdcDZftMleXWaPywcbajvI9LwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="298" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Pbp6KmQYW7w/Wd-4VcH6pHI/AAAAAAAAWiQ/cD91BuEmTq8TNOagjwEYZ8qIwmteD_aiwCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在 打開的 編輯器 裡面，在&lt;code&gt;TargetFramework&lt;/code&gt;下面加入：     &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;&amp;lt;RuntimeIdentifiers&amp;gt;win-x64;linux-x64&amp;lt;/RuntimeIdentifiers&amp;gt;&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-daqJUolrcPY/Wd-4XY9ONBI/AAAAAAAAWiU/kazob9b55JcFgMF16N4VklRKjJ7itzuUgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="228" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-wBPgqUdu_So/Wd-4bcoLiFI/AAAAAAAAWiY/fMryEA0uyGw2pRDpGwqpSHu3noL_Ljy-ACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;     輸入的值為RDI，有什麼值可以使用可以參考：&lt;a href="https://docs.microsoft.com/en-us/dotnet/core/rid-catalog"&gt;https://docs.microsoft.com/en-us/dotnet/core/rid-catalog&lt;/a&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;     題外話：.Net Core 2.0之後才有所謂的&lt;em&gt;Portable&lt;/em&gt;版本，例如&lt;code&gt;linux-x64&lt;/code&gt; - 避免需要列出很多不同的linux distro。     &lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      對&lt;code&gt;SCD.csproj&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;，然後選擇&lt;code&gt;Publish&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6Cmn_ereLaM/Wd-4dPtZoAI/AAAAAAAAWic/NnQZhtQRSegGtXvYP_WiplN-8PGo-Ft9gCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="373" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-jIyuop_TTrI/Wd-4e9qNbPI/AAAAAAAAWig/p2hHLHF7CmcilCJ7noWsc9uoS_zWc0CLQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在跳出來的視窗：     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;選擇 中間的 &lt;code&gt;Folder&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇 右下角 的 &lt;kbd&gt;publish&lt;/kbd&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-GdB5ofiVEmQ/Wd-4gsiZL9I/AAAAAAAAWik/tryIv6fXQoMuySYxAl6PTLJCT1PbCN33wCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="314" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-4zSTc3ooInQ/Wd-4hX5dO_I/AAAAAAAAWio/EQ2sJ0DYgcotkCLTd3sTUI6mvGPYk4krgCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      這個時候會開始 發佈，注意到 &lt;em&gt;target runtime&lt;/em&gt; 的部分（這邊是&lt;code&gt;win-x64&lt;/code&gt;），可以打開最後發佈的結果（點&lt;code&gt;Target Location&lt;/code&gt;的鏈接），會看到熟悉的exe檔案     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ak-au9JGe_k/Wd-4iM0gaGI/AAAAAAAAWis/1sbf7Sr-MPEyHTiDh-iqIQj_oJF3LGNrwCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="364" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-5rNmCh-fk8Q/Wd-4lbQczcI/AAAAAAAAWiw/yDltHngCdQAFDcFkpEBCB0MAYDwbzFnCACHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-JmDbgTKxoSc/Wd-4nyCXz3I/AAAAAAAAWi0/qEnNdj0m4Rkq0mXcZWV03I17ed90BN3HACHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="379" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-83ZmW_-R0oc/Wd-4pu45F9I/AAAAAAAAWi4/ivFZMkiLql8-_3XrGHMOiyv0taz5fIDgwCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507833474917242"&gt;修改發佈設定 - 建立linux版本&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      回到 VS 的發佈畫面，可以點下：     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;Settings&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在開啟的畫面選擇&lt;code&gt;Target Runtime&lt;/code&gt;&lt;/li&gt;&lt;li&gt;改成&lt;code&gt;Linux-x64&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-U8My-rRLobY/Wd-4q5kM2AI/AAAAAAAAWi8/_MxEXxyKzzw-0_bK3wgCZeHLWvJvH7BrQCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="241" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-MOU__Y7Xnw8/Wd-4u1Hm2VI/AAAAAAAAWjA/YHeT-6Vh3c8DJk_oPprJfmGl6R-k6EkpwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-hvQ8ZbIsm3k/Wd-4wgkSLTI/AAAAAAAAWjE/1PsUoLxWTqUHqkY-bXpeJMhFGjBEWY87ACHMYCw/s1600-h/image%255B44%255D"&gt;&lt;img width="654" height="357" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-nf7DrfnOc0I/Wd-4xhEW6dI/AAAAAAAAWjI/YdwkXo1WohY3vD9lAWxNRtEYkbHXDBnqQCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      這個時候在按一次 &lt;code&gt;publish&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      檢查 產出 內容 會發現和剛剛 target win-x64的時候不一樣，也沒有exe檔案     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DZDQ9Lbx7Uc/Wd-40UeXcsI/AAAAAAAAWjM/SSd7w3A85NscRmiIXTaK529YlBiZFMLawCHMYCw/s1600-h/image%255B47%255D"&gt;&lt;img width="654" height="487" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-CZw7AEo75bg/Wd-4137KLXI/AAAAAAAAWjQ/ZUARzdGgvrc-Gmbio68snb0wuo366BX_gCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    完整程式碼可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab2/2-scd-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab2/2-scd-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab2%2F2-scd-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507833474917455"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;        官方介紹 SCD         &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#simpleSelf"&gt;https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#simpleSelf&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;        RDI - 指定的target runtime       &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/core/rid-catalog"&gt;https://docs.microsoft.com/en-us/dotnet/core/rid-catalog&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;    &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:63b642ee-f6d4-40d1-8db7-860115667cf1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2872869917813689419/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-2-net-core-console-with-SCD-publish.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2872869917813689419'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2872869917813689419'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-2-net-core-console-with-SCD-publish.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][02-2]了解Self Contained Deployment(SCD)執行(發佈)模式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-L0KtGxDgkbM/Wd-4J12kWrI/AAAAAAAAWhw/blhfV_nN-GMB-0LLb1GJjfgxDo9IOIUawCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5655715581380715724</id><published>2017-10-13T01:59:00.000+08:00</published><updated>2017-10-13T01:59:28.853+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][02-1]了解Framework Dependent Deployment(FDD)執行(發佈)模式</title><content type='html'>&lt;section&gt;&lt;figure&gt;    &lt;a href="https://lh3.googleusercontent.com/-4N0oJS96C8k/Wd-sdiAb00I/AAAAAAAAWgY/-wQqKfYH1HU1oyHCPOLnsFe0bRvULgPlgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-R54tMjLhxAk/Wd-sfAnHU3I/AAAAAAAAWgc/N0eHCaqND2Y5GZ-AbCeFmp-f7KN4IBH-gCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上個Lab：&lt;a href="http://blog.alantsai.net/2017/10/event-net-conf-workshop-01-install-net-core-sdk.html"&gt;[01]準備環境&lt;/a&gt;準備好環境之後，接下來就是建立一個.Net Core Console的Hello World範例程式。   &lt;/p&gt;&lt;p&gt;  建立出來之後，了解.Net Core在發佈出來的成果為 Framework Dependent Deployment(FDD)類型並且了解這個和以前.Net Framework的有何不同。   &lt;/p&gt;&lt;/section&gt;      &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507830362454616" ;=""&gt;操作步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507830362455344" ;=""&gt;用Visual Studio建立Net Core Console程式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507830362455991" ;=""&gt;用Visual Studio發佈&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507830362455381" ;=""&gt;用dotnet執行&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507830362455460" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507830362454616"&gt;操作步奏&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;用Visual Studio建立Net Core Console程式&lt;/li&gt;&lt;li&gt;用Visual Studio發佈&lt;/li&gt;&lt;li&gt;用&lt;code&gt;dotnet&lt;/code&gt;執行&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507830362455344"&gt;用Visual Studio建立Net Core Console程式&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;     用VS 2017 然後 File -&amp;gt; New -&amp;gt; Project      &lt;/dt&gt;&lt;dd&gt;     &lt;p&gt;    在彈出的輸入框選擇：.Net Core -&amp;gt; Console App (.net core)     &lt;/p&gt;&lt;p&gt;     然後在下面輸入框輸入：      &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Name：&lt;code&gt;FDD&lt;/code&gt;&lt;/li&gt;&lt;li&gt;       SolutionName：&lt;code&gt;NetCoreDeployment&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-f1ykvdjKpfU/Wd-sf6hBfVI/AAAAAAAAWgg/jXsSmsS3po058tVK-xlQSHMuwMsGThPvACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-AKguQrFrHpE/Wd-shmlNYFI/AAAAAAAAWgk/w815RINFEbYIzMh-pKBET5aGU5D0VC-pgCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;建立新專案的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      直接 &lt;kbd&gt;F5 （Run）&lt;/kbd&gt; 這個專案，會看到跳出一個Console寫“Hello World！”     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-HgDOIliesI0/Wd-sjRQcB1I/AAAAAAAAWgo/nLW1XBfboZMA0CxdJE_I24GU1PIaqymYQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="149" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FYu9tTuEy80/Wd-skFHxhoI/AAAAAAAAWgs/0Z765Uxkc8EOSav1e_Z0N14XpWswg4URQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;執行成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;   這邊和我們一般建立.Net Framework的console沒有兩樣。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507830362455991"&gt;用Visual Studio發佈&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      對 &lt;code&gt;FDD&lt;/code&gt; 的專案點 &lt;kbd&gt;右鍵&lt;/kbd&gt; 然後選擇 &lt;kbd&gt;Publish&lt;/kbd&gt;&lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;       &lt;a href="https://lh3.googleusercontent.com/-NpmoVOaKjH8/Wd-slxwCm5I/AAAAAAAAWgw/6rWlnfAuDOoY3ObBJWVFffV4IcHlZRR_wCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="528" height="373" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-M32EHN4_UWw/Wd-soEwOU2I/AAAAAAAAWg0/UMSI-ie0X5UZI59Gpe5ywO6DMQCjS-v2wCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在跳出來的視窗：     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;選擇 中間的 &lt;code&gt;Folder&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇 右下角 的 &lt;kbd&gt;publish&lt;/kbd&gt; &lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/--hNyyyyaYFQ/Wd-spOVeD0I/AAAAAAAAWg4/5K1a-EoGPS8Ofyiodc_vUMdBIWNgokJswCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="313" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XovT4LHwua0/Wd-ssLUuBTI/AAAAAAAAWg8/3sQ55B3NVYQWz0SOC5I7sJJVXTVk1AESQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     在&lt;code&gt;Publish&lt;/code&gt;的畫面，可以直接點 &lt;kbd&gt;Target Location&lt;/kbd&gt;的鏈接開啟發佈的位置     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-bqG7mJOd194/Wd-ss_QWeRI/AAAAAAAAWhA/mCc4WcxWb3Y767Uu-FlrxIsi2JzAYe0CQCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="334" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-SWZPGaT7Rx8/Wd-swjZbNKI/AAAAAAAAWhE/2M3vaXwFdAIxQsOf-GAhd4MSgSi9mxM2QCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      會看到產出的內容 - 發現&lt;em&gt;沒有&lt;/em&gt;預期中的exe檔案     &lt;/dt&gt;&lt;dd&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-xcAHAhd1Nx8/Wd-syz0hnyI/AAAAAAAAWhI/2UkNAb4-u8kiX3YndpqUua0M2ln0auzyACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="196" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-2UGam_rxZak/Wd-s0ZDt5nI/AAAAAAAAWhM/IKa3mBkncO8z6nb_EDRvQmipz1_0PjdpgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507830362455381"&gt;用dotnet執行&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      在 &lt;code&gt;檔案總管&lt;/code&gt; 的輸入網址的地方     &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;輸入 &lt;code&gt;cmd&lt;/code&gt; 按下 &lt;kbd&gt;Enter&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;命令提示窗&lt;/code&gt;會被打開&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-kOat8v6awXk/Wd-s2AYk0QI/AAAAAAAAWhQ/YVoeZYy5QkAWkLrlqy8l0AeR1YQvDDxEwCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="227" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Frg58xCt00c/Wd-s3E7jzBI/AAAAAAAAWhU/wNQ0l3M9BzQOnk17PdRaCNtNLCsKtTlxACHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      在 &lt;code&gt;命令提示窗&lt;/code&gt; 輸入：     &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;dotnet FDD.dll&lt;/code&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-t-fcEq8tPkw/Wd-s3zHSbTI/AAAAAAAAWhY/G41WBIsF2ZEZZl99VqcZ3r_JSbCD6355gCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="111" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-qDdrBGhKmzU/Wd-s5VbOR5I/AAAAAAAAWhc/yVQ7NJp2niAySwTf7xeTy3L-6PcEGVZuwCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;出現 Hello World！&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;    這個就是Framework Dependent Deployment（FDD）模式 - 由電腦安裝的runtime去執行對應的程式     &lt;/p&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;    程式碼範例可以再github看到：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop"&gt;https://github.com/alantsai-samples/2017-10-14-net-core-workshop&lt;/a&gt;&lt;/p&gt;&lt;p&gt;    git標籤：&lt;code&gt;lab2/1-fdd-finish&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    兩種方式取得：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用git clone然後在checkout到&lt;code&gt;lab2/1-fdd-finish&lt;/code&gt;&lt;/li&gt;&lt;li&gt;從github release下載：&lt;a href="https://github.com/alantsai-samples/2017-10-14-net-core-workshop/releases/tag/lab2%2F1-fdd-finish"&gt;下載鏈接&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507830362455460"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;        官方介紹 FDD       &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#framework-dependent-deployment"&gt;https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#framework-dependent-deployment&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;   &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:8f3a6e8e-5dff-4918-a22d-561ed8aed011" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5655715581380715724/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-1-net-core-console-with-FDD-publish.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5655715581380715724'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5655715581380715724'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-02-1-net-core-console-with-FDD-publish.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][02-1]了解Framework Dependent Deployment(FDD)執行(發佈)模式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-R54tMjLhxAk/Wd-sfAnHU3I/AAAAAAAAWgc/N0eHCaqND2Y5GZ-AbCeFmp-f7KN4IBH-gCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4971492735805926887</id><published>2017-10-13T01:08:00.000+08:00</published><updated>2017-10-13T01:08:44.390+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='lab'/><category scheme='http://www.blogger.com/atom/ns#' term='「.Net Core 與 .Net Standard 實戰教學」'/><category scheme='http://www.blogger.com/atom/ns#' term='net-core'/><title type='text'>[.Net Core 與 .Net Standard 實戰教學][Lab][01]準備環境</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rDWxvnFR1OU/Wd-fB0FQ-iI/AAAAAAAAWfE/QIni2ogqyPg2vhc9xHRR8kCZA2q9MCx3gCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9qxzjp3wArU/Wd-fDrgO39I/AAAAAAAAWfI/fHOrIVhdWXQ6ePEX9y3Ct__bM97Zal9NQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/workshop-rustic-hammer-wrench-tool-2608390/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  要開始開發.Net Core程式之前，一定需要先把環境準備好。   &lt;/p&gt;&lt;p&gt;  這篇lab主要介紹如何以VS 2017為主的開發模式來準備需要的環境。   &lt;/p&gt;&lt;/section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538795" ;=""&gt;操作&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538157" ;=""&gt;支援的OS&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538630" ;=""&gt;必裝的軟體&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538122" ;=""&gt;.Net Core SDK 安裝步奏&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538875" ;=""&gt;.Net Core SDK 安裝路徑&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538874" ;=""&gt;非必裝的軟體&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1507825549538531" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1507825549538795"&gt;操作&lt;/h2&gt;&lt;p&gt;  總共有以下幾個環節：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;支援的OS&lt;/li&gt;&lt;li&gt;必裝的軟體&lt;/li&gt;&lt;li&gt;非必裝的軟體&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507825549538157"&gt;支援的OS&lt;/h3&gt;&lt;p&gt;   主要支援：Windows、Mac和Linux。    &lt;/p&gt;&lt;p&gt;   以Windows來說支援的有：    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Windows 7 SP1 +&lt;/li&gt;&lt;li&gt;Windows Server 2008 R2 SP1 +&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;   以Mac和Linux來說，詳細那個OS版號請參考：    &lt;a href="https://github.com/dotnet/core/blob/master/release-notes/2.0/2.0-supported-os.md"&gt;https://github.com/dotnet/core/blob/master/release-notes/2.0/2.0-supported-os.md&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507825549538630"&gt;必裝的軟體&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;     .Net core SDK     &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.microsoft.com/net/download/core#/sdk "&gt;https://www.microsoft.com/net/download/core#/sdk &lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt; Microsoft Visual C++ 2015 Redistributable Update 3     &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=52685"&gt;https://www.microsoft.com/en-us/download/details.aspx?id=52685&lt;/a&gt;&lt;/li&gt;&lt;li&gt;裝SDK的時候會&lt;strong&gt;&lt;em&gt;一起安裝&lt;/em&gt;&lt;/strong&gt; - Windows 10 和 Windows Server 2016 以上自帶&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;什麼情景需要&lt;/em&gt;&lt;/strong&gt;：如果使用 Self Contained Deployment（SCD）不存在的話會有問題&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1507825549538122"&gt;.Net Core SDK 安裝步奏&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;      選擇 符合電腦位元的Installer - 以Windows為例就是Windows (x64) Installer        &lt;/p&gt;&lt;p&gt;&lt;a href="https://download.microsoft.com/download/0/F/D/0FD852A4-7EA1-4E2A-983A-0484AC19B92C/dotnet-sdk-2.0.0-win-x64.exe"&gt;直接下載鏈接&lt;/a&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9RBYhSf6pzg/Wd-fEms2v5I/AAAAAAAAWfM/RCZmF9lrJAUT5ZntQtq37ORmpHc0ai8SgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="181" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-UaXb7Auz5PA/Wd-fFnsEZgI/AAAAAAAAWfQ/MOOS-0V9KDEK2FC9mk-L_XzPbnYblNuzQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;一般會是Windows(x64) Installer&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;把下載的 exe執行起來，然後就一直下一步就好       &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-_37EWvN5CIo/Wd-fHP1-nTI/AAAAAAAAWfU/b0z-KsZVsis4tuIv-qWxQZd0cQpchpcoQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="486" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-rbviMCSucx8/Wd-fI36l6rI/AAAAAAAAWfY/TC997Y9Y6l0Ab9OUiKc8oyrvQJAn0sTbQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1tv-MGZwJ5I/Wd-fKXLY78I/AAAAAAAAWfc/fswQQpJZ3LgSOYrtST4otYY7zZ1OnDhOgCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="486" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-DXmSG1EV-ic/Wd-fMpcxTSI/AAAAAAAAWfg/F1_8y-rWPno018hWDOp0Yxo8EoSIy7iggCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;一直下一步就好&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;li&gt;       安裝好之後開啟&lt;code&gt;cmd&lt;/code&gt;然後執行 &lt;code&gt;dotnet --version&lt;/code&gt; 確認版本       &lt;br /&gt;&lt;a href="https://lh3.googleusercontent.com/-0vnBk9gUX-M/Wd-fPpX0zKI/AAAAAAAAWfk/-EBhK96M-HgMt8k8Z9mGJXQR1dW7oBd4wCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="574" height="341" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tydeS0vlycg/Wd-fR2Vht8I/AAAAAAAAWfo/IXgt2HccvGg8J_crW6YqV0LVg8d6sGiVACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Y1U977lBAKY/Wd-fTMspnVI/AAAAAAAAWfs/FYyQee5qh-s-Daa9fcBQL0s0Goa6uDquACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="375" height="134" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-agaJNOjhUD0/Wd-fVf47HSI/AAAAAAAAWfw/tjQ1tfr0M2k9qNlKjNlViylTxzbCT3cogCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;看到 2.0 表示安裝成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1507825549538875"&gt;.Net Core SDK 安裝路徑&lt;/h4&gt;&lt;p&gt;     預設安裝在 &lt;code&gt;%programfiles%\dotnet\sdk&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4iLpTjvCYjw/Wd-fWL3FCFI/AAAAAAAAWf0/qjYdBmQWdCgxQgf1cgxc2VGc8wHxdV2sgCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="651" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9AgaBeOg_dk/Wd-fZ15mVAI/AAAAAAAAWf4/Zrw_uKGBDFsknY4CNsi_qMUXH0eGzK7mACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;開啟 檔案總管 並且輸入 預設的 路徑&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wO3pqVrq89c/Wd-ffBWjNCI/AAAAAAAAWf8/BwokIVtHoIwm_3uPGrhSPpf6ExU85CnOQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="553" height="282" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IvEcWvPVeKc/Wd-ffy7B2aI/AAAAAAAAWgA/OpBbDlGHy5cV5eOc1rtplsN5YUbC9BENwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt; 可以看到可以同時裝很多版本 以這個範例來說，總共有 1.0、1.1和2.0       &lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1507825549538874"&gt;非必裝的軟體&lt;/h3&gt;&lt;dl&gt;&lt;dt&gt;      Visual Studio     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     可以使用任意編輯器搭配sdk提供的cli工具，不過地表最強的IDE還是我們的最愛，因此如果使用Visual Studio需要：      &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Visual Studio 2017.3 以上 -         &lt;a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=community&amp;amp;rel=15&amp;amp;dotnetid=1105131875.1483487752"&gt;VS 2017 Community&lt;/a&gt;&lt;/li&gt;&lt;li&gt;        安裝的時候選擇 .NET Core cross-platform development workload        &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-41EyHpNlCbo/Wd-fgnwucnI/AAAAAAAAWgE/UtoXe2UPizkg8jVy0RhiXTgxsTA0aDYoACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="367" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1jQHpwdw_io/Wd-fhfdslmI/AAAAAAAAWgI/fK7elNP7spIvdi3myvRZd2fHEE9sbdXNwCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;要記得選擇 .NET Core cross-platform development workload&lt;/figcaption&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1507825549538531"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     Windows安裝 .Core SDK    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/core/windows-prerequisites?tabs=netcore2x"&gt;https://docs.microsoft.com/zh-tw/dotnet/core/windows-prerequisites?tabs=netcore2x&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Mac安裝 .Core SDK    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/core/macos-prerequisites"&gt;https://docs.microsoft.com/zh-tw/dotnet/core/macos-prerequisites&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Linux安裝 .Core SDK    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/zh-tw/dotnet/core/linux-prerequisites?tabs=netcore2x"&gt;https://docs.microsoft.com/zh-tw/dotnet/core/linux-prerequisites?tabs=netcore2x&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:793bd138-b49f-4708-a559-66971775c0ad" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/net-core" rel="tag"&gt;net-core&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/lab" rel="tag"&gt;lab&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c.Net+Core+%e8%88%87+.Net+Standard+%e5%af%a6%e6%88%b0%e6%95%99%e5%ad%b8%e3%80%8d" rel="tag"&gt;「.Net Core 與 .Net Standard 實戰教學」&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4971492735805926887/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-01-install-net-core-sdk.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4971492735805926887'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4971492735805926887'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/10/event-net-conf-workshop-01-install-net-core-sdk.html' title='[.Net Core 與 .Net Standard 實戰教學][Lab][01]準備環境'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-9qxzjp3wArU/Wd-fDrgO39I/AAAAAAAAWfI/fHOrIVhdWXQ6ePEX9y3Ct__bM97Zal9NQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8974202733784324546</id><published>2017-09-30T00:13:00.000+08:00</published><updated>2017-09-30T00:13:59.148+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='best practices'/><category scheme='http://www.blogger.com/atom/ns#' term='jquery'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><title type='text'>[jquery]jquery ajax post能夠正確Model Bind到Asp .net Mvc網站 - 三種不同情境的建議做法</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-f7_NqIpPRF0/Wc5wPPHHHXI/AAAAAAAAWdY/4SQ6FkiqjpwKeaO1wNewjqx-UK-212jbACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-NNFK3P7sbK0/Wc5wQTnpLAI/AAAAAAAAWdc/fmP8NwNR3ywmSJrvf-bE130Z6j8PQifyACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  Model Binding是Asp .net Mvc裡面用來處理表單送出(Form Post)資料自動轉成強型別的機制。   &lt;/p&gt;&lt;p&gt;  一般來說，如果用&lt;code&gt;HtmlHelper&lt;/code&gt;產生的html內容，在Post back的時候Model Binding基本上不會遇到什麼問題。   &lt;/p&gt;&lt;p&gt;  不過為了網站responsive更好，很多時候會希望Form Post是透過ajax來做。   &lt;/p&gt;&lt;p&gt;  這個時候依據不同做法，就很容易造成form post到asp .net mvc的時候Model Binding不到。   &lt;/p&gt;&lt;p&gt;  這篇將會建議不同情境的時候應該如何寫正確的Jquery Form post寫法，避免Model Binding不到的問題。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   這篇文章相關的範例程式碼在：&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample"&gt;https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample&lt;/a&gt;，有用&lt;code&gt;tag&lt;/code&gt;標註每一個不同的情境。   &lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478767" ;=""&gt;三種情境建議做法 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478888" ;=""&gt;三種情境做法建議原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478152" ;=""&gt;想Post的內容是所有的Form欄位&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478288" ;=""&gt;想post的內容只是表單裡面幾個欄位&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478280" ;=""&gt;想post的內容包含檔案上傳&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1506701089478987" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1506701089478767"&gt;三種情境建議做法 - TL;DR&lt;/h2&gt;&lt;p&gt;  基本上要form post的時候會遇到三種不同的情況：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;想Post的內容是所有的Form欄位 - 換句話說只是要ajax post模擬一個&lt;code&gt;submit&lt;/code&gt;的效果&lt;/li&gt;&lt;li&gt;想post的內容只是表單裡面幾個欄位，並非全部的欄位&lt;/li&gt;&lt;li&gt;想Post的內容包含檔案上傳&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  針對這三個不同情境，有幾個不同的jquery post方式建議：   &lt;/p&gt;&lt;dl class="border-around"&gt;&lt;dt&gt;     想Post的內容是所有的Form欄位    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    只需要post的時候，&lt;code&gt;data&lt;/code&gt;欄位傳入：&lt;code&gt;$("#postForm").serialize()&lt;/code&gt; 即可。    &lt;/p&gt;&lt;p&gt;   片段範例：    &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: $("#postForm").serialize()&lt;br /&gt;})&lt;/pre&gt;&lt;/dd&gt;&lt;dt&gt;     想post的內容只是表單裡面幾個欄位    &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;組出最後要送出的javascript 物件 &lt;code&gt;data&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在 ajax 的 &lt;code&gt;data&lt;/code&gt;欄位值輸入：&lt;code&gt;JSON.stringify(data)&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在 ajax的 &lt;code&gt;contentType&lt;/code&gt;欄位值輸入：&lt;code&gt;"application/json"&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;    片段範例：     &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = [];&lt;br /&gt;data.push({ Title: $("input[name='[0].Title']").val(), Content: $("input[name='[0].Content']").val() });&lt;br /&gt;data.push({ Title: $("input[name='[1].Title']").val(), Content: $("input[name='[1].Content']").val() });&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: JSON.stringify(data),&lt;br /&gt; contentType: "application/json"&lt;br /&gt;})&lt;/pre&gt;&lt;/dd&gt;&lt;dt&gt;     想post的內容包含檔案上傳    &lt;/dt&gt;&lt;dd&gt;    可以使用&lt;code&gt;FormData&lt;/code&gt;，注意，只有&lt;em&gt;&lt;strong&gt;支援Html 5&lt;/strong&gt;&lt;/em&gt;的browser才能夠用，所以IE 10 以下就不用考慮了。     &lt;ol&gt;&lt;li&gt;用&lt;code&gt;Form&lt;/code&gt; htmlelement 建立 &lt;code&gt;FormData&lt;/code&gt; - 例如：&lt;code&gt;var data = new FormData($("#postForm")[0]);&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在 ajax 的 &lt;code&gt;data&lt;/code&gt; 欄位值輸入第一步建立出來的&lt;code&gt;data&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在 ajax 的 &lt;code&gt;processData&lt;/code&gt;欄位值輸入：&lt;code&gt;false&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在 ajax 的 &lt;code&gt;contentType&lt;/code&gt;欄位值輸入：&lt;code&gt;false&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;    片段範例：     &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = new FormData($("#postForm")[0]);&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: data,&lt;br /&gt; processData: false,&lt;br /&gt; contentType: false&lt;br /&gt;})&lt;/pre&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;  如果對於為什麼這三種情境是這樣建議有興趣，請往下看.....   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1506701089478888"&gt;三種情境做法建議原因&lt;/h2&gt;&lt;p&gt;  依照不同的情境，jquery post的呼叫方式其實也會需要不同不然到asp .net mvc model binding的時候很容易失敗，會話很多時間在debug這些問題，以下將會對於3個情境的做法進一步說明。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1506701089478152"&gt;想Post的內容是所有的Form欄位&lt;/h3&gt;&lt;p&gt;   一般來說，在建立Form表單的時候，撰寫上會使用&lt;code&gt;HtmlHelper&lt;/code&gt;，這種產生出來的html內容只要post上去asp .net mvc model binding基本上沒有什麼問題。    &lt;/p&gt;&lt;p&gt;   因此可以利用Form表單本身然後透過jquery序列化的方式作為送出的資料。    &lt;/p&gt;&lt;p&gt;   假設我們的Form表單的id是&lt;code&gt;postForm&lt;/code&gt;，那麼整個post方式就是：     &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: $("#postForm").serialize()&lt;br /&gt;})&lt;/pre&gt;&lt;p&gt;   換句話說其實就是用jquery&lt;em&gt;&lt;strong&gt;模擬&lt;/strong&gt;&lt;/em&gt;一般的post&lt;code&gt;submit&lt;/code&gt;。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;    範例程式碼：&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample/tree/sample/jquery-serialiaze-post"&gt;tag sample/jquery-serialiaze-post&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1506701089478288"&gt;想post的內容只是表單裡面幾個欄位&lt;/h3&gt;&lt;p&gt;   有時候要post的內容可能不全部在同一個&lt;code&gt;Form&lt;/code&gt;表單，或者可能有幾個不同地方的欄位組成，這個時候，第一種情境的序列化做法就不適合了。    &lt;/p&gt;&lt;p&gt;   這個時候可能會想說建立一個javascript 物件，然後&lt;code&gt;&lt;strong&gt;直接post這個物件&lt;/strong&gt;&lt;/code&gt;。例如，假設後端要binding的model 有 Title和Content欄位：    &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = {};&lt;br /&gt;data.Title = "a";&lt;br /&gt;data.Content = "b";&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: data&lt;br /&gt;})&lt;/pre&gt;&lt;p&gt;這個會binding成功，因此可能想說都是這麼處理就好，但是，當要binding的物件&lt;em&gt;&lt;strong&gt;比較複雜的時候&lt;/strong&gt;&lt;/em&gt;，這個方式就會binding&lt;em&gt;&lt;strong&gt;失敗&lt;/strong&gt;&lt;/em&gt;。 &lt;/p&gt;&lt;p&gt;舉例來說，假設我們有同樣的model結構，但是這個時候後台變成需要的是一個&lt;em&gt;list&lt;/em&gt;，這個時候可能想說傳入array即可： &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = [];&lt;br /&gt;data.push({ Title: "1", Content: "2" });&lt;br /&gt;data.push({ Title: "2", Content: "4" });&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: data&lt;br /&gt;})&lt;/pre&gt;&lt;p&gt;但是這個會binding&lt;em&gt;失敗&lt;/em&gt;，主要原因是因為預設jquery使用的是&lt;code&gt;application/x-www-form-urlencoded&lt;/code&gt;作為&lt;code&gt;ContentType&lt;/code&gt; - 這種方式的產生結構類似於querystring的那種串聯方式，因此在處理&lt;em&gt;複雜結構&lt;/em&gt; 的時候產生出來的內容&lt;em&gt;不符合&lt;/em&gt;asp .net mvc預設model binding的邏輯。 &lt;/p&gt;&lt;p&gt;因此建議直接傳送&lt;em&gt;json&lt;/em&gt;格式的內容，在處理複雜結構沒有什麼問題。 &lt;/p&gt;&lt;p&gt;不過要使用json格式的資料就會需要： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;用&lt;code&gt;JSON.stringfy()&lt;/code&gt;把物件轉成json的字串樣子&lt;/li&gt;&lt;li&gt;把&lt;code&gt;ContentType&lt;/code&gt;設定成為：&lt;code&gt;application/json&lt;/code&gt; - 告知mvc傳入的內容是json&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;因此整個範例變成： &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = [];&lt;br /&gt;data.push({ Title: "1", Content: "2" });&lt;br /&gt;data.push({ Title: "2", Content: "4" });&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: SON.stringify(data),&lt;br /&gt; contentType: "application/json"&lt;br /&gt;})&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;ul&gt;&lt;li&gt;範例程式碼，當object是單純的時候，直接post JavaScript 物件沒有問題：&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample/tree/sample/jquery-simple-object-post"&gt;tag sample/jquery-simple-object-post&lt;/a&gt;&lt;/li&gt;&lt;li&gt;範例程式碼，當object是複雜物件的時候，直接post JavaScript物件&lt;em&gt;有問題&lt;/em&gt;&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample/tree/sample/jquery-complex-object-post-fail"&gt;tag sample/jquery-complex-object-post-fail&lt;/a&gt;&lt;/li&gt;&lt;li&gt;範例程式碼，當object是複雜物件的時候，用json格式post - 建議方式&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample/tree/sample/jquery-complex-object-post-sucess"&gt;tag sample/jquery-complex-object-post-sucess&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1506701089478280"&gt;想post的內容包含檔案上傳&lt;/h3&gt;&lt;p&gt;   當想要post上去的內容包含檔案上傳(input type="file")的時候，上述提到的2種做法都沒有辦法達成。    &lt;/p&gt;&lt;p&gt;   原因是因為檔案上傳要包含的資訊豐富很多，上述兩種方式都沒有辦法達到。    &lt;/p&gt;&lt;p&gt;   因此當需要post的內容包含檔案上傳，需要使用特殊的資料類型&lt;code&gt;FormData&lt;/code&gt;。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;code&gt;FormData&lt;/code&gt;只有在支援Html 5的browser才有支援，因此IE 10 以下沒有辦法。    &lt;/div&gt;&lt;p&gt;   要使用&lt;code&gt;FormData&lt;/code&gt;非常的簡單，只需要在new的時候傳入&lt;em&gt;Form的html element物件&lt;/em&gt;即可。    &lt;/p&gt;&lt;p&gt;   有了&lt;code&gt;FormData&lt;/code&gt;作為資料之後，還有兩個設定：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;processData&lt;/code&gt;要設定為&lt;code&gt;false&lt;/code&gt;避免jquery傳送的時候有額外做一些處理&lt;/li&gt;&lt;li&gt;把&lt;code&gt;ContentType&lt;/code&gt;設定為&lt;code&gt;false&lt;/code&gt;讓jquery決定送出的類型&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;   整個的範例如下：     &lt;/p&gt;&lt;pre class="brush: jscript;"&gt;var data = new FormData($("#postForm")[0]);&lt;br /&gt;&lt;br /&gt;$.ajax({&lt;br /&gt; type: "POST",&lt;br /&gt; url: "@Url.Action("JqueryPost")",&lt;br /&gt; data: data,&lt;br /&gt; processData: false,&lt;br /&gt; contentType: false&lt;br /&gt;})&lt;/pre&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-info"&gt;   範例程式碼：&lt;a href="https://github.com/alantsai-samples/aspnetmvc-jquery-post-model-binding-sample/tree/sample/jquery-FomrData-File-post"&gt;tag sample/jquery-FomrData-File-post&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1506701089478987"&gt;結語&lt;/h2&gt;&lt;p&gt;  越來越多網站會要求直接使用ajax - 整個畫面不需要post給使用者感官沒有load那麼久。   &lt;/p&gt;&lt;p&gt;  希望透過這篇能夠提供一個Reference，當要用jquery ajax post的時候，asp .net mvc model binding不到的時候可以參考以下，避免在抓頭了。   &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:87f5d5d0-9f9c-4b79-89e1-419037842e8a" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Asp+.Net+Mvc" rel="tag"&gt;Asp .Net Mvc&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/best+practices" rel="tag"&gt;best practices&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/jquery" rel="tag"&gt;jquery&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8974202733784324546/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/jquery-ajax-form-post-model-bind-asp-net-mvc-with-no-problem-3-way.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8974202733784324546'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8974202733784324546'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/jquery-ajax-form-post-model-bind-asp-net-mvc-with-no-problem-3-way.html' title='[jquery]jquery ajax post能夠正確Model Bind到Asp .net Mvc網站 - 三種不同情境的建議做法'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-NNFK3P7sbK0/Wc5wQTnpLAI/AAAAAAAAWdc/fmP8NwNR3ywmSJrvf-bE130Z6j8PQifyACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1708966164358775751</id><published>2017-09-20T22:55:00.000+08:00</published><updated>2017-12-01T00:32:15.121+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='best practices'/><category scheme='http://www.blogger.com/atom/ns#' term='security'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='tool'/><category scheme='http://www.blogger.com/atom/ns#' term='iis'/><title type='text'>[iis]每個Server都應該做的資安防護 - 使用IIS Crypto一鍵設定該啟用和停用的SChannel (如SSL 3.0)和Cipher Suite (如MD5)</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-BPjsHhNdiB8/WcKALDvpzCI/AAAAAAAAWbw/SpcwJAnHz4Mdvt1xZ-GyKE4_bPBJPkOAQCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-z0tyOhq64WM/WcKANKBeExI/AAAAAAAAWb0/x7FLMuqukrUHcxMX8Js32YYK9HZb7RVGACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt; &lt;section&gt;   &lt;p&gt;  資安是最需要注意也最容易忽視掉的一環，尤其是當有些資安是和系統設定有關的時候。   &lt;/p&gt;&lt;p&gt;  作為開發人員，程式開發上面的資安注意事項是一定要知道的，但是Server上面就不一定，但是有時候會需要開發者來管理Server，這時候知道一些Server資安要注意的設定就變得非常重要。   &lt;/p&gt;&lt;p&gt;  在這一篇將會提到一個Server常被忽視的地方，就是設定IIS https裡面可以使用的SChannel和Cipher Suite。如何透過IIS Crypto設定最佳建議的設定。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 kmcontenthide="1"&gt;相關文章&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;2017-11-30 - &lt;a href="http://blog.alantsai.net/2017/11/iis-why-online-test-still-show-disabled-cipher-suite-use-TestSSLServer-for-local-cipher-suite-test.html" target="_blank"&gt;[iis]為什麼ssl cipher suite關閉了檢查還是有出現問題 - 如何local檢查ssl和cipher suite&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844864" ;=""&gt;https的資安問題 - SSL 3.0為例&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844346" ;=""&gt;IIS Crypto介紹&lt;/a&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844894" ;=""&gt;SChannel 的設定&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844647" ;=""&gt;Cipher Suite 設定&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844264" ;=""&gt;Site Scanner&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1505917717844224" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;&lt;/a&gt;     &lt;section&gt;&lt;h2 id="WizKMOutline_1505917717844864"&gt;https的資安問題 - SSL 3.0為例&lt;/h2&gt;&lt;p&gt;  資安是一個持續性的議題，很多以前認為安全的東西，在幾年之後就可能會被攻破。   &lt;/p&gt;&lt;p&gt;  以https為例，幾年前就有宣佈SSL 3.0可能會受到&lt;code&gt;貴賓犬&lt;/code&gt;攻擊（&lt;a href="http://www.ithome.com.tw/news/91571"&gt;Google 發現 SSL 3.0 漏洞，小心「貴賓犬」攻擊！&lt;/a&gt;），因此我們的server要關掉SSL 3.0的   SChannel才對。   &lt;/p&gt;&lt;p&gt;  要做到這個事情，有幾個麻煩/困難點：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;要關掉SSL 3.0只能夠透過&lt;code&gt;regedit（登錄檔）&lt;/code&gt;，換句話說內建沒有簡單方式能夠做到，只能完全了regedit的路徑並且設定。&lt;/li&gt;&lt;li&gt;另外一個問題是，那些應該要關掉對開發者來說其實&lt;em&gt;並不知道&lt;/em&gt;，所以可能會需要花很多時間找資料才能夠完全關掉不安全的SChannel。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;  因此，誕生了一個軟體&lt;code&gt;IIS Crypto&lt;/code&gt;，能夠幫我們快速關掉一些SChannel和Cipher   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505917717844346"&gt;IIS Crypto介紹&lt;/h2&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;br&gt;&lt;dl&gt;&lt;dt&gt;      軟體名稱     &lt;/dt&gt;&lt;dd&gt;      IIS Crypto     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      下載鏈接     &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://www.nartac.com/Products/IISCrypto/Download"&gt;https://www.nartac.com/Products/IISCrypto/Download&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      特色     &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;免費軟體&lt;/li&gt;&lt;li&gt;一鍵關閉不安全的SChannel&lt;/li&gt;&lt;li&gt;一鍵關閉不安全的Cipher Suite&lt;/li&gt;&lt;li&gt;快速檢查網站https安全程度&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;p&gt;  基本上使用IIS Crypto非常簡單，只需要run起來然後使用&lt;code&gt;Best Practise&lt;/code&gt;然後選擇&lt;code&gt;Apply&lt;/code&gt;即可。接下來會針對每個部分看一下實際操作。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505917717844894"&gt;SChannel 的設定&lt;/h3&gt;&lt;p&gt;   打開軟體之後第一個看到的就是&lt;code&gt;SChannel&lt;/code&gt;的設定。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-sByG97PefRE/WcKAOPtflLI/AAAAAAAAWb4/CVvxYxnPWf482SMQjqHzwaYbvAwAHjvdQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="513" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-XQmld8INz4o/WcKAO8Kk5iI/AAAAAAAAWb8/Uw0vj2MVbpEQhI12Tp1sLvy7cxKSyWIFQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;剛開啟的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   預設都是&lt;em&gt;灰色&lt;/em&gt;表示沒有做過任何設定。這個時候可以透過勾選的方式來選擇那些要開啟和那些要關閉。    &lt;/p&gt;&lt;p&gt;   不過一般非資安人員不會知道那些應該勾而那些不應該，所以這個時候可以使用建議的設定，在左下角有個&lt;code&gt;Best Practise&lt;/code&gt;的按鈕，點下去之後，會自動勾選要的（安全的）和不勾選（不安全的）設定。    &lt;/p&gt;&lt;p&gt;   這個時候要在點下右邊的&lt;code&gt;Apply&lt;/code&gt;才會真的做修改。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-hEDhzMzmJ5A/WcKAQNqyu1I/AAAAAAAAWcA/6IqtJSp1CQkfWbEwFrKCQ-e7IVaKKIr1ACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="513" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-8W0OTWuSu7s/WcKASxI15jI/AAAAAAAAWcE/zqZK2ZmiWC0jxDbohFwnNEjSd7Moo26XwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;使用最建議的設定方式&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505917717844647"&gt;Cipher Suite 設定&lt;/h3&gt;&lt;p&gt;   和SChannel設定一樣，進去的時候會有一堆清單，用勾選來表示那些要包含，取消勾選來不包含。    &lt;/p&gt;&lt;p&gt;   如果不知道設定什麼，一樣用最佳設定就好，選擇&lt;code&gt;Best Practise&lt;/code&gt;，然後選擇&lt;code&gt;Apply&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cA2aaI-nICI/WcKAVAWgsAI/AAAAAAAAWcI/CqtvvsEQqBAwU5xvg3Z9qRX6U20HfruJQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="513" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dnsWEs2mE5g/WcKAXRBEzeI/AAAAAAAAWcM/6u8tImLRc10gdR5BVPYkpiaKAliVYXf2QCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;使用Best Practise的設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505917717844264"&gt;Site Scanner&lt;/h3&gt;&lt;p&gt;   當設定好https之後，最好驗證一下有沒有什麼問題，這個時候可以切換到左邊&lt;code&gt;第四個&lt;/code&gt;頁簽：&lt;code&gt;Site Scanner&lt;/code&gt;，把要檢測的網址輸入進去，然後按下&lt;code&gt;scan&lt;/code&gt;。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jn4zubrGSIc/WcKAZBDhNHI/AAAAAAAAWcQ/LDKfQbmGC_Uhr3qCUhw3ekkXT9F5mnEagCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="324" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-suZN_LiG_gY/WcKAbjMZAMI/AAAAAAAAWcU/FaW5-ijydEEM_7hbg288_zB2uJD3dUldwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;以google為範例&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   會自動開啟瀏覽器，然後直接帶到&lt;code&gt;Qualys SSL Labs&lt;/code&gt;的檢測結果，會幫ssl憑證打分，並且建議那些地方可以做調整（如果資安不安全的話）。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1mn_mBzzHSc/WcKAdNmpcZI/AAAAAAAAWcY/uZ-cTh8hpWIavSQ7gEi3aLhynV_OZBrJACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="282" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-R0-E6lE9rOo/WcKAgBEtp1I/AAAAAAAAWcc/ZXuk2DQ2AxQOOggFbMVdgGIAzoF2LKYKACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;以google為例評分為A&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   可以點進去看：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-j6561Sd_2NE/WcKAhwuTzMI/AAAAAAAAWcg/kVk0MwMEyo0fL_Me9Btct3QiuOd_rXPtgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="338" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-0wBveDqYzjQ/WcKAl6No-NI/AAAAAAAAWck/A0ccSn-csP8-yDCQ_2snHRJRw24P_VCawCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;以這邊為例可以看到建議Cipher Suites裡面&lt;code&gt;TLS_RSA_WITH_3DES_EDE_CBC_SHA (0xa) &lt;/code&gt;屬於弱&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   所以這個Site Scanner可以再做一個二次確認，確保設定有啟用成功。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505917717844224"&gt;結語&lt;/h2&gt;&lt;p&gt;  IIS Crypto是一個人人都應該要有的軟體，並且每一台Windows Server都應該要執行並且設定以避免一些不安全的cipher和SChannel被使用。   &lt;/p&gt;&lt;p&gt;  這個軟體最棒的地方是，就算你不清楚那些有問題，他已經幫你定義好一些最佳建議，因此只要設定就好，再也不用使用&lt;code&gt;regedit&lt;/code&gt;然後打錯字導致設定錯誤。   &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:d759a044-4ccf-4e45-a08e-774c6b7b2755" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/iis" rel="tag"&gt;iis&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/best+practices" rel="tag"&gt;best practices&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/security" rel="tag"&gt;security&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1708966164358775751/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/iis-security-set-correct-schannel-and-cipher-suite-using-iis-crypto.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1708966164358775751'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1708966164358775751'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/iis-security-set-correct-schannel-and-cipher-suite-using-iis-crypto.html' title='[iis]每個Server都應該做的資安防護 - 使用IIS Crypto一鍵設定該啟用和停用的SChannel (如SSL 3.0)和Cipher Suite (如MD5)'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-z0tyOhq64WM/WcKANKBeExI/AAAAAAAAWb0/x7FLMuqukrUHcxMX8Js32YYK9HZb7RVGACHMYCw/s72-c/image_thumb%255B6%255D?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6768631030517279675</id><published>2017-09-18T00:34:00.000+08:00</published><updated>2017-09-18T00:34:46.829+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://www.blogger.com/atom/ns#' term='best practices'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>[git]repo、branch和tag取名建議和注意事項 - 怎麼取名比較不會有問題</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-S7iuBS5PD84/Wb6jAKfSZMI/AAAAAAAAWZw/miNJOcMgk38YHwzSUB1QStakfYigAAvYQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-j5KSvRVzn8k/Wb6jBiY_bnI/AAAAAAAAWZ0/m52LFVFMjI8im51x4UpidJQETPLVzqI6QCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  最近在和同事協同開發的時候，發生了一件事情：   &lt;/p&gt;&lt;p&gt;  由於我們還沒啟用CD（自動部署）但是更新測試機器又不一定是同一個人，為了好管控目前程式碼和目前測試機器上面的版本，我們使用了一個標籤叫做&lt;code&gt;TestServer&lt;/code&gt;來記錄。   &lt;/p&gt;&lt;p&gt;  不過當我同事更新的時候，他使用了&lt;code&gt;testserver&lt;/code&gt;作為標籤，結果我這邊發生了雖然local只有一個tag&lt;code&gt;testserver&lt;/code&gt;，但是在remote上面其實有兩個標籤：&lt;code&gt;TestServer&lt;/code&gt;和&lt;code&gt;testserver&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;  為什麼會發生這個事情呢？如果不處理，未來在看的時候非常混亂，這讓我想起來一直想要寫的一篇文章，為git repo、tag和branch取名的時候應該要注意什麼比較不會有問題，因此兩篇一起寫，算是不好好naming會帶來什麼問題的use case範例。   &lt;/p&gt;&lt;p&gt;  搜索關鍵字：naming guidance for git repo, tag and branch.   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;   範例repo請看：&lt;a href="https://github.com/alantsai-samples/git-naming-problem"&gt;alantsai-samples/git-naming-problem&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696184126" ;=""&gt;解決方式 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696184597" ;=""&gt;取名建議 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185747" ;=""&gt;重現問題&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185503" ;=""&gt;建立一個repo&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185379" ;=""&gt;先打一個UnReleased的標籤&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185176" ;=""&gt;push到remote&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185137" ;=""&gt;在修改之後打一個unreleased的標籤&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185858" ;=""&gt;檢查&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185312" ;=""&gt;了解為什麼local變成一個而remote還是兩個&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185376" ;=""&gt;git tag是怎麼儲存&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185578" ;=""&gt;作業系統對待檔名大小寫的不同&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185673" ;=""&gt;例外情況&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185732" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505664696185651" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696184126"&gt;解決方式 - TL;DR&lt;/h2&gt;&lt;p&gt;  如果remote出現了兩個一樣名字的標點，但是只是大小寫不同，那麼：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;建議保留小寫的版本&lt;/li&gt;&lt;li&gt;     用以下指令刪掉遠端有大寫的標籤     &lt;p&gt;&lt;code&gt;git push --delete {tagName}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    例如：&lt;code&gt;git push --delete TestServer&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696184597"&gt;取名建議 - TL;DR&lt;/h2&gt;&lt;p&gt;  基本上對於取名，不管是repo、branch還是tag的時候，建議：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     全部使用小寫    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    由於習慣寫.net code，因此很習慣會用Pascal Casing來取名，例如&lt;code&gt;UnReleased&lt;/code&gt;。但是，由於repo、branch和tag都屬於url的一部分，而url理論上是&lt;em&gt;&lt;strong&gt;會區分大小寫&lt;/strong&gt;&lt;/em&gt;並且     &lt;em&gt;作業系統檔名是否區分大小寫處理也不同&lt;/em&gt;（windows不區分，Linux會區分），因此為了抓下來不會有問題，建議全部使用小寫。因此應該使用&lt;code&gt;unreleased&lt;/code&gt;。     &lt;/p&gt;&lt;p&gt;    可是如果字太長要區分怎麼辦？參考下面分割字符     &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;     關於url應該區分大小寫，可以參考W3的&lt;a href="https://www.w3.org/TR/WD-html40-970708/htmlweb.html"&gt;HTML and URLS&lt;/a&gt;裡面提到：&lt;code&gt;Users should always consider that URLs are case-sensitive&lt;/code&gt; 。     &lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     使用&lt;code&gt;-&lt;/code&gt;(aka 減號、dash)作為文字切割    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    如果名字太長想要切割的話，可以使用&lt;code&gt;-&lt;/code&gt;來區別，例如：&lt;code&gt;my-name-is&lt;/code&gt;。     &lt;/p&gt;&lt;p&gt;    有些會習慣使用&lt;code&gt;_&lt;/code&gt;(下底線)。     &lt;/p&gt;&lt;p&gt;    使用&lt;code&gt;-&lt;/code&gt;有幾個好處：     &lt;/p&gt;&lt;ul&gt;&lt;li&gt;輸入&lt;code&gt;-&lt;/code&gt;不用加&lt;kbd&gt;shift&lt;/kbd&gt; - 比較好輸入      &lt;/li&gt;&lt;li&gt;&lt;code&gt;-&lt;/code&gt;在regex不屬於&lt;code&gt;word&lt;/code&gt;而&lt;code&gt;_&lt;/code&gt;屬於，因此用來切割符號比較明顯&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;    當然有時候字太長了，所以會混合用。     &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     用&lt;code&gt;/&lt;/code&gt;(斜線)來分類branch和tag    &lt;/dt&gt;&lt;dd&gt;     如果有在用&lt;code&gt;git flow&lt;/code&gt;應該會很習慣，主要是用&lt;code&gt;/&lt;/code&gt;(斜線)在工具像小烏龜可以簡單找到相關內容。     &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-eLdSuF3fyIs/Wb6jCWdU0yI/AAAAAAAAWZ4/xlTw7d_97vAha2G90Yug3UH94u5aQ8NngCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="435" height="226" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Z45TXcWfDqk/Wb6jDGYn_BI/AAAAAAAAWZ8/3NdPddrNSBsqGhVqYXdsskBSvoOutzlFQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;好區分範例 - 兩個feature，A和B&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     tag使用&lt;code&gt;v&lt;/code&gt;做前戳，搭配SemVar    &lt;/dt&gt;&lt;dd&gt;     舉例來說，&lt;code&gt;v1.0.1&lt;/code&gt;。加&lt;code&gt;v&lt;/code&gt;的好處是如果要列出和版號有關的tag，可以先打&lt;code&gt;v&lt;/code&gt;然後在按下&lt;kbd&gt;tab&lt;/kbd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;  當然，上面都只是&lt;em&gt;&lt;strong&gt;建議&lt;/strong&gt;&lt;/em&gt;，沒有對錯，只是習慣或者避免一些小問題。   &lt;/p&gt;&lt;p&gt;  上面有些建議裡面已經有包含說明，如果對於一開始提到的問題發生原因有興趣的話，繼續往下看.....   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696185747"&gt;重現問題&lt;/h2&gt;&lt;p&gt;  首先我們先來重現一下問題（這個重現方式和我實際發生的情境有點不同，因為我的情境需要兩個帳號交叉才看得到，不過local可以用以下方式重現，問題點是一樣）。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;   相關repo請看：&lt;a href="https://github.com/alantsai-samples/git-naming-problem"&gt;alantsai-samples/git-naming-problem&lt;/a&gt;&lt;/div&gt;&lt;p&gt;  接下來，我們要：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;建立一個repo&lt;/li&gt;&lt;li&gt;先打一個UnReleased的標籤&lt;/li&gt;&lt;li&gt;push到remote&lt;/li&gt;&lt;li&gt;修改在打一個unreleased的標籤&lt;/li&gt;&lt;li&gt;push到remote&lt;/li&gt;&lt;li&gt;檢查&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185503"&gt;建立一個repo&lt;/h3&gt;&lt;p&gt;   可以參考另外一篇&lt;a href="http://blog.alantsai.net/2017/07/net-project-structure.html"&gt;該怎麼開專案的資料夾結構？每個專案應該要有的資料夾結構和檔案&lt;/a&gt;的Powershell語法來建立一個repo：    &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git clone https://github.com/alantsai/mhat-common-boilerplate-repo.git&lt;br /&gt;cd mhat-common-boilerplate-repo&lt;br /&gt;rm .git -Recurse -Force&lt;br /&gt;git init&lt;br /&gt;git add -A&lt;br /&gt;git commit -m "init project"&lt;/pre&gt;&lt;p&gt;   這個時候，我們修改其中一些檔案。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185379"&gt;先打一個UnReleased的標籤&lt;/h3&gt;&lt;p&gt;   做完修改commit之後我們打一個&lt;code&gt;UnReleased&lt;/code&gt;的tag    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dAU07Fd1NSY/Wb6jENWHJYI/AAAAAAAAWaA/RyiHCts_tgsbohaTJDMv08ZnFs6DaPchACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="78" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-wfjybZR7uzM/Wb6jFYzsB_I/AAAAAAAAWaE/HWZfcURX0rsK9ZWqOaBGzRz2UHmaFDFEwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;打UnReleased的tag&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185176"&gt;push到remote&lt;/h3&gt;&lt;a href="https://lh3.googleusercontent.com/-jGI-jIizi5k/Wb6jGVh9avI/AAAAAAAAWaI/w4aGf-rxORcMR0xMwOUWyXGV9bCC0nWIwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="144" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-jxPYP84Zv-E/Wb6jIvLbgXI/AAAAAAAAWaM/8Krk7MQGEvscscgLI3d7-6hkuuwrYXZIACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-t0RvhDFP2t8/Wb6jJZA0_FI/AAAAAAAAWaQ/q5taHwUORUUNBnX0g-64W3x06hyZNF9dQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="503" height="409" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-E5f4Y4shfE8/Wb6jLzU1KdI/AAAAAAAAWaU/1MgRympHb3AmK8XEre4G4RkjSdURr480ACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;figcaption&gt;push成功之後可以在github上面看到確認有上去&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185137"&gt;在修改之後打一個unreleased的標籤&lt;/h3&gt;&lt;p&gt;   注意這邊的大小寫應該是都小寫的&lt;code&gt;unreleased&lt;/code&gt;。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5zt0gD124KY/Wb6jOUdOldI/AAAAAAAAWaY/U7aun8l1IG0Tq7OCxYHbFiBIxkSxgnzAgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="221" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-z5um5SLV5ok/Wb6jRHdAQsI/AAAAAAAAWac/GAXLzajuV-UBpFZyd0miesoZ8V_xdALoACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;打一個unreleased的標籤&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185858"&gt;檢查&lt;/h3&gt;&lt;p&gt;   發現到，在本機只剩下全小寫的那個&lt;code&gt;unreleased&lt;/code&gt;的標籤，有大寫的不見了，但是在remote，&lt;em&gt;&lt;strong&gt;大小寫兩個標籤都在&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-Hg0iWyWtFjI/Wb6jRw-g59I/AAAAAAAAWag/9of8XbGZ6jkoA9D_OVjWcTj3rP2I-NkLwCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="196" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-7N-NrMElljA/Wb6jTZKhQvI/AAAAAAAAWak/c1OfqBufbZg5WlHXMkN1lWSyT1YiXZMJACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-IbMOzBig35g/Wb6jUG5c2NI/AAAAAAAAWao/guAwGXFpeYobw_slnfwBowJhcCFFHzKrwCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="571" height="696" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-aTcRyfYFR28/Wb6jVdg_luI/AAAAAAAAWas/HdhIQyb009kq_G8C6mDetXT0dSWfFb6ewCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;local和remote比對&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    如果是從remote clone下來不會看到一樣的情況，這個下面會在做說明。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696185312"&gt;了解為什麼local變成一個而remote還是兩個&lt;/h2&gt;&lt;p&gt;  要了解這個發生的原因我們需要兩個前置的訊息：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;git tag是怎麼儲存&lt;/li&gt;&lt;li&gt;作業系統對待檔名大小寫的不同&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185376"&gt;git tag是怎麼儲存&lt;/h3&gt;&lt;p&gt;   git的資訊其實是存在&lt;code&gt;.git\refs\tags&lt;/code&gt;裡面（好吧，這個說法其實不太精準，以下會在說明），以我這邊為例，可以看到有一個叫做&lt;code&gt;unreleased&lt;/code&gt;的檔案，這個檔案的內容其實存的是一個hash值指向tag的位置。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-L6I0muE44cQ/Wb6jWwILczI/AAAAAAAAWaw/SDh1RLNWctMsEMxliqXzgnEbn9pTjkV8wCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="258" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tvS4bHEsZWU/Wb6jZegh0vI/AAAAAAAAWa0/av4w9cqEWVgxroStEjIjrV9R4pPaKDurgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;tag如何儲存 - 看到在tags資料夾檔案裡面就是一個hash&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   了解這個之後搭配下面的資訊我們就知道為什麼了。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505664696185578"&gt;作業系統對待檔名大小寫的不同&lt;/h3&gt;&lt;p&gt;   Windows和Linux在處理很多事情上面其實不太一樣，這裡面有一個不同之處在於如何對待檔名大小寫：    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Windows&lt;em&gt;&lt;strong&gt;不區分&lt;/strong&gt;&lt;/em&gt;大小寫&lt;/li&gt;&lt;li&gt;Linux&lt;em&gt;&lt;strong&gt;區分&lt;/strong&gt;&lt;/em&gt;大小寫&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;   什麼意思呢？舉例來說，如果我有兩個檔案，一個叫做&lt;code&gt;UnReleased&lt;/code&gt;另外一個叫做&lt;code&gt;released&lt;/code&gt;：    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;在Windows，兩個檔案會互蓋，換句話說，在同一個資料夾，這兩個檔案只能&lt;em&gt;留1個&lt;/em&gt;&lt;/li&gt;&lt;li&gt;在Linux，因為區分大小寫，因此在同一個資料夾兩個檔案可以&lt;em&gt;共存&lt;/em&gt;，換句話說不會互蓋&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;p&gt;   搭配上面的資訊，為什麼變成一個的原因就浮出水面了，當第一個tag建立的時候，會有個檔案叫做&lt;code&gt;UnReleased&lt;/code&gt;出現，當第二個tag &lt;code&gt;unreleased&lt;/code&gt;出現的時候，因為Windows不區分大小寫，直接就把    &lt;code&gt;UnReleased&lt;/code&gt;蓋掉了，因此local變成&lt;em&gt;只有一個&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;   那remote為什麼還是兩個呢？因為我們push上去的地方時github，那github host在linux（應該是啦，這個我沒找到Reference，所以說錯和我說一下，不過大部分的host應該都是liunx），而linux &lt;em&gt;區分&lt;/em&gt;大小寫，所以保留了下來。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;h4 id="WizKMOutline_1505664696185673"&gt;例外情況&lt;/h4&gt;&lt;p&gt;   假設從sample repo clone程式碼下來，會發現兩個tag都存在阿，沒有所謂互蓋的情況啊，這是為什麼呢？    &lt;/p&gt;&lt;figure&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;a href="https://lh3.googleusercontent.com/-De7Rh_xByVw/Wb6ja6MYRNI/AAAAAAAAWa4/zTx8riIaDRwTnKcdV3S_TOGmFvoPa3gOwCHMYCw/s1600-h/TortoiseGitProc_2017-09-18_00-13-05%255B2%255D"&gt;&lt;img width="654" height="174" title="TortoiseGitProc_2017-09-18_00-13-05" style="display: inline; background-image: none;" alt="TortoiseGitProc_2017-09-18_00-13-05" src="https://lh3.googleusercontent.com/-18itnByra88/Wb6jdha-GgI/AAAAAAAAWa8/tLnlT_oHSQYs5am5moH1BOc7x2PqyiPIwCHMYCw/TortoiseGitProc_2017-09-18_00-13-05_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;     &lt;figcaption&gt;clone下來的兩個tag都有看到&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   這個原因是因為，其實tag還有可能存在另外一個地方，那個地方是&lt;code&gt;.git\packed-refs&lt;/code&gt;，這個檔案主要是為了如果&lt;code&gt;refs&lt;/code&gt;很多，速度會比較慢，所以會把一些&lt;code&gt;refs&lt;/code&gt;放到&lt;code&gt;packed-refs&lt;/code&gt;    裡面好讓讀取的時候速度比較快。    &lt;/p&gt;&lt;p&gt;   當clone下來的git tag資訊是存在那個裡面，所以不會有檔名問題，因此兩個tag都出現了，不過如果開始建立tag可以重現上述的問題。    &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696185732"&gt;結語&lt;/h2&gt;&lt;p&gt;  其實這一篇混雜了兩個主題：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;建議的naming方式&lt;/li&gt;&lt;li&gt;如何解決因為naming問題導致出現兩個標籤的問題&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;  由於兩個主題有相關因此寫在了一起，算是為了建議naming的一個use case範例。   &lt;/p&gt;&lt;p&gt;  不過就像上面說的，這邊的是&lt;em&gt;建議&lt;/em&gt;而不是&lt;em&gt;一定要&lt;/em&gt;這麼做 - 也是結合了網路上大家的建議，當然大家有不同的想法，因此不一定都認同，也希望提出不同意見讓整個資訊更加豐富。   &lt;/p&gt;&lt;p&gt;  在追蹤問題的時候，會發現其實需要一些git和OS之間差異的資訊才有辦法發現實際的問題 - 告訴我們 學無止境阿.....   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505664696185651"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     網路上建議的取名方式    &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/11947587/is-there-a-naming-convention-for-git-repositories"&gt;Is there a naming convention for git repositories?&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/19077110/is-it-suggested-to-have-git-repository-names-in-upper-or-camel-case-instead-of-l"&gt;Is it suggested to have Git repository names in upper or camel case instead of lower case?&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Tag命名的建議    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://stackoverflow.com/questions/2006265/is-there-a-standard-naming-convention-for-git-tags"&gt;Is there a standard naming convention for git tags? [closed]&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     pack-refs - 官方介紹作用    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://git-scm.com/docs/git-pack-refs"&gt;git-pack-refs&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:66a22c75-0b7a-4f56-80a8-76a9388312d2" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/best+practices" rel="tag"&gt;best practices&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6768631030517279675/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/git-naming-for-repo-tag-and-branch-best-practice.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6768631030517279675'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6768631030517279675'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/git-naming-for-repo-tag-and-branch-best-practice.html' title='[git]repo、branch和tag取名建議和注意事項 - 怎麼取名比較不會有問題'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-j5KSvRVzn8k/Wb6jBiY_bnI/AAAAAAAAWZ0/m52LFVFMjI8im51x4UpidJQETPLVzqI6QCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6266023670875465419</id><published>2017-09-15T23:22:00.000+08:00</published><updated>2017-09-15T23:24:35.709+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][暫完]階段性總結</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-f7LhRI7Ud3o/WbvvpbcqynI/AAAAAAAAWZY/QiG_KwVWyMc11iJnJhqsqbJU7r93cIzqQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FY3yw8qmB4s/WbvvsLdnTGI/AAAAAAAAWZc/D42NnnV_QsIz8wDE1KWvK65HRA5wLTDWQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-multi-project-template-and-item-template.html"&gt;[12]TemplateBuilder建立Multi Project和Item Template&lt;/a&gt;）介紹完最複雜類型的template - multi project template之後，基本上已經涵蓋一般常見到的情況了。&lt;/p&gt;&lt;p&gt;		在這一篇將會對於這一系列所介紹的方式做個總結，並且展望接下來可以關注的方向。 		&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085689" ;=""&gt;總結目前介紹的內容&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085917" ;=""&gt;template重要性和何為template&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085883" ;=""&gt;用匯出的方式建立template&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085741" ;=""&gt;用VS的project template建立template&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085945" ;=""&gt;SideWaffle的降臨&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085561" ;=""&gt;關於未來&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085111" ;=""&gt;什麼是Wizard&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558085460" ;=""&gt;.net core帶來的新template模式&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505487558086954" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1505487558085689"&gt;總結目前介紹的內容&lt;/h2&gt;&lt;p&gt;		整合到目前為止所介紹的內容。 		&lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085917"&gt;template重要性和何為template&lt;/h3&gt;&lt;p&gt;			這一個系列的一開始，先介紹了template的重要性，用template來規範團隊是最好的方式。 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-intro.html"&gt;[01]開篇&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-template-intro-sample-package-intro.html"&gt;[02]了解template類型和建立出要變成範本的程式&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085883"&gt;用匯出的方式建立template&lt;/h3&gt;&lt;p&gt;			最簡單和最快的建立template方式就是透過Visual Studio（以下簡稱VS）匯出的方式來達成。 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html"&gt;[03]透過匯出建立Project Template&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;			在接下來介紹vstemplate的內容和如何透過微調vstemplate來達到想要的效果 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;			最後介紹如何建立最複雜類型的template - multi project template和item template。 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-multi-project-template.html"&gt;[05]建立多專案(multi project)的Template&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-item-template.html"&gt;[06]建立Item Template&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-create-item-template.html"&gt;[07]匯出template建立小總結，更好的建立方式介紹 VSIX&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085741"&gt;用VS的project template建立template&lt;/h3&gt;&lt;p&gt;			由於匯出template不好管理，因此開始深入了解如何透過VS的Project Template和VSIX建立template。 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-vs-expermiental-instance-intro-and-VSIX-setting.html"&gt;[08]Visual Studio Experimental Instance 和 VSIX template的細節設定介紹&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;			用VSIX開發會自動開啟VS的Experimental Instance做測試，因此對於如何使用Experimental Instance做了一些介紹 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-VSIX-problem-SideWaffle-pros-intro.html"&gt;[09]內建VSIX的缺點 - SideWaffle基本介紹&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085945"&gt;SideWaffle的降臨&lt;/h3&gt;&lt;p&gt;			Project Template的缺點是，如果要調整template是在不方便，因為template本身都是替換的Parameter，造成無法像一般開發的方式來2度微調template，因此SideWaffle進來了： 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-use-sidewaffle-to-create-project-template.html"&gt;[10]用SideWaffle建立Project Template&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;			有了一些使用SideWaffle的概念之後，開始介紹實際的背後功臣 - TemplateBuilder - 如何微調並且使用建立multi project template 			&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-setting-and-convention.html"&gt;[11]深入了解TemplateBuilder的特殊檔案設定方式&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-multi-project-template-and-item-template.html"&gt;[12]TemplateBuilder建立Multi Project和Item Template&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/section&gt;&lt;div class="bs-callout bs-callout-default"&gt;				這個系列只有有程式碼的部分都可以再github &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template"&gt;alantsai-samples/mhat-visualstudio-template&lt;/a&gt; 找到範例，有程式碼的篇章都會有一個tag 				以&lt;code&gt;sample/&lt;/code&gt;為開頭，例如&lt;code&gt;sample/chapter02&lt;/code&gt;&lt;/div&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505487558085561"&gt;關於未來&lt;/h2&gt;&lt;p&gt;		到目前為止，用TemplateBuilder已經能夠很方便建立出自己的template，基本上一般情境都夠用了，不過是否這就已經是到頭了呢？ 		&lt;/p&gt;&lt;p&gt;		基本上有兩個部分還沒有介紹： 		&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Wizard的介紹&lt;/li&gt;&lt;li&gt;.net core的新template模式&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085111"&gt;什麼是Wizard&lt;/h3&gt;&lt;p&gt;			在建立template的時候，有時候會希望和使用者互動。舉例來說，如果我的template包含自動設定好db連線，這個時候建立template的時候就會希望有個地方會讓他輸入db相關資訊 -  			template建立好就設定好不需要建立完在自己去找對應檔案和調整。 			&lt;/p&gt;&lt;p&gt;			要達到這種效果，就需要寫Wizard。 			&lt;/p&gt;&lt;p&gt;			可以想象成寫asp .net mvc的時候，如果建立controller會讓你選擇要建立的controller類型（controller其實用的是Scaffolding在做這個事情，不過概念是差不多）。 			&lt;/p&gt;&lt;p&gt;			Wizard目前&lt;em&gt;沒有&lt;/em&gt;打算介紹（至少短期內不會），因為使用的情境比較少，雖然有Wizard的確UX會更好，但是如果template沒有複雜到某個程度，其實不會用到。 			&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505487558085460"&gt;.net core帶來的新template模式&lt;/h3&gt;&lt;p&gt;			作為.net developer，最近應該長聽到的就是.net core 2.0的到來。 			&lt;/p&gt;&lt;p&gt;			如果對.net core有關注的就會注意到，.net core 很大一個特色就是程式的執行模式和以前的.net framework不一樣，多了一個&lt;code&gt;dotnet&lt;/code&gt;的指令。 			&lt;/p&gt;&lt;p&gt;			裡面可以使用&lt;code&gt;dotnet new&lt;/code&gt;的方式來建立出template，這種類型的template和VS裡面的template建立方式有些不同。 			&lt;/p&gt;&lt;p&gt;			在不遠的將來，將會對於.net core的template建立方式做介紹。 			&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505487558086954"&gt;結語&lt;/h2&gt;&lt;p&gt;		在這篇把這個系列做一個階段性總結。 		&lt;/p&gt;&lt;p&gt;		更深入的template需求可以朝Wizard的方向做研究和客制，不過因為使用情境比較深入因此暫時不會介紹。 		&lt;/p&gt;&lt;p&gt;		反而是因為.net core的到來，新的template建立方式勢必會越來越常使用。 		&lt;/p&gt;&lt;p&gt;		不過如果不了解.net core，會無法了解為何template有做了變化。 		&lt;/p&gt;&lt;p&gt;		因此這個系列將會暫時結束，轉向對.net core作介紹，並且在那邊介紹如何使用&lt;code&gt;SideWaffle Creator 2017&lt;/code&gt;（SideWaffle的VS 2017版本）來建立出VS和dotnet new格式的template。 		&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:03e7790e-6b07-4798-9509-c8543fbcec39" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6266023670875465419/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-summary.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6266023670875465419'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6266023670875465419'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-summary.html' title='[打造自己的template-建立一致性程式碼][暫完]階段性總結'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-FY3yw8qmB4s/WbvvsLdnTGI/AAAAAAAAWZc/D42NnnV_QsIz8wDE1KWvK65HRA5wLTDWQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2758951895043872646</id><published>2017-09-14T00:04:00.000+08:00</published><updated>2017-09-14T00:04:52.739+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][12]TemplateBuilder建立Multi Project和Item Template</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cgN1fvGUZH8/WblVmdfAMZI/AAAAAAAAWXU/WrsfTnq6chsvMdvaEnJp4kmGApCMNyiAwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Yv6enYeEOXU/WblV0_NjMhI/AAAAAAAAWXY/Q1ZR4q9v_Y8b2FDR_T6FbiA1iC9nze1PQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-setting-and-convention.html"&gt;[11]深入了解TemplateBuilder的特殊檔案設定方式&lt;/a&gt;）對於TemplateBuilder的一些特殊檔案的設定做了更詳細的介紹，對於一般微調已經夠用了。   &lt;/p&gt;&lt;p&gt;  不過如果要建立Multi Project還未遇到一些問題，因此這篇將會對如何用TemplateBuilder來建立Multi Project的template和快速介紹建立Item Template。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter12"&gt;github mhat-visualstudio-template sample/chapter12&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819762289" ;=""&gt;用TemplateBuilder建立Multi Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763908" ;=""&gt;把要建立的Multi Project複製一份到ProjectTemplates\MultiTemplate下面&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763163" ;=""&gt;在根專案建立_Definitions和如果需要_preprocess&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763134" ;=""&gt;在各自專案建立vstemplate和如果需要_preprocess&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763625" ;=""&gt;把這些特殊檔案加入專案reference&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763237" ;=""&gt;測試&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763118" ;=""&gt;調整&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763362" ;=""&gt;用TemplateBuilder建立ItemTemplate&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763907" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505317819763256" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505317819762289"&gt;用TemplateBuilder建立Multi Project Template&lt;/h2&gt;&lt;p&gt;  基本上建立Multi Project Template和一般template做法差不多，唯一的差別點是為了讓&lt;code&gt;_preprocess&lt;/code&gt;有作用，需要設定一些&lt;code&gt;Wizard&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;  整個建立過程如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;把要建立的Multi Project複製一份到&lt;code&gt;ProjectTemplates\MultiTemplate&lt;/code&gt;下面&lt;/li&gt;&lt;li&gt;在根專案建立&lt;code&gt;_Definition&lt;/code&gt;和如果需要&lt;code&gt;_preprocess&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在各自專案建立&lt;code&gt;vstemplate&lt;/code&gt;和如果需要&lt;code&gt;_preprocess&lt;/code&gt;&lt;/li&gt;&lt;li&gt;把這些特殊檔案加入專案reference&lt;/li&gt;&lt;li&gt;測試&lt;/li&gt;&lt;li&gt;調整&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763908"&gt;把要建立的Multi Project複製一份到ProjectTemplates\MultiTemplate下面&lt;/h3&gt;&lt;p&gt;   先用之前建立的multi project template來建立一個專案。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-e8TA-L0_4aI/WblV2kQvuOI/AAAAAAAAWXc/SToFySXqWeY6Em55Rsk8fbvdM0zhRsTKgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IKP7AhF92FQ/WblV3qu9bII/AAAAAAAAWXg/DGF_WoaIj4w2eQOAHOZhh77A4cRnGqEwQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;先建立一個專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   把那個專案複製到VSIX專案的ProjectTemplates\MultiTemplate下面：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-p5PalKmp2Rg/WblV4cbTnHI/AAAAAAAAWXk/LDS2xC9tHpcoMzhfoHfeXH-k21rcI8H3wCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="203" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-oVDSmgnogwM/WblV5qSM1zI/AAAAAAAAWXo/cYPCyQy5SZ0g0-NH5p7Wpnet2G0ERiQFgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;複製過去&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   調整一下，讓sln同一層就是另外兩個專案的資料夾    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RhQMKjibJQw/WblV6redsVI/AAAAAAAAWXs/EYBDEYjuC7UQsIVH_glaeWodtzthwfjNACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="408" height="147" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-h83kCNoGCPg/WblV8AQtYvI/AAAAAAAAWXw/24B78rcWPA0mVp0YiOqCaVI1fEVvyW6-wCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;調整階層&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763163"&gt;在根專案建立_Definitions和如果需要_preprocess&lt;/h3&gt;&lt;p&gt;   首先是&lt;code&gt;_Definitions&lt;/code&gt;的部分，由於這個template不需要像單個ProjectTemplate那樣要包含的內容要從csproj出來，反而是像一般的vstemplate的方式，因此我們直接建立一個&lt;code&gt;CSharp.vstemplate&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;   這邊和我們一般&lt;code&gt;vstemplate&lt;/code&gt;一樣，只是要加一個&lt;code&gt;WizardExtension&lt;/code&gt;：    &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;WizardExtension&amp;gt;&lt;br /&gt;    &amp;lt;Assembly&amp;gt;TemplateBuilder, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&amp;lt;/Assembly&amp;gt;&lt;br /&gt;    &amp;lt;FullClassName&amp;gt;TemplateBuilder.RootWizard&amp;lt;/FullClassName&amp;gt;&lt;br /&gt;&amp;lt;/WizardExtension&amp;gt;&lt;/pre&gt;&lt;p&gt;   這個Wizard主要讓&lt;code&gt;_preprocess&lt;/code&gt;執行的時候替換參數不會有問題。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yhxsriWXkYY/WblV9MzKx7I/AAAAAAAAWX0/ePgl7seQT3kBOw9PEXPLFYAUt6k7xzf-wCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="410" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--YoNqSMcza4/WblV_mKiZSI/AAAAAAAAWX4/UcywyacKSewGcb4k7MuXP9VmrdeaPWFRACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   最後，加入一個&lt;code&gt;_preprocess&lt;/code&gt;，主要用來設定&lt;code&gt;分類&lt;/code&gt;和要替換的namespace部分。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-o1E9tO9xxiU/WblWBA1AnmI/AAAAAAAAWX8/Orxl_aCD2iAu3jt1HGatkLt3PeDFcl1DACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="428" height="210" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-zVIgac_AW0c/WblWC4IrW7I/AAAAAAAAWYA/Tlf2Y1CI8J0uR_ZeVVtky6F4f34E9_YtgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;目前Visual Studio Solution看到的樣子&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763134"&gt;在各自專案建立vstemplate和如果需要_preprocess&lt;/h3&gt;&lt;p&gt;   目前有兩個專案，分別在這兩個專案資料夾加入一個一般的&lt;code&gt;vstemplate&lt;/code&gt;和&lt;code&gt;_preprocess&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;   在&lt;code&gt;vstemplate&lt;/code&gt;的部分和一般的沒什麼兩樣，不過要加一個&lt;code&gt;WizardExtension&lt;/code&gt; - 注意和root對應所以是&lt;code&gt;ChildWizard&lt;/code&gt;，整個內容如下：    &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;WizardExtension&amp;gt;&lt;br /&gt;    &amp;lt;Assembly&amp;gt;TemplateBuilder, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&amp;lt;/Assembly&amp;gt;&lt;br /&gt;    &amp;lt;FullClassName&amp;gt;TemplateBuilder.ChildWizard&amp;lt;/FullClassName&amp;gt;&lt;br /&gt;&amp;lt;/WizardExtension&amp;gt;&lt;/pre&gt;&lt;p&gt;   其中一個的&lt;code&gt;_preprocess&lt;/code&gt;和&lt;code&gt;vstemplate&lt;/code&gt;如下：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RsVg9yCGKM8/WblWF2vhTMI/AAAAAAAAWYE/dXvwOPxFqEQkOUBk_xyQGrRQvCsYAhqtQCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="204" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-o_ZRX7w6uV4/WblWJrkM9zI/AAAAAAAAWYI/e2hG-sMzYZUGSwpc2uKyh6aLVSK9eOMRwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;、&lt;a href="https://lh3.googleusercontent.com/-GDqdP07vTb4/WblWNF9dmUI/AAAAAAAAWYM/N2ctqAUA3MkEdrwEIG7JqaqgeEXsYADIgCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="347" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OLUeJiOj6gk/WblWO_0ycMI/AAAAAAAAWYQ/l_nZHFDxkNoNddXtcKdl5sW-8gVGyltaACHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;preprocess和template內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763625"&gt;把這些特殊檔案加入專案reference&lt;/h3&gt;&lt;p&gt;   剛剛建立的那些檔案都要加入到sln裡面，最後的結果如下：    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-51m519mnSwU/WblWQbIpIvI/AAAAAAAAWYU/DQZ4c_jPJYksQn8jwXXoyoLC6ciUohdDQCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="441" height="242" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-T0A_k2QCkMs/WblWTt2aJiI/AAAAAAAAWYY/uwDXNMfAmR8OU-wQkQVWsg7BOG3PyLzSwCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;目前sln樣子&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   這個時候要回去調整一下root的&lt;code&gt;_Definitions\CSharp.vstemplate&lt;/code&gt;把ProjectTemplate的link指向剛剛在上一步建立的vstemplate路徑。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763237"&gt;測試&lt;/h3&gt;&lt;p&gt;&lt;kbd&gt;Ctrl + F5&lt;/kbd&gt;把Visual Studio Experimental Instance執行起來，在&lt;code&gt;C#&lt;/code&gt; -&amp;gt; &lt;code&gt;Multi Project&lt;/code&gt;會看到template    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-fm8fqPwVq6A/WblWUkPRrNI/AAAAAAAAWYc/L2VBpMRChGc9BzrFaxH6ZIRE3sk5tReIgCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="372" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-WWyLYMAlvbI/WblWWNFhxmI/AAAAAAAAWYg/j7F-rIxxcNgV0S013J4-17Byx5tdICkzwCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   建立出來的結果    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UYY2N2Nxezg/WblWcgwgbMI/AAAAAAAAWYk/yNmqfrYiSKQoQSKuvHus4MsVG8SLDyF5QCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="350" height="385" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-1dUmIY0pENg/WblWe83EXTI/AAAAAAAAWYo/JBqnufO4_98FvCj4qeuSqElxFFIQ0JtVQCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505317819763118"&gt;調整&lt;/h3&gt;&lt;p&gt;   很有可能會希望在調整template，這個時候可以怎麼做呢？    &lt;/p&gt;&lt;p&gt;   還記得我們複製過來的時候有包含&lt;code&gt;sln&lt;/code&gt;，其實只需要把那個&lt;code&gt;sln&lt;/code&gt;&lt;em&gt;執行起來，並且向一般開發一樣修改專案&lt;/em&gt;，之後確定好了，只要回到VSIX專案Ctrl + F5 直接在Experimental Instance測試。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    github的sample程式碼雖然可以建立出template，但是其實還需要一些tweak才能夠正常build，這個就留個有興趣的來玩玩看。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505317819763362"&gt;用TemplateBuilder建立ItemTemplate&lt;/h2&gt;&lt;p&gt;  由於ItemTemplate只是一個檔案居多（其實可以多檔案），因此不會像Project Template那樣幫助那麼大，不過還是有些Convention可以讓建立的時候更加方便。   &lt;/p&gt;&lt;p&gt;  基本上和project template一樣，建立&lt;code&gt;_Definitions\*.vstemplate&lt;/code&gt;和&lt;code&gt;_preprocess&lt;/code&gt;，不過因為沒有csproj，因此和一般定義vstemplate定義方式一樣。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   由於和一般內建的建立方式差不多，所以不詳細介紹，可以參考範例程式碼。如果建立一個cs檔案，最後sln結構如下：    &lt;a href="https://lh3.googleusercontent.com/-KEEBqec_li8/WblWfyDxO6I/AAAAAAAAWYs/OGhCo9HlIvo6NL85W4t7yK24bFoPJ5NNgCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="338" height="211" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Q2lMwvcmcg8/WblWhNJpH-I/AAAAAAAAWYw/LAC_zSDtwo8YEG2F6GtZelPZVdP3_lI3gCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-D1aOHn_C9s8/WblWiXbEZgI/AAAAAAAAWY0/BKmbk901RJgvnDzTYd3QjPM7_d7dw2DTACHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-yLWKZKk8M3Y/WblWkh4B_xI/AAAAAAAAWY4/xtXoj4YPTPs2SW20fWCGHflLasM-p86gwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;item template結構和建立item template看到的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505317819763907"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇介紹了如何建立Multi Project Template - 基本上已經是最複雜類型的Project Template了。   &lt;/p&gt;&lt;p&gt;  因此，SideWaffle的介紹也差不多到了一個尾聲。透過目前所學，對於一般要建立自己的template已經沒什麼問題了。   &lt;/p&gt;&lt;p&gt;  在下一篇，將會對於最近這些篇章的內容做一個階段性的總結，和這個系列接下來會介紹的方向。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505317819763256"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="https://github.com/ligershark/side-waffle/wiki/How-to-create-a-multi-project-template"&gt;How to create a multi project template&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;      官方介紹如何建立Multi Project     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:fe54f48a-9afa-41af-9fa8-66b232285fc3" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2758951895043872646/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-multi-project-template-and-item-template.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2758951895043872646'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2758951895043872646'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-multi-project-template-and-item-template.html' title='[打造自己的template-建立一致性程式碼][12]TemplateBuilder建立Multi Project和Item Template'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-Yv6enYeEOXU/WblV0_NjMhI/AAAAAAAAWXY/Q1ZR4q9v_Y8b2FDR_T6FbiA1iC9nze1PQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-871351307223371019</id><published>2017-09-11T23:50:00.000+08:00</published><updated>2017-09-11T23:50:52.670+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][11]深入了解TemplateBuilder的特殊檔案設定方式</title><content type='html'>&lt;section&gt;&lt;figure&gt;    &lt;a href="https://lh3.googleusercontent.com/-k_ePvij1ZgA/WbawHFrN4PI/AAAAAAAAWV8/a7EqbWqsODMJ9C5OIYpr9-4YF9XZN-sOQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Yleworxvc0A/WbawIhGDuyI/AAAAAAAAWWA/2XQucePQVu4W7u0d5x765PnkE-j3G2uIgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-use-sidewaffle-to-create-project-template.html"&gt;[10]用SideWaffle建立Project Template&lt;/a&gt;）了解了如何用SideWaffle建立出project的方式。   &lt;/p&gt;&lt;p&gt;  在這一篇將會更深入的介紹TemplateBuilder裡面的一些特殊檔案的作用和如何微調讓產生出想要的Template。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter11"&gt;github mhat-visualstudio-template sample/chapter11&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497625" ;=""&gt;TemplateBuilder的一些特殊檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497610" ;=""&gt;_Definition\_project.vstemplate.xml&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497844" ;=""&gt;和*.vstemplate~的差異&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497381" ;=""&gt;_preprocess.xml&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497868" ;=""&gt;TemplateBuilder的Convention&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1505144311497206" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1505144311497625"&gt;TemplateBuilder的一些特殊檔案&lt;/h2&gt;&lt;p&gt;  還記得其實建立Template的背後功臣是TemplateBuilder，而TemplateBuilder透過一些特殊的檔案和習慣（Convention）來讓建立template變得簡單：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;_Definition\_project.vstemplate.xml&lt;/li&gt;&lt;li&gt;_preprocess.xml&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505144311497610"&gt;_Definition\_project.vstemplate.xml&lt;/h3&gt;&lt;p&gt;   在上篇的&lt;code&gt;Add Template Reference&lt;/code&gt;其中被加入的一個檔案就是&lt;code&gt;_Definition\_project.vstemplate.xml&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;   這個檔案打開來看會發現和一般定義template用到的&lt;code&gt;vstemplate&lt;/code&gt;基本一樣，唯一差異的地方是：    &lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;&lt;code&gt;Project&lt;/code&gt;的內容完全沒有（主要用來定義template要包含什麼內容）&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;   這其實就是&lt;code&gt;TemplateBuilder&lt;/code&gt;好的地方，template要包含的內容，會由&lt;code&gt;csproj&lt;/code&gt;有包含的內容整合到&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;檔案裡面。    &lt;/p&gt;&lt;p&gt;   這也是為什麼如果有改template，就像一般開發，然後直接build就好 - 原因就在於&lt;code&gt;TemplateBuilder&lt;/code&gt;會在build的時候把&lt;code&gt;csproj&lt;/code&gt;和&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;結合。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1505144311497844"&gt;和*.vstemplate~的差異&lt;/h4&gt;&lt;p&gt;    在SideWaffle裡面有一個Item Template叫做&lt;code&gt;SideWaffle Definition Folder&lt;/code&gt;，會建立&lt;code&gt;Definitions&lt;/code&gt;資料夾，然後裡面有好幾個以&lt;code&gt;*.vstemplate~&lt;/code&gt;的檔案     &lt;/p&gt;&lt;p&gt;    這種和&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;差異在於，&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;會結合csproj的檔案，而&lt;code&gt;*.vstemplate~&lt;/code&gt;則不會，他們的作用則是快速建立     &lt;em&gt;不同&lt;/em&gt;語言的template。舉例來說，今天要建立一個template用於&lt;code&gt;CSharp&lt;/code&gt;和&lt;code&gt;VB&lt;/code&gt;，那麼就會保留&lt;code&gt;CSharp.vstemplate&lt;/code&gt;和&lt;code&gt;VB.vstemplate&lt;/code&gt;&lt;/p&gt;&lt;p&gt;    (這邊注意要把尾巴的&lt;code&gt;~&lt;/code&gt;拿掉才有作用)     &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-JRRtCq2Sc5Q/WbawK11IbxI/AAAAAAAAWWE/FNG8ew8rQwAbteOG5uuSUAAAASTGD8FmgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-WZb2Ee2WUqY/WbawLxZFEpI/AAAAAAAAWWI/ytASVicH44oSyAUSYtVRFWx6ZmRAU2KIwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;      &lt;a href="https://lh3.googleusercontent.com/-6AuAxteCOmU/WbawM4PAHLI/AAAAAAAAWWM/UYZAEr2qJbgT6ukjEztis8dUUsEe61NKgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="308" height="149" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-TcuFEgZP5xg/WbawNwd0c9I/AAAAAAAAWWQ/pNAhbD8onfUEVCG1M2TkcaGZTgPeLZbyQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立item template和建立出來的內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1505144311497381"&gt;_preprocess.xml&lt;/h3&gt;&lt;p&gt;   這個檔案有兩個目的：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      設定關鍵字替換     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     上面的&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;讓我們不用自己手動設定說那些檔案要包含在template裡面，完全看csproj有包含的檔案。      &lt;/p&gt;&lt;p&gt;     但是這樣建立出來還有個問題就是，有些&lt;em&gt;內容希望替換掉&lt;/em&gt;，例如namespace要改成使用者建立時候輸入的內容，這個就是這個檔案的作用。      &lt;/p&gt;&lt;p&gt;     以下面的範例為例：      &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;Replacements Include="*.*" Exclude="*.vstemplate;*.csproj;*.fsproj;*.vbproj;*.jpg;*.png;*.ico;_preprocess.xml;_project.vstemplate.xml"&amp;gt;&lt;br /&gt; &amp;lt;add key="MHAT.ConsoleWithOption" value="$safeprojectname$"/&amp;gt;&lt;br /&gt;&amp;lt;/Replacements&amp;gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;Replacements&lt;/code&gt;可以設定那些檔案要包含，然後那些檔案要略過，然後每一個關鍵字就是用&lt;code&gt;add&lt;/code&gt;來加。      &lt;/p&gt;&lt;p&gt;     以這邊例子就是把目前namespace改成建立時候給的名稱。      &lt;/p&gt;&lt;p&gt;     可以看到，要被替換的內容可以用&lt;code&gt;Parameter&lt;/code&gt;&lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      設定template的分類     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;     會希望建立的template在某些template的分類裡面，這個就是&lt;code&gt;_preprocess.xml&lt;/code&gt;裡面的：      &lt;/p&gt;&lt;pre class="brush: xml;"&gt;     &amp;lt;TemplateInfo Path="CSharp\Web\SideWaffle"/&amp;gt;&lt;/pre&gt;&lt;p&gt;     以上就是設定template要放在&lt;code&gt;C#&lt;/code&gt;-&amp;gt;&lt;code&gt;Web&lt;/code&gt;-&amp;gt;&lt;code&gt;SideWaffle&lt;/code&gt;裡面      &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;code&gt;_preprocess.xml&lt;/code&gt;是可以多個，離檔案越近的&lt;code&gt;_preprocess.xml&lt;/code&gt;權重越高，可以透過這種方式來針對某些資料夾特殊處理。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505144311497868"&gt;TemplateBuilder的Convention&lt;/h2&gt;&lt;p&gt;  TemplateBuilder其實有特殊Convention的資料夾，分別為：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;ProjectTemplates&lt;/li&gt;&lt;li&gt;ItemTemplates&lt;/li&gt;&lt;li&gt;Snippet&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;  只要建立資料夾把檔案放到對應的資料夾，就會建立出對應的template/Snippet。所以除了上篇提到的&lt;code&gt;Add Template Reference&lt;/code&gt;，其實也可以用這種方式來建立。   &lt;/p&gt;&lt;p&gt;  以昨天的例子來說：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     建立出Convention的資料夾結構和複製檔案    &lt;/dt&gt;&lt;dd&gt;    基本上就是&lt;code&gt;ProjectTemplates&lt;/code&gt; -&amp;gt; &lt;code&gt;ConsoleWithOption&lt;/code&gt;和複製檔案到資料夾裡面。&lt;/dd&gt;&lt;dd&gt;&lt;a href="https://lh3.googleusercontent.com/-8D-hkp-JVVM/WbawPf-p7QI/AAAAAAAAWWU/T7C_V9Nz5UEJXoWA8ejJxURan2Uo0lJdQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="421" height="291" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-tRhEnTJc_hc/WbawR5nBXOI/AAAAAAAAWWY/BLz_bLcHOJ4yehnYYXI9pew8GR4Q7NyoACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;     &lt;a href="https://lh3.googleusercontent.com/-ZJ__CToIRuY/WbawU5H-DTI/AAAAAAAAWWc/L4e6Rwy4FRwreY2diSy7TUe7ImpGM8VJACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="343" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-DVGfPNizMM0/WbawW89sptI/AAAAAAAAWWg/swzNDKR0z0oYha6JE8kxCyHRtPi2weGyACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;建立結構&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     在VS裡面加入相關檔案和csproj    &lt;/dt&gt;&lt;dd&gt;     VS加入相關檔案。     &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-WgFiC9THSV0/WbawXxcF3iI/AAAAAAAAWWk/N7XHFzHKAuQY4fwmBaYAto1eLlzh_g4vwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="461" height="520" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-pmzz3LJzm9I/WbawZtwmhyI/AAAAAAAAWWo/EWXkxy02fDkW1czvpArgdYL2XtM08MorQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;加入相關&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     測試    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    這邊template名稱有改成&lt;code&gt;Convention Template&lt;/code&gt;比較容易看     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-a7VlJQNT4DI/WbawcKYmyHI/AAAAAAAAWWs/EBXjlv45psYtcwWxLEA-9tvLmQbof8NEACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="301" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-AMc5T8D_sqU/WbawjKuNkEI/AAAAAAAAWWw/vym0A6GmDWMuncnd1xHFkTjqzKXrAHUrgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;測試VS&lt;/figcaption&gt;&lt;/figure&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;  如果需要修改template，可以用另外一個VS來開啟對應的sln或者csproj，然後在那邊直接像一般開發的方式來調整template，確認好了之後，在切回到vsix專案直接build，template就更新了。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1505144311497206"&gt;結語&lt;/h2&gt;&lt;p&gt;  整個TemplateBuilder的精髓就在一些Convention和一些特殊檔案讓建立tempalte變得簡單。   &lt;/p&gt;&lt;p&gt;  雖然沒有介紹Item Template的做法，但是基本概念一樣。   &lt;/p&gt;&lt;p&gt;  到目前為止，TemplateBuilder快到一個段落了，不過還有一種複雜template還沒介紹，也就是Multi Project Template。   &lt;/p&gt;&lt;p&gt;  因此，下一篇將會介紹Multi Project Template。   &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:04aca6ea-f9e8-484c-8bbd-d541973b9e40" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/871351307223371019/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-setting-and-convention.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/871351307223371019'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/871351307223371019'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-TemplateBuilder-setting-and-convention.html' title='[打造自己的template-建立一致性程式碼][11]深入了解TemplateBuilder的特殊檔案設定方式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-Yleworxvc0A/WbawIhGDuyI/AAAAAAAAWWA/2XQucePQVu4W7u0d5x765PnkE-j3G2uIgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1544839911353393974</id><published>2017-09-09T22:48:00.000+08:00</published><updated>2017-09-09T22:48:00.975+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][10]用SideWaffle建立Project Template</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Eq9thKeBhHE/WbP99k8_VuI/AAAAAAAAWTs/c8LVCqs6yj4AKbmRThYsaNvyOoMv-6wTgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[10]用SideWaffle建立Project Template" style="display: inline; background-image: none;" alt="[10]用SideWaffle建立Project Template" src="https://lh3.googleusercontent.com/-F3PTN-FIXS0/WbP9-wRnUVI/AAAAAAAAWTw/Hrp5_N2lzfswBeZ4iV9zBPjRT-GD6tr6wCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-VSIX-problem-SideWaffle-pros-intro.html"&gt;[09]內建VSIX的缺點 - SideWaffle基本介紹&lt;/a&gt;）介紹完了內建VSIX template在維護上面的不方便和對於SideWaffle做了一個初步的介紹。   &lt;/p&gt;&lt;p&gt;  在這篇，將會使用SideWaffle來建立Project Template - 看看和內建的做法有何不同。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter10"&gt;github mhat-visualstudio-template sample/chapter10&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509933" ;=""&gt;SideWaffle建立Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509861" ;=""&gt;先安裝SideWaffle到VS 2015&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509494" ;=""&gt;建立一個VSIX專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509929" ;=""&gt;建立一個要變成template的project&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509267" ;=""&gt;用SideWaffle的功能建立關聯&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509779" ;=""&gt;微調設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509302" ;=""&gt;讓Project Template設定為不build&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509277" ;=""&gt;調整_project.vstemplate.xml的檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509558" ;=""&gt;把_project.vstemplate.xml的檔案Wizard刪掉&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509573" ;=""&gt;測試&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509682" ;=""&gt;是否無法使用VS 2017來建立？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509489" ;=""&gt;在project template的專案下面增加了檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509130" ;=""&gt;修改了VSIX專案包含一個特殊的Reference到project template的專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509968" ;=""&gt;在VSIX專案安裝TemplateBuilder&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504967803509572" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1504967803509933"&gt;SideWaffle建立Project Template&lt;/h2&gt;&lt;p&gt;  在上一篇有提到說其實讓template變得好建立其實是透過套件&lt;code&gt;TemplateBuilder&lt;/code&gt;，SideWaffle&lt;em&gt;不是&lt;/em&gt;必須要被安裝。   &lt;/p&gt;&lt;p&gt;  不過有SideWaffle在建立上可以省一點事，所以在接下來這個demo，我們會先切換到Visual Studio（下面簡稱VS) 2015來做這個事情。   &lt;/p&gt;&lt;p&gt;  接下來的操作步奏如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;先安裝SideWaffle到VS 2015&lt;/li&gt;&lt;li&gt;建立一個VSIX專案&lt;/li&gt;&lt;li&gt;建立一個要變成template的project&lt;/li&gt;&lt;li&gt;用SideWaffle的功能建立關聯&lt;/li&gt;&lt;li&gt;微調設定&lt;/li&gt;&lt;li&gt;測試&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509861"&gt;先安裝SideWaffle到VS 2015&lt;/h3&gt;&lt;p&gt;   首先到VS的Marketplace，找到SideWaffle（&lt;a href="https://marketplace.visualstudio.com/items?itemName=MadsKristensen.SideWaffleTemplatePack"&gt;下載鏈接&lt;/a&gt;），然後安裝到VS 2015。    &lt;/p&gt;&lt;p&gt;   最後檢查一下，在&lt;code&gt;Tools&lt;/code&gt; -&amp;gt; &lt;code&gt;Extensions and Updates&lt;/code&gt;裡面看看SideWaffle是否安裝成功。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jhJ5mewnq40/WbP-ClevX7I/AAAAAAAAWT0/TAKdNCJrh0o5XbipD9Kmx4fKdXFkkI1bQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="310" title="SideWaffle安裝好" style="display: inline; background-image: none;" alt="SideWaffle安裝好" src="https://lh3.googleusercontent.com/-gY6vRRe88SE/WbP-Ejc99XI/AAAAAAAAWT4/CsX6UDir4HoBd2aaQk9l97OUYtoocAnAACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;SideWaffle安裝好&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509494"&gt;建立一個VSIX專案&lt;/h3&gt;&lt;p&gt;   建立一個新的VSIX專案，這個會作為template安裝的VSIX檔案的來源。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-2AY0-lSNV48/WbP-IthUzkI/AAAAAAAAWT8/ZKDLam2cGVEQ0c3GmH6LLfN4DrKuBmvkwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="200" title="建立出VSIX專案" style="display: inline; background-image: none;" alt="建立出VSIX專案" src="https://lh3.googleusercontent.com/-VwocP_0_5rU/WbP-L-ZWbBI/AAAAAAAAWUA/aia9DJMnSbwa0MvOlSAykzAvw4c7OOccACHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立出VSIX專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509929"&gt;建立一個要變成template的project&lt;/h3&gt;&lt;p&gt;   在同一個Solution裡面，建立要變成Project Template的project。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-j8BKveCsmYQ/WbP-ONrv2RI/AAAAAAAAWUE/qVDI5yWE0M8DgZtLe9Zwr8x_MogfMex2gCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="372" height="462" title="加入完之後Solution的內容" style="display: inline; background-image: none;" alt="加入完之後Solution的內容" src="https://lh3.googleusercontent.com/-NjgN-NXvDDM/WbP-PN0GdrI/AAAAAAAAWUI/rGANKUu3iPsLVrYP3vV10K8N5UtHyOHIACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;加入完之後Solution的內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509267"&gt;用SideWaffle的功能建立關聯&lt;/h3&gt;&lt;p&gt;   對&lt;em&gt;VSIX專案&lt;/em&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;選擇&lt;code&gt;Add&lt;/code&gt; -&amp;gt; &lt;code&gt;Add Template Reference (Sidewaffle Project)&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-k7ZqoNPUpSU/WbP-RmivkKI/AAAAAAAAWUM/II6gTDNWAqYTsqTrCWcp5O-RKDWWh0MigCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="282" title="建立template reference" style="display: inline; background-image: none;" alt="建立template reference" src="https://lh3.googleusercontent.com/-Q2MxW6CDSRs/WbP-aG_OjoI/AAAAAAAAWUQ/mgTgOiC4DrgbghXW77VMyW24QBvi9hzdQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立template reference&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   下拉選單會出現要變成template的project，確定好之後直接按下&lt;kbd&gt;ok&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mq_yfyMSDuQ/WbP-a-9W81I/AAAAAAAAWUU/gxsJc8BY6KU-E5IeWcNZP3bta7doJo6PwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="590" height="284" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-OTS5onFgVUg/WbP-dRagyAI/AAAAAAAAWUY/EIUCoMKjRyUM5Pd23cB1FSWdl6EqAcW7gCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇template的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   這個時候VS會開始做一些動作，包括安裝&lt;code&gt;TemplateBuilder&lt;/code&gt;，可以看VS的左下角知道他在做什麼。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-PWk_s-tFCZw/WbP-e0t7pEI/AAAAAAAAWUc/QVTbTXTU7UIxN7Fkw3qpiJYlEUkf_e5ygCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="124" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Ee_j0lEjmuI/WbP-gvy-ACI/AAAAAAAAWUg/GUf0AiL7ThAPTNsqwNWVKrXrbWr-YfLYACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;VS訊息&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   完成之後，會開啟&lt;code&gt;_preprocess.xml&lt;/code&gt;的檔案    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-B-yHzQqXb4M/WbP-hZQU4BI/AAAAAAAAWUk/a1iGVy-iHAI0gD8gMmhoijZbm2bIJYvbACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="175" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-NTMZ2Z_updY/WbP-jBfr7lI/AAAAAAAAWUo/1fJpRbjYzCM1vkDe9QW0nwKD4Aq-ynylgCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後完成畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509779"&gt;微調設定&lt;/h3&gt;&lt;p&gt;   建立好之後，有兩個設定可以做一下調整：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;讓Project Template設定為不build&lt;/li&gt;&lt;li&gt;調整_project.vstemplate.xml的檔案&lt;/li&gt;&lt;li&gt;把_project.vstemplate.xml的檔案Wizard刪掉&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1504967803509302"&gt;讓Project Template設定為不build&lt;/h4&gt;&lt;p&gt;   因為另外一個project是我們的template，所以他其實不需要build，因此可以設定讓他不build，以減少每次的build時間。    &lt;/p&gt;&lt;p&gt;   在build configuration那邊可以把Template的build勾選掉。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-xonjUG893nQ/WbP-mTJg8eI/AAAAAAAAWUs/5aCAmWtfSxkAD7u8BRmdR5nL5bCodka8wCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="187" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-o3699PNqG-M/WbP-n6aPnaI/AAAAAAAAWUw/0LuwEAdhXE4-w-CUWkAiI1VCfNRqDaYmgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-qOXlZr6nk2Q/WbP-pnNA9xI/AAAAAAAAWU0/nIa4rqKrfeQmI0vDbP3COHZJ0_XIL7CJwCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="478" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-hr0CDUpicZo/WbP-sviujcI/AAAAAAAAWU4/DbJ247YwJJQwkjzrO6mFDmUr3dd8kMrJQCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;勾選掉build，避免花時間&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1504967803509277"&gt;調整_project.vstemplate.xml的檔案&lt;/h4&gt;&lt;p&gt;    SideWaffle的這個功能其實有個bug，產生出來的&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;的檔案有bug，在裡面的&lt;code&gt;Project&lt;/code&gt;element的&lt;code&gt;File&lt;/code&gt;屬性是錯的，改成和project名稱一樣即可。     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-kEVRA7Idllk/WbP-tR9JQhI/AAAAAAAAWU8/wCLeSMOvPNcgd86G1Jff0g8pEDnOPqwagCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="130" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-L-bOHE_VT20/WbP-ubk8JkI/AAAAAAAAWVA/MkYew9kz7MozaOi_aFWWPbY7oqr09_0wwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;修正錯誤的地方&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1504967803509558"&gt;把_project.vstemplate.xml的檔案Wizard刪掉&lt;/h4&gt;&lt;p&gt;    還有一個地方也應該拿掉，在&lt;code&gt;_project.vstemplate.xml&lt;/code&gt;裡面&lt;code&gt;WizardExtension&lt;/code&gt;可以直接拿掉。     &lt;/p&gt;&lt;p&gt;    那個是SideWaffle template用來記錄template下載次數，但是一般不要整合到SideWaffle的template不需要     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-IQV0Q39K014/WbP-wJVQA_I/AAAAAAAAWVE/fJtYT1hsIdwNbehPfYhkvl5LZHBObQXPQCHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="298" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-8jCrd62gsKU/WbP-zRlqS2I/AAAAAAAAWVI/CdE6HV8-LHYnh7Le8YjJJ8uzPkGUY33iQCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;拿掉的部分&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509573"&gt;測試&lt;/h3&gt;&lt;p&gt;   做好了之後，可以直接run起來，然後預設在分類&lt;code&gt;C#&lt;/code&gt; -&amp;gt; &lt;code&gt;Web&lt;/code&gt; -&amp;gt; &lt;code&gt;SideWaffle&lt;/code&gt;裡面。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-g6wSlGOpWo0/WbP-0Eh9QUI/AAAAAAAAWVM/bHh--lpzKGc7qvvqDgNiHLE-JcWeUKiBQCHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-9cwiybPl14A/WbP-5pv6uiI/AAAAAAAAWVQ/QAYDLeQ-5oYcBP_n0wpG422rM9A18giqwCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;測試template&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   這個時候，假設我們要調整範本，可以直接在&lt;code&gt;MHAT.ConsoleWithOption&lt;/code&gt;這個專案裡面直接加入，&lt;em&gt;不需要&lt;/em&gt;在做任何事情，新的修改都會包含在建立出來的template裡面。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504967803509682"&gt;是否無法使用VS 2017來建立？&lt;/h2&gt;&lt;p&gt;  基本上做完上面的流程，用SideWaffle建立Project Template的方式就完成了。   &lt;/p&gt;&lt;p&gt;  接下來只要對Template專案做任何修改，只要在run就會包含修改內容，不需要額外做任何處理。   &lt;/p&gt;&lt;p&gt;  但是畢竟目前官方SideWaffle只有支援VS 2015，是否2017就無法做到一樣效果？   &lt;/p&gt;&lt;p&gt;  其實不然，如果分析一下，就可以發現&lt;code&gt;Add Template Reference&lt;/code&gt;在做什麼，基本上修改/新增一些檔案：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;在project template的專案下面增加了檔案&lt;/li&gt;&lt;li&gt;修改了VSIX專案包含一個特殊的Reference到project template的專案&lt;/li&gt;&lt;li&gt;在VSIX專案安裝TemplateBuilder&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;p&gt;   詳細每一個檔案調整什麼可以參考commit：&lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/commit/06cfaaba0b5193cf107ff93b5d76c792d681a681"&gt;用SideWaffle的Add Template Reference完&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509489"&gt;在project template的專案下面增加了檔案&lt;/h3&gt;&lt;p&gt;   總共增加了幾個檔案：    &lt;/p&gt;&lt;ul&gt;&lt;li&gt;\_Definitions\_project.vstemplate.xml&lt;/li&gt;&lt;li&gt;\_preprocess.xml&lt;/li&gt;&lt;li&gt;\sw-file-icon.png&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509130"&gt;修改了VSIX專案包含一個特殊的Reference到project template的專案&lt;/h3&gt;&lt;p&gt;   在&lt;code&gt;SideWaffle.csproj&lt;/code&gt;（VSIX專案的csproj）加入一個Item Group    &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&amp;lt;ItemGroup&amp;gt;&lt;br /&gt; &amp;lt;TemplateReference Include="MHAT.ConsoleWithOption.csproj"&amp;gt;&lt;br /&gt;   &amp;lt;PathToProject&amp;gt;../MHAT.ConsoleWithOption/MHAT.ConsoleWithOption.csproj&amp;lt;/PathToProject&amp;gt;&lt;br /&gt; &amp;lt;/TemplateReference&amp;gt;&lt;br /&gt;&amp;lt;/ItemGroup&amp;gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504967803509968"&gt;在VSIX專案安裝TemplateBuilder&lt;/h3&gt;&lt;p&gt;   這個就同等於用nuget安裝&lt;code&gt;TemplateBuilder&lt;/code&gt;一樣。    &lt;/p&gt;&lt;/section&gt;&lt;p&gt;  所以其實完全可以用VS 2017建立，然後做上面幾個動作來達到一樣的效果。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504967803509572"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇介紹了如何用VS 2015搭配SideWaffle套件來建立一個Project Template。   &lt;/p&gt;&lt;p&gt;  這種方式建立出來的Project Template有個很強的優勢 - 未來要改template內容，只要用像一般VS開發專案那樣調整project template專案就好。   &lt;/p&gt;&lt;p&gt;  也分析了到底SideWaffle的動作加了什麼，了解背後原理之後，其實VS 2017也可以做到一樣效果，只是需要手動處理比較麻煩。   &lt;/p&gt;&lt;p&gt;  不過這些檔案的意義和如何微調SideWaffle將會是下一篇的重點。   &lt;/p&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:5b9471c2-d94f-4073-b65c-193f3e058a72" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1544839911353393974/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-use-sidewaffle-to-create-project-template.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1544839911353393974'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1544839911353393974'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-use-sidewaffle-to-create-project-template.html' title='[打造自己的template-建立一致性程式碼][10]用SideWaffle建立Project Template'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-F3PTN-FIXS0/WbP9-wRnUVI/AAAAAAAAWTw/Hrp5_N2lzfswBeZ4iV9zBPjRT-GD6tr6wCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3543202173653726989</id><published>2017-09-06T23:39:00.001+08:00</published><updated>2017-09-06T23:39:39.826+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][09]內建VSIX的缺點 - SideWaffle基本介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vfb6GwPamPg/WbAVjJ25KkI/AAAAAAAAWTU/d2Da1gtdi3UUTxZAYgFYIXGP6xaCiV7cwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[打造自己的template-建立一致性程式碼][09]內建VSIX的缺點 - SideWaffle基本介紹" style="display: inline; background-image: none;" alt="[打造自己的template-建立一致性程式碼][09]內建VSIX的缺點 - SideWaffle基本介紹" src="https://lh3.googleusercontent.com/-vvJKLRB1FbY/WbAVk-dvJjI/AAAAAAAAWTY/-8xPd0um4S4bL8fiS0T9YlBgmuHeUZiJgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-vs-expermiental-instance-intro-and-VSIX-setting.html"&gt;[08]Visual Studio Experimental Instance 和 VSIX template的細節設定介紹&lt;/a&gt;）   介紹完了Visual Studio（以下簡稱VS）的Experimental Instance的一些維護方式和VSIX template的一些細節設定。內建VSIX方式建立template基本就告一個段落。   &lt;/p&gt;&lt;p&gt;不過會發現雖然用VSIX可以版控template專案和部署的時候變得容易，但是建立template的過程有些地方還是過於繁瑣。&lt;em&gt;SideWaffle因此而誕生&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;這篇將會對現行做法有什麼問題在做一些介紹，和SideWaffle如何讓這些變得更加容易。   &lt;/p&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348418" ;=""&gt;VSIX建立template的問題&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348323" ;=""&gt;SideWaffle是什麼？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348642" ;=""&gt;SideWaffle小檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348844" ;=""&gt;SideWaffle 版本問題 - VS 2017怎麼辦？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348301" ;=""&gt;是否一定要安裝SideWaffle？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348585" ;=""&gt;TemplateBuilder如何讓建立template變得容易？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565348846" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504711565349249" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt;    &lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348418"&gt;VSIX建立template的問題&lt;/h2&gt;&lt;p&gt;VSIX建立template的方式比匯出的方式已經在版控和安裝上面一大進步了，但是在建立template的事情上面還是有點不便利。   &lt;/p&gt;&lt;p&gt;最大的不便利就是template內容本身的修改不方便。   &lt;/p&gt;&lt;p&gt;由於template裡面有一些Parameter(例如&lt;code&gt;$safeprojectname$&lt;/code&gt;) - 所以假設今天template本身要加檔案或者要改內容，需要手動改vstemplate（來把檔案加入），並且由於有哪些Parameter，也沒辦法像一般solution那樣build做測試。   &lt;/p&gt;&lt;p&gt;這些導致每一次要改template：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;需要先用template new project建立出來&lt;/li&gt;&lt;li&gt;做好調整&lt;/li&gt;&lt;li&gt;在用匯出方式產生出來&lt;/li&gt;&lt;li&gt;把zip檔案解壓縮出來更新到Project Template專案&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;所以修改template非常繁瑣。   &lt;/p&gt;&lt;p&gt;為了解決這個問題，一個open source專案誕生了：&lt;em&gt;&lt;strong&gt;SideWaffle&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348323"&gt;SideWaffle是什麼？&lt;/h2&gt;&lt;p&gt;SideWaffle是一個VS套件可以裝在2012/2013/2015。   &lt;/p&gt;&lt;p&gt;最當初的目的是提供一些常見專案類型的template和一些Snippet；由於要管理這麼多template也很花時間，因此也包含了一些VS tweak讓建立template更加簡單。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1504711565348642"&gt;SideWaffle小檔案&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;官網：&lt;a href="http://sidewaffle.com/"&gt;http://sidewaffle.com/&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;提供以下功能：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;一些Project Template&lt;/li&gt;&lt;li&gt;一些Item Template&lt;/li&gt;&lt;li&gt;一些Snippet&lt;/li&gt;&lt;li&gt;方便建立Template的VS tweak&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348844"&gt;SideWaffle 版本問題 - VS 2017怎麼辦？&lt;/h2&gt;&lt;p&gt;官方support版本只有到VS 2015，沒有support VS 2017，不過有第三方調整讓VS 2017可以安裝 &lt;a href="https://github.com/ligershark/side-waffle/issues/400"&gt;Visual Studio 2017 support&lt;/a&gt;&lt;/p&gt;&lt;p&gt;在未來，官方會有一個全新的版本，    目前已經有發佈在Marketplace叫做&lt;a href="https://marketplace.visualstudio.com/items?itemName=Sayed-Ibrahim-Hashimi.SidewaffleCreator2017"&gt;SideWaffle Creator 2017&lt;/a&gt;需要VS 2017.3版本才能夠正常使用。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348301"&gt;是否一定要安裝SideWaffle？&lt;/h2&gt;&lt;p&gt;如果不需要那些提供的Project Template、Item Template和Snippet，其實可以&lt;em&gt;不用&lt;/em&gt;安裝SideWaffle。   &lt;/p&gt;&lt;p&gt;讓template更容易建立是透過一個nuget套件叫做&lt;code&gt;TemplateBuilder&lt;/code&gt;，SideWaffle只是讓建立&lt;code&gt;TemplateBuilder&lt;/code&gt;相關檔案&lt;em&gt;更加容易&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;所以，如果只是為了建立template更加方便，可以&lt;em&gt;不用&lt;/em&gt;裝SideWaffle。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348585"&gt;TemplateBuilder如何讓建立template變得容易？&lt;/h2&gt;&lt;p&gt;&lt;code&gt;TemplateBuilder&lt;/code&gt;是裝在VSIX專案裡面，裝好了之後，會自動做幾個事情：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;加入MSBuild的target &lt;code&gt;ligershark.templates.targets&lt;/code&gt;（&lt;a href="https://github.com/ligershark/template-builder/blob/master/tools/ligershark.templates.targets"&gt;原始碼&lt;/a&gt;）&lt;/li&gt;&lt;li&gt;自動加入 &lt;code&gt;Asset&lt;/code&gt;到VSIX的&lt;code&gt;vsixmanifest&lt;/code&gt;檔案裡面 - 自動加入 Output/ItemTemplates和Output/ProjectTemplates&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;MSBuild的target會做很多事情，其中比較重要的有：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     自動把所有對應檔案把特定的值替換成設定的值    &lt;/dt&gt;&lt;dd&gt;     不需要在cs檔案裡面改成&lt;code&gt;Parameter&lt;/code&gt;，用規則自動替換 - 換句話說因為沒有&lt;code&gt;Parameter&lt;/code&gt;cs可以build    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     自動依照csproj裡面設定建立出vstemplate裡面的檔案清單    &lt;/dt&gt;&lt;dd&gt;     不需要自己手動寫vstemplate裡面的那些檔案要包含    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     不用手動寫vstemplate裡面的&lt;code&gt;ProjectItem&lt;/code&gt;，會自動依照csproj建立    &lt;/dt&gt;&lt;dt&gt;     把VSIX專案裡面資料夾&lt;code&gt;ProjectTemplates&lt;/code&gt;和&lt;code&gt;ItemTemplates&lt;/code&gt;和&lt;code&gt;Snippets&lt;/code&gt;自動加入到 vsix    &lt;/dt&gt;&lt;dd&gt;     用Convention的方式知道那些內容屬於Project Template、Item Template 和 Snippet。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;簡而言之，&lt;code&gt;TemplateBuilder&lt;/code&gt;能夠讓專案保持在可build的情況下又能夠直接產生template，讓&lt;em&gt;修改template變得和開發一樣方便&lt;/em&gt;。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565348846"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇對於VSIX修改template的繁瑣步奏做了說明，並且簡單介紹了SideWaffle所帶來的功能和&lt;code&gt;TemplateBuilder&lt;/code&gt;如何讓建立Template變得簡單。   &lt;/p&gt;&lt;p&gt;在下篇將會對如何用SideWaffle提供的VS tweak讓用TemplateBuilder建立Project Template非常簡單。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504711565349249"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="https://github.com/ligershark/side-waffle/wiki/How-SideWaffle-Works"&gt;How SideWaffle Works&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     介紹&lt;code&gt;TemplateBuilder&lt;/code&gt;的作用    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="http://sidewaffle.com/"&gt;SideWaffle VS 2015 官網&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     官網介紹VS 2015    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://marketplace.visualstudio.com/items?itemName=Sayed-Ibrahim-Hashimi.SidewaffleCreator2017"&gt;Sidewaffle Creator (2017)&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     SideWaffle VS 2017 版本，需要VS 2017.3才能夠裝    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://github.com/ligershark/side-waffle/issues/401"&gt;SideWaffle Creator 的願景&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     SideWaffle VS 2017 和 .net core 如何整合搭配    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:554d4d4b-b3a2-455b-8d84-84e1c9aeac75" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3543202173653726989/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-VSIX-problem-SideWaffle-pros-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3543202173653726989'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3543202173653726989'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-VSIX-problem-SideWaffle-pros-intro.html' title='[打造自己的template-建立一致性程式碼][09]內建VSIX的缺點 - SideWaffle基本介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-vvJKLRB1FbY/WbAVk-dvJjI/AAAAAAAAWTY/-8xPd0um4S4bL8fiS0T9YlBgmuHeUZiJgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7109750680915506903</id><published>2017-09-04T23:33:00.000+08:00</published><updated>2017-09-04T23:33:00.769+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][08]Visual Studio Experimental Instance 和 VSIX template的細節設定介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9lsS1AgHskU/Wa1xhRtH87I/AAAAAAAAWSE/loEjgv1gkMMbHha8mb7z4F0WT7exMd4agCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="Visual Studio Experimental Instance 和 VSIX template的細節設定介紹" style="display: inline; background-image: none;" alt="Visual Studio Experimental Instance 和 VSIX template的細節設定介紹" src="https://lh3.googleusercontent.com/-Bg52WoVgLHY/Wa1xiTCd2AI/AAAAAAAAWSI/YAhUT-0-28IZFxLbGfknTFkaNbQLRoUGQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上篇（&lt;a href="http://blog.alantsai.net/2017/09/buildYourOwnTemplate-create-item-template.html"&gt;[07]匯出template建立小總結，更好的建立方式介紹 VSIX&lt;/a&gt;）介紹了如何透過VSIX的方式建立一個Visual Studio（以下簡稱VS）的套件來安裝template。   &lt;/p&gt;&lt;p&gt;  在這篇則會針對測試用的&lt;code&gt;Experimental Instance&lt;/code&gt;和VSIX建立方式的一些小地方做延伸介紹。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter08"&gt;github mhat-visualstudio-template sample/chapter08&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678272" ;=""&gt;VS Experimental Instance&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678741" ;=""&gt;VS Experimental Instance的cache位置&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678396" ;=""&gt;如何reset Experimental Instance&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678442" ;=""&gt;如何手動執行Experimental Instance&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678846" ;=""&gt;VSIX template和匯出Template的不同之處&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678530" ;=""&gt;如何設定template的分類&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678475" ;=""&gt;是否能夠建立Multi Project （多專案） Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678326" ;=""&gt;VS Experimental Instance沒有出現 - 注意tempalte路徑長度&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504538766678366" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504538766678272"&gt;VS Experimental Instance&lt;/h2&gt;&lt;p&gt;  之前透過匯出的方式建立template的時候有個討厭的地方是更新template比較麻煩，因為測試的時候會直接安裝到正常在使用的VS，可能會造成混亂。   &lt;/p&gt;&lt;p&gt;  因為擔心這種情況，所以在VS在預設執行VSIX的時候會開啟&lt;code&gt;Experimental Instance&lt;/code&gt; - 這個可以想象成和一般VS一樣，只是設定是和一般的分開。有點像是進入Windows可以有多個使用者，使用者和使用者之間的設定   不會互相干擾。   &lt;/p&gt;&lt;h3 id="WizKMOutline_1504538766678741"&gt;VS Experimental Instance的cache位置&lt;/h3&gt;&lt;p&gt;  還記得之前在介紹更新templatecache的時候有提到VS會有一個cache的地方儲存一些相關資訊（&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931725"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式#更新template - 如何讓vs重新刷新&lt;/a&gt;）。Experimental Instance也有這個概念，位置在：&lt;code&gt;%appdata%\Microsoft\VisualStudio\{VS版本}_{後面幾個奇怪數字}Exp&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-TwbKD45532Y/Wa1xjSeJJ9I/AAAAAAAAWSM/ETw25YTuhoctEa8-u2CDx4tUPyhMRKUpQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="349" title="cache的截圖位置" style="display: inline; background-image: none;" alt="cache的截圖位置" src="https://lh3.googleusercontent.com/-t_wDcoMzIkE/Wa1xkITpnWI/AAAAAAAAWSQ/kDJP3Gr2xQUe1JxhJJmxr-5aN5dyn81ZwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;cache的截圖位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  所以假設有需要手動清理cache可以到這個資料夾處理。   &lt;/p&gt;&lt;h3 id="WizKMOutline_1504538766678396"&gt;如何reset Experimental Instance&lt;/h3&gt;&lt;p&gt;  假設開發很多個VSIX或者甚至一些客制VS功能的套件導致Experimental Instance有點怪怪的情況下，可以reset Experimental Instance（把這個VS Experimental Instance還原到最一開始的情況）   &lt;/p&gt;&lt;p&gt;  可以透過在Windows 裡面搜索&lt;code&gt;Reset the Visual Studio 2017 Expermiental Instance&lt;/code&gt;，執行之後就會回到預設狀態。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-GUfsY1Fah0Y/Wa1xlFdn65I/AAAAAAAAWSU/WDcp0bBT-DgcNzGCrAA1ZJmHoIKgynvYwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="604" height="392" title="找到reset的執行cmd" style="display: inline; background-image: none;" alt="找到reset的執行cmd" src="https://lh3.googleusercontent.com/-eOANs3_i0tU/Wa1xl1xnndI/AAAAAAAAWSY/4lFsrFGCL08Rp3Ll_R9OYVwtNh7sgPgrQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;找到reset的執行cmd&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-info"&gt;   不確定reset的作用是不是就只是是把vs Experimental instance的cache資料夾的所有內容刪掉，但是如果執行完reset去cache看看，會發現整個資料夾是空的。   &lt;/div&gt;&lt;h3 id="WizKMOutline_1504538766678442"&gt;如何手動執行Experimental Instance&lt;/h3&gt;&lt;p&gt;  假設有天希望直接測試有安裝的template，可以透過直接開啟VS Experimental Instance達到。   &lt;/p&gt;&lt;p&gt;  執行方式也很簡單，在Windows裡面搜索&lt;code&gt;Start Experimental Instance of Visual Studio 2017&lt;/code&gt;。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UXMzgk5DYg0/Wa1xmzA0dUI/AAAAAAAAWSc/q9srAlTHScUqDZ0h-ox4dRMmki09y1glQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="620" height="525" title="開啟VS 2017 Experimental Instance" style="display: inline; background-image: none;" alt="開啟VS 2017 Experimental Instance" src="https://lh3.googleusercontent.com/-M19NdH6xnwc/Wa1xoazwvLI/AAAAAAAAWSg/pOPomvZeawAMuGp5Fc_OrU4QWA-tkZ1HACHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;開啟VS 2017 Experimental Instance&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504538766678846"&gt;VSIX template和匯出Template的不同之處&lt;/h2&gt;&lt;p&gt;  當建立template從匯出改成用VSIX之後，有幾個地方需要注意一下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;如何設定template的&lt;code&gt;分類&lt;/code&gt;&lt;/li&gt;&lt;li&gt;是否能夠建立Multi Project（多專案）Template&lt;/li&gt;&lt;li&gt;VS Experimental Instance沒有出現 - 注意tempalte路徑長度&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504538766678530"&gt;如何設定template的分類&lt;/h3&gt;&lt;p&gt;   還記得如果是匯出Template的話，分類是&lt;em&gt;依照放的資料夾結構&lt;/em&gt;來建立出分類，可是到了VSIX沒有辦法控制資料夾了阿，怎麼設定template出現的分類呢？    &lt;/p&gt;&lt;p&gt;   在Project Template的&lt;code&gt;vstemplate&lt;/code&gt;檔案，開啟&lt;code&gt;Property&lt;/code&gt;（可以用&lt;kbd&gt;F4&lt;/kbd&gt;或者 右鍵 選擇 &lt;code&gt;Property&lt;/code&gt;），然後&lt;code&gt;Category&lt;/code&gt;那個欄位輸入要的分類。    &lt;/p&gt;&lt;p&gt;   如果分類有多層，就用反斜線&lt;code&gt;\&lt;/code&gt;區隔，例如：&lt;code&gt;myVsix\test&lt;/code&gt;。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JlqWe_mBXBA/Wa1xqG_Bf6I/AAAAAAAAWSk/G8KPMxEoE1kb5S87V3jr9OeEPUtb68iiQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="480" title="設定分類" style="display: inline; background-image: none;" alt="設定分類" src="https://lh3.googleusercontent.com/-j4lJomSf6gM/Wa1xqyrPn0I/AAAAAAAAWSo/Qge11gmsAsY-ieeqYSM-xe6iQTtXcu42QCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定分類&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504538766678475"&gt;是否能夠建立Multi Project （多專案） Template&lt;/h3&gt;&lt;p&gt;   可以的，做法其實和我們建立之前的Project Template方式一樣，只是這次&lt;code&gt;buildAction&lt;/code&gt;設定成為&lt;code&gt;VSTemplate&lt;/code&gt;會是根的那個。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Tg9mjW6PQ4w/Wa1xuIkk2sI/AAAAAAAAWSs/0mokSp5ePAYFXWbtOMe9IUQyWlQN6qAOACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="478" height="542" title="multi project template" style="display: inline; background-image: none;" alt="multi project template" src="https://lh3.googleusercontent.com/-RX6TCfuu4Fo/Wa1x0KrDy0I/AAAAAAAAWSw/yUnUznaBzh4riqqVJDVRkhENdDIWIWYYACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;multi project template&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504538766678326"&gt;VS Experimental Instance沒有出現 - 注意tempalte路徑長度&lt;/h3&gt;&lt;p&gt;   如果run的時候VS Experimental Instance沒有出現 - 有可能有出現錯誤。    &lt;/p&gt;&lt;p&gt;   這個時候注意&lt;code&gt;Error&lt;/code&gt;那邊有沒有出現錯誤，例如&lt;code&gt;Problem occurred while extracting the vsix to the experimental extensions path&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bVI2h4v4IB4/Wa1x1zkd5HI/AAAAAAAAWS0/4JXnS2O8K0ofu8w8fBCXrV73kAJcfeOiwCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="163" title="錯誤截圖" style="display: inline; background-image: none;" alt="錯誤截圖" src="https://lh3.googleusercontent.com/-OT4j_OdxmR8/Wa1x46gv_-I/AAAAAAAAWS4/H9HfDUypj9kJwpX_keNxiqGBZwSwui18gCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;錯誤截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   非常有可能是template裡面的路徑&lt;em&gt;過長&lt;/em&gt;導致。如果VSIX的名稱很長，也有可能導致路徑過長。因為VS的cache路徑本身就蠻長的。    &lt;/p&gt;&lt;p&gt;   所以一定要注意路徑，尤其是有時候使用一些第三方套件，很有可能路徑過長導致有問題。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504538766678366"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇介紹了VS的Experimental Instance和匯出Template不同之處的地方。   &lt;/p&gt;&lt;p&gt;  到這邊其實VSIX的template包裝方式基本上已經到一個段落（雖然還有Item Template的沒有介紹，不過概念是一樣的），會發現相較於匯出Template的方式，在管理上面和安裝上面變的更加簡單。   &lt;/p&gt;&lt;p&gt;  但是還是有些不便利的地方，這也就是&lt;code&gt;SideWaffle&lt;/code&gt;帶來的好處。   &lt;/p&gt;&lt;p&gt;  在下一篇將會對於vsix的這種方式的缺點和SideWaffle的一些基本介紹。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:ee817909-dfbb-413d-b313-db4081aa314e" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7109750680915506903/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-vs-expermiental-instance-intro-and-VSIX-setting.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7109750680915506903'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7109750680915506903'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-vs-expermiental-instance-intro-and-VSIX-setting.html' title='[打造自己的template-建立一致性程式碼][08]Visual Studio Experimental Instance 和 VSIX template的細節設定介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-Bg52WoVgLHY/Wa1xiTCd2AI/AAAAAAAAWSI/YAhUT-0-28IZFxLbGfknTFkaNbQLRoUGQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-447532867700666016</id><published>2017-09-02T15:36:00.000+08:00</published><updated>2017-09-02T15:36:03.316+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][07]匯出template建立小總結，更好的建立方式介紹 VSIX</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RufUA8c1yjU/WapccBmGIcI/AAAAAAAAWPg/6pkcat7zvQoLwWwM3cOThERX1DQiqmHDgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="匯出template建立小總結，更好的建立方式介紹 VSIX" style="display: inline; background-image: none;" alt="匯出template建立小總結，更好的建立方式介紹 VSIX" src="https://lh3.googleusercontent.com/-cJeVi8qqRCg/WapcdgoEP4I/AAAAAAAAWPk/xO1OHh-NzLULJfqx7P1vfTgtZlLdvX7LgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  在上一篇（&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-item-template.html"&gt;[06]建立Item Template&lt;/a&gt;）介紹完了Item Template的建立方式之後，基本上關於template建立方式的介紹就結束了。剩下只是透過介紹的內容微調自己的template達到想要的目標。   &lt;/p&gt;&lt;p&gt;  Template建立方式講完了，但是另外一個問題出現了，這種建立出來的template在管理上面非常的不方便，例如沒有版控，安裝還要到特定位置等，是否有什麼方式可以讓管理變得更加簡單嗎？   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter07"&gt;github mhat-visualstudio-template sample/chapter07&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310442958" ;=""&gt;匯出Template的方式管理問題是什麼&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310442754" ;=""&gt;使用建立Project Template的專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310442224" ;=""&gt;整合之前的專案到Project Tempalte專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443750" ;=""&gt;了解專案的特殊之處&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443867" ;=""&gt;vstemplate的buildAction&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443772" ;=""&gt;cs檔案不會被建制&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443594" ;=""&gt;更簡單的安裝方式 - VSIX&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443748" ;=""&gt;1. 建立一個VSIX的Project&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443883" ;=""&gt;2. 設定VSIX包含Project Template專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443933" ;=""&gt;3. 測試&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504336310443617" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1504336310442958"&gt;匯出Template的方式管理問題是什麼&lt;/h2&gt;&lt;p&gt;  在這幾篇文章介紹匯出Template的時候，會注意到範例程式碼只是提供run起來的版本，要變成template還是需要自己透過匯出的方式。   &lt;/p&gt;&lt;p&gt;  難道沒有什麼方式可以讓他像一般專案一樣，只有在建立的時候在建立成為zip檔案嗎？   &lt;/p&gt;&lt;p&gt;  另外一個問題，要安裝這個template需要把zip放到對應的資料夾才會出現。   &lt;/p&gt;&lt;p&gt;  難道不能夠像安裝軟體那樣安裝嗎？還有如果要更新template怎麼管控這些template？   &lt;/p&gt;&lt;p&gt;  總結起來說大概有這幾個問題：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;如何版控template？&lt;/li&gt;&lt;li&gt;如何更容易更新template？&lt;/li&gt;&lt;li&gt;如何更容易安裝template？&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;  這些問題其實已經有被發現，因此有所謂的建立&lt;code&gt;Project Template&lt;/code&gt;用的Project和用安裝一般VS套件的方式來裝tempalte。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504336310442754"&gt;使用建立Project Template的專案&lt;/h2&gt;&lt;p&gt;  這個標題有點饒舌，不過意思是在Visual Studio（統稱VS）裡面其實有一個特殊的Template，專門用來建立Template的，不過要使用之前，會需要安裝&lt;code&gt;Visual Studio SDK&lt;/code&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   Visual Studio SDK在2015版本之後都是和VS一起安裝的時候可以選的一個選項。    &lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-WpDH4_Uq0J8/Wapce_nSW9I/AAAAAAAAWPo/6l-wDr0nWdUaEYJiV1v_oqW31BLzCyi3gCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="496" height="571" title="VS 2015的安裝選項" style="display: inline; background-image: none;" alt="VS 2015的安裝選項" src="https://lh3.googleusercontent.com/-w_GBgZHzcIc/Wapcfz74TpI/AAAAAAAAWPs/otXwI51qffUzUpHYX_OlllQDddoOFPhRQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;figcaption&gt;VS 2015的安裝選項 - 截圖取自於：&lt;a href="https://msdn.microsoft.com/zh-tw/library/mt683786.aspx"&gt;https://msdn.microsoft.com/zh-tw/library/mt683786.aspx&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-kdPQ0THz6JI/WapcgxwgpMI/AAAAAAAAWPw/dTZoZ6pbjl0Fjy-ssYwhXN9951hvWHEWgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="334" title="VS 2017的安裝選項" style="display: inline; background-image: none;" alt="VS 2017的安裝選項" src="https://lh3.googleusercontent.com/-UQRAdqGxBOs/WapciGILUqI/AAAAAAAAWP0/C6u9Te3YCHUeMSxDwRTKDzjaelWMmYARwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;figcaption&gt;VS 2017的安裝選項 - 截圖取自於：https://blogs.msdn.microsoft.com/devops/2016/12/12/the-visual-studio-modeling-sdk-is-now-available-with-visual-studio-2017/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;p&gt;  安裝好之後，在VS建立新的專案會發現有個分類叫做&lt;code&gt;Extensibility&lt;/code&gt; -&amp;gt; &lt;code&gt;C# Project Template&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-K9iufyIPUnc/WapcjJHYydI/AAAAAAAAWP4/buMMQ0niVNwQwTGUbWXni_gTC0eFcqHCQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="375" title="建立Project Template" style="display: inline; background-image: none;" alt="建立Project Template" src="https://lh3.googleusercontent.com/-y36-Z12FNXA/Wapcls9kD6I/AAAAAAAAWP8/4xQjQmMOzasomoW8HnldR5VJ-Lt0qnmrQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-0OHHgL66DHs/WapcnMN4x1I/AAAAAAAAWQA/_jKzyBwaKrQhFG8TQ8UQsMflF-rGwyNwACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="469" height="421" title="建立出來的ProjectTemplate範本內容" style="display: inline; background-image: none;" alt="建立出來的ProjectTemplate範本內容" src="https://lh3.googleusercontent.com/-0-MeP-cHuRI/WapcpfPDcII/AAAAAAAAWQE/EAXXxiXANh4rHWjBt0GBpfnGG-L3gweVQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figcaption&gt;&lt;figcaption&gt;Project Template的位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  建立出來之後，會發現和一般的Project差不多，不過看到熟悉的&lt;code&gt;vstemplate&lt;/code&gt;檔案，並且build之後會發現release那邊有一個zip檔案被產生出來。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-T0FJsfvnP_Y/WapcsgvfQDI/AAAAAAAAWQI/sCaKQWHY3k4s1W8d36xaPYdlXT5IHzVjgCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="236" title="build產生的內容" style="display: inline; background-image: none;" alt="build產生的內容" src="https://lh3.googleusercontent.com/-H5SyRAULcD8/WapcuFxq6VI/AAAAAAAAWQM/KS8PTdc7V5klcgHhmxtEElSgtLwF94RAwCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;build之後的內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504336310442224"&gt;整合之前的專案到Project Tempalte專案&lt;/h2&gt;&lt;p&gt;  既然有了更好的產生zip檔案的方式，可以把之前&lt;em&gt;匯出&lt;/em&gt;的zip檔案內容解壓縮出來然後加入到建立出來的Project Template。   &lt;/p&gt;&lt;p&gt;  不過在做這件事情之前，要先了解一下這個專案的不同之處。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504336310443750"&gt;了解專案的特殊之處&lt;/h3&gt;&lt;p&gt;  這個專案有幾個特別之處：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;vstemplate&lt;/code&gt;檔案的&lt;code&gt;buildAction&lt;/code&gt;是&lt;code&gt;VSTemplate&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;cs&lt;/code&gt;檔案不會被建制&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1504336310443867"&gt;vstemplate的buildAction&lt;/h4&gt;&lt;p&gt;  如果對&lt;code&gt;VSIXSingProjectTemplate.vstemplate&lt;/code&gt;點&lt;kbd&gt;右鍵&lt;/kbd&gt;然後選擇&lt;code&gt;Properties&lt;/code&gt;：   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   也可以選到 &lt;code&gt;VSIXSingProjectTemplate.vstemplate&lt;/code&gt;之後，安縣鍵盤的&lt;kbd&gt;F4&lt;/kbd&gt;來開啟   &lt;/div&gt;&lt;p&gt;  在Property視窗可以看到&lt;code&gt;BuildAction&lt;/code&gt;的值是&lt;code&gt;VSTemplate&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-yvMhnCpjEz0/Wapcv88kdOI/AAAAAAAAWQQ/fGfKfjEhz-8cE5e6E4raE9bdn5Zr-dYZACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="570" title="buildAction 不同之處" style="display: inline; background-image: none;" alt="buildAction 不同之處" src="https://lh3.googleusercontent.com/-45Tu7DSkgvY/WapcwgZiCzI/AAAAAAAAWQU/gskhDwv0npAyuIuZpUbnXau6iy4TtC2sQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;1. 選了檔案，2. 用右鍵或者F4開啟 3. 的property然後看到4. 的property視窗&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  這個其實就是特別之處，告訴VS在build的時候要觸發zip這個動作。   &lt;/p&gt;&lt;p&gt;  所以，在把匯出的template整合進來的時候，&lt;em&gt;&lt;strong&gt;要把vstemplate的&lt;code&gt;BuildAction&lt;/code&gt;改成&lt;code&gt;VSTemplate&lt;/code&gt; &lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1504336310443772"&gt;cs檔案不會被建制&lt;/h4&gt;&lt;p&gt;   如果對cs檔案點右鍵，然後選擇&lt;code&gt;Property&lt;/code&gt;，會發現他們的的&lt;code&gt;buildAction&lt;/code&gt;會是&lt;code&gt;None&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ib9TcUgrGvw/WapcyIQ9uLI/AAAAAAAAWQY/7JTAhBw_9bwCGMbbzGRlJ99JXATDSxj3gCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="606" height="421" title="把buildAction改成none" style="display: inline; background-image: none;" alt="把buildAction改成none" src="https://lh3.googleusercontent.com/-o55-y7EWFhA/Wapc5p9N83I/AAAAAAAAWQc/IOMKdlQG1-EZzJoSLMdKY_ByRHqWCaYPACHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;buildAction為none&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   所以，記得等一下整合匯出的cs檔案要設定&lt;code&gt;buildAction&lt;/code&gt;為&lt;code&gt;None&lt;/code&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;  最後整合好的template看起來如下圖：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XazYisbySts/Wapc7yYhJXI/AAAAAAAAWQg/HxszknPeUsoyb4lNRcl7JXSg3ERHAfVrACHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="368" height="439" title="最後專案的樣子" style="display: inline; background-image: none;" alt="最後專案的樣子" src="https://lh3.googleusercontent.com/-PEzd6PdnERE/Wapc8-l4k_I/AAAAAAAAWQk/mI54gi26klAJuLQWXv20MQyvfIujFoVYQCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後的樣子&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504336310443594"&gt;更簡單的安裝方式 - VSIX&lt;/h2&gt;&lt;p&gt;  建立出zip檔案之後，還是需要自己手動搬移其實還是很麻煩。   &lt;/p&gt;&lt;p&gt;  這個時候可以搭配建立一個VSIX（VS的擴充套件的專案類型）來讓安裝template更加簡單。          &lt;/p&gt;&lt;p&gt;  建立方式如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;建立一個VSIX的Project&lt;/li&gt;&lt;li&gt;設定VSIX包含Project Template專案&lt;/li&gt;&lt;li&gt;測試&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504336310443748"&gt;1. 建立一個VSIX的Project&lt;/h3&gt;&lt;p&gt;  在Project Template專案那個Solution裡面在加入一個專案，不過這次建立的是一個&lt;code&gt;VSIX Project&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RMPANDIupBU/Wapc9uXZIfI/AAAAAAAAWQo/PUSzRUpM_dEvEjuFsTUOcJVijEpDgSj5gCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="375" title="建立VSIX專案" style="display: inline; background-image: none;" alt="建立VSIX專案" src="https://lh3.googleusercontent.com/-0ZHItf3-4bM/Wapc_3jCghI/AAAAAAAAWQs/ph7gIltpPJUhGLJ8dg5vAkxEkr9S64AowCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;VSIX專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  可以對建立出來的&lt;code&gt;source.extension.vsixmanifest&lt;/code&gt;點兩下，然後會開出一個設定的畫面。   &lt;/p&gt;&lt;p&gt;  可以先設定一些這個套件你的相關資訊。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ofXh9mWontc/WapdA7rKY1I/AAAAAAAAWQw/ZfHCghTG4oY3NL5Ccl1Cj1wNJdPLbNI6ACHMYCw/s1600-h/image%255B34%255D"&gt;&lt;img width="654" height="262" title="套件基本資訊" style="display: inline; background-image: none;" alt="套件基本資訊" src="https://lh3.googleusercontent.com/-NubVDS4z6SI/WapdCYbS7MI/AAAAAAAAWQ0/m7SshNVqY9cggdjHZ6MqG6bj-nQUZpmrgCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;基本資訊的設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504336310443883"&gt;2. 設定VSIX包含Project Template專案&lt;/h3&gt;&lt;p&gt;   設定好這個套件相關資訊之後，一樣還是&lt;code&gt;source.extension.vsixmanifest&lt;/code&gt;的設定裡面：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;選擇 &lt;code&gt;Assets&lt;/code&gt;&lt;/li&gt;&lt;li&gt;選擇右邊的&lt;kbd&gt;News&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;Type&lt;/code&gt;選擇&lt;code&gt;Microsoft.VisualStudio.ProjectTemplates&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;Source&lt;/code&gt;選擇&lt;code&gt;A Project in solution&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;Project&lt;/code&gt;選擇 上面建立的那個Project Template專案&lt;/li&gt;&lt;li&gt;按下 &lt;kbd&gt;OK&lt;/kbd&gt;&lt;/li&gt;&lt;/ol&gt;&lt;a href="https://lh3.googleusercontent.com/-P5KbNp9TT9o/WapdDDj5BhI/AAAAAAAAWQ4/tCshQr2h7c8pv2diBk6MHARCP0ezd1xWACHMYCw/s1600-h/image%255B37%255D"&gt;&lt;img width="654" height="211" title="加入一個Assets" style="display: inline; background-image: none;" alt="加入一個Assets" src="https://lh3.googleusercontent.com/-leyrmsz-7io/WapdEAXZF_I/AAAAAAAAWQ8/lF2TzCvAiWQm5Jj31zj0y-_6yEokYPcrQCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1a72zgae-Pg/WapdFygWs_I/AAAAAAAAWRA/eaZvCZrstlswMoYweyPosqvheL4nAJu3ACHMYCw/s1600-h/image%255B40%255D"&gt;&lt;img width="654" height="559" title="選擇Project Template" style="display: inline; background-image: none;" alt="選擇Project Template" src="https://lh3.googleusercontent.com/-ed5jPy8lhsY/WapdHRgLkUI/AAAAAAAAWRE/iS22UiNkZ0wbw8vhZ3pqu2wJXDmPIrMZQCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;相關設定的截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504336310443933"&gt;3. 測試&lt;/h3&gt;&lt;p&gt;   先把 VSIX 專案設定為&lt;code&gt;Startup Project&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7iLFY9ORAiA/WapdNU12TmI/AAAAAAAAWRI/bqUX5FR-d7wMMqrEv1AvdmunUVIdnWUoQCHMYCw/s1600-h/image%255B43%255D"&gt;&lt;img width="654" height="427" title="選擇為起始專案" style="display: inline; background-image: none;" alt="選擇為起始專案" src="https://lh3.googleusercontent.com/-_rigzhjDNkw/WapdQHRjkiI/AAAAAAAAWRM/_E-XPfJJ8E0gvCyDUCRjuiQaNXOckkb0ACHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;設定 startup project&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   這個時候把專案Run起來，等一下之後，VS會開啟一個&lt;code&gt;Experimental Instance&lt;/code&gt;的版本。    &lt;/p&gt;&lt;p&gt;   在這個VS裡面，新增 專案的時候會看到剛剛建立的Template，嘗試建立出來測試是否符合需求。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--dAT6B78kSo/WapdRR47LTI/AAAAAAAAWRQ/rSiqCVIRy2EfF5btuqTYVJ7atG6Y4PmWwCHMYCw/s1600-h/image%255B46%255D"&gt;&lt;img width="654" height="364" title="自動啟動Experimental Instance並且template存在" style="display: inline; background-image: none;" alt="自動啟動Experimental Instance並且template存在" src="https://lh3.googleusercontent.com/-g-VNe48L6F8/WapdSbpZS8I/AAAAAAAAWRU/5Yxgp07_b-wfLuM5dq6_O-5ETKqxzv93QCHMYCw/image_thumb%255B16%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;可以看到名稱會加入一個&lt;code&gt;Experimental Instance&lt;/code&gt;的字，並且在新增 專案 看到剛剛那個template&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;p&gt;  最後，如果都確認沒有問題之後，想要給另外一台電腦或者實際在開發的VS裝上template，可以把VSIX專案bin裡面的VSIX檔案取出來，點兩下去做安裝。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-2TF6U-foc9E/WapdTdL6H_I/AAAAAAAAWRY/vSuXQwHtnw0_6_sCqrR2f5d5xJwEBxNsACHMYCw/s1600-h/image%255B49%255D"&gt;&lt;img width="654" height="139" title="可安裝的VSIX檔案" style="display: inline; background-image: none;" alt="可安裝的VSIX檔案" src="https://lh3.googleusercontent.com/-2leCkNEixJc/WapdUcZFXOI/AAAAAAAAWRc/fqmkheamyNIY7YdH9nl6ll9mAU_0isWfACHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後產生出的VSIX&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;secction&gt;&lt;h2 id="WizKMOutline_1504336310443617"&gt;結語&lt;/h2&gt;&lt;p&gt; 這篇了解了如何透過使用Project Template專案搭配VSIX專案來讓管理和安裝變得更加的簡單；讓整個template可以被版控和容易安裝。  &lt;/p&gt;&lt;p&gt; 在下一篇會對於VS的Experimental Instance做一些介紹，讓未來在debug template的時候更加簡單，和一些Project Template專案和匯出template不同之處的細節設定（例如如何設定&lt;code&gt;分類&lt;/code&gt;）。  &lt;/p&gt;&lt;/secction&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:11690d93-c373-406c-b7fa-7fcf659c60fc" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/447532867700666016/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-create-item-template.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/447532867700666016'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/447532867700666016'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/09/buildYourOwnTemplate-create-item-template.html' title='[打造自己的template-建立一致性程式碼][07]匯出template建立小總結，更好的建立方式介紹 VSIX'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-cJeVi8qqRCg/WapcdgoEP4I/AAAAAAAAWPk/xO1OHh-NzLULJfqx7P1vfTgtZlLdvX7LgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4894623057683788227</id><published>2017-08-31T01:22:00.000+08:00</published><updated>2017-08-31T01:22:08.837+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][06]建立Item Template</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wwVvmq3dNuw/WabzDC9CTfI/AAAAAAAAWN8/_C7VSoY0F8U8D9NtIXPJkbOgAyId43jDgCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="建立Item Template" style="display: inline; background-image: none;" alt="建立Item Template" src="https://lh3.googleusercontent.com/-ZLF-3pDERrE/WabzFHHKVII/AAAAAAAAWOA/L1XdX2zPbIMw3bWnFxiOuWu3ho-ZVJgKQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上篇（&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-multi-project-template.html"&gt;[05]建立多專案(multi project)的Template&lt;/a&gt;）了解了如何建立Multi Project了之後，   Project Template基本上就告一個段落了。   &lt;/p&gt;&lt;p&gt;  在這篇則是針對另外一種Template：Item Template的建立方式做一個介紹。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;匯出用的範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter05"&gt;github mhat-visualstudio-template sample/chapter05&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762816" ;=""&gt;建立Item Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762684" ;=""&gt;透過匯出的方式建立&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762953" ;=""&gt;丟到正確的路徑安裝到VS&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762322" ;=""&gt;測試結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762596" ;=""&gt;Item Template和Project Template的不同之處&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762590" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762450" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762816"&gt;建立Item Template&lt;/h2&gt;&lt;p&gt;  Item Template是在建立在專案裡面項目的時候可以選的一種template。以我們的例子來說，今天要寫一個ProcessTemplate，那麼最快的方式就是建立一個class繼承&lt;code&gt;BaseExecuteProcessTemplate&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;  因此假設在建立class的時候，這個繼承關係就建立好了，開發者根本不需要看文件確認繼承的class名稱，加快開發者開發並且程式碼一致，這就是Item Template的價值所在。   &lt;/p&gt;&lt;p&gt;  如果要建立一個Item Template，基本上和Project Template差不多：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;透過匯出的方式建立&lt;/li&gt;&lt;li&gt;丟到正確路徑安裝到VS&lt;/li&gt;&lt;li&gt;測試結果&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1504112955762684"&gt;透過匯出的方式建立&lt;/h3&gt;&lt;p&gt;   想必在建立Project Template匯出的時候，應該有注意到另外一個選項是Item Template。    &lt;/p&gt;&lt;p&gt;   因此，就是透過選Item Template、再來選擇哪個Class（只能夠單選）、再來選擇要包含的dll最後填完資訊就匯出完成了。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;    同Project Template一樣，匯出的路徑一樣在（預設）&lt;code&gt;%userprofile%\Documents\Visual Studio {version}\My Exported Templates&lt;/code&gt;&lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-OA6Lh-4EGfY/WabzGQ33KGI/AAAAAAAAWOE/byyyQXCpkuYyG7q3ePUTLJGFBBR2v-mygCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="585" title="匯出選擇Item Template" style="display: inline; background-image: none;" alt="匯出選擇Item Template" src="https://lh3.googleusercontent.com/-gZ3sGXFVhGA/WabzIDoI7JI/AAAAAAAAWOI/sHbYdwj7VqcS-niZmhqlVXOxWkq2vAxzQCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;匯出選擇Item Template&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Cf2VGdSnk7M/WabzJwVHPvI/AAAAAAAAWOM/BsLofCvyUncnYUduzRmDOrVBDL5EErKEgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="https://lh3.googleusercontent.com/-yJYbloBOJw0/WabzL7BAKTI/AAAAAAAAWOQ/eV2gfr_3TpY8SQe95Kyv1yb006riwGV_QCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇要匯出的檔案，只能單個檔案&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7Z0m6faXNGk/WabzNR8frLI/AAAAAAAAWOU/AveZKV_0VzstqQT-IESNPFeAFmnliShawCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="https://lh3.googleusercontent.com/-mNGsSKNZA0o/WabzPHD849I/AAAAAAAAWOY/2mVvxuowOIMngFmCXpH6xoLmYlS-QXc_wCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;再來可以選擇要Reference的dll&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    這邊reference的時候不會包含實際的dll，所以如果那台機器沒有裝那個dll在gac - 基本上會有問題。因此不建議加入非gac的dll    &lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-pnQRPkQlIjs/WabzQN0sO_I/AAAAAAAAWOc/t1-VI1I2Gr8fcYExdQjkQEh7_0kysdqQwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="https://lh3.googleusercontent.com/-eTCGbKRgv5w/WabzRmPohFI/AAAAAAAAWOg/bz7s4ZK3PuAIltW2qJ0lKMl0hxeCUArQQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;加入相關資訊  - 然後完成&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    同Project Template一樣，&lt;em&gt;不建議勾選&lt;/em&gt; &lt;code&gt;Automatically Import the template into visual studio&lt;/code&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762953"&gt;丟到正確的路徑安裝到VS&lt;/h2&gt;&lt;p&gt;   同Project Template一樣，Item Template也有分兩個位置：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;系統等級 - VS安裝的時候&lt;/li&gt;&lt;li&gt;使用者等級 - 個人安裝範本的位置&lt;/li&gt;&lt;/ol&gt;&lt;dl&gt;&lt;dt&gt;    系統等級   &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;   這個放的位置在：    &lt;/p&gt;&lt;p&gt;&lt;code&gt;\{VisualStudioInstallationDirectory}\Common7\IDE\ProjectTemplates\{Language}\{category\\{Locale}\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   舉例來說：    &lt;/p&gt;&lt;p&gt;&lt;code&gt;c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplates\CSharp\Web\1033\WebApplicationProject40\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   這個template是VS 2017在&lt;code&gt;C#&lt;/code&gt;-&amp;gt;&lt;code&gt;Web&lt;/code&gt;-&amp;gt;英文(1033)的&lt;code&gt;WebApplicationProject40&lt;/code&gt;專案位置    &lt;/p&gt;&lt;p&gt;   一般來說，這邊路徑的template&lt;em&gt;&lt;strong&gt;不會去動&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;    使用者等級   &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;   這個預設放在：     &lt;code&gt;\{My Documents}\{Visual Studio Version}\Templates\ItemTemplates\{Language}\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   例如：     &lt;code&gt;C:\Documents and Settings\UserName\My Documents\Visual Studio Version\Templates\ItemTemplates\Visual C#\&lt;/code&gt;放的是C#範本的位置    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    使用者等級是可以改的，在VS裡面的&lt;code&gt;Option&lt;/code&gt; -&amp;gt; &lt;code&gt;Projects and Soultion&lt;/code&gt;那邊是可以調整的，因此如果等一下範本匯入沒有作用，確認一下這邊的路徑是否正確。     &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zrL8ApjqCbY/WabzS7yy7xI/AAAAAAAAWOk/U6oUaAhGkrcm2Z1rwRfoQ5g17v2Dms3lwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="442" title="" style="display: inline; background-image: none;" alt="" src="https://lh3.googleusercontent.com/-E6LeWMHBYcM/WabzT_8kb8I/AAAAAAAAWOo/AiedDhucVrYFDsmOyxo9J-TikVpx2q1gQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;設定的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;   因此把匯出的zip檔案丟到正確的位置（如果需要「分類」記得依照結構建立即可，如果不確定請參考：&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931924"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式#管理Project Template到某個分類&lt;/a&gt;）    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_1RRRtUuoUA/WabzWX4L0fI/AAAAAAAAWOs/cRtpu-f1j_Aevf_DSV9lUAtdMwOAML5owCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="173" title="" style="display: inline; background-image: none;" alt="" src="https://lh3.googleusercontent.com/-m8UCR2xZRf8/WabzYJ2Lt7I/AAAAAAAAWOw/bkCpwaNbRHMfBxMYhVDjcLwnNFTxioDhgCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;丟入正確的路徑&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762322"&gt;測試結果&lt;/h2&gt;&lt;p&gt;    如果丟入路徑正確，可以再建立的時候找到     &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-z9_FnynuC0I/WabzbCqAXdI/AAAAAAAAWO0/ea4IZ3u1-zsPasWKhT_HXebX5GiSVVXawCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-msbj72FqoGM/WabziDed_HI/AAAAAAAAWO4/qRu8fdBbwj0DCcv9a4xs6E22DM9xAowaQCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立Item&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    假設VS沒有出現，可以把cache刪掉看看，cache路徑&lt;code&gt;%appdata%\Microsoft\VisualStudio\ItemTemplatesCache&lt;/code&gt;。（如果不清楚可以參考&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931725"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式#更新template - 如何讓vs重新刷新&lt;/a&gt;）只需要注意Item Template是&lt;code&gt;ItemTemplateCache&lt;/code&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762596"&gt;Item Template和Project Template的不同之處&lt;/h2&gt;&lt;p&gt;  打開&lt;code&gt;vstemplate&lt;/code&gt;會發現，其實Item Template和Project Template基本上差不多，唯一的主要不同之處在於&lt;code&gt;vstemplate&lt;/code&gt;裡面的&lt;code&gt;VSTemplate&lt;/code&gt;的&lt;code&gt;Type="Item"&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;  所以之前章節提到的微調其實也是適用於在Item template裡面。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   甚至可以透過微調的方式達到Item Template會建立多個檔案和資料夾。不過這個留在外來在介紹。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762590"&gt;結語&lt;/h2&gt;&lt;p&gt;  到目前為止其實建立Project Template和Item Template基本上已經沒有什麼問題了，其實會匯出和了解&lt;code&gt;vstemplate&lt;/code&gt;就能夠打造出適合自己的template。   &lt;/p&gt;&lt;p&gt;  不過到目前為止應該會發現到這種方式有幾個不方便之處，其中很大一個部分就是版控（也因為這樣這幾篇其實都沒有source code可以參考）。   &lt;/p&gt;&lt;p&gt;  因此在接下來將會專注于如何讓建立template這件事情更容易版控和更容易安裝和使用。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1504112955762450"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     微調template的相關資訊和常見的問題。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-item-templates"&gt;How to: Create Item Templates&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     官方介紹建立Item Template    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:7f8394e1-6708-416f-9b40-2e6d3ea8ae28" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4894623057683788227/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-item-template.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4894623057683788227'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4894623057683788227'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-item-template.html' title='[打造自己的template-建立一致性程式碼][06]建立Item Template'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-ZLF-3pDERrE/WabzFHHKVII/AAAAAAAAWOA/L1XdX2zPbIMw3bWnFxiOuWu3ho-ZVJgKQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3482839217864869259</id><published>2017-08-29T01:06:00.000+08:00</published><updated>2017-08-29T01:07:30.675+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][05]建立多專案(multi project)的Template</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-UTRqHogw9u8/WaRMnLMbGiI/AAAAAAAAWM8/s_U_39GWgigoFhGkaGqtw2cwqZW9UW04ACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[打造自己的template-建立一致性程式碼][05]建立多專案(multi project)的Template" style="display: inline; background-image: none;" alt="[打造自己的template-建立一致性程式碼][05]建立多專案(multi project)的Template" src="https://lh3.googleusercontent.com/-p8GROR4SZn8/WaRMoE4cwyI/AAAAAAAAWNA/X020GDiIChY4Rg-fH5-s9H0TtnCIH8L5gCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上篇&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式&lt;/a&gt;   了解了project template的最重要檔案，&lt;code&gt;vstemplate&lt;/code&gt;並且了解了如何微調匯出的Template。   &lt;/p&gt;&lt;p&gt;在這一篇將會在了解如何調整&lt;code&gt;vstemplate&lt;/code&gt;來建立多Project（multi project）的Project Template。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;範例程式碼 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter05"&gt;github mhat-visualstudio-template sample/chapter05&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015912651" ;=""&gt;為什麼會需要Multi Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913400" ;=""&gt;建立Multi Project的情境&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913990" ;=""&gt;建立Multi Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913235" ;=""&gt;先把兩個project用匯出的方式匯出Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913682" ;=""&gt;建立出multi project template的資料夾結構&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913464" ;=""&gt;整個打包zip&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913354" ;=""&gt;放到對應路徑&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913225" ;=""&gt;測試最後結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913264" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503939015913640" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;     &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt;&lt;h2 id="WizKMOutline_1503939015912651"&gt;為什麼會需要Multi Project Template&lt;/h2&gt;&lt;p&gt;一般來說當我們程式比較大一點的時候，我們都會把他們分層。最常見就是分3層：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;DB層&lt;/li&gt;&lt;li&gt;邏輯層&lt;/li&gt;&lt;li&gt;顯示層&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;有時候為了好區分，我們可能會把這三層各自建立一個project - 所以假設今天我建立一個新的project直接就建立出3個Project，是不是就會引導大家把對應內容放到對應的Project，來達到關注點分離。   &lt;/p&gt;&lt;p&gt;因此，Multi Project的範本也非常的有幫助。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503939015913400"&gt;建立Multi Project的情境&lt;/h2&gt;&lt;p&gt;首先還是要先建立出未來新增的時候要建立的內容。   &lt;/p&gt;&lt;p&gt;所以先建立出一個新的solution，然後把&lt;code&gt;Process&lt;/code&gt;和&lt;code&gt;Model&lt;/code&gt;的CS檔案放到另外一個邏輯層的專案。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;實際的程式碼可以參考：&lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/tree/sample/chapter05/src/MultiProjectTemplate"&gt;github 上面 MultiProjectTemplate&lt;/a&gt;&lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Tuv-pVxulLI/WaRMptL0H4I/AAAAAAAAWNE/nBqrh7Jw4tkeFPWm81_EtHRMz2BY9xOHACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="452" height="441" title="multi project最後看起來的樣子" style="display: inline; background-image: none;" alt="multi project最後看起來的樣子" src="https://lh3.googleusercontent.com/-ZhjP8sW8gHI/WaRMqgo8dII/AAAAAAAAWNI/_99H4HRVdlU-JKd_BdeUeya1cTLjAxaXwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;multi project最後看起來的樣子&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503939015913990"&gt;建立Multi Project Template&lt;/h2&gt;&lt;p&gt;整個建立的流程如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;先把兩個project用匯出的方式匯出Project Template&lt;/li&gt;&lt;li&gt;建立出multi project template的資料夾結構&lt;/li&gt;&lt;li&gt;整個打包zip&lt;/li&gt;&lt;li&gt;放到對應路徑&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503939015913235"&gt;1 先把兩個project用匯出的方式匯出Project Template&lt;/h3&gt;&lt;p&gt;用在第三篇（&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html"&gt;[03]透過匯出建立Project Template&lt;/a&gt;）學到的方式，把兩個專案分別匯出。    &lt;/p&gt;&lt;p&gt;最後會得到兩個zip檔案。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RhI77NNMhxU/WaRMrs6lDWI/AAAAAAAAWNM/X1Oc0b8zLdQ5N6F2EGMwBsn1UjuVa7wrwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="130" title="匯出的zip檔案" style="display: inline; background-image: none;" alt="匯出的zip檔案" src="https://lh3.googleusercontent.com/-cVc5I9OjSy8/WaRMsfM1k1I/AAAAAAAAWNQ/qbe85q3l9lsTAoLKWZMG0CZ9bvcDxd7SgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;匯出的zip檔案&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503939015913682"&gt;2 建立出multi project template的資料夾結構&lt;/h3&gt;&lt;p&gt;基本上Multi Project和單一project差不多，唯一的差異在於在根會有個&lt;code&gt;vstemplate&lt;/code&gt;檔案，會指向要建立兩個project的&lt;code&gt;vstemplate&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;所以先把兩個zip檔案解壓縮出來，然後在根的資料夾建立一個&lt;code&gt;root.vstemplate&lt;/code&gt;的檔案    &lt;/p&gt;&lt;pre class="brush: plain;"&gt;Multi Project&lt;br /&gt;|--MHAT.MultiConsole.Bll&lt;br /&gt;  |--MyTemplate.vstemplate&lt;br /&gt;|--MHAT.MultiConsole.ConsoleApp&lt;br /&gt;  |--MyTemplate.vstemplate&lt;br /&gt;|--root.vstemplate&lt;/pre&gt;&lt;p&gt;&lt;code&gt;root.vstemplate&lt;/code&gt;內容則是：    &lt;/p&gt;&lt;pre class="brush: xml;highlight:[1,18,21]"&gt;&lt;vstemplate xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" type="ProjectGroup" version="3.0.0"&gt;&lt;br /&gt;  &lt;templatedata&gt;&lt;br /&gt;    &lt;name&gt;MHAT.ProcessTemplate.ConsoleApp.Multi&lt;/name&gt;&lt;br /&gt;    &lt;description&gt;&amp;lt;No description available&amp;gt;&lt;/description&gt;&lt;br /&gt;    &lt;projecttype&gt;CSharp&lt;/projecttype&gt;&lt;br /&gt;    &lt;projectsubtype&gt;&lt;br /&gt;    &lt;/projectsubtype&gt;&lt;br /&gt;    &lt;sortorder&gt;1000&lt;/sortorder&gt;&lt;br /&gt;    &lt;createnewfolder&gt;true&lt;/createnewfolder&gt;&lt;br /&gt;    &lt;defaultname&gt;ConsoleApp1&lt;/defaultname&gt;&lt;br /&gt;    &lt;providedefaultname&gt;true&lt;/providedefaultname&gt;&lt;br /&gt;    &lt;locationfield&gt;Enabled&lt;/locationfield&gt;&lt;br /&gt;    &lt;enablelocationbrowsebutton&gt;true&lt;/enablelocationbrowsebutton&gt;&lt;br /&gt;    &lt;icon&gt;__TemplateIcon.ico&lt;/icon&gt;&lt;br /&gt;  &lt;/templatedata&gt;&lt;br /&gt;  &lt;templatecontent&gt;&lt;br /&gt;    &lt;projectcollection&gt;  &lt;br /&gt;        &lt;projecttemplatelink projectname="$safeprojectname$.ConsoleApp"&gt;  &lt;br /&gt;            MHAT.MultiConsole.ConsoleApp\MyTemplate.vstemplate  &lt;br /&gt;        &lt;/projecttemplatelink&gt;  &lt;br /&gt;        &lt;projecttemplatelink projectname="$safeprojectname$.Bll"&gt;  &lt;br /&gt;            MHAT.MultiConsole.Bll\MyTemplate.vstemplate  &lt;br /&gt;        &lt;/projecttemplatelink&gt;  &lt;br /&gt;    &lt;/projectcollection&gt; &lt;br /&gt;  &lt;/templatecontent&gt;&lt;br /&gt;&lt;/vstemplate&gt;&lt;/pre&gt;&lt;p&gt;這個&lt;code&gt;root.vstemplate&lt;/code&gt;有幾個地方注意一下： &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;&lt;code&gt;VSTemplate&lt;/code&gt;的&lt;code&gt;Type="ProjectGroup"&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;   之前Project Template是&lt;code&gt;Type="Project"&lt;/code&gt;，而multi project則是&lt;code&gt;ProjectGroup&lt;/code&gt;。  &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;TemplateContent&lt;/code&gt;內容不同  &lt;/dt&gt;&lt;dd&gt;   變成是一個&lt;code&gt;ProjectCollection&lt;/code&gt;，裡面會包含每一個multi project要包含的&lt;code&gt;vstemplate&lt;/code&gt;的位置，這邊可以注意到&lt;code&gt;ProjectName&lt;/code&gt;則是可以定義建立出來的專案名稱。   透過使用&lt;code&gt;Parameter&lt;/code&gt;可以讓名稱一致。  &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;Projecttemplatelink&lt;/code&gt;的順序很重要  &lt;/dt&gt;&lt;dd&gt;   放在第一個的會作為預設的&lt;em&gt;起始專案&lt;/em&gt;。  &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-DPZcI4DuAkI/WaRMtTKpsjI/AAAAAAAAWNU/6Lkh5zbZaS0zNn3BJsedQmjLjAG__rfVQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="173" title="最後的專案結構" style="display: inline; background-image: none;" alt="最後的專案結構" src="https://lh3.googleusercontent.com/-pCZWpYI7oyc/WaRMxXJcZPI/AAAAAAAAWNY/cgeN-_7a6GwR042zn7j2a9LE5XBc6gL5wCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最後的專案結構&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503939015913464"&gt;3 整個打包zip&lt;/h3&gt;&lt;p&gt;確認好之後，可以直接把它zip起來，變成multi project template的內容。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503939015913354"&gt;4 放到對應路徑&lt;/h3&gt;&lt;p&gt;基本上在Document下面的VS的Project Template下面，然後如果要放到某個分類裡面建立對應資料夾。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;ul&gt;&lt;li&gt;      這篇有&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html#WizKMOutline_1503805714768815"&gt;[03]透過匯出建立Project Template&lt;/a&gt;詳細介紹路徑要放哪裡      &lt;/li&gt;&lt;li&gt;       這篇有&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931924"&gt;[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式&lt;/a&gt;介紹分類的資訊。      &lt;/li&gt;&lt;/ul&gt;，         &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503939015913225"&gt;測試最後結果&lt;/h2&gt;&lt;p&gt;放好之後就可以開VS然後測試建立Multi Project。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果VS template找不到，可以試試看清理cache，詳細參考&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931725"&gt;更新template - 如何讓vs重新刷新&lt;/a&gt;&lt;/div&gt;&lt;a href="https://lh3.googleusercontent.com/-l3ihSwwfqwU/WaRMyLXNXJI/AAAAAAAAWNc/WsWSsEKEEVcU_3w-KC8mOfRaEr9R0NRQACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="375" title="建立專案畫面" style="display: inline; background-image: none;" alt="建立專案畫面" src="https://lh3.googleusercontent.com/-fvMuhtoIPkM/WaRMz5Br0SI/AAAAAAAAWNg/vSQGoKBPUMwWlFRbh_fHyeHLRsdGNISaQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-l3tbqyI88HI/WaRM2OUibHI/AAAAAAAAWNk/fDzhWzSFJ18HpdOPm7bjRehzBUIWVIp3ACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="365" height="385" title="建立出來的內容" style="display: inline; background-image: none;" alt="建立出來的內容" src="https://lh3.googleusercontent.com/-CvTRA4LyeEs/WaRM6Fra2ZI/AAAAAAAAWNo/5QYAZ_Z-awYKY939LJQT52PRaSPzQNGAwCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立出multi project 可以看到輸入的專案名稱會有對應到各自專案&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;這邊注意到，雖然build起來會先nuget restore，但是因為路徑的關係，所以dll的reference會錯。所以還需要自己手動把資料夾往上提一層就好。因為專案建立出來會自己多包一層，造成層數有錯。這個只能夠透過寫&lt;code&gt;Wizard&lt;/code&gt;    來解決。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503939015913264"&gt;結語&lt;/h2&gt;&lt;p&gt;了解了Project Template的細節之後，再回來看Multi Project Template，會發現其實很容易理解，只是需要知道&lt;code&gt;ProjectGroup&lt;/code&gt;類型的&lt;code&gt;vstemplate&lt;/code&gt;結構即可。   &lt;/p&gt;&lt;p&gt;基本上Project Template的部分差不多到了一個段落，在下一篇將會對於另外一種Template - Item Template作介紹   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503939015913640"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-multi-project-templates"&gt;How to: Create Multi-Project Templates&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     官方介紹的文件    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://blog.jayway.com/2015/03/13/visual-studio-how-to-create-a-solution-template-with-multiple-projects/"&gt;Visual Studio: How to create a solution template with multiple projects&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     很不錯介紹建立Multi Project Template的教學    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://github.com/ligershark/template-builder/pull/79"&gt;SideWaffle fix for multi-project template structure&lt;/a&gt;&lt;br /&gt;&lt;a href="https://stackoverflow.com/questions/3882764/issue-with-visual-studio-template-directory-creation"&gt;Issue with visual studio template &amp;amp; directory creation&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;     提到nuget路徑的問題，需要透過寫Wizard來解決。SideWaffle有個&lt;code&gt;SolutionWizard&lt;/code&gt;但是我實際用有錯。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;  &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:59b4947b-30a2-463a-be40-4c3fa6c25cc1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3482839217864869259/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-multi-project-template.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3482839217864869259'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3482839217864869259'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-multi-project-template.html' title='[打造自己的template-建立一致性程式碼][05]建立多專案(multi project)的Template'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-p8GROR4SZn8/WaRMoE4cwyI/AAAAAAAAWNA/X020GDiIChY4Rg-fH5-s9H0TtnCIH8L5gCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-452729036416916048</id><published>2017-08-27T16:35:00.000+08:00</published><updated>2017-08-29T01:07:11.463+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--B6HJjISnjU/WaKDvkPg_3I/AAAAAAAAWLs/P-U3Qdf4u-8CoNUPpuivJWMnrgj0q6h4wCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="解vstemplate來微調匯出的Template和強制VS更新Template的方式" style="display: inline; background-image: none;" alt="解vstemplate來微調匯出的Template和強制VS更新Template的方式" src="https://lh3.googleusercontent.com/-DaBFjMM9SOY/WaKDw-cp9ZI/AAAAAAAAWLw/VHyg7uM6g8Qq2VXAAkhOY82Fd6xJDH00gCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;了解vstemplate來微調匯出的Template和強制VS更新Template的方式&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在上一篇&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html"&gt;[打造自己的template-建立一致性程式碼][03]透過匯出建立Project Template&lt;/a&gt;透過匯出的方式得到了   一個zip檔案。可以透過放到對應位置來達到安裝到VS上面。   &lt;/p&gt;&lt;p&gt;但是匯出來的zip檔案其實有一些不如意的地方，因此在這篇將會介紹Project Template組成的原理來方便微調並且介紹如何讓VS更新Template。   &lt;/p&gt;&lt;/section&gt;   &lt;div class="bs-callout bs-callout-default"&gt;之前建立的sample 程式用來產生範本在 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02"&gt;github mhat-visualstudio-template sample/chapter02&lt;/a&gt;&lt;/div&gt;&lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931551" ;=""&gt;了解匯出的zip檔案內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931126" ;=""&gt;vstemplate檔案內容&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931473" ;=""&gt;TemplateData&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931630" ;=""&gt;TemplateConten&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931721" ;=""&gt;cs檔案有被調整的內容 - Parameter介紹&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931219" ;=""&gt;微調的部分&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931836" ;=""&gt;修正建立專案預設名稱&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931924" ;=""&gt;管理Project Template到某個分類&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931725" ;=""&gt;更新template - 如何讓vs重新刷新&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931726" ;=""&gt;找到對應的VS 暫存位置&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931563" ;=""&gt;把對應的TemplateCache資料夾刪掉&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931166" ;=""&gt;重新開啟VS&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503822127931471" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt;    &lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931551"&gt;了解匯出的zip檔案內容&lt;/h2&gt;&lt;p&gt;首先，先來了解一下Visual Studio (以下簡稱VS) 匯出的zip檔案包含了什麼內容。   &lt;/p&gt;&lt;p&gt;如果我們把它解壓縮出來，會發現整個資料夾內容和我們專案差不多，我們專案有的內容，zip裡面也有，不過zip版本有幾個不同的地方：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;多了一個 &lt;code&gt;MyTemplate.vstemplate&lt;/code&gt; 的檔案&lt;/li&gt;&lt;li&gt;*.cs檔案有被調整過&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-B2yI3IQ8IZE/WaKDxssZ2BI/AAAAAAAAWL0/FvELvqgZc2QAZPLkHsli2Oe1Rd1hqDhTQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="380" title="zip檔案內容" style="display: inline; background-image: none;" alt="zip檔案內容" src="https://lh3.googleusercontent.com/-lVGu6xpRptw/WaKDyhc6R8I/AAAAAAAAWL4/zkqbLtRt6L0EBlLrf05FT-Vfq94xcv87gCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;zip檔案內容&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931126"&gt;vstemplate檔案內容&lt;/h2&gt;&lt;p&gt;&lt;code&gt;*.vstemplate&lt;/code&gt;基本上定義了Project Template的相關資訊和Project Template建立的時候那些檔案要被建立出來。   &lt;/p&gt;&lt;p&gt;這個xml的根節點是&lt;code&gt;VSTemplate&lt;/code&gt;，這個根節點會定義這次的Template是那種，以我們的例子是 &lt;code&gt;Type="Project"&lt;/code&gt;表示是Project Template   &lt;/p&gt;&lt;p&gt;&lt;code&gt;VSTemplate&lt;/code&gt;裡面有有幾個部分：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     TemplateData    &lt;/dt&gt;&lt;dd&gt;     專案的一些meta資訊    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     TemplateConten    &lt;/dt&gt;&lt;dd&gt;     定義有哪些檔案要包含在Project Template裡面    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     WizardExtension    &lt;/dt&gt;&lt;dd&gt;     這個我們匯出的Project Template沒有，但是如果未來在Project Template建立的過程有特殊邏輯要處理，可以寫C#程式達到客制目的。哪些就會定義在這邊    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     WizardData    &lt;/dt&gt;&lt;dd&gt;     可以傳入到WizardExtensio的參數    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多介紹，可以參考：&lt;a href="https://msdn.microsoft.com/en-us/library/31cdwx28(v=vs.100).aspx"&gt;VSTemplate Element (Visual Studio Templates)&lt;/a&gt;&lt;/div&gt;&lt;p&gt;整個vstemplate看起來如下：   &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;vstemplate xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" type="Project" version="3.0.0"&gt;&lt;br /&gt;  &lt;templatedata&gt;&lt;br /&gt;    &lt;name&gt;MHAT.Console.ProcessTemplate.ExecuteWithOption&lt;/name&gt;&lt;br /&gt;    &lt;description&gt;MHAT ConsoleApp ProcessTemplate 讀取參數一次性執行的Echo程式碼範例&lt;/description&gt;&lt;br /&gt;    &lt;projecttype&gt;CSharp&lt;/projecttype&gt;&lt;br /&gt;    &lt;projectsubtype&gt;&lt;br /&gt;    &lt;/projectsubtype&gt;&lt;br /&gt;    &lt;sortorder&gt;1000&lt;/sortorder&gt;&lt;br /&gt;    &lt;createnewfolder&gt;true&lt;/createnewfolder&gt;&lt;br /&gt;    &lt;defaultname&gt;MHAT.Console.ProcessTemplate.ExecuteWithOption&lt;/defaultname&gt;&lt;br /&gt;    &lt;providedefaultname&gt;true&lt;/providedefaultname&gt;&lt;br /&gt;    &lt;locationfield&gt;Enabled&lt;/locationfield&gt;&lt;br /&gt;    &lt;enablelocationbrowsebutton&gt;true&lt;/enablelocationbrowsebutton&gt;&lt;br /&gt;    &lt;icon&gt;__TemplateIcon.ico&lt;/icon&gt;&lt;br /&gt;  &lt;/templatedata&gt;&lt;br /&gt;  &lt;templatecontent&gt;&lt;br /&gt;    &lt;project replaceparameters="true" file="MHAT.ConsoleWithOption.csproj" targetfilename="MHAT.ConsoleWithOption.csproj"&gt;&lt;br /&gt;      &lt;projectitem replaceparameters="true" targetfilename="App.config"&gt;App.config&lt;/projectitem&gt;&lt;br /&gt;      &lt;folder name="Model" targetfoldername="Model"&gt;&lt;br /&gt;        &lt;projectitem replaceparameters="true" targetfilename="EchoProcessOption.cs"&gt;EchoProcessOption.cs&lt;/projectitem&gt;&lt;br /&gt;      &lt;/folder&gt;&lt;br /&gt;      &lt;projectitem replaceparameters="true" targetfilename="packages.config"&gt;packages.config&lt;/projectitem&gt;&lt;br /&gt;      &lt;folder name="Process" targetfoldername="Process"&gt;&lt;br /&gt;        &lt;projectitem replaceparameters="true" targetfilename="EchoProcess.cs"&gt;EchoProcess.cs&lt;/projectitem&gt;&lt;br /&gt;      &lt;/folder&gt;&lt;br /&gt;      &lt;projectitem replaceparameters="true" targetfilename="Program.cs"&gt;Program.cs&lt;/projectitem&gt;&lt;br /&gt;      &lt;folder name="Properties" targetfoldername="Properties"&gt;&lt;br /&gt;        &lt;projectitem replaceparameters="true" targetfilename="AssemblyInfo.cs"&gt;AssemblyInfo.cs&lt;/projectitem&gt;&lt;br /&gt;      &lt;/folder&gt;&lt;br /&gt;    &lt;/project&gt;&lt;br /&gt;  &lt;/templatecontent&gt;&lt;br /&gt;&lt;/vstemplate&gt;&lt;/pre&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931473"&gt;TemplateData&lt;/h3&gt;&lt;p&gt;這裡面放的是一些Project Template的meta資訊，其中有幾個比較會調整的有：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      name     &lt;/dt&gt;&lt;dd&gt;      這個是在VS裡面顯示的名稱。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      description     &lt;/dt&gt;&lt;dd&gt;      選中某個Project Template之後右邊呈現的訊息     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      ProjectType     &lt;/dt&gt;&lt;dd&gt;      顯示在那個大分類下面，&lt;code&gt;CSharp&lt;/code&gt;就是顯示在&lt;code&gt;Visual C#&lt;/code&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      defaultname     &lt;/dt&gt;&lt;dd&gt;      當選中Project Template的時候，預設要顯示的專案名稱     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      NumberOfParentCategoriesToRollUp          &lt;/dt&gt;&lt;dd&gt;      這個在我們的檔案沒有，不過意思是多少&lt;em&gt;層&lt;/em&gt;以上也能夠顯示這個Project Template。等一下會提到分類這個事情，如何在上層分類也顯示下層分類的Project Template就是靠這個參數值。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多關於每個參數的用途，可以參考 &lt;a href="https://msdn.microsoft.com/en-us/library/hy7dh5te(v=vs.100).aspx"&gt;TemplateData Element (Visual Studio Templates)&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931630"&gt;TemplateConten&lt;/h3&gt;&lt;p&gt;這邊定義的是Project Template建立的時候，那些檔案會建立出來，基本上看名稱應該可以猜的出來做什麼的，不過有幾個要提一下：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      targetfilename     &lt;/dt&gt;&lt;dd&gt;      這個定義建立出來的時候這個檔案的&lt;em&gt;名稱&lt;/em&gt;要是什麼。舉例來說，有可能建立的檔案前面的部分要用使用者輸入的名稱 - 就是改這個attribute     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      replaceparameters     &lt;/dt&gt;&lt;dd&gt;      如果建立出來的檔案有部分內容要和使用者建立時候輸入的檔案名稱對應 - 那麼就會用到特殊的&lt;code&gt;Parameter&lt;/code&gt;，這個參數表示這個檔案是否要做&lt;code&gt;Parameter&lt;/code&gt;替換處理。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多關於每個參數的作用，可以參考：&lt;a href="https://msdn.microsoft.com/en-us/library/zfkkzb88(v=vs.100).aspx"&gt;TemplateContent Element (Visual Studio Templates)&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931721"&gt;cs檔案有被調整的內容 - Parameter介紹&lt;/h2&gt;&lt;p&gt;如果我們打開一個cs檔案，例如&lt;code&gt;Program.cs&lt;/code&gt;，會注意到，有些值被改成了用錢字號包起來&lt;code&gt;$safeprojectname$&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;這些其實是表示會被替換的&lt;code&gt;Parameter&lt;/code&gt;，還記得上面有提到一個在&lt;code&gt;vstemplate&lt;/code&gt;裡面，&lt;code&gt;replaceparameters&lt;/code&gt;的attribute，那個值決定檔案裡面的&lt;code&gt;Parameter&lt;/code&gt;是否要被替換。   &lt;/p&gt;&lt;p&gt;因為有了這些，我們才能夠在新增的時候，namespace會和輸入的專案名稱有關。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個&lt;code&gt;Parameter&lt;/code&gt;可以用在&lt;code&gt;vstemplate&lt;/code&gt;裡面的&lt;code&gt;targetfilename&lt;/code&gt;，讓檔名可以和輸入的專案名稱呼應。   &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;有哪些可用的&lt;code&gt;Parameter&lt;/code&gt;可以再這裡：&lt;a href="https://docs.microsoft.com/en-us/visualstudio/ide/template-parameters"&gt;Template Parameters&lt;/a&gt;找到資訊。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931219"&gt;微調的部分&lt;/h2&gt;&lt;p&gt;上面介紹了Project Template的組成，有了這些資訊，有些地方我們可以做一些微調，分別為：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;修正建立專案預設名稱&lt;/li&gt;&lt;li&gt;管理Project Template到某個分類&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931836"&gt;修正建立專案預設名稱&lt;/h3&gt;&lt;p&gt;在我們匯出的時候，讓我們輸入&lt;code&gt;Template Name&lt;/code&gt;的值會用作於&lt;code&gt;選擇專案時候的名稱&lt;/code&gt;和&lt;code&gt;預設專案名稱&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;可是一般來說這兩個值可能不同，舉例來說，建立一個C# console，他的Template名稱是：&lt;code&gt;Console App （.Net Framework）&lt;/code&gt;，但是預設專案名稱則是：&lt;code&gt;ConsoleApp&lt;/code&gt;&lt;/p&gt;&lt;p&gt;因此建議調整&lt;code&gt;name&lt;/code&gt;（template名稱）和&lt;code&gt;defaultname&lt;/code&gt;（專案預設名稱）    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931924"&gt;管理Project Template到某個分類&lt;/h3&gt;&lt;p&gt;我們上篇Project Template出現的地方在&lt;code&gt;Visual C#&lt;/code&gt;，如果未來我們這個專案有很多template，&lt;code&gt;Visual C#&lt;/code&gt;這個節點會越積越多，造成不好查找。    &lt;/p&gt;&lt;p&gt;因此如果可以把相關template放在一起，到時候查找相關就很方便。    &lt;/p&gt;&lt;p&gt;建立分類很方便，只需要建立資料夾&lt;em&gt;層級&lt;/em&gt;然後把template zip丟進去就好了。    &lt;/p&gt;&lt;p&gt;舉例來說，如果我這個template想要放在 &lt;code&gt;MHAT&lt;/code&gt; -&amp;gt; &lt;code&gt;ConsoleAppProcessTemplate&lt;/code&gt;下面，那麼我就會把template放到對應資料夾位置。    &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-8s56vmc9YwQ/WaKD0dZ_ofI/AAAAAAAAWL8/TFlPCUPcynMvhxSJdHfu5ECinG8S_0eXgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="262" title="放到正確結構" style="display: inline; background-image: none;" alt="放到正確結構" src="https://lh3.googleusercontent.com/-FXhk9teQ1PU/WaKD1BIrwHI/AAAAAAAAWMA/sSAXSIz6B2s5mcgB7WiLrfM5VGyW4Ya0wCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-St0Ge0lYbjI/WaKD2811D9I/AAAAAAAAWME/mnXtBKRWkhonDbEZNN-20H7YUAkhLDuLwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="220" title="在new project template可以看到分類正確" style="display: inline; background-image: none;" alt="在new project template可以看到分類正確" src="https://lh3.googleusercontent.com/-HIj7KEbEFeM/WaKD3oUPE8I/AAAAAAAAWMI/9Nyghxn6b_IPqK02JrBxzUaTeoqXJgltgCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;放到正確結構，在new project template可以看到分類正確&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;分類只能歸在某個語言下面，例如&lt;code&gt;Visual C#&lt;/code&gt;，無法建立 &lt;code&gt;Visual C#&lt;/code&gt;那個層級    &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;還記得上面提到&lt;code&gt;NumberOfParentCategoriesToRollUp&lt;/code&gt;，目前沒有設，所以當我們選到&lt;code&gt;MHAT&lt;/code&gt;這個分類的時候，會看不到東西，如果有設定值為1，表示&lt;em&gt;上面1層&lt;/em&gt;也看得到這個template。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931725"&gt;更新template - 如何讓vs重新刷新&lt;/h2&gt;&lt;p&gt;假設今天要更新template - 不管是改了&lt;code&gt;vstemplate&lt;/code&gt;檔案，還是重新調整之後匯出zip檔案，丟到了對應的位置，很有可能開啟&lt;code&gt;new project&lt;/code&gt;還是沒有發現template或者template建立了沒有更新的內容。   &lt;/p&gt;&lt;p&gt;因此這邊有個小tips可以確保template都會更新成功。   &lt;/p&gt;&lt;p&gt;在系統裡面，有個地方是放VS template zip解壓縮內容的地方，我們只要把那邊刪掉，重啟VS就會重新從zip裡面解壓縮出來，達到更新成功的目的。   &lt;/p&gt;&lt;p&gt;操作步奏如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;找到對應的VS 暫存位置&lt;/li&gt;&lt;li&gt;把ProjectTemplates的部分刪掉&lt;/li&gt;&lt;li&gt;重新開啟VS&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931726"&gt;找到對應的VS 暫存位置&lt;/h3&gt;&lt;p&gt;直接在檔案總管輸入：&lt;code&gt;%appdata%\Microsoft\VisualStudio\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;找到你的 &lt;code&gt;{VS版本}_{後面幾個奇怪數字}&lt;/code&gt;的資料夾，舉例來說在我電腦&lt;code&gt;15.0_00cdbf3e&lt;/code&gt;是我的VS 2017的暫存位置    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果今天是VS的Experimental Instance（後面提到用VSIX建立template會用到），那麼規則變成 &lt;code&gt;{VS版本}_{後面幾個奇怪數字}Exp&lt;/code&gt;，舉例來說&lt;code&gt;15.0_00cdbf3eExp&lt;/code&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931563"&gt;把對應的TemplateCache資料夾刪掉&lt;/h3&gt;&lt;p&gt;舉例來說，今天如果是要重設Project Template，就是把&lt;code&gt;ProjectTemplatesCache&lt;/code&gt;資料夾刪掉。如果是Item Template（下一篇提到），則是把&lt;code&gt;ItemTemplatesCache&lt;/code&gt;砍掉。    &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-FwLLAA6al68/WaKD5uhKauI/AAAAAAAAWMM/xX3iVuyMmBIy4-MVZa1PjAiasDWrmXyIACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="313" title="要刪掉的ProjectTemplateCache資料夾" style="display: inline; background-image: none;" alt="要刪掉的ProjectTemplateCache資料夾" src="https://lh3.googleusercontent.com/-DBJvFwdiuZk/WaKD83TYpgI/AAAAAAAAWMQ/iu4Zw_aukiA6bSp-0nsetuRbKTxWSGXKACHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;要刪掉的ProjectTemplateCache資料夾&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503822127931166"&gt;重新開啟VS&lt;/h3&gt;&lt;p&gt;不需要把現在有開的VS關掉，直接開一個新的，然後Project Template就會更新 - &lt;code&gt;ProjectTemplateCache&lt;/code&gt;也會自動被建立出來。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503822127931471"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇深入了解了匯出的template內容，了解了&lt;code&gt;vstemplate&lt;/code&gt;的幾個重要欄位和設定，最後還了解了如何確保VS更新template。   &lt;/p&gt;&lt;p&gt;對於單個Project Template的建立也算告一個段落。   &lt;/p&gt;&lt;p&gt;在下篇，將會介紹如何建立Multi Project Template（建立出來的時候有2個project）。&amp;nbsp;&amp;nbsp; &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&amp;nbsp;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:207819aa-4314-43a2-97b8-7fda3a467f6c" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/452729036416916048/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/452729036416916048'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/452729036416916048'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html' title='[打造自己的template-建立一致性程式碼][04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-DaBFjMM9SOY/WaKDw-cp9ZI/AAAAAAAAWLw/VHyg7uM6g8Qq2VXAAkhOY82Fd6xJDH00gCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8015198633888361428</id><published>2017-08-27T11:58:00.000+08:00</published><updated>2017-08-27T11:58:56.021+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][03]透過匯出建立Project Template</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-lwkkE6kjAUw/WaJCTo3MeAI/AAAAAAAAWKg/wxbjy85pAcA8BFDS7KDRPDwonpru6n89ACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="透過匯出建立Project Template" style="display: inline; background-image: none;" alt="透過匯出建立Project Template" src="https://lh3.googleusercontent.com/-AjGU_CtbFTk/WaJCU5MowrI/AAAAAAAAWKk/FY4GK8QXSu4FCES-IFQR-NxqOhLPzXUpQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上一篇&lt;a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-template-intro-sample-package-intro.html"&gt;[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式&lt;/a&gt;建立出一個能夠用Console Process Template套件建立出來的的Echo程式之後，在這篇我們將會把建立的程式變成範本。   &lt;/p&gt;&lt;p&gt;  我們將會透過VS匯出的功能產生Template，並且介紹如何匯入匯出的template。   &lt;/p&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;上篇建立的sample 程式在 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02"&gt;github mhat-visualstudio-template sample/chapter02&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;    &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714767899" ;=""&gt;匯出成Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768152" ;=""&gt;使用匯出的範本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768815" ;=""&gt;Template放置的位置&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768579" ;=""&gt;匯入template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768216" ;=""&gt;測試範本&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768757" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768242" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;    &lt;a name='more'&gt;&lt;/a&gt;    &lt;section&gt;&lt;h2 id="WizKMOutline_1503805714767899"&gt;匯出成Project Template&lt;/h2&gt;&lt;p&gt;  建立Template的最簡單方式是透過Visual Studio（以下簡稱VS）的匯出功能。   &lt;/p&gt;&lt;p&gt;  首先用VS開啟上篇建立的專案（如果上篇沒有建立，可以從&lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02"&gt;github&lt;/a&gt; clone/下載下來），然後選擇上面Toolbar的：   &lt;/p&gt;&lt;p&gt;&lt;code&gt;Project&lt;/code&gt; -&amp;gt; &lt;code&gt;Export Template&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-b2hTa_Z4ZgI/WaJCV35sqwI/AAAAAAAAWKo/9A4_uCJxJIwrzuV-OuutyK5mocI8z7vLACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="647" title="Export Template位置" style="display: inline; background-image: none;" alt="Export Template位置" src="https://lh3.googleusercontent.com/-8DNN9fjqNIo/WaJCXO7jtFI/AAAAAAAAWKs/XJFPyaBmlIQeAxvYFoNZotlo0DptUmJ9QCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Export Template位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;div class="bs-callout bs-callout-warning"&gt;   上面提到的位置是VS 2017 - 2015的版本在 &lt;code&gt;Files&lt;/code&gt; -&amp;gt; &lt;code&gt;Export Template&lt;/code&gt;&lt;/div&gt;&lt;p&gt;  這個時候跳出的視窗請選擇 &lt;code&gt;Project Template&lt;/code&gt;，下拉選擇要匯出的專案（應該只有一個）然後按下&lt;kbd&gt;Next&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-tML0TT4hfc0/WaJCYOi3NBI/AAAAAAAAWKw/9UecVMJ65cs1WmS8POeMlJ9TlknyZOPwgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="585" title="匯出類型選項" style="display: inline; background-image: none;" alt="匯出類型選項" src="https://lh3.googleusercontent.com/-bhdRQJz3cW4/WaJCZzdBMII/AAAAAAAAWK0/vC417nKAiD06vYMKrMkousb0DytS2nFCwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;匯出類型選項&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  記下來是填寫一些基本資料：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     Template Name    &lt;/dt&gt;&lt;dd&gt;     這個是出現在新增專案的時候呈現的名稱    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Template Description    &lt;/dt&gt;&lt;dd&gt;     長一點介紹這個template的內容 - 會在新增專案右邊畫面出現。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Icon Image    &lt;/dt&gt;&lt;dd&gt;     新增專案的時候，範本呈現的圖示    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     Preview Image    &lt;/dt&gt;&lt;dd&gt;     預覽的時候的圖片    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-warning"&gt;   這邊注意一下，預設&lt;code&gt;Automatically Import the template into visual studio&lt;/code&gt;會是&lt;em&gt;&lt;strong&gt;打鉤&lt;/strong&gt;&lt;/em&gt;，建議&lt;em&gt;&lt;strong&gt;不要勾&lt;/strong&gt;&lt;/em&gt;，未來比較好管理。   &lt;/div&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9utv7MQ2M3s/WaJCax3wKhI/AAAAAAAAWK4/oUV8JGGasvAPehVyE9yeWSu-9e8KUlfFQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="585" title="meta資訊的輸入畫面" style="display: inline; background-image: none;" alt="meta資訊的輸入畫面" src="https://lh3.googleusercontent.com/-VTkqXIBihnY/WaJCbzKeZGI/AAAAAAAAWK8/_1cGuO4H7QgtDQCvZyN4yrVTUahLptAWQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;meta資訊的輸入畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  按下&lt;kbd&gt;finish&lt;/kbd&gt;之後，稍等一下，會自動打開檔案總管位置是匯出範本的地方。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503805714768152"&gt;使用匯出的範本&lt;/h2&gt;&lt;p&gt; 範本匯出之後，可以看到是一個zip的檔案，這個檔案會需要丟到特定的地方VS就會自動接受到，VS接受到之後就可以在新增專案的時候找到這個template。  &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503805714768815"&gt;Template放置的位置&lt;/h3&gt;&lt;p&gt; 在VS總共有兩個地方是放Template的：  &lt;/p&gt;&lt;ol&gt;&lt;li&gt;系統等級 - 和VS安裝的時候進來&lt;/li&gt;&lt;li&gt;使用者等級 - 我們個人客制匯出&lt;/li&gt;&lt;/ol&gt;&lt;dl&gt;&lt;dt&gt;    系統等級   &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;   這個放的位置在：    &lt;/p&gt;&lt;p&gt;&lt;code&gt;\{VisualStudioInstallationDirectory}\Common7\IDE\ProjectTemplates\{Language}\{category\\{Locale}\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   舉例來說：    &lt;/p&gt;&lt;p&gt;&lt;code&gt;c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplates\CSharp\Web\1033\WebApplicationProject40\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   這個template是VS 2017在&lt;code&gt;C#&lt;/code&gt;-&amp;gt;&lt;code&gt;Web&lt;/code&gt;-&amp;gt;英文(1033)的&lt;code&gt;WebApplicationProject40&lt;/code&gt;專案位置    &lt;/p&gt;&lt;p&gt;   一般來說，這邊路徑的template&lt;em&gt;&lt;strong&gt;不會去動&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;    使用者等級   &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;   這個預設放在：     &lt;code&gt;\{My Documents}\{Visual Studio Version}\Templates\ProjectTemplates\{Language}\&lt;/code&gt;&lt;/p&gt;&lt;p&gt;   例如：     &lt;code&gt;C:\Documents and Settings\UserName\My Documents\Visual Studio Version\Templates\ProjectTemplates\Visual C#\&lt;/code&gt;放的是C#範本的位置    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;    使用者等級是可以改的，在VS裡面的&lt;code&gt;Option&lt;/code&gt; -&amp;gt; &lt;code&gt;Projects and Soultion&lt;/code&gt;那邊是可以調整的，因此如果等一下範本匯入沒有作用，確認一下這邊的路徑是否正確。     &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZKw-Upf5DtA/WaJCdNahl9I/AAAAAAAAWLA/3N7sl9H7LuQ5n4xa2dtuO9l2rrDd_3ygQCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="442" title="設定的畫面" style="display: inline; background-image: none;" alt="設定的畫面" src="https://lh3.googleusercontent.com/-y-9Oz7M4qWk/WaJCfj4j-UI/AAAAAAAAWLE/KYd5R6X03fUVhmwq-dvn3ccLerkL-TC2wCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;設定的畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503805714768579"&gt;匯入template&lt;/h3&gt;&lt;p&gt;  既然了解了template存放的位置，我們就可以把匯出的template放到正確的位置。   &lt;/p&gt;&lt;p&gt;  舉例來說，我這個是C#的template，因此我會放在C#的資料夾下面，以我的來說就是：   &lt;br /&gt;&lt;code&gt;D:\Library\Documents\Visual Studio 2017\Templates\ProjectTemplates\Visual C#\&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-E6kSYfYC1RQ/WaJCg5dIVFI/AAAAAAAAWLI/g1EvsGuoLMw_0AfIZw9-kT5Up755u9UzACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="220" title="放的位置" style="display: inline; background-image: none;" alt="放的位置" src="https://lh3.googleusercontent.com/-VNFx8CTSysw/WaJCjbikNBI/AAAAAAAAWLM/9e54ZYDH41cNCCYqO1zTxD-XxubpRvexACHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;放的位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503805714768216"&gt;測試範本&lt;/h3&gt;&lt;p&gt;  這個時候就可以開一個VS，然後選擇，&lt;code&gt;New&lt;/code&gt; -&amp;gt; &lt;code&gt;Project&lt;/code&gt;，在&lt;code&gt;Visual C#&lt;/code&gt;下面就會看到我們匯出的範本：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Dhz4FLSMRr4/WaJCkxBorwI/AAAAAAAAWLQ/70f-TkzdBBgAYP2UhTKJDISL34MION0NACHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="375" title="新增template，找到匯出的Template" style="display: inline; background-image: none;" alt="新增template，找到匯出的Template" src="https://lh3.googleusercontent.com/-ywueiqoIHXc/WaJCmhz3WPI/AAAAAAAAWLU/g23Aki0yAAQPuJHk7GkufLZZ7knXIfRXACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;新增template，找到匯出的Template&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;  然後new出來之後會發現namespace什麼有跟著變換，然後結構和我們建立的專案一樣：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-d2D0WhVMDig/WaJCoVnLuhI/AAAAAAAAWLY/474rq8qmtXw4hP7kYu4Vd5K4OctY_lQEACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="211" title="new出來的結果" style="display: inline; background-image: none;" alt="new出來的結果" src="https://lh3.googleusercontent.com/-Iu-qZeuADaU/WaJCqhCBTSI/AAAAAAAAWLc/T5HhYP7YfWkuELxtRN9TMnXP4B71DfkTwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;new出來的結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503805714768757"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇介紹了如何把現有專案透過匯出的方式產生zip檔案，然後介紹範本讀取的路徑並且測試建立出來。   &lt;/p&gt;&lt;p&gt;  到這邊為止，其實已經能夠自己建立出template了，不過會發現有些細節還有問題，例如template預設的名稱看起來很奇怪，還有假設想要調整template顯示名稱能夠怎麼做，還有是否能夠在&lt;code&gt;Visua C#&lt;/code&gt;下面建立自己的分類等。   &lt;/p&gt;&lt;p&gt;  這些細節的部分，將會在下篇介紹，如何微調template和一些常見的小問題。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503805714768242"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     template路徑位置（英文）    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-locate-and-organize-project-and-item-templates"&gt;How to: Locate and Organize Project and Item Templates&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     匯出建立template（英文）    &lt;/dt&gt;&lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-project-templates"&gt;How to: Create Project Templates&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;  &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:2bd05b5e-4a9c-4d5d-9353-7b18f9b9b8a9" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Visual+Studio" rel="tag"&gt;Visual Studio&lt;/a&gt;&lt;/div&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8015198633888361428/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8015198633888361428'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8015198633888361428'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-VS-template-using-export.html' title='[打造自己的template-建立一致性程式碼][03]透過匯出建立Project Template'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-AjGU_CtbFTk/WaJCU5MowrI/AAAAAAAAWKk/FY4GK8QXSu4FCES-IFQR-NxqOhLPzXUpQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4574293120161303317</id><published>2017-08-26T23:34:00.000+08:00</published><updated>2017-08-27T11:39:36.774+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><title type='text'>[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式</title><content type='html'>&lt;section&gt;&lt;a href="https://lh3.googleusercontent.com/-MEdbLDhFS9A/WaGUXtVyNqI/AAAAAAAAWJI/5MmL3Y9g3bcRMZ0yPsvLpd438uFkmnymACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式" style="display: inline; background-image: none;" alt="[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式" src="https://lh3.googleusercontent.com/-mNsfXKtpTdk/WaGUY_scJTI/AAAAAAAAWJM/qyMOkN8nTjowjDQlqVceoS6d631VKt38QCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  上篇了解了template的重要性之後，在這篇將會先介紹Visual Studio裡面的兩種Template：Project Template和Item Template。   &lt;/p&gt;&lt;p&gt;  了解完兩種template類型之後，將會開始打造我們的template。這邊會以一個我自己的的open source console專案作為之後範本的目標，然後建立出一個實用這個套件的簡單console程式，未來會被用來做於template。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;div class="bs-callout bs-callout-default"&gt;    sample 程式在 &lt;a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02&amp;quot;"&gt;github mhat-visualstudio-template sample/chapter02&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079102608" ;=""&gt;Template類型&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103871" ;=""&gt;Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103263" ;=""&gt;Item Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103588" ;=""&gt;準備建立自己的Project Template&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103149" ;=""&gt;快速介紹MHAT-ConsoleApp-ProcessTemplate專案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103985" ;=""&gt;準備未來範本長的樣子&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103147" ;=""&gt;1. 建立一個一般的Console程式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103671" ;=""&gt;2. 安裝套件 MHAT.ConsoleApp.ProcessTemplate&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103604" ;=""&gt;3. 最後調整應該要包含的檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103935" ;=""&gt;測試剛剛建立的程式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503761079103211" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503761079102608"&gt;Template類型&lt;/h2&gt;&lt;p&gt;  在Visual Studio（之後都統稱VS）裡面有兩種template：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Project Template&lt;/li&gt;&lt;li&gt;Item Template&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503761079103871"&gt;Project Template&lt;/h3&gt;&lt;p&gt;   當我們開啟VS之後，做的第一件事情一定是&lt;code&gt;File&lt;/code&gt; &amp;gt; &lt;code&gt;New&lt;/code&gt; &amp;gt; &lt;code&gt;Project&lt;/code&gt;。   &lt;/p&gt;&lt;p&gt;   這個時候會打開一個視窗，裡面可以選的範本就是所謂的Project Template。    &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-4IL5fm8ehQM/WaGUZg89xII/AAAAAAAAWJQ/x5kLwLfafKwpzVXFqSgTR-FvYszdotZbQCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="190" title="file new project畫面" style="display: inline; background-image: none;" alt="file new project畫面" src="https://lh3.googleusercontent.com/-ZeKv280oxyM/WaGUabEJnnI/AAAAAAAAWJU/NI47Gf2BdwQrbWeEY1DIc2UQMQsvYWsUwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-scuc8m5CpkU/WaGUcC0wM9I/AAAAAAAAWJY/qnuH5dKCkjY5pCRNoPwvswZ-mjBtso0hQCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="375" title="選project的視窗" style="display: inline; background-image: none;" alt="選project的視窗" src="https://lh3.googleusercontent.com/-0DQ9z-QRhPw/WaGUcwIzWZI/AAAAAAAAWJc/vrwlh1MCrPsogexkVR_IHQ780X9Y68HzwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;file new project和選project的視窗&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   從選範本的視窗可以看出，會先依照語言類型（例如C#還是Visual Basic）然後裡面會在分例如Web還是.Net等。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503761079103263"&gt;Item Template&lt;/h3&gt;&lt;p&gt;   當我們建立好Project之後，會開始建立檔案，例如要在加入一個cs檔案 - 這個時候我們會對要加入的&lt;em&gt;資料夾&lt;/em&gt;（或&lt;em&gt;專案&lt;/em&gt;;如果是根目錄）點&lt;kbd&gt;右鍵&lt;/kbd&gt; &lt;code&gt;Add&lt;/code&gt; &amp;gt; &lt;code&gt;New Item&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;   這個時候會跳出一個視窗讓你選要建立的類型。這些範本就是所謂的Item Template    &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-Icz3FDhQTHw/WaGUd2FnuXI/AAAAAAAAWJg/N8z1Q8yAm5w4yfhF-uA-s3fHHvCf4kQ3ACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="209" title="Add New item" style="display: inline; background-image: none;" alt="Add New item" src="https://lh3.googleusercontent.com/-Qshw9RTrgIs/WaGUegCe6WI/AAAAAAAAWJk/i3dISp9kEkQGxUT0dEOX5foYY14NiPfOgCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figcaption&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-5FA7xSXFfaI/WaGUfg9w3PI/AAAAAAAAWJo/LkhuZB_zLrIvHf2Y9HH7CYkUDiIOym5IACHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="375" title="item template視窗" style="display: inline; background-image: none;" alt="item template視窗" src="https://lh3.googleusercontent.com/-aW7Sfg9Wl7Y/WaGUhQv6l1I/AAAAAAAAWJs/2baIjqOyYrgHbAZE4TGB_zwQDaXon2KRQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figcaption&gt;&lt;figcaption&gt;Add New item和跳出來的視窗&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   依照目前的Project不同呈現的Item Template也會不同，然後裡面也是依照類型區分，例如是web類型。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503761079103588"&gt;準備建立自己的Project Template&lt;/h2&gt;&lt;p&gt;  在對Template的類別和這些Template的視窗內容大概長什麼有些了解之後，我們就準備來建立一個自己的Project Template。   &lt;/p&gt;&lt;p&gt;  在開始介紹如何建立之前，需要先給各位一個情境 - 我們是為了什麼而建立Template？   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503761079103149"&gt;快速介紹MHAT-ConsoleApp-ProcessTemplate專案&lt;/h3&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://github.com/alantsai/MHAT-ConsoleApp-ProcessTemplate"&gt;Github 專案位置&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href="https://www.nuget.org/packages/MHAT.ConsoleApp.ProcessTemplate/"&gt;Nuget位置&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;kbd&gt;Install-Package MHAT.ConsoleApp.ProcessTemplate&lt;/kbd&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;  在這邊讓我快速介紹一下這個專案。   &lt;/p&gt;&lt;p&gt;  相信大家應該都有寫過console，寫console的時候都會遇到幾個問題：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     可以傳什麼參數不清楚，說明也不清楚，參數組合也不清楚    &lt;/dt&gt;&lt;dd&gt;     一般來說有時候console會因為參數不同功能也不同，在複雜一點還有可能當某個參數有值另外一個參數也要 - 但是搭配別的參數就不一定要。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     console沒有辦法針對某個階段做處理    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    寫過Asp .net就會知道，我們有些想要在request進來要處理，有些是request要出去的時候要做處理。這些是因為asp .net有把不同階段切出來     &lt;/p&gt;&lt;p&gt;    console則是沒有這個概念，造成了有時候想要在執行實際內容前想要做驗證都要自己切割。     &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     持續輸入類型的console    &lt;/dt&gt;&lt;dd&gt;     例如有可能是開著等使用者輸入，輸入一次處理一次直到使用者把程式關掉。    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;   這些細節每次寫console都要再次處理其實很浪費時間。因此這個專案誕生，讓整個處理變得非常簡單。   &lt;/p&gt;&lt;p&gt;   這個專案也很適合寫Project Template，未來開console就不用VS內建的版本。   &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503761079103985"&gt;準備未來範本長的樣子&lt;/h2&gt;&lt;p&gt;  既然我們有了情境之後，首先我們先建立出，未來範本建立出來時候長的樣子。   &lt;/p&gt;&lt;p&gt;  這個專案提供兩種模式：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;一種是持續輸入類型的&lt;/li&gt;&lt;li&gt;一種則是&lt;em&gt;執行一次&lt;/em&gt;就結束那種&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;  這次的範本先建立&lt;em&gt;執行一次&lt;/em&gt;就結束。建立步奏如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;建立一個一般的console程式&lt;/li&gt;&lt;li&gt;透過nuget安裝套件：&lt;kbd&gt;Install-Package MHAT.ConsoleApp.ProcessTemplate&lt;/kbd&gt;&lt;/li&gt;&lt;li&gt;最後調整應該要包含的檔案&lt;/li&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1503761079103147"&gt;1. 建立一個一般的Console程式&lt;/h3&gt;&lt;p&gt;  首先先建立出一個Console專案：先開VS然後透過&lt;code&gt;New&lt;/code&gt; &amp;gt; &lt;code&gt;File&lt;/code&gt; &amp;gt; &lt;code&gt;Project&lt;/code&gt;建立出一個一般的console程式：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-L3vygbkwU6g/WaGUiiy4nVI/AAAAAAAAWJw/RRCxdVu6syckCaM6CP9kzN_Tb4f3cTdpwCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="375" title="建立一個console程式" style="display: inline; background-image: none;" alt="建立一個console程式" src="https://lh3.googleusercontent.com/-nMXXQBMv15c/WaGUkXqOKWI/AAAAAAAAWJ0/0FiHkguiYzkJr7nrLGfwhnC2wyNqEsx_wCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建立一個console程式&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 id="WizKMOutline_1503761079103671"&gt;2. 安裝套件 MHAT.ConsoleApp.ProcessTemplate&lt;/h3&gt;&lt;p&gt;  這個時候透過nuget直接安裝套件 &lt;kbd&gt;Install-Package MHAT.ConsoleApp.ProcessTemplate&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-G17HusOdkXw/WaGUmPhOWmI/AAAAAAAAWJ4/BaZa3qPLIfkOVyItIWLqi80fyj8coUwcQCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="448" title="安裝MHAT.ConsoleApp.ProcessTemplate" style="display: inline; background-image: none;" alt="安裝MHAT.ConsoleApp.ProcessTemplate" src="https://lh3.googleusercontent.com/-XfDdT6PK1jo/WaGUpGE63qI/AAAAAAAAWJ8/bcWyRT1hOsUq6OBUEWW_tFP5eM-wJfedQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;安裝套件&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 id="WizKMOutline_1503761079103604"&gt;3. 最後調整應該要包含的檔案&lt;/h3&gt;&lt;p&gt;  這個專案的目的是在使用這個套件的時候比較容易，因此我會先定義好一些資料夾結構和一個範例的程式碼讓使用的時候更加方便。   &lt;/p&gt;&lt;p&gt;  這邊的範例會是建立一個echo的console程式，也就是使用者傳入某個參數，console會把那個參數的內容輸出出來。   &lt;/p&gt;&lt;p&gt;  在使用這個套件的時候，基本上有3個地方要處理：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     1. 建立一個代表傳入參數的model    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    這個會讓我們在取得傳入參數的時候更加方便。     &lt;/p&gt;&lt;p&gt;    先建立一個&lt;em&gt;資料夾&lt;/em&gt;叫做&lt;code&gt;Model&lt;/code&gt;，在&lt;code&gt;Model&lt;/code&gt;資料夾裡面建立一個cs檔案叫做&lt;code&gt;EchoProcessOption.cs&lt;/code&gt;，裡面內容如下：     &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;using CommandLine;&lt;br /&gt;&lt;br /&gt;namespace MHAT.ConsoleWithOption.Model&lt;br /&gt;{&lt;br /&gt;    public class EchoProcessOption&lt;br /&gt;    {&lt;br /&gt;        [Option('t', "text", Required = true, HelpText = "要console呈現的內容")]&lt;br /&gt;        public string Text { get; set; }&lt;br /&gt;    }&lt;br /&gt;}&lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     2. 建立一個process    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    process讓我們可以做一些不同時間的處理：&lt;code&gt;PreProcess&lt;/code&gt;、&lt;code&gt;Process&lt;/code&gt;、&lt;code&gt;PostProcess&lt;/code&gt;（還有幾個但是沒有列出來）     &lt;/p&gt;&lt;p&gt;    先建立一個&lt;em&gt;資料夾&lt;/em&gt;&lt;code&gt;Process&lt;/code&gt;，在這個資料夾建立一個cs檔案叫做&lt;code&gt;EchoProcess.cs&lt;/code&gt;，裡面內容如下：     &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;using MHAT.ConsoleApp.ProcessTemplate;&lt;br /&gt;using MHAT.ConsoleWithOption.Model;&lt;br /&gt;&lt;br /&gt;namespace MHAT.ConsoleWithOption.Process&lt;br /&gt;{&lt;br /&gt;    public class EchoProcess : BaseExecuteProcessTemplate&amp;lt;echoprocessoption&amp;gt;&lt;br /&gt;    {&lt;br /&gt;        protected override void PreProcess()&lt;br /&gt;        {&lt;br /&gt;            Console.WriteLine("準備輸出傳入的參數.....");&lt;br /&gt;            base.PreProcess();&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        protected override void Process()&lt;br /&gt;        {&lt;br /&gt;            Console.WriteLine($"您輸入的是：{ArugemntOption.Text}");&lt;br /&gt;            base.Process();&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        protected override void PostProcess()&lt;br /&gt;        {&lt;br /&gt;            Console.WriteLine("完成輸出輸入的參數");&lt;br /&gt;            Console.WriteLine("程式關閉");&lt;br /&gt;            base.PostProcess();&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;    &lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     3. 在&lt;code&gt;Program.cs&lt;/code&gt;執行&lt;code&gt;EchoProcess&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;    這個部分是要執行process的部分，因此在&lt;code&gt;Program.cs&lt;/code&gt;裡面調整程式碼如下：     &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;using MHAT.ConsoleWithOption.Process;&lt;br /&gt;&lt;br /&gt;namespace MHAT.ConsoleWithOption&lt;br /&gt;{&lt;br /&gt;    class Program&lt;br /&gt;    {&lt;br /&gt;        static void Main(string[] args)&lt;br /&gt;        {&lt;br /&gt;            var process = new EchoProcess();&lt;br /&gt;            process.StartProcess(args);&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;/pre&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1cUq81X7UMw/WaGUsHmm5zI/AAAAAAAAWKA/lFlbjA3VZEI9YuZXdhZCwTb_6YM_qLs_ACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="444" height="332" title="整個建立出來長的樣子" style="display: inline; background-image: none;" alt="整個建立出來長的樣子" src="https://lh3.googleusercontent.com/-yoUuHPWkOLA/WaGUuLjumYI/AAAAAAAAWKE/-XbpLTjf64YKndEibFkqKyjIEKQG4NtEwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整個建立出來長的樣子&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503761079103935"&gt;測試剛剛建立的程式&lt;/h2&gt;&lt;p&gt;  上面的步奏建立好了之後，build一下，我們就可以測試我們的程式。   &lt;/p&gt;&lt;p&gt;  開啟一個&lt;code&gt;cmd&lt;/code&gt;然後直接執行&lt;kbd&gt;MHAT.ConsoleWithOption.exe&lt;/kbd&gt;&lt;/p&gt;&lt;p&gt;  這個時候會出現一個說明畫面，會看到有個參數叫做&lt;code&gt;-t&lt;/code&gt;或者&lt;code&gt;-text&lt;/code&gt;是必填（Required），主要目的是希望console要印出來的內容。   &lt;/p&gt;&lt;p&gt;  這時候我們調整，改成輸入&lt;kbd&gt;MHAT.ConsoleWithOption.exe -t "Hello World"&lt;/kbd&gt;，這個時候就會列印出我們process裡面寫的pre、process和post裡面的內容。   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-dLL9UsDUEII/WaGUu54b5cI/AAAAAAAAWKI/uSbeRTz16rA-CN0CtiZI6Ewh5RtEKIDtQCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="179" title="整個的測試截圖" style="display: inline; background-image: none;" alt="整個的測試截圖" src="https://lh3.googleusercontent.com/-foNkbMp3FUo/WaGUv-JThiI/AAAAAAAAWKM/oPZ4uUbggnIY1fEoRX3uSj4NH8dFrV9lwCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整個的測試截圖&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503761079103211"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇先了解了VS裡面的兩種不同的Template：Project Template和Item Template。   &lt;/p&gt;&lt;p&gt;  再來為了讓我們之後有更好的情境，介紹了一個自己寫的console套件。   &lt;/p&gt;&lt;p&gt;  依照這個套件寫了一個簡單的echo console程式。這個echo程式的結構就是未來我們建立Project Template的時候希望產生的內容。   &lt;/p&gt;&lt;p&gt;  在下篇將會透過最簡單的方式產生Project Template - 透過VS的匯出功能。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:68b877eb-0edb-4415-a9f9-2ab4ebb487b1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/C%23" rel="tag"&gt;C#&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4574293120161303317/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-template-intro-sample-package-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4574293120161303317'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4574293120161303317'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-template-intro-sample-package-intro.html' title='[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-mNsfXKtpTdk/WaGUY_scJTI/AAAAAAAAWJM/qyMOkN8nTjowjDQlqVceoS6d631VKt38QCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2038277174631087708</id><published>2017-08-24T07:47:00.000+08:00</published><updated>2017-08-27T11:39:36.769+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='「打造自己的template-建立一致性程式碼」'/><title type='text'>[打造自己的template-建立一致性程式碼][01]開篇</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-P9o83QiHk-M/WZ4THnpQK1I/AAAAAAAAWIw/aPzVNIErZJ8_V8ERTSMcCNs667-mgXT-wCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[打造自己的template-建立一致性程式碼][01]開篇" style="display: inline; background-image: none;" alt="[打造自己的template-建立一致性程式碼][01]開篇" src="https://lh3.googleusercontent.com/-OTkgMS48gDA/WZ4TJbyxjYI/AAAAAAAAWI0/hA-HP2Gm7lsdVheSJsdt9Cwa6aALdT43ACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在公司裡面或者自己建立的套件/框架一般來說使用上都有一定的規範。例如ViewModel應該開在哪裡？建立之後要繼承什麼class？應該要有什麼namespace等。   &lt;/p&gt;&lt;p&gt;  如果規範沒有好好遵守，很容易一個人寫一個樣，另外一個人寫另外一樣 - 或許從最終結果來說沒有差異（會動就好XD），但是對於未來要維護的時候會造成很大困擾。   &lt;/p&gt;&lt;p&gt;  因此如何讓不同團隊成員有一樣概念來建立一致性專案就是一件非常麻煩的事情，而Template（範本）就是專門來解決這個問題。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503531554951590" ;=""&gt;為什麼寫這個主題？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503531554951298" ;=""&gt;這個系列到底包含那些內容？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503531554951226" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;  &lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1503531554951590"&gt;為什麼寫這個主題？&lt;/h2&gt;&lt;p&gt;  曾經我也介紹過如何建立&lt;a href="http://blog.alantsai.net/search/label/%E3%80%8CiThome%20%E7%AC%AC%E4%B8%83%E5%B1%86%E9%90%B5%E4%BA%BA%E8%B3%BD%E3%80%8D"&gt;自己的Mvc框架&lt;/a&gt;，   舉在這個框架裡面在Bll範例，會建立&lt;code&gt;Service&lt;/code&gt;可以繼承   &lt;code&gt;GenericService&lt;/code&gt;來減少一些boilerplate code。   &lt;/p&gt;&lt;p&gt;  可以想一下，假設今天有個新的同事進來想要使用，他是不是需要受到教育訓練告訴他新的Service要開在那個資料夾，然後要繼承什麼class，然後要覆寫什麼方法。   &lt;/p&gt;&lt;p&gt;  如果今天有一個範本，他只需要選擇&lt;code&gt;New Item&lt;/code&gt;然後選擇建立Service，然後裡面自動把CS檔案建立在正確的位置，並且寫好class 繼承和應該要覆寫的方法。   &lt;/p&gt;&lt;p&gt;  整個教&lt;em&gt;&lt;strong&gt;學習的時間成本降低&lt;/strong&gt;&lt;/em&gt;，並且&lt;em&gt;&lt;strong&gt;人為輸入錯誤的幾率也降低&lt;/strong&gt;&lt;/em&gt;（因為沒有Template的情況下，可能是從現有的程式碼copy然後改，非常容易有缺東西）。   &lt;/p&gt;&lt;p&gt;  所以如何建立自己常用的範本變得非常重要，在未來可以省去很多copy和paste的時間和人為錯誤的時間。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;   想象一下，如果今天你要學Asp .Net Mvc，而無法直接從Visual Studio開一個mvc專案，每一次建立都要自己開Controller和View的資料夾，然後設定一些routing資訊等，是不是很有可能東西會少copy到導致會花很多時間在debug上面？    &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503531554951298"&gt;這個系列到底包含那些內容？&lt;/h2&gt;&lt;p&gt;  基本上會針對以下幾個部分做介紹：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;在VS的世界裡，有什麼類型的Template&lt;/li&gt;&lt;li&gt;透過匯出的方式建立自己的Template&lt;/li&gt;&lt;li&gt;微調自己的Template&lt;/li&gt;&lt;li&gt;建立VSIX讓Template更容易讓安裝&lt;/li&gt;&lt;li&gt;如何使用SideWaffle讓建立範本變得更容易&lt;/li&gt;&lt;li&gt;dot net new - dotnet core的範本模式&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503531554951226"&gt;結語&lt;/h2&gt;&lt;p&gt;  Template其實非常的重要，但是由於要寫自己的Template還是需要了解一些學習，因此大家還是習慣用copy和paste的方式。   &lt;/p&gt;&lt;p&gt;  但是如同程式設計好的結構一樣，只要寫過3次就應該要整理成為方法，copy和paste 3次以上難道不用自己整合常建立內容嗎？   &lt;/p&gt;&lt;p&gt;  這個系列希望降低未來要建立Template的門檻。   &lt;/p&gt;&lt;p&gt;  目前其實還有&lt;a href="http://blog.alantsai.net/search/label/%E3%80%8CiThome%20%E7%AC%AC%E5%85%AB%E5%B1%86%E9%90%B5%E4%BA%BA%E8%B3%BD%E3%80%8D"&gt;[從.Net工程師的角度來看]&lt;/a&gt;的系列還沒有寫完   ，但是由於最近剛好有認真的在學習一下，在還有記憶的時候做一個總結介紹。   &lt;/p&gt;&lt;p&gt;  下一篇會從VS到底提供哪些類型的範本和我們怎麼使用它作介紹。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:53ab2459-b5c8-4202-bc74-727049657025" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag"&gt;「打造自己的template-建立一致性程式碼」&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2038277174631087708/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2038277174631087708'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2038277174631087708'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/buildYourOwnTemplate-intro.html' title='[打造自己的template-建立一致性程式碼][01]開篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-OTkgMS48gDA/WZ4TJbyxjYI/AAAAAAAAWI0/hA-HP2Gm7lsdVheSJsdt9Cwa6aALdT43ACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5817943309714363671</id><published>2017-08-22T07:53:00.000+08:00</published><updated>2017-08-24T07:45:38.728+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><category scheme='http://www.blogger.com/atom/ns#' term='iis'/><title type='text'>IIS 無法取得font - 錯誤 Failed to decode downloaded font - 了解MIME設定和gitattributes錯誤導致的問題</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-8TpADWT6OmQ/WZtxfeb43ZI/AAAAAAAAWH8/_g9poanEVm4CbvsrkgNGEmAfMe9gMWqlACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="IIS 無法取得font - 錯誤 Failed to decode downloaded font - 了解MIME設定和gitattributes錯誤導致的問題" style="display: inline; background-image: none;" alt="IIS 無法取得font - 錯誤 Failed to decode downloaded font - 了解MIME設定和gitattributes錯誤導致的問題" src="https://lh3.googleusercontent.com/-V3br0Dtoy5g/WZtxhTuUeTI/AAAAAAAAWIA/yHcalXYpIBAC4VFiUODnguoHlMsZZU1xgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;最近在案子裡面遇到網站有使用到&lt;a href="http://fontello.com/"&gt;Fontello&lt;/a&gt;的元件。網站的靜態切板沒什麼問題但是掛到了iis之後，發現icon的部分&lt;em&gt;&lt;strong&gt;都出不來&lt;/strong&gt;&lt;/em&gt;，然後chrome F12的developer工具出現了錯誤訊息：   &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-1tcOkAXFX0Y/WZtxiRgeLBI/AAAAAAAAWIE/y7C8_zs7_BYWNa2XEUur4IoUtPP5ZdfDgCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="396" title="Failed to decode downloaded font" style="display: inline; background-image: none;" alt="Failed to decode downloaded font" src="https://lh3.googleusercontent.com/-ErvNjpVFzSQ/WZtxjTRhYvI/AAAAAAAAWII/C2RlG9H0ui4UvxB3P9kyyM_xl12z_4e1ACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;&lt;p&gt;Failed to decode downloaded font&lt;/p&gt;&lt;p&gt;OTS parsing error: incorrect file size in WOFF header     &lt;/p&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-EgbvhY-tMlA/WZtxkrt5IFI/AAAAAAAAWIM/FVk0_OFdIU0K9oeE8_3-q9b4kUazlUgBACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="258" title="但是看network裡面fontello的font又有load成功" style="display: inline; background-image: none;" alt="但是看network裡面fontello的font又有load成功" src="https://lh3.googleusercontent.com/-RhOCqPezsKo/WZtxmcepKsI/AAAAAAAAWIQ/ppsE9bs8-hEHC_25Vm0JuVK0egobjfTAgCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;但是看&lt;code&gt;network&lt;/code&gt;裡面fontello的font又有load成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;p&gt;這不是我第一次使用這種font相關的套件，為什麼以前沒有發生呢？這篇將會對於發生的原因和解決方式做個總結。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;    關鍵字：fontello出不來、fontawesome出不來、無法使用font套件   &lt;/section&gt;   &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233239" ;=""&gt;解決方式 - TL;DR&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233944" ;=""&gt;IIS需要設定font附件的MIME類型&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233843" ;=""&gt;注意font的line ending是不是被改動了&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233823" ;=""&gt;問題發生原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233147" ;=""&gt;了解MIME設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233505" ;=""&gt;MIME目的是什麼？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233907" ;=""&gt;MIME的全稱和格式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233281" ;=""&gt;MIME和web（http）的關係&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233262" ;=""&gt;這個和我們問題有什麼關係？&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233667" ;=""&gt;git line ending問題&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503358811233442" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1503358811233239"&gt;解決方式 - TL;DR&lt;/h2&gt;&lt;p&gt;其實這個問題有兩個部分：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;IIS需要設定font附件的MIME類型，要不然瀏覽器會識別不出來&lt;/li&gt;&lt;li&gt;注意font的line ending是不是被改動了 - 假設使用git做版控然後line ending沒處理好，非常有可能發生&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233944"&gt;IIS需要設定font附件的MIME類型&lt;/h3&gt;&lt;p&gt;設定方式很簡單，只需要在網站裡面的&lt;code&gt;Web.config&lt;/code&gt;的&lt;code&gt;system.webServer&lt;/code&gt; &amp;gt; &lt;code&gt;staticContent&lt;/code&gt; 加入以下即可：   &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;system.webServer&gt;&lt;br /&gt; &lt;staticcontent&gt;&lt;br /&gt;  &lt;mimemap fileExtension=".eot" mimeType="application/vnd.ms-fontobject" /&gt;&lt;br /&gt;  &lt;remove fileExtension=".ttf" /&gt;&lt;br /&gt;  &lt;mimemap fileExtension=".ttf" mimeType="application/x-font-ttf" /&gt;&lt;br /&gt;  &lt;remove fileExtension=".woff" /&gt;&lt;br /&gt;  &lt;mimemap fileExtension=".woff" mimeType="application/font-woff" /&gt;&lt;br /&gt;  &lt;remove fileExtension=".woff2" /&gt;&lt;br /&gt;  &lt;mimemap fileExtension=".woff2" mimeType="application/font-woff2" /&gt;&lt;br /&gt; &lt;/staticContent&gt;&lt;br /&gt;&lt;/system.webServer&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233843"&gt;注意font的line ending是不是被改動了&lt;/h3&gt;&lt;p&gt;假設是Windows，那麼如果你的&lt;code&gt;.gitattribute&lt;/code&gt;沒有設定好的話，那麼很有可能你的font line ending已經被改掉了，這會造成chrome無法parsing。    &lt;/p&gt;&lt;p&gt;解決方式是做個斷行一致化處理，詳細可以參考：&lt;a href="http://blog.alantsai.net/2017/07/git-normalize-line-ending.html"&gt;[git]為什麼常出現有修改但是比對不卻顯示不出差異？談談檔案斷行問題和如何達到不同平台正確一致化&lt;/a&gt;，基本要做的動作如下：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      先為專案設定&lt;code&gt;.gitattribute&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo/blob/master/.gitattributes"&gt;可以使用我另外一篇介紹的gitattribute做開始&lt;/a&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;                     假設有任何修改尚未commit，先commit                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git commit -am "儲存目前修改"&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                         把所有檔案刪掉（不包含.git）                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;                            git rm --cached -r .                         &lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                         重新從repo把刪除的修改revert掉                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git reset .&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                     加入index                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git add -u&lt;/code&gt; - 如果有看到很多warning提示會從crlf轉成lf是正常的。                 &lt;/dd&gt;&lt;dt&gt;                     commit上去                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git commit -m "斷行一致化處理"&lt;/code&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503358811233823"&gt;問題發生原因&lt;/h2&gt;&lt;p&gt;從上面的解決方式有2個步奏不難發現，其實這個問題有兩個部分：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;IIS MIME設定問題&lt;/li&gt;&lt;li&gt;git line ending 問題&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503358811233147"&gt;了解MIME設定&lt;/h2&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233505"&gt;MIME目的是什麼？&lt;/h3&gt;&lt;p&gt;大家有沒有想過，這世界上格式那麼多，當收到一個檔案，例如pdf，電腦怎麼知道這是一個pdf？   &lt;/p&gt;&lt;p&gt;如果是windows出生可能會想說靠副檔名啊，有什麼難的，但是副檔名是可以自己亂改，那麼系統收到一個檔案的時候怎麼知道這是什麼檔案呢？ &lt;/p&gt;&lt;p&gt;這個就是MIME的作用。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233907"&gt;MIME的全稱和格式&lt;/h3&gt;&lt;p&gt;MIME的全稱是&lt;code&gt;Multipurpose Internet Mail Extensions&lt;/code&gt;本來主要的使用地方是在表示寄送的&lt;em&gt;&lt;strong&gt;email內容和附件的格式內容&lt;/strong&gt;&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;MIME的格式是&lt;code&gt;{大類}/{小類}&lt;/code&gt; - 例如&lt;code&gt;video/mp4&lt;/code&gt;或者&lt;code&gt;application/pdf&lt;/code&gt;。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233281"&gt;MIME和web（http）的關係&lt;/h3&gt;&lt;p&gt;既然上面說了MIME主要用於email那麼和web有什麼關係？在http裡面其實也會遇到和email一樣問題，不過有兩個情況：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     browser可能想要和server取得某種類型格式的資料    &lt;/dt&gt;&lt;dd&gt;      http header&lt;code&gt;Accept&lt;/code&gt;用來做這個事情 - 值則是使用MIME的值    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     server告訴browser目前傳遞的是什麼類型的資料 &lt;/dt&gt;&lt;dd&gt;     http header &lt;code&gt;Content-Type&lt;/code&gt; 用來做這個事情 - 值則是使用MIME的值    &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;所以可以發現http基本上是用了MIME的格式在定義傳輸和要求的資料要是什麼格式。   &lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1503358811233262"&gt;這個和我們問題有什麼關係？&lt;/h3&gt;&lt;p&gt;由於IIS預設並不會設定font相關的MIME，這個造成了當瀏覽器收到的時候，&lt;em&gt;&lt;strong&gt;不知道這個是什麼類型檔案，因此不知道如何處理&lt;/strong&gt;&lt;/em&gt;。    &lt;/p&gt;&lt;p&gt;所以雖然我們在chrome的network看得到font資訊，但是因為缺少mime，browser無法處理造成讀取失敗。因此出現了錯誤訊息：    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;Failed to decode downloaded font    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503358811233667"&gt;git line ending問題&lt;/h2&gt;&lt;p&gt;git line ending問題在另外一篇&lt;a href="http://blog.alantsai.net/2017/07/git-normalize-line-ending.html"&gt;[git]為什麼常出現有修改但是比對不卻顯示不出差異？談談檔案斷行問題和如何達到不同平台正確一致化&lt;/a&gt;已經有詳細說明了，因此這篇不再贅述實際解決方式，不過對於實際錯誤問題做一點說明。   &lt;/p&gt;&lt;p&gt;下面的截圖可以看到&lt;code&gt;content-type&lt;/code&gt;對了，但是line ending其實錯了，所以還是出現不了，只需要做完line ending一致化就好了。   &lt;/p&gt;&lt;a href="https://lh3.googleusercontent.com/-Hjb65Ijv0Ew/WZtxn_BWQDI/AAAAAAAAWIU/eP1BDIxELp4FIrPWEO-9zR95nVbXsYWkACHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="389" title="content-type對了" style="display: inline; background-image: none;" alt="content-type對了" src="https://lh3.googleusercontent.com/-xRIPAUm7bbY/WZtxpdjdozI/AAAAAAAAWIY/5vnpRej9dccsTaBRZI9qKndvW1zvh2EzwCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XmURTUNZgWU/WZtxsG0ZMzI/AAAAAAAAWIc/phxFMhSeWiUPBkz5O9VZD2ito84YkDx-gCHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="226" title="line ending還沒有解決" style="display: inline; background-image: none;" alt="line ending還沒有解決" src="https://lh3.googleusercontent.com/-hnb4Vlrv47M/WZtxugMm6II/AAAAAAAAWIg/x02C-o5_e4M9ePWij9_spenswrUGZ6aPQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;br /&gt;&lt;figcaption&gt;第一張圖可以看到mime問題解決，但是和git比對的時候發現line ending還沒有解決(第二張圖是對)所以還是有問題，一致化之後就好了&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1503358811233442"&gt;結語&lt;/h2&gt;&lt;p&gt;在開篇的時候我有提到，其實我用過很多次這種font的Library，為什麼以前都沒問題？我事後想了一下，非常有可能之前用的都是cdn的服務，因此cdn設定好了所以沒有問題。   &lt;/p&gt;&lt;p&gt;這個告訴我，其實有很多細節別的系統可能都處理好了，但是如果個人基本功不好，其實很容易花時間在這種小細節上面。   &lt;/p&gt;&lt;p&gt;希望透過這篇能夠再次說明git line ending的問題和了解mime對於http的重要性。   &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5817943309714363671/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/08/faq-iis-font-not-showing.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5817943309714363671'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5817943309714363671'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/08/faq-iis-font-not-showing.html' title='IIS 無法取得font - 錯誤 Failed to decode downloaded font - 了解MIME設定和gitattributes錯誤導致的問題'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-V3br0Dtoy5g/WZtxhTuUeTI/AAAAAAAAWIA/yHcalXYpIBAC4VFiUODnguoHlMsZZU1xgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1344702390109286642</id><published>2017-07-30T15:24:00.000+08:00</published><updated>2017-12-12T23:34:03.634+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='visual studio team service'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='powershell'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[從.Net工程師的角度來看DevOps 21]Build階段的總結和重構 - Build Server介紹</title><content type='html'>&lt;section&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-gYpW8LUpf5w/WX2I6KNMruI/AAAAAAAAWFQ/rZsSO91M1vw57S1SDrHhGSAI7YoZbiKfACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-pFq03lv9lM8/WX2I71yy8II/AAAAAAAAWFU/u0XRdmLnuTQIsqQPKMswcjieZmD9f7-pACHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figurecaption&gt;圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figurecaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在上篇&lt;a href="http://blog.alantsai.net/2017/01/devopsSeries-stylecop.html"&gt;[iThome第8屆鐵人賽 20]靜態程式碼分析之程式碼風格 - Stylecop&lt;/a&gt;介紹完了如何整合stylecop之後，build階段也差不多到了一個階段。   &lt;/p&gt;&lt;p&gt;  在這個階段裡面，從最基本的編譯、到執行單元測試、到整合程式碼測試的涵蓋率最後整合Code Analysis和stylecop，整個build基本要做的都做了，因此我們要開始進入如何把這個建制整合到builder server來達到CI的效果   &lt;/p&gt;&lt;p&gt;  在這篇，將會談到：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;在一次重構和調整script - 以符合上build server執行的時候比較沒有問題&lt;/li&gt;&lt;li&gt;對build server做個簡單的介紹&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;     &lt;div class="bs-callout bs-callout-default"&gt;  sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter21"&gt;github devops-psake sample/chapter21&lt;/a&gt;   &lt;/div&gt;&lt;section&gt;   &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044432" ;=""&gt;重構build scrip&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044415" ;=""&gt;允許傳入參數的方式決定是否執行Stylecop和Code Analysis&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044268" ;=""&gt;修正script裡面相對路徑是指執行位置而不是相對於檔案本身&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044462" ;=""&gt;整合psake module - 直接load 整合的psake&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044815" ;=""&gt;整合nuget restore&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044596" ;=""&gt;Build Server的目的和使用&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044367" ;=""&gt;build server工具&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044257" ;=""&gt;免費的build server&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1501398736044895" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;   &lt;a name='more'&gt;&lt;/a&gt;   &lt;section&gt;&lt;h2 id="WizKMOutline_1501398736044432"&gt;重構build scrip&lt;/h2&gt;&lt;p&gt;  在這個階段加入的一些build task會需要在做一點重構方便上build server呼叫，這個部分將對重構內容做說明。   &lt;/p&gt;&lt;p&gt;  會重構的有：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;允許傳入參數的方式決定是否執行Stylecop和Code Analysis&lt;/li&gt;&lt;li&gt;修正script裡面相對路徑是指執行位置而不是&lt;em&gt;相對於檔案本身&lt;/em&gt;&lt;/li&gt;&lt;li&gt;整合psake module - 直接load 整合的psake&lt;/li&gt;&lt;li&gt;整合nuget restore&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1501398736044415"&gt;允許傳入參數的方式決定是否執行Stylecop和Code Analysis&lt;/h3&gt;&lt;p&gt;   不是每一個專案都會需要執行Stylecop和Code Analysis，因此我們可以調整compile，讓有傳入參數的時候在執行，沒有則不執行。    &lt;/p&gt;&lt;p&gt;   做法很簡單，就是加2個&lt;code&gt;Properties&lt;/code&gt;，代表是否要執行Stylecop和Analysis，如果是&lt;code&gt;false&lt;/code&gt;就不執行。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;    相關修改可以直接參考commit：&lt;a href="https://github.com/alantsai-samples/devops-psake/commit/3896aebc743b3cf89901a865e94347fab69c7ad9"&gt;調整 - 允許stylecop和condeanalysis透過傳入參數方式決定是否執行&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1501398736044268"&gt;修正script裡面相對路徑是指執行位置而不是&lt;em&gt;相對於檔案本身&lt;/em&gt;&lt;/h3&gt;&lt;p&gt;   在script裡面在執行一些檔案的時候寫了一些相對路徑的語法，舉例來說在&lt;code&gt;build.ps1&lt;/code&gt;的&lt;code&gt;.\default.ps1&lt;/code&gt;：    &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;    Invoke-psake -buildFile .\default.ps1 -taskList Test `&lt;/pre&gt;&lt;p&gt;   乍看之下，會認為說這個的相對路徑是&lt;em&gt;&lt;strong&gt;相對於當前檔案&lt;/strong&gt;&lt;/em&gt;（&lt;code&gt;build.ps1&lt;/code&gt;）- 但是其實不是，這個相對路徑是相對於 &lt;em&gt;&lt;strong&gt;執行檔案的位置&lt;/strong&gt;&lt;/em&gt;。換句話說指的是呼叫script的位置。    &lt;/p&gt;&lt;p&gt;   這個會造成很大問題，因為假設你執行的時候和&lt;code&gt;build.ps1&lt;/code&gt;是同樣的位置，那麼沒有問題。但是如果假設執行的位置和當前檔案位置不同，那麼整個路徑是錯的。    &lt;/p&gt;&lt;p&gt;   因此需要調整變成相對於script。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;    關於這個問題，可以參考一些資料：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;a href="https://weblogs.asp.net/soever/powershell-regerencing-files-relative-to-the-currently-executing-script"&gt;PowerShell - referencing files relative to the currently executing script&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://techblog.dorogin.com/powershell-current-directory-relative-to-executing-script-e0647aa6e898"&gt;PowerShell: current directory relative to executing script&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://viziblr.com/news/2013/2/17/reliable-path-navigation-in-powershell-based-on-script-locat.html"&gt;Reliable Path Navigation in PowerShell based on Script Location&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;    相關修改可以直接參考commit：&lt;a href="https://github.com/alantsai-samples/devops-psake/commit/f790b93404849930cc0fe38691648b181b5d2766"&gt;[重構]修正取得檔案路徑的方式 - 避免執行script位置不同導致路徑問題&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1501398736044462"&gt;整合psake module - 直接load 整合的psake&lt;/h3&gt;&lt;p&gt;   之前psake load進來的版本都是用從nuget package下載下來的版本。在這邊調整為直接load一個準備好的版本。    &lt;/p&gt;&lt;p&gt;   這麼做的原因只是明確表示，目前使用的psake module版本是幾號（目前是4.6） - 可以增加如果nuget package有提供就用那個版本方便未來直接改版，但是目前沒有加入這個機制。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;    相關修改可以直接參考commit：&lt;a href="https://github.com/alantsai-samples/devops-psake/commit/b0e2c7a5065a7198c1995d008e089378df98f44a"&gt;[重構]讓load psake local版本 - 目前是4.6&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1501398736044815"&gt;整合nuget restore&lt;/h3&gt;&lt;p&gt;   有很多套件都依賴nuget下載下來，到目前為止都會先透過nuget下載，所以nuget package都有存在因此build都沒有什麼問題。    &lt;/p&gt;&lt;p&gt;   可是我們不會上&lt;code&gt;packages&lt;/code&gt;資料夾，所以假設從github下載repo，其實根本無法build，需要先自己做nuget restore。 &lt;/p&gt;&lt;p&gt;   因此要在我們的build script裡面加上nuget restore。    &lt;/p&gt;&lt;p&gt;   和psake module一樣，會把nuget直接整合進來，目前使用的版本是3.5。    &lt;/p&gt;&lt;p&gt;   restore的方式很簡單，直接呼叫&lt;code&gt;nuget restore $solutionFile&lt;/code&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;    正常來說應該在&lt;code&gt;default.ps1&lt;/code&gt;整合一個task在&lt;code&gt;Init&lt;/code&gt;前先做nuget restoer就好，但是由於我們在&lt;code&gt;Properties&lt;/code&gt;有一些路勁是從nuget的packages裡面取得（例如&lt;code&gt;$xunitExe&lt;/code&gt;），這個會造成一個     執行順序的問題，假設在進入Task前packages還不存在，&lt;code&gt;Properties&lt;/code&gt;的對應路徑會不存在，這個有兩個解決方式：     &lt;/p&gt;&lt;ol&gt;&lt;li&gt;在執行到task之前先restore - 因此restore要寫在&lt;code&gt;build.ps1&lt;/code&gt;&lt;/li&gt;&lt;li&gt;在default.ps1裡面使用global 參數 - 因此可以讓在執行nuget restore之後把參數的值改掉&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;    目前選擇的方式是第二種 - 不選擇第一種的原因是其實要手動先執行nuget restore不直覺     &lt;/p&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;    相關修改可以直接參考commit：&lt;a href="https://github.com/alantsai-samples/devops-psake/commit/798546dbe7738e54cdc1395420f047876eef2b12"&gt;加入 nuget restore - nuget版本3.5&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1501398736044596"&gt;Build Server的目的和使用&lt;/h2&gt;&lt;p&gt;  Build Server講白一點&lt;em&gt;環境&lt;/em&gt;和我們開發的機器沒什麼兩樣，他的唯一目的就是用來&lt;strong&gt;&lt;em&gt;編譯專案&lt;/em&gt;&lt;/strong&gt;。   &lt;/p&gt;&lt;p&gt;  那或許會說既然和我們兩樣，那幹嘛還要有build server，直接用我們的機器編譯就好了？原因很簡單，完全是為了節省時間。   &lt;/p&gt;&lt;p&gt;  以我目前這麼簡單的一個範例專案，光建制和跑測試（不包含stylecop和code Analysis）就要跑將近1分鐘的時間，可以想象如果多人開發，每一次commit我都要在確認目前上面的code是不是建制沒有問題，假設一天有總共20個commit，   我就要&lt;em&gt;浪費&amp;lt;20分鐘&lt;/em&gt;的時間（因為build的時候一定影響電腦上執行其他的效能，更別說要pull然後build等其他沒有算進來的時間）   &lt;/p&gt;&lt;p&gt;  因此我們用Build server做這件事情，只要有commit就自動幫我們建制是否有成功（至少要build成功，test執行成功，甚至如果有需要也可以設定當測試涵蓋率低於某個數字直接報錯）   &lt;/p&gt;&lt;p&gt;  雖然build server的環境從本質上來說和我們開發的一樣，但是我們開發會自己手動執行做build，但是在build server怎麼自動觸發呢？因此有所謂的build server的軟體可以管理/觸發自動build。   &lt;/p&gt;&lt;p&gt;  整個搭配起來就是所謂的&lt;strong&gt;&lt;em&gt;Continous Integration（CI 持續整合）&lt;/em&gt;&lt;/strong&gt; - 所以build server有時候也稱為CI Server   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1501398736044367"&gt;build server工具&lt;/h2&gt;&lt;p&gt;  既然了解了什麼是build server之後，就來了解一下如果要建制一個環境需有什麼build的軟體。   &lt;/p&gt;&lt;p&gt;  基本上來說還蠻多build server的工具，這些工具一般是一個專案會議組設定檔案用來設定如何建制這個專案。一般來說這些工具也提供一些已經寫好的script，讓大家直接連接專案然後非常簡單設定就會自動建制。   &lt;/p&gt;&lt;p&gt;  直接使用build server提供的script有好有壞，好處是簡單設定，壞處是無法在local跑和build server一樣的動作（因為不知道他的script跑了什麼） - 也是因為這樣所以這個專案的目的就是提供一個通用script能夠在build server跑也能在local跑。   &lt;/p&gt;&lt;p&gt;  常見的.net build server 有：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://azure.microsoft.com/zh-tw/services/visual-studio-team-services/"&gt;TFS (Visual Studio Team Service)&lt;/a&gt;&lt;/li&gt;&lt;li&gt;JetBrain的&lt;a href="https://www.jetbrains.com/teamcity/"&gt;Teamcity&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://jenkins.io/"&gt;Jenkins&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;  其實還有很多，用自己習慣就好。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;   這也是使用自己build script的好處，因為不會被build server綁死。只要能夠跑powershell都跑得了build script。   &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1501398736044257"&gt;免費的build server&lt;/h2&gt;&lt;p&gt;  雖然上面提到的build server工具有些有免費的可以自己架設在自己的Server，可是自己架設畢竟需要自己管理，並且也要一筆費用（像是機器費用，Server License等），因此如果只是open source專案根本用不起。   &lt;/p&gt;&lt;p&gt;  因為這些費用的問題，因此以前很難找到給.net免費的CI Server。   &lt;/p&gt;&lt;p&gt;  幸好目前有非常佛心的服務可以讓我們在open source專案或者提供定量的次數讓我們可以免費使用。   &lt;/p&gt;&lt;p&gt;  這其中分別有：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Visual Studio Team Service - TFS的雲端版本 - 提供每月240分鐘的免費build時間&lt;/li&gt;&lt;li&gt;Appveyor - 提供open source免費的CI build服務&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1501398736044895"&gt;結語&lt;/h2&gt;&lt;p&gt;  在這篇重新把build script又調整了一下，讓我們上build server的時候執行不會有問題。 &lt;/p&gt;&lt;p&gt;  快速介紹了build server，和有哪些可以自己架設的build server - 在下一篇將會介紹Appveyor - 如何使用Appveyor來達到我們Open source專案的CI。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:3d698384-89d3-4802-a7e1-bb1673d70b60" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/devops" rel="tag"&gt;devops&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8ciThome%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag"&gt;「iThome第八屆鐵人賽」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/powershell" rel="tag"&gt;powershell&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/visual+studio+team+service" rel="tag"&gt;visual studio team service&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1344702390109286642/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/07/devopsSeries-refactorScriptAndBuildServerIntro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1344702390109286642'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1344702390109286642'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/devopsSeries-refactorScriptAndBuildServerIntro.html' title='[從.Net工程師的角度來看DevOps 21]Build階段的總結和重構 - Build Server介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-pFq03lv9lM8/WX2I71yy8II/AAAAAAAAWFU/u0XRdmLnuTQIsqQPKMswcjieZmD9f7-pACHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8132513255124894052</id><published>2017-07-25T06:56:00.000+08:00</published><updated>2017-07-25T06:56:25.054+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='markdown'/><category scheme='http://www.blogger.com/atom/ns#' term='visual studio code'/><category scheme='http://www.blogger.com/atom/ns#' term='「簡報」'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><category scheme='http://www.blogger.com/atom/ns#' term='「回顧」'/><title type='text'>[回顧][課程]20170704-20170705-電子內容管理 使用Git 與 github</title><content type='html'>&lt;section&gt;&lt;a href="https://lh3.googleusercontent.com/-5ZK8yMOSvqk/WXZ5MA3zFFI/AAAAAAAAWC0/b9xz8ayCra0w7SZyNPjon_FqW6tNIOJqwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="[回顧][課程]20170704-20170705-電子內容管理 使用Git 與 github" style="display: inline; background-image: none;" alt="[回顧][課程]20170704-20170705-電子內容管理 使用Git 與 github" src="https://lh3.googleusercontent.com/-1JcUvYTIIqg/WXZ5Nm-iSZI/AAAAAAAAWC4/_1soJwEDGqIF_h9yzd_Apqpy2hRoORZgwCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;圖片來源：&lt;a href="https://pixabay.com/en/discussion-session-white-male-1874788/"&gt;https://pixabay.com/en/discussion-session-white-male-1874788/&lt;/a&gt;&lt;/figcaption&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;  在2017/07/04和2017/07/05這兩天（總共6個小時）很榮幸有機會在逢甲給非資訊系的學員介紹版控，並且如何使用版控來管理他們日常文件。   &lt;/p&gt;&lt;p&gt;  這次的課程其實非常特別，因為有別于以往我習慣的教學方式（多說明概念和原因多過於實際操作，因為實際操作很容易找到資料，但是背後原理、概念則不容易找到），這次反而是不需要了解太多背後原理，會用就好，先使用有興趣再來了解   原理。   &lt;/p&gt;&lt;p&gt;  一樣，我喜歡請大家給我一些回饋意見因此有請學員幫我填寫問卷，這篇會針對這次課程的一個總結。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500934689486130"&gt;前情提要&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;     活動相關資訊    &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://www.facebook.com/Study4.tw/photos/a.241568189262415.58655.233737566712144/1389644971121392/?type=3&amp;amp;theater&amp;amp;notif_t=like&amp;amp;notif_id=1499475929918955"&gt;活動相片&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://sites.google.com/view/fcuflight/105%E5%AD%B8%E5%B9%B4%E5%BA%A6%E6%9A%91%E6%9C%9F%E8%AA%B2%E7%A8%8B"&gt;課程相關資訊&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     簡報主要內容    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;        讓非資訊人員了解版控，並且以此課程延伸一些不同地方的興趣。其中使用TortoiseGit介紹幾本git操作，搭配visual studio code教學編輯markdown和編輯html檔案並且透過visual studio code直接做git commit和比對等相關動作    &lt;/p&gt;&lt;p&gt;    因此希望上完這個課程，學員可能因此對git更有興趣，或者對基礎web更有興趣（因為在做線上履歷會自己調整）或者對如何搭配專案管理（github issue tracking）更有興趣，之後在往下專研。    &lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;     相關投影片    &lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt; &lt;iframe width="595" height="485" src="//www.slideshare.net/slideshow/embed_code/key/m8waSchYbDtmSX" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowfullscreen="" style="border: 1px solid rgb(204, 204, 204); border-image: none; margin-bottom: 5px; max-width: 100%;"&gt; &lt;/iframe&gt; &lt;div style="margin-bottom: 5px;"&gt;&lt;strong&gt; &lt;a title="電子內容管理 使用Git 與 github 1" href="//www.slideshare.net/alantsai2007/git-github-1-78200949" target="_blank"&gt;電子內容管理 使用Git 與 github 1&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/li&gt;&lt;li&gt; &lt;iframe width="595" height="485" src="//www.slideshare.net/slideshow/embed_code/key/Lmgxb5MJ6u6yZj" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" allowfullscreen="" style="border: 1px solid rgb(204, 204, 204); border-image: none; margin-bottom: 5px; max-width: 100%;"&gt; &lt;/iframe&gt; &lt;div style="margin-bottom: 5px;"&gt;&lt;strong&gt; &lt;a title="電子內容管理 使用Git 與 github 2" href="//www.slideshare.net/alantsai2007/git-github-2" target="_blank"&gt;電子內容管理 使用Git 與 github 2&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="https://www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486130" ;=""&gt;前情提要&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486319" ;=""&gt;結論&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486855" ;=""&gt;給非資訊學生介紹還是要多點讓他們實作 - 但是要控制好速度&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486886" ;=""&gt;可以發現回饋有點兩極&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486394" ;=""&gt;很開心有些學員因此對Visual studio code有興趣&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486921" ;=""&gt;課程還是要有點實作比較好&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486270" ;=""&gt;詳細數據&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486505" ;=""&gt;整體感覺&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486922" ;=""&gt;最有...&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486560" ;=""&gt;簡報和demo&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486247" ;=""&gt;未來加深和其他建議&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500934689486117" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;  &lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1500934689486319"&gt;結論&lt;/h2&gt;&lt;p&gt;  還是一樣，先從我自己整個總結開始，有興趣可以再往下看。   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486855"&gt;給非資訊學生介紹還是要多點讓他們實作 - 但是要控制好速度&lt;/h3&gt;&lt;p&gt;  這個課程的目的以我來說是讓他們了解有版控這種工具，並且如何讓他們日常使用。   &lt;/p&gt;&lt;p&gt;  所以我的主題都是不求多了解一些背後的原理，只要能夠開始使用，並且興趣是最好的老師，如果有興趣至少給一個好的開始。   &lt;/p&gt;&lt;p&gt;  因此除了必要的基礎概念之外，這次還特別提到github因為搭配一個線上履歷的製作可以把整個學習到的東西串起來。   &lt;/p&gt;&lt;p&gt;  有讓學員實作有時候時間不太好控制，因為學員程度不同有時候容易學員容易就跟丟了，麻煩是一跟丟不一定容易追的上來。   &lt;/p&gt;&lt;p&gt;  因此簡報的&lt;strong&gt;&lt;em&gt;實作步奏&lt;/em&gt;&lt;/strong&gt;很重要 - 要寫清楚他們比較好追上來。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486886"&gt;可以發現回饋有點兩極&lt;/h3&gt;&lt;p&gt;   有些學員回饋比較難跟得上，但是有些覺得其實很容易並且因為有實作所以是這個系列最容易理解的課程。    &lt;/p&gt;&lt;p&gt;   這個和上面那點有關係，還是簡報要清楚一點，讓他們跟不上的時候可以自己追上。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486394"&gt;很開心有些學員因此對Visual studio code有興趣&lt;/h3&gt;&lt;p&gt;   這些學生其實都沒有資訊背景，但是因為有用VS code改html、markdown和直接commit，因此有學員因此對VS Code搭配有興趣。    &lt;/p&gt;&lt;p&gt;   這是我有點始料未及，雖然初衷是希望他們能夠對提到的不同技術有興趣，但是沒想到會對VS Code有興趣。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486921"&gt;課程還是要有點實作比較好&lt;/h3&gt;&lt;p&gt;   有學員回復到這個課程有實作並且最後有個線上履歷其實比較有成就感 - 因此安排這種課程還是最好有個成果比較好。    &lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500934689486270"&gt;詳細數據&lt;/h2&gt;&lt;p&gt;  整個課程總共有20個人，不過到了我這堂的時候總共剩下6個。   &lt;/p&gt;&lt;p&gt;  6個學員都有給我回饋，所以回收率是100%   &lt;/p&gt;&lt;p&gt;  數字類型的回答都是數字越大越好   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486505"&gt;整體感覺&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-bxF-RF6SXao/WXZ5OwEVzeI/AAAAAAAAWC8/CInGdGyhuQ0gZ8Gv8VQOU0y2cKgkSQneACHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="277" title="2堂的整體感覺 - 2極剛好一半一半" style="display: inline; background-image: none;" alt="2堂的整體感覺 - 2極剛好一半一半" src="https://lh3.googleusercontent.com/-SON2fCjsok8/WXZ5P9F8CNI/AAAAAAAAWDA/-QsZ0kYkoFYiBKWp4APjh0NE7QHMhlhVwCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;2堂的整體感覺 - 2極剛好一半一半&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-a9bqcotzQIU/WXZ5Q6n5DnI/AAAAAAAAWDE/WdlhaMBAm4UPHgPQRaJzr6udqWR2uRJHACHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="654" height="277" title="整理的難易度 - 和整體感覺成正比，可能因為太難理解所以感覺不好" style="display: inline; background-image: none;" alt="整理的難易度 - 和整體感覺成正比，可能因為太難理解所以感覺不好" src="https://lh3.googleusercontent.com/-x88WI_swBdo/WXZ5TCC4h9I/AAAAAAAAWDI/gBSOwivTigIknYLq-0ha6lD5U6zarM-1wCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整理的難易度 - 和整體感覺成正比，可能因為太難理解所以感覺不好&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ru0Gy8VrWPE/WXZ5UC020jI/AAAAAAAAWDM/Gh2lDjKBYA435JsDXsxBM0bM4K-jfoOCwCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="283" title="有沒有學到新的東西 - 很高興大部分都有學到新的東西" style="display: inline; background-image: none;" alt="有沒有學到新的東西 - 很高興大部分都有學到新的東西" src="https://lh3.googleusercontent.com/-rgm_wyw3KJA/WXZ5XCYVy0I/AAAAAAAAWDQ/x0E_bxaGKn8qFZJWJaCQdH4FFwYDGUodQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;有沒有學到新的東西 - 很高興大部分都有學到新的東西&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-BZtlafejiRk/WXZ5YRzdbCI/AAAAAAAAWDU/qYGC161eT3Azi4jVPR-X2zEscvas4oiPwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="287" title="整體會不會無聊 - 各項都有，可能節奏上面控制不夠好" style="display: inline; background-image: none;" alt="整體會不會無聊 - 各項都有，可能節奏上面控制不夠好" src="https://lh3.googleusercontent.com/-aTOk_17jyek/WXZ5avh6EdI/AAAAAAAAWDY/6qvHNFlCiLgPz6CsgOyQVdmwsXz4-KXjgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整體會不會無聊 - 各項都有，可能節奏上面控制不夠好&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   整體來說分兩邊，一邊覺得很好，一邊覺得還好 - 或許和感覺太難有關。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486922"&gt;最有...&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZFInrS84iBc/WXZ5bvtMWMI/AAAAAAAAWDc/NSu5-TMbazMblVpmV1ZtgnXHqpZEzAJEACHMYCw/s1600-h/image%255B17%255D"&gt;&lt;img width="654" height="253" title="最有印象 - 有人說VS code耶" style="display: inline; background-image: none;" alt="最有印象 - 有人說VS code耶" src="https://lh3.googleusercontent.com/-u0zXSbjk2ZE/WXZ5dIGva5I/AAAAAAAAWDg/8HzjZRtr2bw40VS5TYZb9zKbSrF2OKfLQCHMYCw/image_thumb%255B5%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最有印象 - 有人說VS code耶&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Yf44mhl12pI/WXZ5d1ZCwXI/AAAAAAAAWDk/1uhRFHL7jqMg4K99R-xVGW2to4_ha6hCwCHMYCw/s1600-h/image%255B20%255D"&gt;&lt;img width="654" height="219" title="最聽不懂" style="display: inline; background-image: none;" alt="最聽不懂" src="https://lh3.googleusercontent.com/-xTke3HGsL_Y/WXZ5e3sEi5I/AAAAAAAAWDo/rqBdrDrCabsF0p7OUWVsPu3Se6yldGtwQCHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最聽不懂&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;   有對VS Code有興趣還蠻特別。不過另外一個提到VS code和github溝通 - 這個部分其實只有口頭提到，大部分還是用TortoiseGit在操作    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486560"&gt;簡報和demo&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-G-IqvyeZ4Qo/WXZ5gba7s2I/AAAAAAAAWDs/99slmCYOVjQlmBg6KcmbN0eymM-V2o5hACHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img width="654" height="242" title="簡報有些比喻有沒有覺得很難理解？有沒有什麼其他建議？ - 有個提到有時候有點快，或許因為這樣所以不好理解？" style="display: inline; background-image: none;" alt="簡報有些比喻有沒有覺得很難理解？有沒有什麼其他建議？ - 有個提到有時候有點快，或許因為這樣所以不好理解？" src="https://lh3.googleusercontent.com/-3lWep1Nu_K8/WXZ5jH3KAnI/AAAAAAAAWDw/5ce00yiCK1gMLDS7qoM3jB5ejMLmvSAqgCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;簡報有些比喻有沒有覺得很難理解？有沒有什麼其他建議？ - 有個提到有時候有點快，或許因為這樣所以不好理解？&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Tsbb4nbyQ0U/WXZ5kj3576I/AAAAAAAAWD0/MztueW6k6pofYbfVcK49fcHXypXHzaGegCHMYCw/s1600-h/image%255B26%255D"&gt;&lt;img width="654" height="232" title="簡報結構/順序有沒有需要調整的？- 有點和上面結果互斥，不過其中有個提到要詳細步奏這個後來我補上了" style="display: inline; background-image: none;" alt="簡報結構/順序有沒有需要調整的？- 有點和上面結果互斥，不過其中有個提到要詳細步奏這個後來我補上了" src="https://lh3.googleusercontent.com/-IWOtXsNuq9k/WXZ5oua8ozI/AAAAAAAAWD4/4d33nW1UYNgbzrFy65H04Fr7R3H2zaTEgCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;簡報結構/順序有沒有需要調整的？- 有點和上面結果互斥，不過其中有個提到要詳細步奏這個後來我補上了&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4Ec8Frcid8c/WXZ5q7EUptI/AAAAAAAAWD8/0KMp4iS1TB420QSXS8HsDT7w_yBuG8epQCHMYCw/s1600-h/image%255B29%255D"&gt;&lt;img width="654" height="186" title="Demo的部分有沒有什麼建議？ - 字體的部分或許下次考慮廣播，或者在調整一下縮放" style="display: inline; background-image: none;" alt="Demo的部分有沒有什麼建議？ - 字體的部分或許下次考慮廣播，或者在調整一下縮放" src="https://lh3.googleusercontent.com/-y5tpRM93rEc/WXZ5tebH6aI/AAAAAAAAWEA/hUSEKZR6u3MmAMGiSZt7A2W73GE_4eS5QCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;Demo的部分有沒有什麼建議？ - 字體的部分或許下次考慮廣播，或者在調整一下縮放&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-27zKw8t-MjM/WXZ5uM9I35I/AAAAAAAAWEE/rjgyb6Rhz7YD81BdwQA4Q8oy3dFGgQzRgCHMYCw/s1600-h/image%255B32%255D"&gt;&lt;img width="654" height="180" title="那個部分覺得最無聊？ - 還蠻高興聽到有成就感" style="display: inline; background-image: none;" alt="那個部分覺得最無聊？ - 還蠻高興聽到有成就感" src="https://lh3.googleusercontent.com/-qJk-9qQuux8/WXZ5ynhHE9I/AAAAAAAAWEI/-YHDn6pEfpo5J-pP4annYWTbgvmQTijXwCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;那個部分覺得最無聊？ - 還蠻高興聽到有成就感&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500934689486247"&gt;未來加深和其他建議&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-zvNLDno52I8/WXZ5zvE-oSI/AAAAAAAAWEM/30nztAEhYMEo70KUbO6Z_pG4hqmSNHuXQCHMYCw/s1600-h/image%255B35%255D"&gt;&lt;img width="654" height="183" title="有沒有什麼內容希望在加深說明？ 大部分對github深入有興趣和Visual studio code" style="display: inline; background-image: none;" alt="有沒有什麼內容希望在加深說明？ 大部分對github深入有興趣和Visual studio code" src="https://lh3.googleusercontent.com/-ZW6TRQ3Hf2U/WXZ51L-q4LI/AAAAAAAAWEQ/NdTu5g8wIX0WKufiWuPZt-QQNzUyONrXwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;有沒有什麼內容希望在加深說明？ 大部分對github深入有興趣和Visual studio code&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mOfhdN3gYIY/WXZ52Pmn91I/AAAAAAAAWEU/d3nbLwKGRZ47v-Kso0Fg8h1ogQop6mc3ACHMYCw/s1600-h/image%255B38%255D"&gt;&lt;img width="654" height="297" title="如果未來有相關課程，您會希望的形式是： - 果然還是希望實作多一些" style="display: inline; background-image: none;" alt="如果未來有相關課程，您會希望的形式是： - 果然還是希望實作多一些" src="https://lh3.googleusercontent.com/-rQjUMvxunSU/WXZ520nwXgI/AAAAAAAAWEY/Owa6JBaHoj0YqyVISxIj9e3VfCO669FBQCHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;如果未來有相關課程，您會希望的形式是： - 果然還是希望實作多一些&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Si2vGei_ql4/WXZ53sNcxbI/AAAAAAAAWEc/JqrENDDT_Wc-6XSXM-ruLF99JYuDmzYtACHMYCw/s1600-h/image%255B41%255D"&gt;&lt;img width="654" height="193" title="其他任何建議 - 雖然有點難過有學員提到還是不清楚如何使用，不過聽到有些覺得有滿滿收穫其實立馬補充回來" style="display: inline; background-image: none;" alt="其他任何建議 - 雖然有點難過有學員提到還是不清楚如何使用，不過聽到有些覺得有滿滿收穫其實立馬補充回來" src="https://lh3.googleusercontent.com/-kilHrG72XVA/WXZ54vPUTgI/AAAAAAAAWEg/9D4nvMw1QnoNEyyDypHtDkg6IOb3Pb4mgCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;其他任何建議 - 雖然有點難過有學員提到還是不清楚如何使用，不過聽到有些覺得有滿滿收穫其實立馬補充回來&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500934689486117"&gt;結語&lt;/h2&gt;&lt;p&gt;  整體來說我覺得這次是在簡報製作上面不夠細緻 - 或許這個是實作類型要特別注意的地方。   &lt;/p&gt;&lt;p&gt;  不過雖然有學員說不知道如何用在日常有點難過，但是同時也有學員說很有成就感讓我覺得還是算有小成功。   &lt;/p&gt;&lt;p&gt;  希望未來還有機會，回饋會都是正面評價。   &lt;/p&gt;&lt;p&gt;  也謝謝學員給的寶貝回饋建議。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:4606c393-3939-449c-81b5-c77b334676e1" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%9b%9e%e9%a1%a7%e3%80%8d" rel="tag"&gt;「回顧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e7%b0%a1%e5%a0%b1%e3%80%8d" rel="tag"&gt;「簡報」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/markdown" rel="tag"&gt;markdown&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/visual+studio+code" rel="tag"&gt;visual studio code&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8132513255124894052/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/07/review-20170704-fcu-git-beginner-presentaion.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8132513255124894052'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8132513255124894052'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-20170704-fcu-git-beginner-presentaion.html' title='[回顧][課程]20170704-20170705-電子內容管理 使用Git 與 github'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-1JcUvYTIIqg/WXZ5Nm-iSZI/AAAAAAAAWC4/_1soJwEDGqIF_h9yzd_Apqpy2hRoORZgwCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3614773393769547761</id><published>2017-07-23T22:57:00.000+08:00</published><updated>2017-07-23T22:59:03.803+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://www.blogger.com/atom/ns#' term='best practices'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>該怎麼開專案的資料夾結構？每個專案應該要有的資料夾結構和檔案</title><content type='html'>&lt;section&gt;&lt;figure&gt;  &lt;a href="https://lh3.googleusercontent.com/-a7ZZO4VOGmM/WXS4iikVg-I/AAAAAAAAWCU/uaoAaJUarD8I-1smPrYKQb28dm9jNZxtwCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="290" title="image" style="display: inline; background-image: none;" alt="該怎麼開專案的資料夾結構？" src="https://lh3.googleusercontent.com/-TelksbiCLJE/WXS4kbsC8fI/AAAAAAAAWCY/i6NywR60lvYnDEi6JypuBD5q3Gl12p_AgCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;圖片來源：&lt;a href="https://pixabay.com/en/key-tag-security-label-symbol-2114047/"&gt;https://pixabay.com/en/key-tag-security-label-symbol-2114047/&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;每當需要建立一個新的專案的時候，最長遇到的問題就是，我的 &lt;strong&gt;&lt;em&gt;資料夾應該怎麼開&lt;/em&gt;&lt;/strong&gt;、&lt;strong&gt;&lt;em&gt;有哪些檔案是必須要存在&lt;/em&gt;&lt;/strong&gt;。   &lt;/p&gt;&lt;p&gt;對於初學者來說，可能會覺得這有什麼好難的，我就visual studio開起來，然後建立一個專案就可以開始工作了，範例不都是這樣開的嗎？   &lt;/p&gt;&lt;p&gt;這個為什麼很重要呢？假設有些必要的檔案沒有建立，除了在開發上會造成負擔（例如缺少git忽略檔案），在之後自己回來看的時候就要花很多時間去找。例如文件在哪裡？專案的變更記錄在哪裡？ci的自動化build script在哪裡？   &lt;/p&gt;&lt;p&gt;如果每個專案的結構和內容相近的話，不僅讓找資料更加方便，也能提醒自己有些東西需要補（例如萬惡的文件XD）。   &lt;/p&gt;&lt;p&gt;這篇將會介紹每個專案應該要有的資料夾結構和應該要有的檔案，讓未來在建立專案的時候不會忘記。   &lt;/p&gt;&lt;p&gt;最後，在實際進入之前，和任何軟體開發一樣，這個有很重的個人喜好（personal preference）在裡面，所以可能和各位習慣不同，由我先拋磚引玉，如果有不同想法和更好建議也歡迎提出來。   &lt;/p&gt;&lt;p&gt;關鍵字:專案結構、開專案資料夾、project strcture、特殊檔案   &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;參考的repo：&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo"&gt;mhat-common-boilerplate-repo&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;    &lt;section&gt; &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048576" ;=""&gt;好的專案結構的重要性&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048649" ;=""&gt;可參考的應該要有的專案結構&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048431" ;=""&gt;應該要有的資料夾結構&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048878" ;=""&gt;build&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048160" ;=""&gt;docs&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048765" ;=""&gt;src&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048501" ;=""&gt;tools&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048207" ;=""&gt;應該要有的檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048385" ;=""&gt;.gitignore&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048633" ;=""&gt;.gitattributes&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048338" ;=""&gt;README.md&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048927" ;=""&gt;最好要有的檔案&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048785" ;=""&gt;LICENSE.md&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048856" ;=""&gt;CONTRIBUTING.md&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048900" ;=""&gt;CHANGELOG.md&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048585" ;=""&gt;CODE_OF_CONDUCT.md&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048961" ;=""&gt;ISSUE_TEMPLATE&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896048374" ;=""&gt;NEW_PULL_REQUEST&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1500820896049674" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;br /&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;br /&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896048576"&gt;好的專案結構的重要性&lt;/h2&gt;&lt;p&gt;在進入正題之前，還是要先說說為什麼這件事情很重要。   &lt;/p&gt;&lt;p&gt;先給大家一個例子：我常常在非我自己建立的專案裡面最長發現漏掉的就是 &lt;code&gt;.gitignore&lt;/code&gt;檔案 - 這個檔案是git版控會用來忽略不要進入版控的一個設定檔案。沒有這個會造成什麼後果？每一次build之後，一堆bin底下的dll   都會變成有變更。   &lt;/p&gt;&lt;p&gt;如果仔細一點的工程師，在commit的時候會知道不要上這些東西，如果commit不看就一股腦就上上去了，造成的後果是不止專案空間比較大，未來在追蹤log的時候有很多雜訊，浪費判斷時間。   &lt;/p&gt;&lt;p&gt;同樣，除了和開發有直接關係的這種之外，一些專案訊息類型的也很重要，例如專案的變更記錄 - 請問你怎麼知道1.3版本和1.2版本從功能面差多少？（下面我會在詳細提這個部分）   或者是你這個專案的文件在哪裡？   &lt;/p&gt;&lt;p&gt;這些其實都是因為在開專案的時候，專案缺少了好的結構和一些檔案。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896048649"&gt;可參考的應該要有的專案結構&lt;/h2&gt;&lt;p&gt;我有建立了一個github的repo，裡面包含了一個專案應該要有的結構，和每一個檔案裡面應該要有的內容。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;ul&gt;&lt;li&gt;專案位置：&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo"&gt;mhat-common-boilerplate-repo&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;假設你自己要建立一個專案，可以透過以下的powershell指令快速從這個專案下載下來並且init自己的專案結構   &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git clone https://github.com/alantsai/mhat-common-boilerplate-repo.git&lt;br /&gt;cd mhat-common-boilerplate-repo&lt;br /&gt;rm .git -Recurse -Force&lt;br /&gt;git init&lt;br /&gt;git add -A&lt;br /&gt;git commit -m "init project"&lt;/pre&gt;然後改對應檔案的一些內容描述以符合你的專案內容。更詳細介紹可以參考專案的&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo#不包含這個專案的歷史記錄"&gt;說明&lt;/a&gt;&lt;p&gt;下面會針對裡面的每一個資料夾和檔案做說明。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896048431"&gt;應該要有的資料夾結構&lt;/h2&gt;&lt;p&gt;首先是資料夾的部分，每一個專案至少要有：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;build&lt;/li&gt;&lt;li&gt;docs&lt;/li&gt;&lt;li&gt;src&lt;/li&gt;&lt;li&gt;tools&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048878"&gt;build&lt;/h3&gt;&lt;p&gt;這邊我對build的定義是和建制這個專案有關的一些script檔或者建制過程產生的一些臨時檔案可以放的地方。    &lt;/p&gt;&lt;p&gt;我習慣性會把build script例如建立nuget或者執行測試放到一個自己的獨立資料夾，而這裡就是那個地方。    &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048160"&gt;docs&lt;/h3&gt;&lt;p&gt;放文件的地方，有些習慣用&lt;code&gt;doc&lt;/code&gt; - 不過很多專案都有加s，所以這邊是有加s的版本    &lt;/p&gt;&lt;p&gt;原則上任何專案都應該有文件，而文件可以放在另外一個地方，但是最好是用markdown和專案放在一起，這樣也可以順便版控文件    &lt;/p&gt;&lt;p&gt;整個結構大概會是：    &lt;/p&gt;&lt;pre class="brush: plain;"&gt;docs&lt;br /&gt;   |--asset&lt;br /&gt;   |--topic 1&lt;br /&gt;     |--asset&lt;br /&gt;     |--sub topic 1&lt;br /&gt;       |--...&lt;br /&gt;     |--README.md&lt;br /&gt;   |-README.md&lt;br /&gt;   |-SUMMARY.md&lt;/pre&gt;&lt;p&gt;說明一下：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      asset     &lt;/dt&gt;&lt;dd&gt;      這個資料夾用來放markdown裡面用到的圖片或者檔案 - 方便鏈接過去      &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      README.md     &lt;/dt&gt;&lt;dd&gt;      這個是每一個chapter或者每一個部分的起始頁，有點類似&lt;code&gt;index.html&lt;/code&gt;在網站的地位     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      SUMMARY.md     &lt;/dt&gt;&lt;dd&gt;      這個則是整個文件的目錄的概念      &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048765"&gt;src&lt;/h3&gt;&lt;p&gt;這個就是主要放程式碼的地方，有些專案會叫他&lt;code&gt;lib&lt;/code&gt;或&lt;code&gt;app&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;裡面的資料結構大概會是：    &lt;/p&gt;&lt;pre class="brush: plain;"&gt;src&lt;br /&gt;   |--{project name}.Bll&lt;br /&gt;   |--{project name}.Web&lt;br /&gt;   |-- ...&lt;br /&gt;   |-{project name}.sln&lt;/pre&gt;&lt;p&gt;說明一下：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;     {project name}     &lt;/dt&gt;&lt;dd&gt;      這個指的是專案名稱，例如假設我今天有一個xxx專案的網站，那麼我就會有 &lt;code&gt;xxx.Bll&lt;/code&gt;作為bll層的&lt;code&gt;csproj&lt;/code&gt;位置，&lt;code&gt;xxx.Web&lt;/code&gt;作為網站的&lt;code&gt;csproj&lt;/code&gt;位置。     &lt;/dd&gt;&lt;dt&gt;     {project name}.sln     &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;src&lt;/code&gt;進去之後的唯一檔案就是他，這樣不僅很明確如何開啟這個專案，如果有多個sln也不會混在一起     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;一般我在開專案的時候，我建立的都會是一個&lt;code&gt;blank solution&lt;/code&gt;（只有sln） - 然後我會把它手動拉倒&lt;code&gt;src&lt;/code&gt;下面，這樣之後建立的&lt;code&gt;csproj&lt;/code&gt;專案的結構就會像描述那樣。    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048501"&gt;tools&lt;/h3&gt;&lt;p&gt;這個資料夾我會放一些工具類的內容。例如說網站都要套版，ui就會放在裡面。    &lt;/p&gt;&lt;p&gt;假設有用到一些第三方的dll或者exe也可以放在這邊    &lt;/p&gt;&lt;/section&gt;&lt;p&gt;以上是關於資料夾結構的部分，也可以參考一些說明像是&lt;a href="https://github.com/kriasoft/Folder-Structure-Conventions"&gt;Folder-Structure-Conventions&lt;/a&gt;這個專案就是在介紹這些內容。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896048207"&gt;應該要有的檔案&lt;/h2&gt;&lt;p&gt;介紹完應該要有的資料夾結構，接下來就是檔案啦，一定要有的會有：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;.gitignore&lt;/li&gt;&lt;li&gt;.gitattributes&lt;/li&gt;&lt;li&gt;README.md&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048385"&gt;.gitignore&lt;/h3&gt;&lt;p&gt;.gitignore基本上就是git的忽略檔案 - 忽略那些不要進入版控的檔案。     &lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;這個為什麼重要？&lt;/em&gt;&lt;/strong&gt;除了可以讓git的repo小一點之外，也可以避免每一次commit看到一堆修改，或者是在追log的時候看到一些“雜訊”。    &lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;什麼才應該commit到git裡面？&lt;/em&gt;&lt;/strong&gt;基本上只要是可以 &lt;strong&gt;&lt;em&gt;重新建立出來的都應該進入忽略檔案&lt;/em&gt;&lt;/strong&gt;。例如build出來的bin檔案。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;在github上面有個專案專門放那些語言和環境應該忽略什麼&lt;a href="https://github.com/github/gitignore"&gt;https://github.com/github/gitignore&lt;/a&gt;。我這邊的gitignore也是組合這個repo裡面的內容。    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048633"&gt;.gitattributes&lt;/h3&gt;&lt;p&gt;這個檔案能夠設定git在操作某些檔案的時候要做那些處理。    &lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;為什麼重要？&lt;/em&gt;&lt;/strong&gt;還記得之前有一篇介紹關於斷行的問題：&lt;a href="http://blog.alantsai.net/2017/07/git-normalize-line-ending.html"&gt;[git]為什麼常出現有修改但是比對不卻顯示不出差異？談談檔案斷行問題和如何達到不同平台正確一致化&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048338"&gt;README.md&lt;/h3&gt;&lt;p&gt;這個檔案就好比以前一包html裡面&lt;code&gt;index.html&lt;/code&gt;的概念 - 所有資訊的入口都在這個檔案。     &lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;為什麼重要？&lt;/em&gt;&lt;/strong&gt;如果沒有一個入口，根本無法快速上手這個專案。尤其目前各個git host都會預設呈現這個檔案的內容。    &lt;/p&gt;&lt;p&gt;在這個檔案裡面，一般來說會有幾個內容：    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;      介紹專案的目的     &lt;/dt&gt;&lt;dd&gt;      每個專案都有特定目的，介紹清楚可以讓後來看的時候馬上知道這個專案是不是你在找的那個專案。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      專案狀態的badge     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;例如目前最新版本的build狀態，還是透過gitter溝通的網址，這些都可以用badge快速呈現讓使用者一看知道一些資訊。     &lt;/p&gt;&lt;p&gt;badge可以參考&lt;a href="http://shields.io/"&gt;http://shields.io/&lt;/a&gt;&lt;/p&gt;&lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      如何快速上手     &lt;/dt&gt;&lt;dd&gt;      怎麼讓人能夠快速使用這個專案，例如透過nuget安裝然後使用     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;      其他資訊的鏈接     &lt;/dt&gt;&lt;dd&gt;      例如要看文件提供一個鏈接連到&lt;code&gt;docs&lt;/code&gt;的&lt;code&gt;README.md&lt;/code&gt;檔案；看變更記錄提供鏈接到對應檔案。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;網路上蠻多&lt;code&gt;README.md&lt;/code&gt;的範例（例如這個&lt;a href="https://github.com/fraction/readme-boilerplate"&gt;https://github.com/fraction/readme-boilerplate&lt;/a&gt;）大家都可以參考一下    &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;我專案的ReadMe裡面都有說明每一個部分應該寫的內容。    &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896048927"&gt;最好要有的檔案&lt;/h2&gt;&lt;p&gt;接下來介紹的檔案都是最好要有類型的檔案，有些可能和open source比較有關，所以不一定都會放，但是和大家做個極少。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，這些特殊類型的檔案預設都會是&lt;em&gt;全大寫&lt;/em&gt;，例如&lt;code&gt;README.md&lt;/code&gt;，不過也沒有一定規定，所以還是看個人喜好。   &lt;/div&gt;&lt;p&gt;總共會介紹：   &lt;/p&gt;&lt;ul&gt;&lt;li&gt;LICENSE.md&lt;/li&gt;&lt;li&gt;CONTRIBUTING.md&lt;/li&gt;&lt;li&gt;CHANGELOG.md&lt;/li&gt;&lt;li&gt;CODE_OF_CONDUCT.md&lt;/li&gt;&lt;li&gt;ISSUE_TEMPLATE&lt;/li&gt;&lt;li&gt;NEW_PULL_REQUEST&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048785"&gt;LICENSE.md&lt;/h3&gt;&lt;p&gt;這個很明顯就是open source專案會用到的，明確告訴使用者你的授權模式。    &lt;/p&gt;&lt;p&gt;一般來說，如果只是希望版權是你的，但是允許大家做任何修改並且沒有其他限制，那麼&lt;code&gt;MIT&lt;/code&gt;最適合。    &lt;/p&gt;&lt;p&gt;MIT的license很簡單，就是一段話，把名字改成自己的的名字和年份改成對應年份就好。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;ol&gt;&lt;li&gt;       如果不知道該選什麼作為license，可以參考github建立的一個網站：&lt;a href="https://choosealicense.com/"&gt;https://choosealicense.com/&lt;/a&gt;&lt;/li&gt;&lt;li&gt;        其他相關資訊可以參考：&lt;a href="https://opensource.guide/legal/#which-open-source-license-is-appropriate-for-my-project"&gt;lisense opensource project&lt;/a&gt;、       &lt;a href="https://help.github.com/articles/licensing-a-repository/"&gt;Licensing a repository&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;提醒大家，我不是法律人士，所以對這種授權也可能理解有錯，所以如果你對於你的授權有疑慮，最好還是請教相關的法律專業人士。    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048856"&gt;CONTRIBUTING.md&lt;/h3&gt;&lt;p&gt;這個檔案基本上是介紹如何貢獻到你的專案。    &lt;/p&gt;&lt;p&gt;貢獻有很多形式，例如：    &lt;/p&gt;&lt;ol&gt;&lt;li&gt;翻譯&lt;/li&gt;&lt;li&gt;寫文件&lt;/li&gt;&lt;li&gt;改code - 介紹如何build和改code&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;這邊也可以提供一些專案目標（roadmap）的資訊，讓其他人知道你的目標。 &lt;/p&gt;&lt;p&gt;也可以提到一些這個專案&lt;em&gt;不接受&lt;/em&gt;什麼貢獻，避免有人不清楚一直問。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多參考資訊：     &lt;ol&gt;&lt;li&gt;&lt;a href="https://opensource.guide/starting-a-project/#writing-your-contributing-guidelines"&gt;writing有人contributing guidelines&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://github.com/nayafia/contributing-template/blob/master/CONTRIBUTING-template.md"&gt;contributing template&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://mozillascience.github.io/working-open-workshop/contributing/"&gt;Mozila contributing guidelines&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://github.com/blog/1184-contributing-guidelines"&gt;github contributing guidelines&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048900"&gt;CHANGELOG.md&lt;/h3&gt;&lt;p&gt;專案的變更記錄檔案。    &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;&lt;em&gt;&lt;strong&gt;這個檔案為什麼重要？&lt;/strong&gt;&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;     是否能夠讓人家一眼了解版號之間變更的主要目的就是這個檔案要傳達的消息。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;em&gt;&lt;strong&gt;和git的log有什麼差別？&lt;/strong&gt;&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;     切記，git log是細部的說明每次調整什麼，但是這個檔案則是從大局來看到底變動了什麼，所以他絕對不是git log貼上去就好。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;em&gt;&lt;strong&gt;github 的 release不就可以寫說明，幹嘛還要有這個檔案？&lt;/strong&gt;&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;      github release非常巧妙的利用了git tag的資訊讓大家方便找每一個release，但是問題是    假設今天你的repo要搬到別的地方去呢，假設那個hosting不支援release的時候要怎麼辦？因此這個檔案提供一種&lt;em&gt;萬用（universal）資訊的提供位置&lt;/em&gt;。     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;dt&gt;&lt;em&gt;這個檔案應該些什麼？&lt;/em&gt;&lt;/dt&gt;&lt;dd&gt;      基本上，每一個版號會有個時間記錄，然後這個版號下面會有 對應的 變更類型（&lt;code&gt;Added&lt;/code&gt;、&lt;code&gt;Changed&lt;/code&gt;、&lt;code&gt;Deprecated&lt;/code&gt;、&lt;code&gt;Removed&lt;/code&gt;、&lt;code&gt;Fixed&lt;/code&gt;和      &lt;code&gt;Security&lt;/code&gt;）     &lt;/dd&gt;&lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多關於格式的部分可以參考：&lt;a href="http://keepachangelog.com/en/1.0.0/"&gt;Keep a changelog&lt;/a&gt;（也有中文，進去右上角可以切換語言，提供英文鏈接因為是最新內容）    &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048585"&gt;CODE_OF_CONDUCT.md&lt;/h3&gt;&lt;p&gt;這個是大家在這個repo合作的合作公約。    &lt;/p&gt;&lt;p&gt;不過說實話，我個人覺得意義比較沒那麼大，所以我的範例repo沒有放。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;相關資訊可以參考：&lt;a href="https://opensource.guide/code-of-conduct/"&gt;https://opensource.guide/code-of-conduct/&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048961"&gt;ISSUE_TEMPLATE&lt;/h3&gt;&lt;p&gt;這個是github上面才會吃的檔案，當使用者建立一個issue，會有一個範本跑出來。這個檔案就是定義範本內容。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;詳細資訊參考github：&lt;a href="https://github.com/blog/2111-issue-and-pull-request-templates"&gt;https://github.com/blog/2111-issue-and-pull-request-templates&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1500820896048374"&gt;NEW_PULL_REQUEST&lt;/h3&gt;&lt;p&gt;一樣是github上面才會吃的檔案，當使用者建立一個pull request呈現的內容，這個範本就是定義那些內容。    &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;詳細資訊參考github：&lt;a href="https://github.com/blog/2111-issue-and-pull-request-templates"&gt;https://github.com/blog/2111-issue-and-pull-request-templates&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;p&gt;以上就是這些特殊檔案的說明。其他參考資訊：&lt;a href="https://github.com/kmindi/special-files-in-repository-root"&gt;https://github.com/kmindi/special-files-in-repository-root&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1500820896049674"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇介紹了專案應該要有的結構和一些特殊檔案的使用說明。希望未來對於大家在建立專案的時候有幫助。   &lt;/p&gt;&lt;p&gt;當然，這個和個人喜好有非常大的關係，所以由我先和大家拋磚引玉一下，也希望大家給我一些回饋。 &lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:23f38e24-ba23-4318-8458-963953f68e55" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/C%23" rel="tag"&gt;C#&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/FAQ" rel="tag"&gt;FAQ&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/best+practices" rel="tag"&gt;best practices&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3614773393769547761/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/07/net-project-structure.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3614773393769547761'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3614773393769547761'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/net-project-structure.html' title='該怎麼開專案的資料夾結構？每個專案應該要有的資料夾結構和檔案'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-TelksbiCLJE/WXS4kbsC8fI/AAAAAAAAWCY/i6NywR60lvYnDEi6JypuBD5q3Gl12p_AgCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-708873645690901389</id><published>2017-07-09T21:01:00.000+08:00</published><updated>2017-07-30T12:18:21.823+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='visual studio team service'/><category scheme='http://www.blogger.com/atom/ns#' term='「簡報」'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><category scheme='http://www.blogger.com/atom/ns#' term='「回顧」'/><title type='text'>[回顧][活動][Study4]20170624-大家應該都要會的工具 git - 從放棄到會用</title><content type='html'>&lt;section class="banner"&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6RAU75Xix_A/WWImJlGVtGI/AAAAAAAAV8Q/qhjEXuZtvw0929Zl9w2dumQVe7_9hDVQACHMYCw/s1600-h/image%255B4%255D"&gt;&lt;img width="654" height="345" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-8S6EY6ll998/WWImLS0awtI/AAAAAAAAV8U/-NtKpTIeoGkmioOj7BSGRClh5D1bi3pMwCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;在2017/06/24的時候非常有榮幸和大家在Study4的6月場次裡面介紹了git。      &lt;/p&gt;&lt;p&gt;我對於大家聽完的感想其實非常有興趣，因此做了一個問卷請大家幫忙填寫。      &lt;/p&gt;&lt;p&gt;大家都那麼認真幫我做了填寫，我當然也要認真的把大家的建議納入進去 - 因此這篇我將會對我看問卷的結果和自己時候思考到的問題總結一下，作為未來修正的參考。      &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1499603365963870"&gt;前情提要&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;活動相關資訊&lt;/dt&gt;&lt;dd&gt;&lt;a href="http://study4.tw/Activity/Details/6"&gt;Study4 6月活動&lt;/a&gt;&lt;/dd&gt;&lt;dt&gt;簡報主要內容&lt;/dt&gt;&lt;dd&gt;版控歷史介紹、gui和powershell操作、Visual Studio Team Service介紹、Visual Studio Code搭配呼叫&lt;/dd&gt;&lt;dt&gt;相關投影片&lt;/dt&gt;&lt;dd&gt;&lt;ul&gt;&lt;li&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/FTHpEfvOtZTgPg" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt;&lt;strong&gt; &lt;a href="//www.slideshare.net/alantsai2007/git-1-77281734" title="大家應該都要會的工具 Git 從放棄到會用1-基礎篇" target="_blank"&gt;大家應該都要會的工具 Git 從放棄到會用1-基礎篇&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a target="_blank" href="https://www.slideshare.net/alantsai2007"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/FKvLphwLzfkYc8" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt;&lt;strong&gt; &lt;a href="//www.slideshare.net/alantsai2007/git-2-77281730" title="大家應該都要會的工具 Git 從放棄到會用2-分支篇" target="_blank"&gt;大家應該都要會的工具 Git 從放棄到會用2-分支篇&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a target="_blank" href="https://www.slideshare.net/alantsai2007"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt;&lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963870" ;=""&gt;前情提要&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963891" ;=""&gt;結論&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963932" ;=""&gt;課程大綱說明難易度的部分不夠清楚&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963945" ;=""&gt;控制簡報時間不準確&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963875" ;=""&gt;簡報的內容要多做幾次review&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963563" ;=""&gt;大家對於git其實還滿有興趣&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963746" ;=""&gt;詳細數據&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365963623" ;=""&gt;場地和人員感官&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964555" ;=""&gt;版控使用經驗&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964790" ;=""&gt;整體感覺&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964527" ;=""&gt;使用git的方式 - cli vs gui&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964488" ;=""&gt;簡報內容和簡報的方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964374" ;=""&gt;未來相關課程&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1499603365964938" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;  &lt;a name='more'&gt;&lt;/a&gt;  &lt;section&gt;&lt;h2 id="WizKMOutline_1499603365963891"&gt;結論&lt;/h2&gt;&lt;p&gt;先講一下我自己最後的總結，如果對每個資料的部分有興趣在往下看。      &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365963932"&gt;課程大綱說明難易度的部分不夠清楚&lt;/h3&gt;&lt;p&gt;在回復問卷的人裡面，總共有&lt;em&gt;3個&lt;/em&gt;從來沒有使用過版控 - 因此在整體的理解度上面有&lt;em&gt;2個&lt;/em&gt;給了比較低的分數。甚至有人有提到說             如果他知道是這種內容，他根本不會考慮過來。         &lt;/p&gt;&lt;p&gt;如果考慮到問卷回復率，那麼很有可能其他沒有回復的有幾個也是這種情況。         &lt;/p&gt;&lt;p&gt;因此是否在未來提供課程大綱的時候能夠透過一些方法更明確的告知可能參加的人更多關於難易度的問題，例如說：             &lt;/p&gt;&lt;ul&gt;&lt;li&gt;提供一個這個課程難易度的指標 - 例如 雖然會從頭講，但是內容比較多，速度比較快&lt;/li&gt;&lt;li&gt;透過問卷了解期望聽到什麼內容&lt;/li&gt;&lt;li&gt;提供管道可以讓可能想參加的人詢問課程內容 - 或者先提供投影片&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365963945"&gt;控制簡報時間不準確&lt;/h3&gt;&lt;p&gt;在這次我的時間上來說應該是2個小時 - 但是那天實際花了簡報的時間大約是&lt;em&gt;2個小時40分鐘&lt;/em&gt; - 超過30分鐘 + 10 分鐘換堂休息。          &lt;/p&gt;&lt;p&gt;這個其實對後面的講師非常的不公平 - 因為整個會壓到別人的時間。          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365963875"&gt;簡報的內容要多做幾次review&lt;/h3&gt;&lt;p&gt;這次的簡報內容大概有至少3個地方有寫錯（雖然不是完全有錯，比較多是不夠精準），但是這個代表Review簡報的部分做的不夠細緻。          &lt;/p&gt;&lt;p&gt;題外話，問卷有發生被糾正錯字 - 比較丟臉 XD。這個我就比較沒有辦法，只能夠盡量 - 國文造詣不好。          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365963563"&gt;大家對於git其實還滿有興趣&lt;/h3&gt;&lt;p&gt;滿多人對於如果有後續課程其實還滿有興趣，尤其是如何使用rebase來整理版控記錄&lt;/p&gt;&lt;p&gt;如果是lab形式應該還會有興趣 - 因為有些提到希望有些操作&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1499603365963746"&gt;詳細數據&lt;/h2&gt;&lt;p&gt;這次總共有 36 個人報名 - 不太確定實際報道人數，不過這次有回復問卷的總共是10個人&lt;/p&gt;&lt;p&gt;因此大約1/3的問卷回收率&lt;/p&gt;&lt;p&gt;這邊我會把問卷項目的內容列出來。數字型的，都是大數字為好(例如：10最好)，小數字為不好(例如：1最差)      &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365963623"&gt;場地和人員感官&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4d4jowS3oEU/WWImNSXFE5I/AAAAAAAAV8Y/wgTmUinrEQQWESlJHq8YKQO7Eoo-9i8WwCHMYCw/s1600-h/image%255B7%255D"&gt;&lt;img width="654" height="285" title="人員感覺" style="display: inline; background-image: none;" alt="人員感覺" src="https://lh3.googleusercontent.com/-bRcjn_wJ3dw/WWImPDCnzkI/AAAAAAAAV8c/Jc6BCB4aWiYMilquZUJw6EWZdKZ1lVNTQCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-NdPiH3IKMg0/WWImQSFKX1I/AAAAAAAAV8g/TV8c2CULD-03SWL1qvr9jpSXdThQ0WqfgCHMYCw/s1600-h/image%255B10%255D"&gt;&lt;img width="654" height="281" title="場地感覺" style="display: inline; background-image: none;" alt="場地感覺" src="https://lh3.googleusercontent.com/-2EjBulcJAhg/WWImRs_nawI/AAAAAAAAV8k/dtnp27YWgB4_4NTYori64LxAcbN2SM7cgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;場地和工作人員感官&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;基本上對於整體感覺都不錯 - 不過有人對於場地滿意度有比較低，可惜這個部分沒有取得為什麼這樣的資訊。              （可能和沒有機會demo有關，比較低的剛好是有回復比較屬於沒用過版控的人）          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365964555"&gt;版控使用經驗&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-u7zgkCvJ_sk/WWImUJgTOFI/AAAAAAAAV8o/kCLr0wpAjMsy8AWnHgo4WXw0zb4_QJ8FwCHMYCw/s1600-h/image%255B15%255D"&gt;&lt;img width="654" height="387" title="是否使用過版控" style="display: inline; background-image: none;" alt="是否使用過版控" src="https://lh3.googleusercontent.com/-z2wBinW2Bpc/WWImWqOohTI/AAAAAAAAV8s/CeIz5ON261MZwx3exEmqzuT8_1z7SxAAgCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-6DmdXHDaMus/WWImZEsZSKI/AAAAAAAAV8w/ZjYMxk10ocsmcfCdHW4xgSx6BKYxNFJUwCHMYCw/s1600-h/image%255B18%255D"&gt;&lt;img width="654" height="386" title="是否使用過git" style="display: inline; background-image: none;" alt="是否使用過git" src="https://lh3.googleusercontent.com/-nFJdvFYjBNs/WWIma8hdxpI/AAAAAAAAV80/wMqCrU1vVHcIsP0xDbQQLOWQpLrzt2MUwCHMYCw/image_thumb%255B8%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;使用經驗，和是否用過git&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;滿特別的是有3個人沒有碰過版控 - 這裡面的其中2個有提到整體的吸收和學習就比較打了折扣。          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365964790"&gt;整體感覺&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-P37JlzHthqU/WWImcsqyEyI/AAAAAAAAV84/Ku4HzsaHHYw1vT9XRDItrUl1QWnnq8pmgCHMYCw/s1600-h/image%255B21%255D"&gt;&lt;img width="654" height="302" title="整體感覺" style="display: inline; background-image: none;" alt="整體感覺" src="https://lh3.googleusercontent.com/-vgeROHOhM8s/WWImfJJdmOI/AAAAAAAAV88/FZtjSdeILSQLSNKAUZRTTUpixH7441XuQCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6wUnDLz8uCM/WWImjNC6HjI/AAAAAAAAV9A/FJV-KS4kWqscZNUVTo_KNw7xLxDC75B9gCHMYCw/s1600-h/image%255B24%255D"&gt;&lt;img width="654" height="283" title="整理容易理解度" style="display: inline; background-image: none;" alt="整理容易理解度" src="https://lh3.googleusercontent.com/-zRXFIQoe7Ko/WWImnwH9SMI/AAAAAAAAV9E/ZtfLnAucdqYB-UrSpwRV_P7RXzPWL_auQCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-BEEy_9nsJs8/WWImrI2X8pI/AAAAAAAAV9I/2J7iP_bOAcY-fRxdTIPHUl8ZLjd9LJhqACHMYCw/s1600-h/image%255B27%255D"&gt;&lt;img width="654" height="290" title="學習到新的東西" style="display: inline; background-image: none;" alt="學習到新的東西" src="https://lh3.googleusercontent.com/-nWTh3Diei9s/WWImx6_6f6I/AAAAAAAAV9M/pPW5FCiX0Vwk1IR5p8-cgZw9_peeOCpjwCHMYCw/image_thumb%255B11%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-d6rFXfstsu4/WWImz8Wya7I/AAAAAAAAV9Q/xythVYe4P2ckGJnOzzswy6MuaxAiMgOgQCHMYCw/s1600-h/image%255B30%255D"&gt;&lt;img width="654" height="289" title="會不會無聊" style="display: inline; background-image: none;" alt="會不會無聊" src="https://lh3.googleusercontent.com/-sHtj_V9pi2Q/WWIm2GeOk5I/AAAAAAAAV9U/XUp1wobdVCsgwCsmwe__SQP_PCxyjib7ACHMYCw/image_thumb%255B12%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;整體感覺、理解度和學到新的東西&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;注意到有2個人的分數都比較低 - 剛好和沒有使用過版控的人對上          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365964527"&gt;使用git的方式 - cli vs gui&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-onRhXR6VOhY/WWIm4DOeGlI/AAAAAAAAV9Y/1TGGrfmRBWMYrou_yO0qwlmtiBtecm2QACHMYCw/s1600-h/image%255B33%255D"&gt;&lt;img width="654" height="345" title="使用git的方式" style="display: inline; background-image: none;" alt="使用git的方式" src="https://lh3.googleusercontent.com/-cPz6kGcrttQ/WWIm5UCwJTI/AAAAAAAAV9c/pU5WZKkE-_Yc4f5100wDtv3wi4myfpX3wCHMYCw/image_thumb%255B13%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;gui和powershell&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;可能這次回答都是工程師比較多，所以其實大家並不排斥cli - gui和cli基本上1半1半。          &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365964488"&gt;簡報內容和簡報的方式&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-XilBOhDopDg/WWIm6jpnHaI/AAAAAAAAV9g/RwwOQnFchwYGjkaO-M05VC2ONgr6fkIVACHMYCw/s1600-h/image%255B36%255D"&gt;&lt;img width="654" height="248" title="最有印象" style="display: inline; background-image: none;" alt="最有印象" src="https://lh3.googleusercontent.com/--ANUm0SDvJs/WWIm77TFVpI/AAAAAAAAV9k/XoJuB5rkoLIuyr2JOqEtatMo8yws6gevwCHMYCw/image_thumb%255B14%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-s91kJ-RWXT0/WWInAG4TgpI/AAAAAAAAV9o/PObuoBtPcTIXQed8E5mYsXpnscBxPdO7gCHMYCw/s1600-h/image%255B39%255D"&gt;&lt;img width="654" height="235" title="最聽不懂" style="display: inline; background-image: none;" alt="最聽不懂" src="https://lh3.googleusercontent.com/-b30LL4ZUR5I/WWInBmtDuOI/AAAAAAAAV9s/gsXrDJe8RfIQpVLqMycTN96tGX11WjM7wCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-RDDUkwU2H40/WWInDiwAbTI/AAAAAAAAV9w/YHgCpLE9bhUuTy3z30BU891A6CicWKGSwCHMYCw/s1600-h/image%255B42%255D"&gt;&lt;img width="654" height="187" title="比喻是佛難以理解" style="display: inline; background-image: none;" alt="比喻是佛難以理解" src="https://lh3.googleusercontent.com/-evhutjVaINg/WWInF3NfMBI/AAAAAAAAV90/ZDy_otzeDUE44KkoHmGBGCkJKn0N0omZgCHMYCw/image_thumb%255B16%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-jVWcOCAflAM/WWInHeJMGqI/AAAAAAAAV94/nF17HGzL8JcRGQpA0Vr5L1IN13o9pyvGACHMYCw/s1600-h/image%255B45%255D"&gt;&lt;img width="654" height="161" title="簡報結構" style="display: inline; background-image: none;" alt="簡報結構" src="https://lh3.googleusercontent.com/-GzjKbMkiJIM/WWInKNAuEmI/AAAAAAAAV98/WDUDH-CS_HsufiIx8bZG8LRFeDo4Z7TXgCHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-I_jEroUIHmQ/WWInLxiWFZI/AAAAAAAAV-A/ermvJ6G0kD0bOidNC1LmStL2Av5dLR_dACHMYCw/s1600-h/image%255B48%255D"&gt;&lt;img width="654" height="163" title="demo建議" style="display: inline; background-image: none;" alt="demo建議" src="https://lh3.googleusercontent.com/-POqHG3APGsg/WWInPzlampI/AAAAAAAAV-E/LXfSkyT38CktnhpjEs3tNRRtARvkZNaMQCHMYCw/image_thumb%255B18%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-SC0Dlm5JxRM/WWInSdxOS9I/AAAAAAAAV-I/jCkcAilDflcabKE8SwRg1NcjuB7pzyELgCHMYCw/s1600-h/image%255B51%255D"&gt;&lt;img width="654" height="158" title="哪裡最無聊" style="display: inline; background-image: none;" alt="哪裡最無聊" src="https://lh3.googleusercontent.com/-hlNZrUURoPY/WWInU_cgrrI/AAAAAAAAV-M/pZeYeQ_ht0ojjY9AwDq_dQz8R6SM3-SJgCHMYCw/image_thumb%255B19%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;最有印象、最聽不懂、比喻、結構和demo的部分&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol&gt;&lt;li&gt;demo的時候投影片字有點小 - 應該要多利用縮放的方式避免看不到&lt;/li&gt;&lt;li&gt;有些希望有些操作，要不然不容易記憶&lt;/li&gt;&lt;li&gt;有個比較丟臉是錯別字 - 把 &lt;code&gt;印象&lt;/code&gt; 打成了 &lt;code&gt;映像&lt;/code&gt; - 趕快改&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1499603365964374"&gt;未來相關課程&lt;/h3&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5iX_rl-mtOU/WWInYOjAdEI/AAAAAAAAV-Q/lvk4IcrCnuEcPzMMfyWAfjppvBwHYrmegCHMYCw/s1600-h/image%255B54%255D"&gt;&lt;img width="654" height="287" title="未來課程形式" style="display: inline; background-image: none;" alt="未來課程形式" src="https://lh3.googleusercontent.com/-pN7WwGynVqI/WWInZDnzl9I/AAAAAAAAV-U/7ovmElaX_loemXzV-9TmfLQqJo_CQ6d8QCHMYCw/image_thumb%255B20%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-2dO_lcXYzRc/WWInfqK3oMI/AAAAAAAAV-Y/Tbj_G4yVLdE7_M4J5smyekb1uO1Zeyd_wCHMYCw/s1600-h/image%255B57%255D"&gt;&lt;img width="654" height="272" title="是否想參加" style="display: inline; background-image: none;" alt="是否想參加" src="https://lh3.googleusercontent.com/-HEwtD8mOejg/WWInguXj50I/AAAAAAAAV-c/UDywABoEQpAb9YtbLB8NoRfKk3o2TgWCwCHMYCw/image_thumb%255B21%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-vxi7UjQ10Bg/WWInhht4K8I/AAAAAAAAV-g/iv_-hIbm5Gci_7rDejjjE6rVSOeNKv9vACHMYCw/s1600-h/image%255B60%255D"&gt;&lt;img width="654" height="279" title="加深課程的方向" style="display: inline; background-image: none;" alt="加深課程的方向" src="https://lh3.googleusercontent.com/-2Zt_8MaJD9k/WWIni8To_WI/AAAAAAAAV-k/ZvKrCcRdBrQzVK471Jgfi_2v6RpXoYB9ACHMYCw/image_thumb%255B22%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-kMRn8AJCxpE/WWInjw31OGI/AAAAAAAAV-o/qt-fKjWbD0AcvDjcuOeNV57dhzCQ67pSgCHMYCw/s1600-h/image%255B63%255D"&gt;&lt;img width="654" height="186" title="其他建議" style="display: inline; background-image: none;" alt="其他建議" src="https://lh3.googleusercontent.com/-tmYXJ7ri7P0/WWInmAwrFGI/AAAAAAAAV-s/Aq8tA_tQZ8YItyLiQPic4s-Q1tV8mt0rQCHMYCw/image_thumb%255B23%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;形式、參與度、內容和其他任何建議&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;可以看到大家對於未來相關課程其實都還是有興趣，形式來說希望demo的部分多一點。          &lt;/p&gt;&lt;p&gt;關於內容 - 大家對於 從舊的版控（svn或者tfs）轉到git和如何使用rebase感到有興趣。          &lt;/p&gt;&lt;p&gt;也很感謝有提醒我們鏈接有放到重複的問題&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1499603365964938"&gt;結語&lt;/h2&gt;&lt;p&gt;整體來說其實這次的分享我個人感覺不能算滿意，我覺得最大問題在於內容過於多，整個時間的控制也不夠好。      &lt;/p&gt;&lt;p&gt;希望透過這次大家的反饋下次的簡報能夠減少有反應的一些問題。      &lt;/p&gt;&lt;p&gt;最後也感謝那天參加的人和幫忙填寫問卷的人。&lt;/p&gt;&lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:e0adea59-80ae-403d-a470-cfcefcadec6e" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%e3%80%8c%e5%9b%9e%e9%a1%a7%e3%80%8d" rel="tag"&gt;「回顧」&lt;/a&gt;,&lt;a href="http://blog.alantsai.net/search/label/%E3%80%8C%E7%B0%A1%E5%A0%B1%E3%80%8D" rel="tag"&gt;「簡報」&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/708873645690901389/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html#comment-form' title='4 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html' title='[回顧][活動][Study4]20170624-大家應該都要會的工具 git - 從放棄到會用'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-8S6EY6ll998/WWImLS0awtI/AAAAAAAAV8U/-NtKpTIeoGkmioOj7BSGRClh5D1bi3pMwCHMYCw/s72-c/image_thumb%255B2%255D?imgmax=800' height='72' width='72'/><thr:total>4</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5869430098436797269</id><published>2017-07-02T19:19:00.000+08:00</published><updated>2017-08-22T06:45:42.004+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>[git]為什麼常出現有修改但是比對不卻顯示不出差異？談談檔案斷行問題和如何達到不同平台正確一致化</title><content type='html'>用git之後，有時候遇到在檢查狀態的時候明明&lt;em&gt;顯示有修改&lt;/em&gt;，但是實際比對的時候發現完全&lt;em&gt;沒有差異&lt;/em&gt;。&lt;p&gt;通常來說發生這種情況就是檔案的&lt;em&gt;斷行跑掉了&lt;/em&gt;，如果沒有好好解決到時候log會常常出現修改，但是實際上並不是真的修改，未來查找log很辛苦。&lt;/p&gt;&lt;p&gt;在這篇將會對於如何一勞永逸處理掉這個斷行問題做個說明。&lt;/p&gt;&lt;section&gt;             &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868881444" ;=""&gt;問題描述&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868881120" ;=""&gt;解決方式&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882389" ;=""&gt;設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882392" ;=""&gt;一致化&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882738" ;=""&gt;問題發生的原因&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882548" ;=""&gt;git 如何處理這個問題 - 自動轉換的時間點&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882994" ;=""&gt;git 斷行自動轉換相關設定&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882552" ;=""&gt;git config core.autocrlf&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882434" ;=""&gt;.gitattributes&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882386" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498993868882817" ;=""&gt;參考資料&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;         &lt;a name='more'&gt;&lt;/a&gt;          &lt;section&gt;&lt;h2 id="WizKMOutline_1498993868881444"&gt;問題描述&lt;/h2&gt;&lt;p&gt;            有時候檢查檔案狀態，發現有變更，但是實際比對會發現其實什麼變更都沒有：         &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-JakOT29vhzw/WVjVqAiOQlI/AAAAAAAAV4Y/QSi05ioPgDka1iAVZuJY_SiWOXubwvXgQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="351" title="log有修改，但是比對發現沒有任何差異" style="display: inline; background-image: none;" alt="log有修改，但是比對發現沒有任何差異" src="https://lh3.googleusercontent.com/-oiF3GWXVD4k/WVjVrklQacI/AAAAAAAAV4c/_I14rsqVcQsYbmHCuFROF8iPex4XrQcVQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;log有修改，但是比對發現沒有任何差異&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;            當然，如果各位有在每次commit的時候認真比對的話，那麼一定不會把這個加到commit裡面，但是有時候如果漏看的話，不小心把這個commit上去，             只會造成未來在看的時候有更多雜訊，浪費時間。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868881120"&gt;解決方式&lt;/h2&gt;&lt;p&gt;            首先要設定好讓git自動做斷行處理，再來如果專案裡面以前沒有設定過，很有可能斷行已經亂掉，這時候做一個一致化（Normalize line ending）的動作。         &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498993868882389"&gt;設定&lt;/h3&gt;&lt;p&gt;            要一次解決這個問題，可以透過兩個設定：         &lt;/p&gt;&lt;dl class="border-around"&gt;&lt;dt&gt;                 git config --global core.autocrlf             &lt;/dt&gt;&lt;dd&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;                            如果是windows設定為&lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;git config --global core.autocrlf true&lt;/code&gt; &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;                            如果是Unix系列設定為 &lt;code&gt;input&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;git config --global core.autocrlf input&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/dd&gt;&lt;dt&gt;                 為專案加入 &lt;code&gt;.gitattributes&lt;/code&gt;檔案             &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;檔案裡面要加入 &lt;code&gt;* text=auto&lt;/code&gt;&lt;/p&gt;&lt;p&gt;更多gitattribute關於斷行的設定可以參考這個github repo                      &lt;a href="https://github.com/alexkaratarakis/gitattributes"&gt;一些不同語言的gitattributes範本&lt;/a&gt;&lt;/p&gt;&lt;p&gt;                    或者可以看我自己每一個專案都會放的gitattribute檔案：&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo/blob/master/.gitattributes"&gt;我的gitattribute&lt;/a&gt;&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498993868882392"&gt;一致化&lt;/h3&gt;&lt;p&gt;                做好了以上設定，要把現行的斷行一致化就變得很簡單，只需要：             &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;                     假設有任何修改尚未commit，先commit                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git commit -am "儲存目前修改"&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                         把所有檔案刪掉（不包含.git）                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;                            git rm --cached -r .                         &lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                         重新從repo把刪除的修改revert掉                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git reset .&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;                     加入index                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git add -u&lt;/code&gt; - 如果有看到很多warning提示會從crlf轉成lf是正常的。                 &lt;/dd&gt;&lt;dt&gt;                     commit上去                 &lt;/dt&gt;&lt;dd&gt;&lt;code&gt;git commit -m "斷行一致化處理"&lt;/code&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;p&gt;            如果對於這兩個設定的目的和用途為何，請繼續往下看。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868882738"&gt;問題發生的原因&lt;/h2&gt;&lt;p&gt;            Windows 和 Unix（包含Linux和mac）代表斷行的字符是不一樣的。         &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;Windows&lt;/dt&gt;&lt;dd&gt;&lt;code&gt;crlf&lt;/code&gt; - 兩個字符代表斷行&lt;/dd&gt;&lt;dt&gt;Unix&lt;/dt&gt;&lt;dd&gt;&lt;code&gt;lf&lt;/code&gt; - 字符代表斷行&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;            還記得git是版控&lt;em&gt;檔案內容&lt;/em&gt;，所以假設本來是&lt;code&gt;crlf&lt;/code&gt;，如果被改成了&lt;code&gt;lf&lt;/code&gt;那麼對於git來說就是一個修改。         &lt;/p&gt;&lt;p&gt;            但是因為斷行字符是&lt;em&gt;看不到的內容&lt;/em&gt;，所以有些比對工具不會顯示出任何差異，造成混亂。         &lt;/p&gt;&lt;p&gt;            而本質上這些不應該算是修改，而是因為作業系統不同而導致的問題，所以git本身有考慮進去怎麼處理。         &lt;/p&gt;&lt;p&gt;            要解決這個問題其實很簡單，假設不管哪個作業系統都是&lt;em&gt;&lt;strong&gt;用一樣的斷行作為儲存&lt;/strong&gt;&lt;/em&gt;，那麼就不會有因為斷行不一樣的原因出現修改。         &lt;/p&gt;&lt;p&gt;           假設一開始沒有設定好，那麼很有可能有些檔案存成lf有些存成crlf，這個時候就需要做斷行一致化的動作（normalize line ending）         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868882548"&gt;git 如何處理這個問題 - 自動轉換的時間點&lt;/h2&gt;&lt;p&gt;            在git裡面，其實內建的時候就有考慮到這個事情，所以他有允許做自動轉換。         &lt;/p&gt;&lt;p&gt;            這個自動轉換發生在兩個時間點：             &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;當把檔案&lt;em&gt;寫到&lt;/em&gt;repo的時候&lt;/dt&gt;&lt;dd&gt;發生的時間點如：&lt;code&gt;git add&lt;/code&gt;、&lt;code&gt;git commit&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;當把檔案從repo&lt;em&gt;讀出&lt;/em&gt;來的時候&lt;/dt&gt;&lt;dd&gt;發生的時間點如：&lt;code&gt;git checkout&lt;/code&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;            所以我們可以透過設定告訴git在這兩個時間點的時候，應該要怎麼轉換。         &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868882994"&gt;git 斷行自動轉換相關設定&lt;/h2&gt;&lt;p&gt;            在git裡面有兩個設定是告訴git如何做這個斷行轉換：         &lt;/p&gt;&lt;ol&gt;&lt;li&gt;git config 的 &lt;code&gt;core.autocrlf&lt;/code&gt;&lt;/li&gt;&lt;li&gt;&lt;code&gt;.gitattributes&lt;/code&gt;設定&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;            這邊git config的設定對所有專案都有作用，但是只能夠對&lt;em&gt;自己有起作用&lt;/em&gt;，換句話說如果在團隊裡面，有些人的電腦沒有設定好             那麼只靠這個設定是不夠的，因為很有可能就是有個別的電腦設定有問題導致斷行錯亂。         &lt;/p&gt;&lt;p&gt;            因此，&lt;code&gt;.gitattributes&lt;/code&gt;的作用就出來了，這個是能夠&lt;em&gt;跟著專案走&lt;/em&gt;的斷行處理設定，設定了就不用擔心有個別電腦沒有設定             &lt;code&gt;core.autocrlf&lt;/code&gt;的問題。         &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498993868882552"&gt;git config core.autocrlf&lt;/h3&gt;&lt;p&gt;                這個其實就是在設定讀和寫的時候自動轉換斷行的處理，總共有三個設定：             &lt;/p&gt;&lt;ul&gt;&lt;li&gt;auto&lt;/li&gt;&lt;li&gt;input&lt;/li&gt;&lt;li&gt;false&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;這三個設定分別為：&lt;/p&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;th&gt;&lt;em&gt;讀&lt;/em&gt;的時候轉換&lt;/th&gt;&lt;th&gt;&lt;em&gt;寫&lt;/em&gt;的時候轉換&lt;/th&gt;&lt;th&gt;建議&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;auto&lt;/th&gt;&lt;td&gt;lf 轉 crlf &lt;/td&gt;&lt;td&gt;crlf 轉 lf&lt;/td&gt;&lt;td&gt;Windows作業系統使用&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;input&lt;/th&gt;&lt;td&gt;不轉換&lt;/td&gt;&lt;td&gt;crlf 轉 lf&lt;/td&gt;&lt;td&gt;Unix作業系統使用&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;false&lt;/th&gt;&lt;td&gt;不轉換&lt;/td&gt;&lt;td&gt;不轉換&lt;/td&gt;&lt;td&gt;不建議使用&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498993868882434"&gt;.gitattributes&lt;/h3&gt;&lt;p&gt;這個檔案放在同&lt;code&gt;.git&lt;/code&gt;資料夾層級，裡面可以設定一些檔案屬性，其中一個就是轉換的部分&lt;/p&gt;&lt;p&gt;                一個範例檔案可能長成如下：   &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;  * text=auto&lt;br /&gt;  *.md text&lt;br /&gt;  *.csproj text eol=crlf&lt;/pre&gt;&lt;p&gt;                自動轉換的設定是&lt;code&gt;* text=auto&lt;/code&gt; - 這個意思是只要是&lt;em&gt;text類型的檔案git會自動轉換&lt;/em&gt;（類似於core.autocrlf但是更加智能）。             &lt;/p&gt;&lt;p&gt;                這個時候可能會好奇，到底哪些是屬於text檔案？git會自動判斷，不過也可以透過設定強制告訴git，例如：&lt;code&gt;*.md text&lt;/code&gt;就是說md結尾的都是                 屬於text類型 - 換句話說就是會做轉換斷行的處理。             &lt;/p&gt;&lt;p&gt;                也有可能有些檔案要保持某一個斷行，例如&lt;code&gt;*.csrpoj&lt;/code&gt;（C# 專案檔案，要保持crlf），這個時候也可以透過設定：&lt;code&gt;*.csproj     text eol=crlf&lt;/code&gt;&lt;/p&gt;&lt;p&gt;                如果想參考一些不同檔案的設定，可以參考這個repo：                 &lt;a href="https://github.com/alexkaratarakis/gitattributes"&gt;一些不同語言的gitattributes範本&lt;/a&gt;&lt;/p&gt;&lt;p&gt;                我自己也有一個常用的設定，也可以參考一下：&lt;a href="https://github.com/alantsai/mhat-common-boilerplate-repo/blob/master/.gitattributes"&gt;我的gitattribute&lt;/a&gt;&lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;      要注意一下，假設今天你不是使用指令的方式在執行git - 那麼有些gui其實不一定會吃.gitattributes的設定（有些ide的git套件不會吃這個設定 - 不確定是否目前還是如此，不過曾經有過像egit不吃這個設定）   所以最好還是要搭配git config的設定。      &lt;/div&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868882386"&gt;結語&lt;/h2&gt;&lt;p&gt;斷行的部分其實還有幾個相關設定，不過那些設定基本上不會碰到，因此我就沒有提。&lt;/p&gt;&lt;p&gt;希望透過這篇也讓大家了解到斷行在不同作業系統會帶來的問題，並且怎麼樣能夠一勞永逸的解決。&lt;/p&gt;&lt;p&gt;gitattributes其實還有別的進階用途，未來有機會在和大家介紹&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498993868882817"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="http://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/"&gt;Mind the End of Your Line(英文)&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;一篇很詳細介紹關於斷行問題的文章&lt;/dd&gt;&lt;dt&gt;&lt;a href="http://schacon.github.io/git/gitattributes.html"&gt;gitattributes的官方說明(英文)&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;介紹整個gitattributes的其他應用&lt;/dd&gt;&lt;dt&gt;&lt;a href="https://help.github.com/articles/dealing-with-line-endings/"&gt;github介紹一致化斷行的處理(英文)&lt;/a&gt;&lt;/dt&gt;&lt;/dl&gt;&lt;/section&gt;  &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:9543e484-8b1d-4c43-91f3-552feb849c04" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5869430098436797269/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/07/git-normalize-line-ending.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5869430098436797269'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5869430098436797269'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/git-normalize-line-ending.html' title='[git]為什麼常出現有修改但是比對不卻顯示不出差異？談談檔案斷行問題和如何達到不同平台正確一致化'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-oiF3GWXVD4k/WVjVrklQacI/AAAAAAAAV4c/_I14rsqVcQsYbmHCuFROF8iPex4XrQcVQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7931427976759779035</id><published>2017-06-25T23:09:00.001+08:00</published><updated>2017-06-25T23:28:44.261+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>[git]開始使用git - 用git操作svn repo</title><content type='html'>&lt;section&gt;&lt;p&gt;git作為分散式版控的一項優勢是可以在offline的情況下查到log，並且能夠隨時隨地commit；這個對於當中央repo在公司內部的時候會更加有感（因為通常內部都要透過vpn，就有可能導致速度慢，甚至有些vnp還會切斷你的外網，   沒有google要怎麼寫code XD）   &lt;/p&gt;&lt;p&gt;很不幸的，如果你今天被要求使用svn或者tfs，你就沒有辦法像git一樣在無連線狀態下查log。   &lt;/p&gt;&lt;p&gt;但是別絕望，git其實可以透過一個Bridge來和svn溝通，從外部來看，你好像還是使用svn，但是其實你實際上使用git。所以git的那些優點（local有一個版本，因此可以local commit，快速切branch等）完全可以使用。          &lt;/p&gt;&lt;p&gt;這是一個很好開始嘗試git的方式。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;題外話，我當初接觸git就是為了他的local功能，因為實在太好用了，最後慢慢就希望全部換成git。   &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;昨天有幸為 &lt;a href="http://study4.tw/Activity/Details/6"&gt;Study4的6月場次介紹git&lt;/a&gt;，其中有學員有特別提到關於git和svn溝通的部分，    因此把當初所做的事情作了一些整理。如果有任何地方看不懂或者有缺或者漏的地方，在留言給我。    &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;    &lt;section&gt;     &lt;a name="KMContentPageTopID" id="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974558" ;=""&gt;這篇的情境&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974422" ;=""&gt;用git作為svn的溝通需要準備什麼？&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974143" ;=""&gt;準備工作 - svn使用者對照表&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974301" ;=""&gt;使用工具產生&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974281" ;=""&gt;用svn-migration-scripts.jar&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974146" ;=""&gt;用svn log產生&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974276" ;=""&gt;開始使用 git svn&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191974819" ;=""&gt;從svn建立git repo&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style="margin: 0px 0px 0px 30px;"&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975461" ;=""&gt;設定svn ignore檔案&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975201" ;=""&gt;日常版控行為&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975954" ;=""&gt;從svn抓取最新&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975432" ;=""&gt;把git的commit推上svn&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975912" ;=""&gt;建立一個git repo mirror&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975209" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1498402191975863" ;=""&gt;參考資料&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;      &lt;a name='more'&gt;&lt;/a&gt;    &lt;section&gt;&lt;h2 id="WizKMOutline_1498402191974558"&gt;這篇的情境&lt;/h2&gt;&lt;p&gt;這篇的主要的情境是：&lt;em&gt;作為一個開發者，我的中央版控使用的是svn，但是我希望使用git來管控應該怎麼做？&lt;/em&gt;&lt;/p&gt;&lt;p&gt;因此，這是一個&lt;em&gt;單項同步&lt;/em&gt;的概念：svn中央庫作為&lt;em&gt;main repo&lt;/em&gt;，而不是說在建立一個中央的git repo然後和中央svn做&lt;em&gt;雙向同步&lt;/em&gt;。   &lt;/p&gt;&lt;p&gt;這篇針對的是windows環境，在linux和mac不確定是否一樣操作，但是本質應該差不多。   &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191974422"&gt;用git作為svn的溝通需要準備什麼？&lt;/h2&gt;&lt;p&gt;首先有幾個程式是&lt;em&gt;必備&lt;/em&gt;的：   &lt;/p&gt;&lt;dl class="border-around"&gt;&lt;dt&gt;     Git for windows    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;既然要用git做為和svn溝通的工具，git當然是需要安裝的程式。    &lt;/p&gt;&lt;p&gt;快速鏈接：&lt;a href="https://git-scm.com/download/win"&gt;Git for windows&lt;/a&gt;&lt;/p&gt;&lt;/dd&gt;&lt;dt&gt;     git svn    &lt;/dt&gt;&lt;dd&gt;     這個是git和svn溝通的bridge - 以前需要額外下載，目前是整合在git for windows裡面    &lt;/dd&gt;&lt;dt&gt;     svn的command line工具    &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;如果有安裝TortoiseSVN（小烏龜），可以不用安裝，小烏龜有帶。    &lt;/p&gt;&lt;p&gt;可以再&lt;a href="https://www.collab.net/downloads/subversion"&gt;CollabNet&lt;/a&gt;下載到，目前最新版本是1.9.5    &lt;/p&gt;&lt;p&gt;快速鏈接：(&lt;a href="https://www.collab.net/servlets/OCNDirector?id=CSVN1.9.5WINC32"&gt;x86&lt;/a&gt;)、(&lt;a href="https://www.collab.net/servlets/OCNDirector?id=CSVN1.9.5WINC64"&gt;x64&lt;/a&gt;)    &lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;&lt;em&gt;非必備&lt;/em&gt;程式：    &lt;/p&gt;&lt;dl class="border-around"&gt;&lt;dt&gt;      svn-migration-scripts.jar     &lt;/dt&gt;&lt;dd&gt;&lt;p&gt;這個是Atlassian提供的一個小工具，方便處理一些事情。如果要使用也需要安裝&lt;em&gt;java&lt;/em&gt;。     &lt;/p&gt;&lt;p&gt;source位置：&lt;a href="https://bitbucket.org/atlassian/svn-migration-scripts/downloads/?_ga=2.168637795.315027162.1498375431-502814452.1486436883"&gt;source&lt;/a&gt;&lt;/p&gt;&lt;p&gt;快速鏈接：&lt;a href="https://bitbucket.org/atlassian/svn-migration-scripts/downloads/svn-migration-scripts.jar"&gt;直接下載&lt;/a&gt;&lt;/p&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;p&gt;如果不確定是否所需要的工具都有了，可以用 &lt;code&gt; svn-migration-scripts.jar&lt;/code&gt;做檢查，在command line輸入：   &lt;/p&gt;&lt;p&gt;&lt;kbd&gt;java -jar svn-migration-scripts.jar verify&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZXw-plX8Q5w/WU_QhGb3sAI/AAAAAAAAV28/Dw_TvR64XvQoSvtQeuDP1v03JAKDY0yXACHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img width="654" height="151" title="執行完的結果，列出幾個工具使用的版本" style="display: inline; background-image: none;" alt="執行完的結果，列出幾個工具使用的版本" src="https://lh3.googleusercontent.com/-wW_PCw5FV6U/WU_QivDshlI/AAAAAAAAV3A/ZTPdU0be24cqXRePVsHH22NrYQRckROMQCHMYCw/image_thumb?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;執行完的結果，列出幾個工具使用的版本&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191974143"&gt;準備工作 - svn使用者對照表&lt;/h2&gt;&lt;p&gt;在svn裡面，誰commit是用帳號做表現，但是在git裡面則是 姓名+email。   &lt;/p&gt;&lt;p&gt;很有可能目前svn和git的對應著無法直接對上，因此先建立一個對應表。   &lt;/p&gt;&lt;p&gt;這個對應表的格式很簡單，就是：   &lt;/p&gt;&lt;p&gt;&lt;code&gt;{{svn帳號}} = {{git姓名}} &amp;lt;{{git email}}&amp;gt;&lt;/code&gt;&lt;/p&gt;&lt;p&gt;多人，就是每個人空一行。   &lt;/p&gt;&lt;p&gt;以我的例子來說，假設svn帳號是J00，然後要對到我，那麼這個檔案內容就會是：   &lt;/p&gt;&lt;code&gt;J00 = Alan Tsai &amp;lt;alan@alantsai.net&amp;gt;&lt;/code&gt;&lt;h3 id="WizKMOutline_1498402191974301"&gt;使用工具產生&lt;/h3&gt;&lt;p&gt;假設你的人名清單很明確可以一個一個自己手刻，但是如果很多情況下建議用產生的方式。   &lt;/p&gt;&lt;p&gt;產生有兩種方式：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;用svn-migration-scripts.jar&lt;/li&gt;&lt;li&gt;用svn log搭配一些工具產生 - 需要先用svn把repo抓下來，個人覺得比較麻煩&lt;/li&gt;&lt;/ol&gt;&lt;h4 id="WizKMOutline_1498402191974281"&gt;用svn-migration-scripts.jar&lt;/h4&gt;&lt;p&gt;執行 (把 &lt;em&gt;{{svn repo url}}&lt;/em&gt; 換成對應的repo url)：   &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;java -jar svn-migration-scripts.jar authors {{svn repo url}} &amp;gt; author.txt&lt;/pre&gt;&lt;p&gt;會得到這個repo裡面每一個使用者的清單，在手動調整一下對應的git名稱即可，下面是我拿open source的一個svn repo的產生結果：   &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-F8_9IMtpfME/WU_QjxZ4-QI/AAAAAAAAV3E/w98dg9c2hQkJ1EEWXUNw_qDmmuX33EmfwCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img width="654" height="211" title="某個open source svn的人名清單，這邊沒有pipe到檔案因此可以直接看到" style="display: inline; background-image: none;" alt="某個open source svn的人名清單，這邊沒有pipe到檔案因此可以直接看到" src="https://lh3.googleusercontent.com/-pz6OHkiJ4LM/WU_Qk1BV-LI/AAAAAAAAV3I/7PZZ6sIYAwQsNCQ-Iu6vYx_rMQk1-t-cACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;某個open source svn的人名清單，這邊沒有pipe到檔案因此可以直接看到&lt;/figcaption&gt;&lt;/figure&gt;&lt;h4 id="WizKMOutline_1498402191974146"&gt;用svn log產生&lt;/h4&gt;&lt;p&gt;這個的前期條件是已經有把那個svn repo用svn抓下來。   &lt;/p&gt;&lt;p&gt;在那個資料夾下面執行：   &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;svn log --quiet --xml | sed -n -e "s/&amp;lt;\/\?author&amp;gt;//g" -e "/[&amp;lt;&amp;gt;]/!p" | sort | sed "$!N; /^\(.*\)\n\1$/!P; D" &amp;gt; author.txt&lt;/pre&gt;&lt;p&gt;這個會得到一個所有svn使用者的清單。   &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;請注意建立出來的txt檔案格式，一定要是&lt;em&gt;&lt;strong&gt;UTF-8 (不包含BOM)&lt;/strong&gt; &lt;/em&gt;&lt;/p&gt;&lt;p&gt;這個可以用Visual Studio Code看出來，在右下角，&lt;code&gt;UTF-8&lt;/code&gt;是對的。假設要改，可以點一下，然後選擇&lt;code&gt;Save with Encoding&lt;/code&gt;在選擇&lt;code&gt;UTF-8&lt;/code&gt;即可。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_PIT1bWHAPs/WU_Ql6p2BjI/AAAAAAAAV3M/25LrJ-q_GT00AZYNzYHZ0iOedRii8BrSwCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img width="579" height="112" title="看到編碼，UTF-8 with BOM是錯的" style="display: inline; background-image: none;" alt="看到編碼，UTF-8 with BOM是錯的" src="https://lh3.googleusercontent.com/-HbjIXWN4rR8/WU_Qm1rZdQI/AAAAAAAAV3Q/e9EM5WARv2oSds6ZcjHm_LDqGVVjueGZQCHMYCw/image_thumb%255B2%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-505ljda0Zt8/WU_QpYSFpHI/AAAAAAAAV3U/dv11mOKs8LwZej2JFLnDgjun8xOcaXTlQCHMYCw/s1600-h/image%255B11%255D"&gt;&lt;img width="654" height="119" title="選擇save with encoding" style="display: inline; background-image: none;" alt="選擇save with encoding" src="https://lh3.googleusercontent.com/-VtSuxnOSOms/WU_QrxdoOSI/AAAAAAAAV3Y/4GSoQTrArj8zk0nEIp8AUk2O0P196ipXgCHMYCw/image_thumb%255B3%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-jbD9oyrzATY/WU_QutlB3tI/AAAAAAAAV3c/BlOzPFhHHpUsLbbv99-lNyWCIREolOLGwCHMYCw/s1600-h/image%255B14%255D"&gt;&lt;img width="654" height="306" title="選擇 UTF-8" style="display: inline; background-image: none;" alt="選擇 UTF-8" src="https://lh3.googleusercontent.com/-v_-TCij9ExM/WU_QvsuNfLI/AAAAAAAAV3g/_-M5HTApXggzwuTZHoTwhxOD3-i5DGCrQCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;選擇為UTF-8&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191974276"&gt;開始使用 git svn&lt;/h2&gt;&lt;p&gt;整個的使用流程如下：   &lt;/p&gt;&lt;ol&gt;&lt;li&gt;從svn建立git repo&lt;/li&gt;&lt;li&gt;日常git版控行為 (開branch，commit，merge master等) 這個就不說明&lt;/li&gt;&lt;li&gt;從svn抓取最新&lt;/li&gt;&lt;li&gt;把git的commit推上svn&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498402191974819"&gt;從svn建立git repo&lt;/h3&gt;&lt;p&gt;首先是需要把svn所有commit抓下來，這個如果svn repo很大的話，需要一些時間，因此要做好放著讓他跑的準備。   &lt;/p&gt;&lt;p&gt;如果你的svn repo是標準方式建立的（換句話說，會有trunk、branches和tags的話）呼叫方式如下：   &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git svn clone svn://localhost svn -A author.txt --stdlayout --prefix=svn/&lt;/pre&gt;&lt;p&gt;參數說明如下：   &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;&lt;code&gt;-A&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;     這個傳入的是那個帳號名稱對應檔 - 在 &lt;a href="#WizKMOutline_1498402191974143"&gt;準備工作 - svn使用者對照表&lt;/a&gt; 篇的到的結果檔案    &lt;/dd&gt;&lt;dt&gt;&lt;code&gt;--stdlayout&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;     表示svn使用的是標準方式建立出來，如果今天不是標準方式建立，那麼需要自己設定 trunk名稱： &lt;code&gt;--trunk=&lt;trunk_subdir&gt;&lt;/trunk_subdir&gt;&lt;/code&gt;，branch名稱：&lt;code&gt;--branches=&lt;branches_subdir&gt;&lt;/branches_subdir&gt;&lt;/code&gt;和     tag名稱：&lt;code&gt;--tags=&lt;tags_subdir&gt;&lt;/tags_subdir&gt;&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;--prefix=svn/&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;     建立出來的svn 遠端 branch用 &lt;code&gt;svn/&lt;/code&gt;作為前戳，方便區分哪些是svn那邊的remote branch。    &lt;/dd&gt;&lt;/dl&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;code&gt;git svn clone&lt;/code&gt;其實就是：    &lt;pre class="brush: powershell;"&gt;git svn int&lt;br /&gt;   git svn fetch&lt;/pre&gt;的縮寫   &lt;/div&gt;&lt;div class="bs-callout bs-callout-warning"&gt;假設呼叫clone過程不知道什麼原因停掉了，可以呼叫 &lt;kbd&gt;git svn fetch&lt;/kbd&gt; - 它會從上次中斷的地方繼續往下做   &lt;/div&gt;&lt;section&gt;&lt;h4 id="WizKMOutline_1498402191975461"&gt;設定svn ignore檔案&lt;/h4&gt;&lt;p&gt;由於svn可能有自定一些ignore的規則，因此當clone完之後，建議先把ignore加進來。     &lt;/p&gt;&lt;p&gt;clone完直接使用：     &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git svn show-ignore &amp;gt;&amp;gt; .gitignore&lt;br /&gt;    git add .gitignore&lt;br /&gt;    git commit -m "加入svn ignore清單"&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;h3 id="WizKMOutline_1498402191975201"&gt;日常版控行為&lt;/h3&gt;&lt;p&gt;抓下來之後，會發現其實整個svn的trunk、branch和tags都變成了git的遠端remote branch。 &lt;/p&gt;&lt;p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-h9hBdf4C6LA/WU_Wm141XJI/AAAAAAAAV3w/R0QWAD8SfscTi_xA0xx4sDX6n7-bgQq9gCHMYCw/s1600-h/image%255B3%255D"&gt;&lt;img width="530" height="359" title="可以看到這個repo只有一個trunk，所以remote/svn/trunck" style="display: inline; background-image: none;" alt="可以看到這個repo只有一個trunk，所以remote/svn/trunck" src="https://lh3.googleusercontent.com/-oaUPZb7ECD0/WU_WqQLSQAI/AAAAAAAAV30/i5riqiN82ggIskumHjSOg1KcSSNFoR3cgCHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"&gt;&lt;/a&gt;&lt;figcaption&gt;可以看到這個repo只有一個trunk，所以remote/svn/trunck&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;接下來就像日常使用git的方式使用 - 也可以使用gui工具例如source tree。   &lt;/p&gt;&lt;p&gt;等到最後要準備上到svn的時候，需要先從svn抓最新的回來   &lt;/p&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498402191975954"&gt;從svn抓取最新&lt;/h3&gt;&lt;p&gt;和同git遠端repo溝通一樣，在溝通前，要先做一次更新，確保本機和正式機器的版本是一樣新。   &lt;/p&gt;&lt;p&gt;這個時候，可以呼叫：   &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;git svn rebase&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;這個其實類似于git裡面的&lt;code&gt;git pull --rebase&lt;/code&gt;。    &lt;/p&gt;&lt;p&gt;所以如果有發生衝突，同等於在rebase的時候發生衝突要處理的方式一樣。    &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h3 id="WizKMOutline_1498402191975432"&gt;把git的commit推上svn&lt;/h3&gt;&lt;p&gt;假設沒有開branch，那麼再上一個步奏svn抓取最新的時候，會自動把master對最新的做rebase，因此不用做任何處理，直接呼叫：     &lt;/p&gt;&lt;pre class="brush: powershell"&gt;git svn dcommit&lt;/pre&gt;即可    &lt;p&gt;假設有開branch，那麼這個時候應該要用&lt;code&gt;rebase&lt;/code&gt;+&lt;code&gt;merge&lt;/code&gt;來達到master和branch 合併的時候會是 Fast Forward Merge：    &lt;/p&gt;&lt;pre class="brush: powershell"&gt;git checkout branch1&lt;br /&gt;   git rebase master&lt;br /&gt;   git checkout master&lt;br /&gt;   git merge branch1&lt;br /&gt;   git svn dcommit&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191975912"&gt;建立一個git repo mirror&lt;/h2&gt;&lt;p&gt;到目前為止其實會發現，git svn只是有一個特殊的branch在記錄目前svn版本在哪裡，然後只有需要和遠端溝通的時候呼叫git svn相關指令，其他操作者一般git沒有兩樣。  &lt;/p&gt;&lt;p&gt;這時候假設想要把目前記錄推送到某一個git repo上面，做法其實很簡單（就是一般加remote的方式）：  &lt;/p&gt;&lt;ol&gt;&lt;li&gt;加入一個remote - 例如 &lt;code&gt;git remote add origin {{git repo url}}&lt;/code&gt;&lt;/li&gt;&lt;li&gt;然後push上去：&lt;code&gt;git push -u origin master&lt;/code&gt;&lt;/li&gt;&lt;/ol&gt;在去哪個git repo看就會發現都上去了  &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191975209"&gt;結語&lt;/h2&gt;&lt;p&gt;要換使用一個工具或方法通常都是因為有某些痛點和需求。因此從svn要轉git，先用這種方式，等到都確定要轉的時候，可以讓大家改成用那個git repo版本而把svn給停用掉。  &lt;/p&gt;&lt;p&gt;另外一個常見的版控，TFS也有類似的bridge工具可以下載 - 運作原理和git svn差不多。  &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1498402191975863"&gt;參考資料&lt;/h2&gt;&lt;dl&gt;&lt;dt&gt;&lt;a href="https://www.atlassian.com/git/tutorials/migrating-overview"&gt;Atlassian關於從Svn到Git的說明(英文)&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;    很棒的一系列介紹如何從svn轉到git   &lt;/dd&gt;&lt;dt&gt;&lt;a href="https://git-scm.com/docs/git-svn"&gt;git svn 指令(英文)&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;    git svn每一個指令和參數的含義   &lt;/dd&gt;&lt;dt&gt;&lt;a href="https://git-scm.com/book/zh-tw/v1/Git-%E8%88%87%E5%85%B6%E4%BB%96%E7%B3%BB%E7%B5%B1-Git-%E8%88%87-Subversion"&gt;官方介紹git svn&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;    鏈接是中文內容   &lt;/dd&gt;&lt;dt&gt;&lt;a href="http://www.sailmaker.co.uk/blog/2013/05/05/migrating-from-svn-to-git-preserving-branches-and-tags-3/"&gt;Migrating from SVN to Git, preserving branches and tags&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;    不錯的概觀介紹。   &lt;/dd&gt;&lt;dt&gt;&lt;a href="https://github.com/doggy8088/Learn-Git-in-30-days/blob/master/zh-tw/29.md"&gt;第 29 天：如何將 Subversion 專案匯入到 Git 儲存庫&lt;/a&gt;&lt;/dt&gt;&lt;dd&gt;    保哥30天git裡面關於和svn溝通的部分   &lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt; &lt;section&gt; &lt;div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:c938c061-8046-46aa-a432-572585499281" style="margin: 0px; padding: 0px; float: none; display: inline;"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7931427976759779035/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/06/git-svn-usage.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7931427976759779035'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7931427976759779035'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/06/git-svn-usage.html' title='[git]開始使用git - 用git操作svn repo'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-wW_PCw5FV6U/WU_QivDshlI/AAAAAAAAV3A/ZTPdU0be24cqXRePVsHH22NrYQRckROMQCHMYCw/s72-c/image_thumb?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6120019698755413264</id><published>2017-06-18T20:45:00.000+08:00</published><updated>2017-06-18T20:50:31.461+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>[git]重新命名檔案的方式和如何在log檢查到改檔名前的歷史記錄</title><content type='html'>&lt;section&gt; &lt;p style="display: none"&gt;how to properly rename in git and show the log of previous rename&lt;/p&gt; &lt;p&gt;當持續在改檔案內容，容易發生當初為這個檔案取的名字已經不適合描述目前內容的情況，所以會對檔案名稱做修改。 &lt;/p&gt; &lt;p&gt;最好的例子就是重構，當重構的時候很容易發生class名稱變換，這個時候會一起調整class的檔案檔名避免未來不好找。 &lt;/p&gt; &lt;p&gt;不過當有天需要追蹤那個檔案的變更歷史的時候，會突然發現，只有 &lt;strong&gt;&lt;em&gt;從新檔名那段開始有記錄，而舊檔名的記錄則看不到&lt;/em&gt;&lt;/strong&gt;。這個對於從svn轉過來的使用者來說是無法理解的。 &lt;/p&gt; &lt;p&gt;在這篇將會針對這個常見的問題來談到解決的方式和為什麼git會是這樣運作。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0sMohXK6dQ4/WUZzzt2JpZI/AAAAAAAAVzQ/hiCIoNlcvEAxQbDmTSIeA6bvDJUcqAPMgCHMYCw/s1600-h/image%255B3%255D"&gt;&lt;img title="rename以前的log不見了" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="rename以前的log不見了" src="https://lh3.googleusercontent.com/-tSi1MrWit2g/WUZz09jMMWI/AAAAAAAAVzU/Gy_RyxYzt24m9DKyRbjfkz-DQKffAmrGwCHMYCw/image_thumb%255B1%255D?imgmax=800" width="654" height="244"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;rename以前的log不見了&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;  &lt;div id="divKMOutline" style="border-top-style: groove; border-left-style: none; border-bottom-style: groove; border-right-style: none; margin: 10px 0px"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288022805" ;=""&gt;問題重現&lt;/a&gt;&lt;br&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023506" ;=""&gt;解決方式&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023559" ;=""&gt;指令的方式&lt;/a&gt;&lt;br&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023932" ;=""&gt;TortoiseGit log 啟用方式&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023898" ;=""&gt;TortoiseGit blame啟用方式&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023181" ;=""&gt;SourceTree log 啟用方式&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023430" ;=""&gt;發生原因 - git如何處理檔名變更&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023158" ;=""&gt;這個時候有些gui就容易誤導使用者&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023478" ;=""&gt;在git裡面重新命名怎麼做才正確&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023284" ;=""&gt;有沒有必要呼叫 git mv&lt;/a&gt;&lt;br&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023734" ;=""&gt;當檔案內容和檔案名稱都有修改的情況下是否會不同？&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023145" ;=""&gt;當有檔案修改又有檔名修改無法用follow和網上說法有點不同&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1497788288023198" ;=""&gt;結語&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt; &lt;h2 id="WizKMOutline_1497788288022805"&gt;問題重現&lt;/h2&gt; &lt;p&gt;基本上我們可以用以下的方式來重現這個問題： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;先建立一個檔案 &lt;code&gt;file.txt&lt;/code&gt;&lt;br&gt; &lt;li&gt;把這個檔案&lt;kbd&gt;commit&lt;/kbd&gt;上去&lt;br&gt; &lt;li&gt;把檔案改名字&lt;code&gt;change.txt&lt;/code&gt;&lt;br&gt; &lt;li&gt;這個時候看狀態會變成 &lt;code&gt;file.txt&lt;/code&gt;在被&lt;em&gt;刪除&lt;/em&gt;狀態，而&lt;code&gt;change.txt&lt;/code&gt;則是&lt;em&gt;untrack&lt;/em&gt;的狀態&lt;br&gt; &lt;li&gt;用 &lt;kbd&gt;add&lt;/kbd&gt; 加入到index （注意到這邊狀態變成了 &lt;em&gt;renamed&lt;/em&gt;）&lt;br&gt; &lt;li&gt;這個時候用小烏龜對那個檔案做看 &lt;kbd&gt;log&lt;/kbd&gt; - 會發現歷史不見了&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-B3anHaRaGms/WUZz2Vn7GOI/AAAAAAAAVzY/aJFrkqXP3VEGVydfQ29iSfI_r-b0iBvoQCHMYCw/s1600-h/image%255B19%255D"&gt;&lt;img title="建立的指令" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="建立的指令" src="https://lh3.googleusercontent.com/-ddXAWUWz2AQ/WUZz39aHueI/AAAAAAAAVzc/FjIKaZLst4oseSFrANteO-XnOdyRZO9hgCHMYCw/image_thumb%255B15%255D?imgmax=800" width="654" height="557"&gt;&lt;/a&gt; &lt;figcaption&gt;建立的指令&lt;/p&gt; &lt;p&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-e-mjpdaieJw/WUZz5uMxAAI/AAAAAAAAVzg/0hpvU_xSRWAQvREFax0Rp9SuBKlhtCK4gCHMYCw/s1600-h/image%255B23%255D"&gt;&lt;img title="log看不到建立出file.txt的記錄" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="log看不到建立出file.txt的記錄" src="https://lh3.googleusercontent.com/-zGmIgTo-QcQ/WUZ0AQWkofI/AAAAAAAAVzk/sPH1z2jhyFQpm0LPRKoabZM6g9i5dI-8ACHMYCw/image_thumb%255B17%255D?imgmax=800" width="654" height="557"&gt;&lt;/a&gt; &lt;figcaption&gt;log看不到建立出&lt;code&gt;file.txt&lt;/code&gt;的記錄&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;/p&gt; &lt;h2 id="WizKMOutline_1497788288023506"&gt;解決方式&lt;/h2&gt; &lt;p&gt;如果今天只是要看到包含改檔名前的日誌，下面是做法 - 如果對於為什麼會發生和git重命名的做法有興趣在往下看。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1497788288023559"&gt;指令的方式&lt;/h3&gt; &lt;p&gt;其實在git裡面針對某個檔案看日誌的時候，可以使用指令&lt;code&gt;follow&lt;/code&gt;來包含變更名稱前的日誌： &lt;/p&gt; &lt;p&gt;&lt;code&gt;git log -follow filex.txt&lt;/code&gt;&lt;/p&gt; &lt;p&gt;在各個ui裡面也有類似的設可以啟用： &lt;/p&gt; &lt;h3 id="WizKMOutline_1497788288023932"&gt;TortoiseGit log 啟用方式&lt;/h3&gt; &lt;p&gt;選取要檢查的檔案（以我們例子是&lt;code&gt;change.txt&lt;/code&gt;），呼叫log的部分並且在最下面第3個按鈕 &lt;kbd&gt;Walk Behaviour&lt;/kbd&gt; -&amp;gt; &lt;kbd&gt;Follow Renames&lt;/kbd&gt;就可以看到。下面截圖就是有開啟的狀態，可以看到最早&lt;code&gt;file.txt&lt;/code&gt;的建立也有看到了： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-o6aC98_J5EQ/WUZ2RFDjCdI/AAAAAAAAV0w/IFfVeAHmVTMXe7NZwenYTOg0SyxkbibxQCHMYCw/s1600-h/image%255B2%255D"&gt;&lt;img title="有follow參數的log" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="有follow參數的log" src="https://lh3.googleusercontent.com/-5xUjoZ9gZUI/WUZ2TbMybMI/AAAAAAAAV00/JXtxylv-vn4ScHX3DXj1H9zhFujb4drMwCHMYCw/image_thumb%255B1%255D?imgmax=800" width="360" height="488"&gt;&lt;/a&gt; &lt;figcaption&gt;有follow參數的log&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h4 id="WizKMOutline_1497788288023898"&gt;TortoiseGit blame啟用方式&lt;/h4&gt; &lt;p&gt;如果對一個檔案做&lt;kbd&gt;blame&lt;/kbd&gt; - 下面的log清單也需要開啟在 &lt;kbd&gt;View&lt;/kbd&gt; -&amp;gt; &lt;kbd&gt;Folle Rename&lt;/kbd&gt;才會看到 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--44afV4T8Ac/WUZ2VO3RxuI/AAAAAAAAV04/RaGhfyKvrPYzHK3bqXpKFwX0o1bIgJ_BwCHMYCw/s1600-h/image%255B3%255D"&gt;&lt;img title="在blame日誌也包含rename" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="在blame日誌也包含rename" src="https://lh3.googleusercontent.com/-beUr5dzXOo0/WUZ2XwtInOI/AAAAAAAAV08/ZNsFkcUyiD8noWSmmBIEnr1avTJCkR1ugCHMYCw/image_thumb%255B2%255D?imgmax=800" width="377" height="473"&gt;&lt;/a&gt; &lt;figcaption&gt;在blame日誌也包含rename&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1497788288023181"&gt;SourceTree log 啟用方式&lt;/h3&gt; &lt;p&gt;在log裡面選&lt;code&gt;change.txt&lt;/code&gt;，點&lt;kbd&gt;右鍵&lt;/kbd&gt;，選擇 &lt;kbd&gt;Log Selected&lt;/kbd&gt;，在左下角有個&lt;kbd&gt;Follow renamed file&lt;/kbd&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ImN1W91-ETs/WUZ2ZOOaESI/AAAAAAAAV1A/ZZUpd3Vu3w4HGfZpA9BVXsfOQv8-NZEcwCHMYCw/s1600-h/image%255B4%255D"&gt;&lt;img title="開啟單一檔案log" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="開啟單一檔案log" src="https://lh3.googleusercontent.com/-js0e5qyfNSE/WUZ2bZqfqqI/AAAAAAAAV1E/3md0MF1Q4Z87324Nlg91cUiAOSpP-aiawCHMYCw/image_thumb%255B3%255D?imgmax=800" width="501" height="290"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-axCVo0tEdX4/WUZ2dUYdBWI/AAAAAAAAV1I/K3K690dcKw0Scoi2-iwXhqqNdr__P2BswCHMYCw/s1600-h/image%255B5%255D"&gt;&lt;img title="開啟follow renamed files" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="開啟follow renamed files" src="https://lh3.googleusercontent.com/-6Nwsfkz9yUY/WUZ2fe_vrPI/AAAAAAAAV1M/eEpwJezHNlsk3Ny1VNldb4DxavL8-rVJwCHMYCw/image_thumb%255B4%255D?imgmax=800" width="188" height="316"&gt;&lt;/a&gt; &lt;figcaption&gt;source tree裡面啟用方式&lt;/figcaption&gt;&lt;/figure&gt; &lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1497788288023430"&gt;發生原因 - git如何處理檔名變更&lt;/h2&gt; &lt;p&gt;大部分第一次遇到這種情況都是在想，會不會是rename方式錯誤，是不是需要透過git的指令來rename就沒問題？ &lt;/p&gt; &lt;p&gt;如果深入在研究，會發現git有提供一個指令叫做&lt;code&gt;git mv&lt;/code&gt;(TortoiseGit也有一個對應的刪除功能）- 但是如果你用那個指令來刪除，會發現其實還是看不到日誌。 &lt;/p&gt; &lt;p&gt;要了解這個，首先有件事情一定要記得的是，git和其他版控不同在於，git記錄的是&lt;strong&gt;&lt;em&gt;內容變更&lt;/em&gt;&lt;/strong&gt;，而不是&lt;strong&gt;&lt;em&gt;檔案變更&lt;/em&gt;&lt;/strong&gt;。 &lt;/p&gt; &lt;p&gt;所以其實git&lt;em&gt;不在乎檔名有沒有變更&lt;/em&gt;，他看的是&lt;em&gt;檔案內容&lt;/em&gt;的變更。所以在上面我們沒有透過git指令改名的時候，一開始在status顯示的是有個檔案被delete，然後有個檔案屬於untrack，但是當我們加到staging之後 （透過 &lt;kbd&gt;git add&lt;/kbd&gt;）自動切換變成&lt;code&gt;renamed&lt;/code&gt;狀態。 &lt;/p&gt;&lt;figure&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-hhevfYNwpFk/WUZ0QgwwQrI/AAAAAAAAV0I/0aTiccbCDyQxnryevF19Kz0xpaNXzTGFACHMYCw/s1600-h/image%255B40%255D"&gt;&lt;img title="add之前顯示的狀態" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="add之前顯示的狀態" src="https://lh3.googleusercontent.com/-WYokbK2dPJg/WUZ0TXi430I/AAAAAAAAV0M/VPw2_6p_ZE0HKPHP4FLiLXpzWWT7qMp-QCHMYCw/image_thumb%255B24%255D?imgmax=800" width="654" height="562"&gt;&lt;/a&gt; &lt;figcaption&gt;add之前顯示的狀態&lt;/p&gt; &lt;p&gt;&lt;/figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-Rxz3L8wg22Y/WUZ0aC1f1_I/AAAAAAAAV0Q/4x9D9uNgPg4dBWUYD3rVNBAfUnmpCndAgCHMYCw/s1600-h/image%255B43%255D"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-Ecx7q8Ty9GA/WUZ0dtSK46I/AAAAAAAAV0U/Sie6ptV462IYSOBPe_G9uo7tUxOa-7VagCHMYCw/image_thumb%255B25%255D?imgmax=800" width="654" height="557"&gt;&lt;/a&gt; &lt;figcaption&gt;add之後變成rename&lt;/figcaption&gt;&lt;/figure&gt; &lt;/p&gt; &lt;p&gt;會有這種混搖是因為git觸發檢查的時間點不同，當status的時候還沒比對過資料，而在add等於進入準備建立commit，所以一比對，發現只是&lt;em&gt;檔名&lt;/em&gt;不同（在git來說就是在不同的tree），因此它自動識別原來這是一個檔名變更。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-warning"&gt; &lt;h4 id="WizKMOutline_1497788288023158"&gt;這個時候有些gui就容易誤導使用者&lt;/h4&gt; &lt;p&gt;以TortoiseGit來說，他沒有staging概念（應該說有，但是commit的那個畫面沒有這種感覺）會造成使用者擔心為什麼不是顯示重改檔名，造成他們不敢commit： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-HeFNZXzHn-Q/WUZ3Dw9Mp0I/AAAAAAAAV1g/u1OneGvFaBod-72tg29QgEvejPUUbgrhgCHMYCw/s1600-h/image%255B9%255D"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-yC_QQ7ZqRVQ/WUZ3FQG2tKI/AAAAAAAAV1k/mHS5KlsoaHMJ4BKkWtMWjTWyO7gO1kwKgCHMYCw/image_thumb%255B8%255D?imgmax=800" width="333" height="323"&gt;&lt;/a&gt;&lt;a href="https://lh3.googleusercontent.com/-5UCxYdnuQVk/WUZ2mhW3FaI/AAAAAAAAV1Y/sh80D2yACu4FuS0wa9DE0kLuCj7VEF1HgCHMYCw/s1600-h/image%255B8%255D"&gt;&lt;img title="sourcetree commit畫面" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="sourcetree commit畫面" src="https://lh3.googleusercontent.com/-hnhcLQHrOyo/WUZ2pcIWf1I/AAAAAAAAV1c/EV7KcbsD7JAReDq9O4lEkxKcHLJHeCgMQCHMYCw/image_thumb%255B7%255D?imgmax=800" width="397" height="318"&gt;&lt;/a&gt;&lt;figcaption&gt;（左圖）TortoiseGit的commit畫面 - 看起來和status未add之前看到的內容，（右圖）sourcetree預設有個stage畫面，因此看起來比較明顯&lt;/figcaption&gt;&lt;/figure&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1497788288023478"&gt;在git裡面重新命名怎麼做才正確&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;當檔案&lt;em&gt;內容&lt;/em&gt;沒有&lt;em&gt;修改或者少量&lt;/em&gt;修改的時候，就依照喜歡的方式改檔名就好&lt;br&gt; &lt;li&gt;如果檔案內容有&lt;em&gt;大幅度&lt;/em&gt;修改，建議改檔名和修改內容分&lt;em&gt;兩個&lt;/em&gt;commit（一個改檔案內容，一個改檔名）&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;詳細說明如下：  &lt;h3 id="WizKMOutline_1497788288023284"&gt;有沒有必要呼叫 git mv&lt;/h3&gt; &lt;p&gt;答案是：&lt;strong&gt;&lt;em&gt;不需要&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;&lt;code&gt;git mv&lt;/code&gt; = 改完檔名然後呼叫 git add &lt;/p&gt; &lt;p&gt;因為Windows使用者習慣直接透過檔案總管改檔名，因此專門為了省一個git add的指令而特意去呼叫&lt;code&gt;git mv&lt;/code&gt;有點不方便，只是要知道顯示一個delete和一個untrack是正常即可。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1497788288023734"&gt;當檔案內容和檔案名稱都有修改的情況下是否會不同？&lt;/h3&gt; &lt;p&gt;假設檔案內容只改了&lt;em&gt;一些&lt;/em&gt; - git會夠聰明的知道，其實這是一個修改檔名+修改檔案內容。 &lt;/p&gt; &lt;p&gt;但是當修改檔案內容&lt;em&gt;很多&lt;/em&gt;也有修改檔名，&lt;code&gt;git add&lt;/code&gt;還是會顯示一個&lt;em&gt;delete和一個untrack&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;如果進入那種狀態，會有以下壞處： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;未來在看commit的時候，不那麼直覺能夠看出是一個檔名修改+檔案內容修改&lt;br&gt; &lt;li&gt;&lt;code&gt;-follow&lt;/code&gt;的參數就沒有用了 - 所以換檔名前的log沒法一次顯示  &lt;div class="bs-callout bs-callout-warning"&gt; &lt;h4 id="WizKMOutline_1497788288023145"&gt;當有檔案修改又有檔名修改無法用follow和網上說法有點不同&lt;/h4&gt; &lt;p&gt;以我解git是記錄檔案內容變更，理論上來說就算變成 一個delete一個untrack也應該要能夠用&lt;code&gt;follow&lt;/code&gt;追蹤的到才對，但是實際上我測試的時候不行。 &lt;/p&gt; &lt;p&gt;這個和網路上的一些說法不一致，因此為了未來看起來方便和容易追蹤，建議還是分兩個commit，一個改檔名，一個改檔案內容。 &lt;/p&gt;&lt;/div&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;假設commit已經是一個delete和一個untrack，可以用&lt;code&gt;rebase&lt;/code&gt;把它拆開成為兩個commit，一個改檔名，一個改檔案內容。 &lt;/p&gt;&lt;/div&gt;&lt;br&gt;&lt;/li&gt;&lt;/ol&gt; &lt;h2 id="WizKMOutline_1497788288023198"&gt;結語&lt;/h2&gt; &lt;p&gt;在第一次接觸到git的rename的時候容易進入到以前以&lt;em&gt;檔案修改&lt;/em&gt;為記錄的版控思維影響，因此希望這篇能夠讓了解發生的原因，並且記得： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;如果&lt;code&gt;log&lt;/code&gt;和&lt;code&gt;blame&lt;/code&gt;需要看到包含改檔名前的記錄，記得找找和&lt;code&gt;follow&lt;/code&gt;有關的關鍵字做切換&lt;br&gt; &lt;li&gt;改檔名不用擔心，可以直接用檔案總管修改然後add、commit即可&lt;br&gt; &lt;li&gt;如果檔案有大改，然後又要改檔名，建議分成兩個commit&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2&gt;參考資料&lt;/h2&gt; &lt;ol&gt; &lt;li&gt;&lt;a href="https://stackoverflow.com/questions/29706086/how-to-stage-a-rename-without-subsequent-edits-in-git"&gt;How to stage a rename without subsequent edits in git?&lt;/a&gt; &lt;/li&gt;&lt;/ol&gt;&lt;/section&gt; &lt;div id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:d50a5557-0f39-432d-9b15-7dc098735800" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"&gt;標籤: &lt;a href="http://blog.alantsai.net/search/label/Git" rel="tag"&gt;Git&lt;/a&gt;&lt;/div&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6120019698755413264/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html#comment-form' title='2 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6120019698755413264'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6120019698755413264'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html' title='[git]重新命名檔案的方式和如何在log檢查到改檔名前的歷史記錄'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-tSi1MrWit2g/WUZz09jMMWI/AAAAAAAAVzU/Gy_RyxYzt24m9DKyRbjfkz-DQKffAmrGwCHMYCw/s72-c/image_thumb%255B1%255D?imgmax=800' height='72' width='72'/><thr:total>2</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7740110155824401825</id><published>2017-03-28T00:36:00.000+08:00</published><updated>2017-03-28T00:36:06.566+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='FAQ'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><category scheme='http://www.blogger.com/atom/ns#' term='C#'/><title type='text'>[Visual Studio]如何在Visual Studio 2015使用C#7的功能？</title><content type='html'>&lt;section&gt; &lt;p&gt;隨著Visual Studio 2017發佈之後，C# 7也同時發佈了。 &lt;/p&gt;&lt;p&gt;C# 7 和 C# 6一樣，帶來都是比較偏幫助開發的時候寫起來更加簡潔的一些寫法，因此很容易就會想要使用來增加易讀性。 &lt;/p&gt;&lt;p&gt;這個時候如果團隊使用的Visual Studio版本不同，容易就會發生編譯問題，以Visual Studio 2015來說，在編譯C# 7 就會出錯，那是否就不能夠用了呢？ &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-left-style: none; border-bottom-style: groove; border-right-style: none; margin: 10px 0px"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1490631898571851" ;=""&gt;範例 - out 參數&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1490631898571744" ;=""&gt;問題&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1490631898571833" ;=""&gt;解決方式&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1490631898571191" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1490631898571851"&gt;範例 - out 參數&lt;/h2&gt;&lt;p&gt;當我們需要呼叫方法的參數會回傳out的時候，通常來說都會需要先定義才能夠呼叫，例如： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;int intValue;&lt;br /&gt;int.TryParse("1", out intValue);&lt;br /&gt;Console.WriteLine(intValue);&lt;/pre&gt;&lt;p&gt;C# 7 有提供一種Syntax Sugar可以讓我們不用先定義參數，因此上面範例變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;int.TryParse("1", out int intValue);&lt;br /&gt;Console.WriteLine(intValue);&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1490631898571744"&gt;問題&lt;/h2&gt;&lt;p&gt;使用C# 7的out參數的確會讓整個寫起來變得更加簡潔，因此很容易就給他用下去了，但是當另外一個開發者使用Visual Studio 2015的時候就會出現編譯錯誤： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4nCFLi8-OWk/WNk-FSCyaLI/AAAAAAAAVqk/hRxrjb46CLw/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-NHONykxW4h4/WNk-Hg67dXI/AAAAAAAAVqo/8JZh-_fxGN0/image_thumb%25255B6%25255D.png?imgmax=800" width="704" height="683"&gt;&lt;/a&gt;&lt;figcaption&gt;VS 2015編譯錯誤&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1490631898571833"&gt;解決方式&lt;/h2&gt;&lt;p&gt;因為VS 2015並不了解C# 7的語法，因此VS 2015在build的時候會顯示錯誤。 &lt;/p&gt;&lt;p&gt;但是實際上C# 7同C# 6一樣，只是使用roslyn compiler編譯過就好，因此其實可以透過安裝roslyn的compiler來讓VS 2015編譯過去。 &lt;/p&gt;&lt;p&gt;因此，只需要在專案加上 nuget package： &lt;/p&gt;&lt;kbd&gt;Install-Package Microsoft.Net.Compilers&lt;/kbd&gt; &lt;p&gt;這個時候我們再看build結果： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-N0Ryer-k1sk/WNk-JOlYCgI/AAAAAAAAVqs/vSs86IHHpTc/s1600-h/image%25255B12%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-WeMuzIHToYs/WNk-KkLalVI/AAAAAAAAVqw/VCRHCDOn1-o/image_thumb%25255B4%25255D.png?imgmax=800" width="704" height="599"&gt;&lt;/a&gt;&lt;figcaption&gt;build成功但是VS 2015還是顯示有錯&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;會注意到 雖然build&lt;em&gt;成功&lt;/em&gt;但是VS 2015還是會&lt;em&gt;顯示有錯誤&lt;/em&gt;。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1490631898571732"&gt;Visual Studio 2013編譯C# 6.0&lt;/h4&gt;&lt;p&gt;其實VS 2013編譯C# 6也會有一樣的問題 - 也可以用同樣方式來解決。 &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1490631898571191"&gt;結語&lt;/h2&gt;&lt;p&gt;C# 7編譯上面差異只在於roslyn compiler，因此可以透過用安裝nuget方式安裝roslyn compiler達到在VS 2015也能編譯C# 7語法。 &lt;/p&gt;&lt;p&gt;美中不足的地方是VS 2015上面還是會顯示有錯 - 這個目前沒有任何解法。 &lt;/p&gt;&lt;p&gt;因此最好的開發體驗還是大家一起升級VS 2017是最好。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7740110155824401825/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2015-build-Csharp7.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7740110155824401825'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7740110155824401825'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2015-build-Csharp7.html' title='[Visual Studio]如何在Visual Studio 2015使用C#7的功能？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-NHONykxW4h4/WNk-Hg67dXI/AAAAAAAAVqo/8JZh-_fxGN0/s72-c/image_thumb%25255B6%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783</id><published>2017-03-12T09:16:00.000+08:00</published><updated>2017-03-12T09:20:30.632+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Visual Studio'/><title type='text'>[Visual Studio 2017]建立離線安裝(Offline Install)包</title><content type='html'>&lt;section&gt; &lt;p&gt;「工欲善其事，必先利其器」作為.Net 開發者來說最大的利器就是Visual Studio。 &lt;/p&gt; &lt;p&gt;最近Visual Studio剛過完20歲週年並且發佈了最新版本VS 2017，當然要第一時間來試試看到底可以對開發增加多少幫助，這個時候會發現，怎麼都找不到離線安裝的版本了呢？ &lt;/p&gt; &lt;p&gt;這篇將會介紹如何建立離線安裝版本的安裝檔。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-left-style: none; border-bottom-style: groove; border-right-style: none; margin: 10px 0px"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656480" ;=""&gt;Visual Studio 的安裝方式&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656558" ;=""&gt;建立離線安裝包&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656697" ;=""&gt;1. 下載對應版本的exe檔案&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656587" ;=""&gt;直接連接&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656419" ;=""&gt;2. 建立離線安裝包&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656819" ;=""&gt;檔案大小&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656452" ;=""&gt;VS 2013/2015的離線安裝建立方式&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656670" ;=""&gt;其他參數&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656273" ;=""&gt;下載特定語系&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656846" ;=""&gt;其他語系編號&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540656422" ;=""&gt;只下載特定功能&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540657258" ;=""&gt;Component Id 清單&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540657197" ;=""&gt;其他更多參數&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540657337" ;=""&gt;如何更新離線安裝包&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540657721" ;=""&gt;結語&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 15px; line-height: 1.6" href="#WizKMOutline_1489280540657381" ;=""&gt;其他資訊&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1489280540656480"&gt;Visual Studio 的安裝方式&lt;/h2&gt; &lt;p&gt;現在軟體開發講究都是快速Release，這個從VS近年來的更新速度完全看的出來，為了趕上這些迭代更新的速度，VS的安裝方式也越來越不一樣。 &lt;/p&gt; &lt;p&gt;從早期的光碟方式，到後來變成下載ISO檔案居多，最後到完全透過一個exe檔案邊安裝邊下載的模式 (VS 2017)。 &lt;/p&gt; &lt;p&gt;透過EXE邊下載邊安裝好處是未來有更新任何部分，可以使用同一個exe來執行更新（想一下如果要快速迭代更新要建立多少個ISO檔案），但是壞處是如果要裝在一個網路速度很慢或者沒有網路環境的地方，就gg了。 &lt;/p&gt; &lt;p&gt;幸好雖然VS 2017只有提供exe安裝方式 - 但是提供了方法讓我們可以建立自己的離線安裝包。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1489280540656558"&gt;建立離線安裝包&lt;/h2&gt; &lt;p&gt;要建立離線安裝包非常簡單，只需要： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;下載對應版本的exe安裝檔&lt;br&gt; &lt;li&gt;透過傳入參數的方式來建立離線安裝&lt;br&gt;&lt;/li&gt;&lt;/ol&gt; &lt;h3 id="WizKMOutline_1489280540656697"&gt;1. 下載對應版本的exe檔案&lt;/h3&gt; &lt;p&gt;可以到 Visual Studio的官網（&lt;a href="https://www.visualstudio.com/downloads/"&gt;https://www.visualstudio.com/downloads/&lt;/a&gt;）選擇要裝的版本下載。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540656587"&gt;直接連接&lt;/h4&gt; &lt;ol&gt; &lt;li&gt;Community - &lt;a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Community&amp;amp;rel=15"&gt;https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Community&amp;amp;rel=15&lt;/a&gt;&lt;br&gt; &lt;li&gt;Professional - &lt;a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Professional&amp;amp;rel=15"&gt;https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Professional&amp;amp;rel=15&lt;/a&gt;&lt;br&gt; &lt;li&gt;Enterprise - &lt;a href="https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;amp;rel=15"&gt;https://www.visualstudio.com/thank-you-downloading-visual-studio/?sku=Enterprise&amp;amp;rel=15&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt; &lt;h3 id="WizKMOutline_1489280540656419"&gt;2. 建立離線安裝包&lt;/h3&gt; &lt;p&gt;下載下來之後，用cmd執行執行以下語法即可： &lt;/p&gt;&lt;pre class="brush: plain;"&gt;vs_community.exe --layout c:\vs2017offline&lt;/pre&gt; &lt;dl&gt; &lt;dt&gt;vs_community.exe  &lt;dd&gt;下載下來的exe，不同版本名稱不同，這邊用community做範例  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;--layout  &lt;dd&gt;告訴exe檔案要離線安裝  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;c:\vs2017offline  &lt;dd&gt;這個則是要安裝到哪裡的路徑，可以自己改變要存在哪裡  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt; &lt;p&gt;這個時候會出現一個請等待的畫面。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-awSvLqsLHfc/WMSiSUulwaI/AAAAAAAAVpk/DmheTXcCPDg/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-qVsuW8wP-Qw/WMSiTovt_YI/AAAAAAAAVpo/aNKfrFUZg3w/image_thumb%25255B2%25255D.png?imgmax=800" width="704" height="304"&gt;&lt;/a&gt; &lt;figcaption&gt;請等待&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;然後會在開啟一個cmd的視窗，並且會自動開始下載： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-6_2ZzPQN9tI/WMSiVcrxUuI/AAAAAAAAVps/woyJObZ58Jc/s1600-h/image%25255B4%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-LOZBQIPA-YA/WMSiXvYpnxI/AAAAAAAAVpw/4UoF3LzvhL4/image_thumb%25255B4%25255D.png?imgmax=800" width="704" height="356"&gt;&lt;/a&gt; &lt;figcaption&gt;下載中&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;這個時候就可以放著給他跑了，當下載完成，&lt;em&gt;cmd會自動關掉，不會有任何訊息說下載完成&lt;/em&gt;。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540656819"&gt;檔案大小&lt;/h4&gt; &lt;p&gt;我這邊只下載英文語系，然後全部功能大約需要 12.7GB。 &lt;/p&gt;&lt;/div&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540656452"&gt;VS 2013/2015的離線安裝建立方式&lt;/h4&gt; &lt;p&gt;其實VS 2013開始的exe安裝方式也可以透過--layout參數來建立離線安裝包。和官方提供的ISO來比，這種方式的下載出來的比較全。 &lt;/p&gt; &lt;p&gt;VS 2013/2015的安裝畫面和2017最大差異在於之前版本可以直接用UI選擇要下載什麼，並且完成會有訊息告知完成。 &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1489280540656670"&gt;其他參數&lt;/h2&gt; &lt;p&gt;上面介紹的是基本建立方式，但是如果想要只安裝部分元件或者只要部分語言的話就需要其他參數，這邊介紹幾個其他參數的用法。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1489280540656273"&gt;下載特定語系&lt;/h3&gt; &lt;p&gt;預設，offline install是下載所有語系，但是通常情況是只會用到需要的語系而已。以我個人來說，習慣使用英文版，這個時候其他語系的檔案只是增加下載時間而已。 &lt;/p&gt; &lt;p&gt;語系可以在後面增加參數：&lt;code&gt;--lang $languageCode1&lt;/code&gt;&lt;/p&gt; &lt;dl&gt; &lt;dt&gt;--lang  &lt;dd&gt;告訴她要下載特定語系  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;$languageCode1  &lt;dd&gt;要下載的語系名稱，如果有多個，就往下加每個code之間用空白區隔。  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt; &lt;p&gt;整個組合在一起就是： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 安裝英文版本&lt;br /&gt;vs_community.exe --layout c:\vs2017offline --lang en-US&lt;br /&gt;# 安裝英文和繁體中文版本&lt;br /&gt;vs_community.exe --layout c:\vs2017offline --lang en-US zh-TW&lt;/pre&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540656846"&gt;其他語系編號&lt;/h4&gt; &lt;p&gt;如果要安裝其他語系版本，語系編碼可以在這看到：&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio#list-of-language-locales"&gt;https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio#list-of-language-locales&lt;/a&gt;&lt;/p&gt;&lt;/div&gt; &lt;h3 id="WizKMOutline_1489280540656422"&gt;只下載特定功能&lt;/h3&gt; &lt;p&gt;假設不希望下載全部功能，這個時候可以用參數 &lt;code&gt;--add $componentId&lt;/code&gt;&lt;/p&gt; &lt;dl&gt; &lt;dt&gt;--add  &lt;dd&gt;告訴它下載特定功能就好  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;$componentId  &lt;dd&gt;要下載的功能清單，多個就用空白區隔即可  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;pre class="brush: powershell;"&gt;# 只安裝 azure和github相關功能&lt;br /&gt;vs_community.exe --layout c:\vs2017offline --add Microsoft.VisualStudio.Workload.Azure Component.GitHub.VisualStudio &lt;/pre&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540657258"&gt;Conponent Id 清單&lt;/h4&gt;可以參考&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/workload-and-component-ids"&gt;https://docs.microsoft.com/en-us/visualstudio/install/workload-and-component-ids&lt;/a&gt;找到自己要的component Id &lt;/div&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1489280540657197"&gt;其他更多參數&lt;/h4&gt; &lt;p&gt;還有其他參數可以下，在這邊可以找到相關資訊&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio"&gt;https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1489280540657337"&gt;如何更新離線安裝包&lt;/h2&gt; &lt;p&gt;假設過了一段時間之後，VS 2017的Component有更新，這個時候是否需要重新下載全部的功能呢？ &lt;/p&gt; &lt;p&gt;其實是不用的，只需要把你當初下載離線包的指令在執行一次，有更新的部分就會自動更新。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;這邊要注意是一樣的指令哦，要不然會下載其他東西。舉例來說，如果當初只安裝英文版，後來沒加上英文版，其他語系也會被下載下來。 &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1489280540657721"&gt;結語&lt;/h2&gt; &lt;p&gt;這篇介紹了如何建立自己的離線安裝包並且如何客制一些常見的參數。當離線包有了，就可以節省其他人安裝的時間。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1489280540657381"&gt;其他資訊&lt;/h2&gt; &lt;dl&gt; &lt;dt&gt;官方介紹如何建立離線包  &lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/create-an-offline-installation-of-visual-studio"&gt;https://docs.microsoft.com/en-us/visualstudio/install/create-an-offline-installation-of-visual-studio&lt;/a&gt;  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;exe其他參數  &lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio"&gt;https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio&lt;/a&gt;  &lt;dd&gt;&lt;br&gt; &lt;dt&gt;可安裝的component 對應id清單  &lt;dd&gt;&lt;a href="https://docs.microsoft.com/en-us/visualstudio/install/workload-and-component-ids"&gt;https://docs.microsoft.com/en-us/visualstudio/install/workload-and-component-ids&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1965872306512675783/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html#comment-form' title='8 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' title='[Visual Studio 2017]建立離線安裝(Offline Install)包'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-qVsuW8wP-Qw/WMSiTovt_YI/AAAAAAAAVpo/aNKfrFUZg3w/s72-c/image_thumb%25255B2%25255D.png?imgmax=800' height='72' width='72'/><thr:total>8</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8816593916184499775</id><published>2017-01-15T02:36:00.000+08:00</published><updated>2017-12-12T23:34:05.039+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 20]靜態程式碼分析之程式碼風格 - Stylecop</title><content type='html'>&lt;section&gt; &lt;p&gt;在上篇介紹了如何透過使用Code Analysis來達到程式碼品質的分析。 &lt;/p&gt;&lt;p&gt;在這一篇將會從另外一個層面介紹使用靜態程式碼分析來達到程式碼&lt;em&gt;風格&lt;/em&gt;的一致性 - Stylecop。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter20"&gt;github devops-psake sample/chapter20&lt;/a&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333802" ;=""&gt;Stylecop是什麼？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333654" ;=""&gt;Stylecop如何使用&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333283" ;=""&gt;設定規則&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333791" ;=""&gt;執行StyleCop&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333581" ;=""&gt;在建制的時候執行&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333657" ;=""&gt;整合到build script&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333287" ;=""&gt;調整VS建制不執行StyleCop&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333662" ;=""&gt;調整build script&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484418446333223" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484418446333802"&gt;Stylecop是什麼？&lt;/h2&gt;&lt;p&gt;Stylecop才是比較符合俗稱的程式碼靜態分析工具。概念和Code Analysis一樣，差別在於Stylecop是分析程式碼的&lt;em&gt;風格&lt;/em&gt;，而Code Analysis則是分析程式碼的&lt;em&gt;邏輯或寫法&lt;/em&gt;是否有問題。 &lt;/p&gt;&lt;p&gt;風格可能有點抽象，舉個簡單的例子就很容易理解，例如說兩個statement之間只能空一行，如果沒空就會報錯，或者是每一個方法都要寫註解，沒有就報錯。 &lt;/p&gt;&lt;p&gt;這些可能感覺很無聊，但是實際上非常重要，因為當開發者是多人的時候，大家習慣不同，很容易整個程式碼看起來很亂。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;ul&gt;&lt;li&gt;Nuget - &lt;a href="https://www.nuget.org/packages/StyleCop.MSBuild"&gt;https://www.nuget.org/packages/StyleCop.MSBuild&lt;/a&gt;&lt;br /&gt;&lt;li&gt;Nuget 指令 - &lt;kbd&gt;Install-Package StyleCop.MSBuild -Version 4.7.55&lt;/kbd&gt;&lt;br /&gt;&lt;li&gt;VS Extension - &lt;a href="https://marketplace.visualstudio.com/items?itemName=ChrisDahlberg.StyleCop"&gt;https://marketplace.visualstudio.com/items?itemName=ChrisDahlberg.StyleCop&lt;/a&gt;&lt;br /&gt;&lt;li&gt;設定檔編輯程式 - &lt;a href="http://stylecop.codeplex.com/releases/view/629688"&gt;http://stylecop.codeplex.com/releases/view/629688&lt;/a&gt; - 這個主要目的是提供 程式自動關聯&lt;code&gt;.StyleCop&lt;/code&gt;的檔案，並且提供界面化設定啟用的規則&lt;br /&gt;&lt;li&gt;github - &lt;a href="https://github.com/StyleCop/StyleCop"&gt;https://github.com/StyleCop/StyleCop&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484418446333654"&gt;Stylecop如何使用&lt;/h2&gt;&lt;p&gt;Stylecop分兩個部分：設定規則和執行分析。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1484418446333283"&gt;設定規則&lt;/h3&gt;&lt;p&gt;stylecop的設定檔預設使用&lt;code&gt;.stylecop&lt;/code&gt;作為付檔名。通常檔案名稱為&lt;code&gt;setting.stylecop&lt;/code&gt;&lt;/p&gt;&lt;p&gt;可以下載設定檔編輯程式比較容易作調整 - 基本上打開就會有一個畫面能夠勾選要執行那些規則。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jZfWzPAk4fY/WHpu-pgpoRI/AAAAAAAAVLY/J0Droyh7Ekk/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-CIJGvR14JY0/WHpu_qCSPCI/AAAAAAAAVLc/LiG5JbpWN28/image_thumb.png?imgmax=800" width="644" height="347"&gt;&lt;/a&gt; &lt;figcaption&gt;設定規則&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;設定檔放在solution下，就會在執行stylecop的時候自動被引用。 &lt;/p&gt;&lt;p&gt;有些規則其實不太符合習慣，所以也不是所有規則都要啟用，可以找一些常見的專案然後看他們都設定些什麼做參考。舉例來說，在Mvc專案的source code就可以看到啟用了那些規則： &lt;a href="https://aspnetwebstack.codeplex.com/SourceControl/latest"&gt;Mvc最新程式碼&lt;/a&gt;&lt;/p&gt;&lt;h3 id="WizKMOutline_1484418446333791"&gt;執行StyleCop&lt;/h3&gt;&lt;p&gt;執行方式有兩種： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;在VS上面執行 - 這個如果有安裝VS的Extension就可以呼叫&lt;br /&gt;&lt;li&gt;在建制的時候執行&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h4 id="WizKMOutline_1484418446333581"&gt;在建制的時候執行&lt;/h4&gt;&lt;p&gt;基本上，對於需要掃描stylecop的程式安裝套件&lt;code&gt;StyleCop.MSBuild&lt;/code&gt;即可。 &lt;/p&gt;&lt;p&gt;然後在build的時候，在Warning那邊就會看到不符合規則訊息。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-j8F4sFBwJ3Q/WHpvA3SLQ0I/AAAAAAAAVLg/UCdCpWJxJAs/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-h9Ve01XBTJM/WHpvDRPeFEI/AAAAAAAAVLk/MWt8EQsnALI/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="138"&gt;&lt;/a&gt; &lt;figcaption&gt;執行結果不通過出現在warning裡面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484418446333657"&gt;整合到build script&lt;/h2&gt;&lt;p&gt;同Code Analysis一樣，執行這種分析所花的時間也可能非常的久，因此這種類型的分析也最好是放在build server的時候執行。 &lt;/p&gt;&lt;p&gt;如果要把stylecop整合到build script，需要做幾件事情： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;先調整讓VS建制的情況下，不執行StyleCop&lt;br /&gt;&lt;li&gt;設定build script要執行StyleCop，並且把warning當做error&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1484418446333287"&gt;調整VS建制不執行StyleCop&lt;/h3&gt;&lt;p&gt;這個要調整有要執行stylecop的專案csproj檔案 - 以這個例子是&lt;code&gt;Webapplication1.csproj&lt;/code&gt;。 &lt;/p&gt;&lt;p&gt;用notepad打開，然後加上： &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;propertygroup&gt;&lt;br /&gt; &lt;stylecopenabled&gt;false&lt;/stylecopenabled&gt;&lt;br /&gt;&lt;/propertygroup&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-sXjnZ0OcKoQ/WHpvE7xI-kI/AAAAAAAAVLo/OE2HQHC5kOE/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-oUDsXTCcEng/WHpvF9wX_6I/AAAAAAAAVLs/B42z1wWh7Yc/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="252"&gt;&lt;/a&gt; &lt;figcaption&gt;調整csproj&lt;/figcaption&gt;&lt;/figure&gt; &lt;h3 id="WizKMOutline_1484418446333662"&gt;調整build script&lt;/h3&gt;&lt;p&gt;build script加入兩個參數： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;code&gt;StyleCopEnabled=true&lt;/code&gt; - 啟用StyleCop&lt;br /&gt;&lt;li&gt;&lt;code&gt;StyleCopTreatErrorsAsWarnings=false&lt;/code&gt; - 把StyleCop錯誤當成error類型的錯誤&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;pre class="brush: powershell;highlight:12"&gt;task Compile -depends Clean, Init -description "編譯程式碼" `&lt;br /&gt;    -requiredVariables solutionFile, buildConfiguration, buildTarget, buildTempDirectory `&lt;br /&gt;{ &lt;br /&gt; Write-Host "開始建制檔案：$solutionFile"&lt;br /&gt;&lt;br /&gt; $buildParam = "Configuration=$buildConfiguration" +&lt;br /&gt;     ";Platform=$buildTarget" + &lt;br /&gt;     ";OutDir=$buildTempDirectory"&lt;br /&gt; &lt;br /&gt; $buildParam = $buildParam + ";GenerateProjectSpecificOutputFolder=true"&lt;br /&gt; $buildParam = $buildParam + ";RunCodeAnalysis=true;CodeAnalysisRuleSet=MinimumRecommendedRules.ruleset;CodeAnalysisTreatWarningsAsErrors=true"&lt;br /&gt; $buildParam = $buildParam + ";StyleCopEnabled=true;StyleCopTreatErrorsAsWarnings=false"&lt;br /&gt;&lt;br /&gt; exec {msbuild $solutionFile "/p:$buildParam"}&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484418446333223"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇粗略了介紹如何使用Stylecop並且如何整合到build流程的一部分。 &lt;/p&gt;&lt;p&gt;通過，Test coverage的Opencover確保了測試程式碼的涵蓋率；透過Code Analysis分析程式碼上面是否有一些不好的邏輯寫法；透過StyleCop讓整個程式碼的風格一致化，這些都是保持程式碼的 品質在一定水準的方法。 &lt;/p&gt;&lt;p&gt;品質過關之後，就要進入發佈上線的階段。 &lt;/p&gt;&lt;p&gt;因此，在接下去將進入到另外一個階段，到底如何準備好發佈需要的東西。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8816593916184499775/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-stylecop.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8816593916184499775'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8816593916184499775'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-stylecop.html' title='[iThome第8屆鐵人賽 20]靜態程式碼分析之程式碼風格 - Stylecop'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-CIJGvR14JY0/WHpu_qCSPCI/AAAAAAAAVLc/LiG5JbpWN28/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6448198893895417041</id><published>2017-01-15T00:35:00.000+08:00</published><updated>2017-12-12T23:34:04.637+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 19]靜態程式碼分析之Assembly品質分析 - Code Analysis(以前的FxCop)</title><content type='html'>&lt;section&gt; &lt;p&gt;在了解完如何分析測試碼的涵蓋率(也代表測試品質)之後，我們將來看另外一種保持程式碼品質的方式，也就是透過靜態程式碼分析。 &lt;/p&gt;&lt;p&gt;在.Net的世界里，從最早期的而外工具FxCop，到後來進化成為VS一部分的Code Analysis就是專門在做這個方面工作的工具。 &lt;/p&gt;&lt;p&gt;在這篇將會介紹如何使用Code Analysis，並且如何把它整并到我們的Build Script裡面。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;廣義來說，靜態程式碼分析應該是針對源代碼(Source Code)作分析，實際上Code Analysis其實是對Assembly作分析，而Assembly也是IL，所以真的要叫做靜態程式碼分析應該也沒錯，只是 真的要嚴格說起來，Code Analysis應該不能夠稱之為靜態程式碼分析。不過以下我還是會稱之為靜態程式碼分析。(有點繞口) &lt;/div&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter19"&gt;github devops-psake sample/chapter19&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105643127" ;=""&gt;什麼是靜態程式碼分析？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644841" ;=""&gt;.Net世界的靜態程式碼分析 - Code Analysis&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644501" ;=""&gt;如何在VS執行Code Analysis&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644349" ;=""&gt;手動執行&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644258" ;=""&gt;設定使用規則&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644126" ;=""&gt;執行靜態程式碼分析&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644729" ;=""&gt;建制的時候自動執行&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644944" ;=""&gt;在build的時候在執行靜態程式碼分析&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484409105644434" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484409105643127"&gt;什麼是靜態程式碼分析？&lt;/h2&gt;&lt;p&gt;靜態程式碼分析其實就是一個針對&lt;em&gt;原程式碼掃描&lt;/em&gt;並且把裡面的結果和&lt;em&gt;規則(RuleSet)&lt;/em&gt;做比對，如果有哪些程式碼不符合規則將會爆出訊息。 &lt;/p&gt;&lt;p&gt;舉例來說，資安風險裡面一個最常見的風險之一就是sql injection - 因此有專門規則是在找出程式碼那裡使用了可能導致sql injection的程式碼。 &lt;/p&gt;&lt;p&gt;從某種程度來說，靜態程式碼分析和聽到的白箱資安掃描其實是同一種類的東西。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;在各個語言基本上都有靜態程式碼分析的工具，尤其是像有些不需要編譯的語言(例如javascript)更是大量使用靜態程式碼分析來增強程式碼品質，這種分析工具在Javascript或者css 稱之為&lt;code&gt;lint&lt;/code&gt;&lt;/div&gt;&lt;/section&gt;&lt;secction&gt; &lt;h2 id="WizKMOutline_1484409105644841"&gt;.Net世界的靜態程式碼分析 - Code Analysis&lt;/h2&gt;&lt;p&gt;在.net世界裡面，最早提供靜態程式碼分析的工具是FxCop。這個工具當初是一個另外下載的一個console程式，並且用它做執行。 &lt;/p&gt;&lt;p&gt;再後來，FxCop被微軟整合到了VS裡面，稱之為Code Analysis，並且在VS裡面提供了方法方便執行這些分析。 &lt;/p&gt;&lt;p&gt;因此，要使用靜態程式碼分析並不需要另外安裝什麼東西，VS就包含了這個工具。 &lt;/p&gt;&lt;p&gt;在接下來將會看看在VS裡面到底如何使用此工具。 &lt;/p&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484409105644501"&gt;如何在VS執行Code Analysis&lt;/h2&gt;&lt;p&gt;在VS裡面也有兩種執行的方式： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;手動執行&lt;br /&gt;&lt;li&gt;建制的時候自動執行&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1484409105644349"&gt;手動執行&lt;/h3&gt;&lt;p&gt;在&lt;code&gt;Analyze&lt;/code&gt;功能裡面可以先對每一個project用的規則做設定，然後就可以手動執行。 &lt;/p&gt;&lt;h4 id="WizKMOutline_1484409105644258"&gt;設定使用規則&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;在Tool bar選擇：&lt;code&gt;Analyze -&amp;gt; Configure Code Anaysis - &amp;gt; For Solution&lt;/code&gt;&lt;br /&gt;&lt;li&gt;可以設定每一個專案所要使用的規則集&lt;br /&gt;&lt;li&gt;如果想自訂規則集也可以&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;figure&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-2uXyPKcHbVw/WHpR_-EIpsI/AAAAAAAAVKI/GUxu0mYVlLI/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-_9EjK3QiUuc/WHpSBtsUqEI/AAAAAAAAVKM/Pc5qDtlvA3o/image_thumb.png?imgmax=800" width="644" height="270"&gt;&lt;/a&gt;&lt;figcaption&gt;開啟設定規則集的畫面&lt;/p&gt;&lt;p&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-5IgPyupyvCU/WHpSCVYn9_I/AAAAAAAAVKQ/dNODkBp1ZWY/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-c9twhiDtEu8/WHpSDB_qKsI/AAAAAAAAVKU/jbLH_I5_0OQ/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="214"&gt;&lt;/a&gt;&lt;figcaption&gt;選擇專案使用的規則集&lt;/figcaption&gt;&lt;/figure&gt; &lt;/p&gt;&lt;h4 id="WizKMOutline_1484409105644126"&gt;執行靜態程式碼分析&lt;/h4&gt;&lt;p&gt;在&lt;code&gt;Analyze -&amp;gt; Run Code Anaysis -&amp;gt; For Solution&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0Yjd38BnuNM/WHpSEKKnGTI/AAAAAAAAVKY/YagDeETRpvs/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-geGI9EiSQrs/WHpSExeS8gI/AAAAAAAAVKc/4JthcKtHAAo/image_thumb%25255B3%25255D.png?imgmax=800" width="644" height="193"&gt;&lt;/a&gt;&lt;figcaption&gt;執行靜態程式碼分析&lt;a href="https://lh3.googleusercontent.com/-uAGK6iS2F4g/WHpSGsPnvBI/AAAAAAAAVKg/HS9YczAOeUo/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-sTjOvmSh15c/WHpSKnuU-eI/AAAAAAAAVKk/qqUUMLNts3c/image_thumb%25255B4%25255D.png?imgmax=800" width="644" height="141"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;執行結果有問題會出現在Erro List清單&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-info"&gt;預設的規則集沒有那麼嚴，所以應該不會看到任何Warning，如果這個時候把規則集改成&lt;code&gt;All&lt;/code&gt;就會看到。 &lt;/div&gt;&lt;h3 id="WizKMOutline_1484409105644729"&gt;建制的時候自動執行&lt;/h3&gt;&lt;p&gt;能夠手動執行當然好，但是不能夠自動執行嗎？ &lt;/p&gt;&lt;p&gt;在Visual Studio其實有提供設定讓Code Analysis在兼職的時候自動執行。 &lt;/p&gt;&lt;p&gt;對要設定建制自動執行的專案點 &lt;code&gt;右鍵 -&amp;gt; Properties -&amp;gt; Code Analysis&lt;/code&gt; 然後把 &lt;code&gt;Enable Code Analysis on Build&lt;/code&gt;打鉤即可 &lt;/p&gt;&lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-RUkK8gaTvL8/WHpSMaOykxI/AAAAAAAAVKo/1O-5UaCJetM/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-E3jz9EFx_OE/WHpSNLrXJvI/AAAAAAAAVKs/o_ZB2__DUVo/image_thumb%25255B5%25255D.png?imgmax=800" width="501" height="484"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/--QR8RF09Mss/WHpSOAM22rI/AAAAAAAAVKw/TOmHYECZzIk/s1600-h/image%25255B20%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-eDTODJeVCxQ/WHpSQRf4lNI/AAAAAAAAVK0/FVbIIAjQhzs/image_thumb%25255B6%25255D.png?imgmax=800" width="644" height="428"&gt;&lt;/a&gt;&lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;在這邊也可以設定要用那個規則集和更詳細調整哪一個規則要開啟： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cYpBYMWonBc/WHpSRLBtMRI/AAAAAAAAVK4/uzX0pT1zDRk/s1600-h/image%25255B23%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-NnhJKuHwKlo/WHpSTiPPusI/AAAAAAAAVK8/WkWXmJj4_Yw/image_thumb%25255B7%25255D.png?imgmax=800" width="644" height="424"&gt;&lt;/a&gt;&lt;figcaption&gt;規則集調整設定&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Rbno1h8J4zU/WHpSWLH2EFI/AAAAAAAAVLA/LIn7_yps_7s/s1600-h/image%25255B26%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-YQV34g52G9c/WHpSXhmkNWI/AAAAAAAAVLE/uPkasiXoTAU/image_thumb%25255B8%25255D.png?imgmax=800" width="644" height="218"&gt;&lt;/a&gt;&lt;figcaption&gt;設定畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;  &lt;h2 id="WizKMOutline_1484409105644944"&gt;在build的時候在執行靜態程式碼分析&lt;/h2&gt;&lt;p&gt;既然能夠手動執行和在建制的時候自動執行，那為什麼不在那個時候執行就好？ &lt;/p&gt;&lt;p&gt;原因很簡單，&lt;em&gt;時間問題&lt;/em&gt;。 &lt;/p&gt;&lt;p&gt;當專案越來越大，每跑一次靜態程式碼分析的時間會需要越來越長。在考慮到還要執行單元測試，整個加在一起會拖累整個開發速度。 &lt;/p&gt;&lt;p&gt;所以為了整個開發的速度能夠快，但是又不犧牲程式碼的品質，這種靜態程式碼分析通常都是在build server執行 - 因為那個時候要執行多久都不會打斷開發時間。 &lt;/p&gt;&lt;p&gt;要在build的時候執行靜態程式碼分析，需要設定三個參數： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;code&gt;RunCodeAnalysis=true&lt;/code&gt; - 表示要執行靜態程式碼分析&lt;br /&gt;&lt;li&gt;&lt;code&gt;CodeAnalysisRuleSet=AllRules.ruleset&lt;/code&gt; - 要用那個規則集執行 - 出入內建的規則集 如果有客製規則集，可以把規則集的路徑放入參數&lt;br /&gt;&lt;li&gt;&lt;code&gt;CodeAnalysisTreatWarningsAsErrors=true&lt;/code&gt; - 這個主要目的是把靜態程式碼分析出來有問題的部分當做Error而不是Warning。&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;p&gt;最後，&lt;code&gt;default.ps1&lt;/code&gt;調整如下： &lt;/p&gt;&lt;pre class="brush: csharp;highlight:11"&gt;task Compile -depends Clean, Init -description "編譯程式碼" `&lt;br /&gt;    -requiredVariables solutionFile, buildConfiguration, buildTarget, buildTempDirectory `&lt;br /&gt;{ &lt;br /&gt; Write-Host "開始建制檔案：$solutionFile"&lt;br /&gt;&lt;br /&gt; $buildParam = "Configuration=$buildConfiguration" +&lt;br /&gt;     ";Platform=$buildTarget" + &lt;br /&gt;     ";OutDir=$buildTempDirectory"&lt;br /&gt; &lt;br /&gt; $buildParam = $buildParam + ";GenerateProjectSpecificOutputFolder=true"&lt;br /&gt; $buildParam = $buildParam + ";RunCodeAnalysis=true;CodeAnalysisRuleSet=AllRules.ruleset;CodeAnalysisTreatWarningsAsErrors=true"&lt;br /&gt;&lt;br /&gt; exec {msbuild $solutionFile "/p:$buildParam"}&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484409105644434"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇快速介紹了靜態程式碼分析，並且如何在VS和build script裡面使用。 &lt;/p&gt;&lt;p&gt;實際上這個可以更詳細的看每一個規則，和介紹一下一般來說那些要打開，不過這個畢竟不是這個系列的重點。 &lt;/p&gt;&lt;p&gt;希望透過這篇，就能夠立竿見影開始使用靜態程式碼分析來提升程式碼品質。 &lt;/p&gt;&lt;p&gt;在下一篇將會介紹另外一個角度的靜態程式碼分析 - 用來統一團隊開發風格的工具StyleCop。 &lt;/p&gt;&lt;/section&gt;&lt;/secction&gt;&lt;section&gt; &lt;h2&gt;相關資料&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/6399014/disable-code-analysis-for-some-projects-using-msbuild"&gt;Disable Code Analysis for Some Projects using MSBuild&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/3178537/how-do-i-specify-a-ruleset-from-msbuild"&gt;How do I specify a ruleset from MSBuild&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/38050517/tfs-build-ignores-configured-code-analysis-ruleset"&gt;TFS Build ignores configured Code Analysis ruleset&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/14366181/treat-warnings-as-errors-has-no-effect"&gt;Treat Warnings as Errors has no effect&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="https://blogs.msdn.microsoft.com/hkamel/2013/10/24/visual-studio-2013-static-code-analysis-in-depth-what-when-and-how/"&gt;Visual Studio 2013 Static Code Analysis in depth: What? When and How?&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6448198893895417041/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-codeAnalysis.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6448198893895417041'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6448198893895417041'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-codeAnalysis.html' title='[iThome第8屆鐵人賽 19]靜態程式碼分析之Assembly品質分析 - Code Analysis(以前的FxCop)'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-_9EjK3QiUuc/WHpSBtsUqEI/AAAAAAAAVKM/Pc5qDtlvA3o/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-9213279794878473081</id><published>2017-01-14T18:34:00.000+08:00</published><updated>2017-12-12T23:34:05.105+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 18]OpenCover 結果 - html結果產生篇</title><content type='html'>&lt;section&gt; &lt;p&gt;在上篇了解到了測試涵蓋率的計算方式之後，已經可以了解xml報告的一些數字所代表的意思。 &lt;/p&gt;&lt;p&gt;但是，xml畢竟不是那麼容易讀得懂，並且也不容易看出到底那些地方沒有測試到。 &lt;/p&gt;&lt;p&gt;在這篇，將會介紹如何把xml結果產生出html結果，並且如何使用。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter18"&gt;github devops-psake sample/chapter18&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753491" ;=""&gt;ReportGenerator - html結果產生工具&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753128" ;=""&gt;build script調整&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753186" ;=""&gt;安裝ReportGenerator&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753602" ;=""&gt;在測試執行完成產生html結果&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753235" ;=""&gt;html結果介紹&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753932" ;=""&gt;結果總覽&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753619" ;=""&gt;Assembly執行結果&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753630" ;=""&gt;Assembly詳細&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753794" ;=""&gt;其他呈現方式&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484389680753778" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484389680753491"&gt;ReportGenerator - html結果產生工具&lt;/h2&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1484389680753541"&gt;ReportGerator&lt;/h4&gt;&lt;p&gt;能夠把多種coverage工具的xml結果產生html格式，其中就有包括open cover的格式 &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Nuget - &lt;a href="https://www.nuget.org/packages/ReportGenerator/"&gt;https://www.nuget.org/packages/ReportGenerator/&lt;/a&gt;&lt;br /&gt;&lt;li&gt;Nuget 安裝指令 - &lt;kbd&gt;Install-Package ReportGenerator&lt;/kbd&gt;&lt;br /&gt;&lt;li&gt;Github - &lt;a href="https://github.com/danielpalme/ReportGenerator"&gt;https://github.com/danielpalme/ReportGenerator&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484389680753128"&gt;build script調整&lt;/h2&gt;&lt;p&gt;基本上有以下幾個地方要調整： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;把ReportGenerator安裝到build專案&lt;br /&gt;&lt;li&gt;在測試執行完的時候產生結果&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1484389680753186"&gt;安裝ReportGenerator&lt;/h3&gt;&lt;p&gt;透過nuget先安裝ReportGenerator，再來在&lt;code&gt;default.ps1&lt;/code&gt;裡面，建立一個property是代表reportGenerator的工具： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;Properties{&lt;br /&gt;....&lt;br /&gt;$reportGeneratorExe = (Get-PackagePath $packageDirectoryPath "ReportGenerator") +&lt;br /&gt;   "\tools\ReportGenerator.exe"&lt;br /&gt;....&lt;br /&gt;}  &lt;br /&gt;  &lt;/pre&gt;&lt;h3 id="WizKMOutline_1484389680753602"&gt;在測試執行完成產生html結果&lt;/h3&gt;&lt;p&gt;再來，有一個&lt;code&gt;Test&lt;/code&gt;的task，這個task其實是在3個測試framework執行完才會執行。 &lt;/p&gt;&lt;p&gt;因此可以在這邊多一個判斷，如果有產生出Coverage的xml的時候，在執行ReportGenerator。 &lt;/p&gt;&lt;p&gt;這個Generator執行起來很容易，只需要傳入兩個參數： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;openCover xml結果的路徑&lt;br /&gt;&lt;li&gt;產生的html要放的路徑&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;p&gt;因此整個task變成： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Test -depends Compile, Clean, XunitTest, NunitTest, MSTest -description "執行Test" { &lt;br /&gt; &lt;br /&gt; if(Test-Path $openCoverResult){&lt;br /&gt;  Write-Host "`r`n產生測試涵蓋率報告 html 格式"&lt;br /&gt;  exec{ &amp;amp;$reportGeneratorExe $openCoverResult $buildTestCoverageDirectory}&lt;br /&gt; } else {&lt;br /&gt;  Write-Host "`r`n沒有產生測試涵蓋率報告"&lt;br /&gt; }&lt;br /&gt;&lt;br /&gt; Write-Host $testMsg&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484389680753235"&gt;html結果介紹&lt;/h2&gt;&lt;p&gt;當在執行build的時候，會在&lt;code&gt;.\testCoverage&lt;/code&gt;裡面多出很多檔案，其中最重要的檔案就是&lt;code&gt;Index.htm&lt;/code&gt;&lt;/p&gt;&lt;p&gt;如果把Index.htm執行起來，可以看到結果的總覽。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1484389680753932"&gt;結果總覽&lt;/h3&gt;&lt;p&gt;在index.htm的上半部，是整個結果的總覽。其中有個部分要注意的是，裡面用了&lt;code&gt;Line Coverage&lt;/code&gt;這個詞，但是其實這邊指的是&lt;code&gt;Sequence Point Coverage&lt;/code&gt;（在報告其他地方也是同理） &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-4WLlQKidvbY/WHn-JV2RG5I/AAAAAAAAVIw/zMu0MD2vM34/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-b2mXcw0O2hM/WHn-KCfu8QI/AAAAAAAAVI0/bVUAMJZISa0/image_thumb.png?imgmax=800" width="644" height="178"&gt;&lt;/a&gt;&lt;figcaption&gt;可以看到整個測試涵蓋率&lt;/figcaption&gt;&lt;/figure&gt; &lt;h3 id="WizKMOutline_1484389680753619"&gt;Assembly執行結果&lt;/h3&gt;&lt;p&gt;在Index.htm的下面則是Assembly執行的總覽，可以簡單看到那些涵蓋率是多少。 &lt;/p&gt;&lt;p&gt;這邊有幾個可以使用的地方： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Grouping - 可以切換如何group結果，只要用左右拖拉即可&lt;br /&gt;&lt;li&gt;排序 - 每一個表頭的三角形可以點做排序&lt;br /&gt;&lt;li&gt;Filter - 可以過濾要看哪一個&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-jrJaI5Gt9K4/WHn-LNCJ-jI/AAAAAAAAVI4/bDehJyMtQ7Y/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-UMQYNs6dHrg/WHn-LwbJqXI/AAAAAAAAVI8/_dzATXYCUxI/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="233"&gt;&lt;/a&gt;&lt;figcaption&gt;Assembly總覽&lt;/figcaption&gt;&lt;/figure&gt; &lt;h3 id="WizKMOutline_1484389680753630"&gt;Assembly詳細&lt;/h3&gt;&lt;p&gt;如果選一個assembly，可以點進去看到底那邊有cover到，那邊沒有。 &lt;/p&gt;&lt;p&gt;下面的例子是我們唯一有寫測試的地方，這個報告還會highlight出，那邊是測試點。如果沒涵蓋，會用紅色標註 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9prErRlDGV8/WHn-NbYXMBI/AAAAAAAAVJA/x1i6S1w5-y8/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-TJCFPgkxx60/WHn-PMS27FI/AAAAAAAAVJE/3-k4pTkYCR0/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="444"&gt;&lt;/a&gt;&lt;figcaption&gt;Assembly詳細&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484389680753794"&gt;其他呈現方式&lt;/h2&gt;&lt;p&gt;ReportGenerator產生的html其實非常詳細，用來看結果其實非常容易發現沒測試到的地方。 &lt;/p&gt;&lt;p&gt;不過或許會好奇還有沒有其他使用OpenCover的xml結果的方式，其實還有兩個地方： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;a href="https://coveralls.io/"&gt;Coveralls&lt;/a&gt; - 如果有希望在網路上給大家看到測試涵蓋率，可以使用Coveralls這個網站服務 - 可以把這個整合到build script裡面，自動把結果發佈到上面&lt;br /&gt;&lt;li&gt;&lt;a href="https://marketplace.visualstudio.com/items?itemName=jamdagni86.OpenCoverUI"&gt;OpenCover UI - VS 套件&lt;/a&gt; - 這個是開發的時候可以使用的，能夠在VS工具裡面直接看到那段程式碼有沒有涵蓋，類似於VS 高版本裡面的Coverage工具呈現的樣子。 &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484389680753778"&gt;結語&lt;/h2&gt;&lt;p&gt;透過這篇，對於測試涵蓋率和測試碼品質如何保證有個概念。 &lt;/p&gt;&lt;p&gt;接下來會來看看另外一個角度來保證程式碼品質，也就是透過程式碼分析的方式來達到。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/9213279794878473081/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-generateHtmlResult.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9213279794878473081'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9213279794878473081'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-generateHtmlResult.html' title='[iThome第8屆鐵人賽 18]OpenCover 結果 - html結果產生篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-b2mXcw0O2hM/WHn-KCfu8QI/AAAAAAAAVI0/bVUAMJZISa0/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5153194122198882687</id><published>2017-01-14T16:58:00.000+08:00</published><updated>2017-12-12T23:34:04.371+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 17]OpenCover 結果 - 涵蓋率介紹篇</title><content type='html'>&lt;section&gt; &lt;p&gt;在上篇把OpenCover整合到測試之後，每當執行測試後會產生出一個涵蓋率的結果報告出來。 &lt;/p&gt;&lt;p&gt;這個涵蓋率的結果是一個xml的檔案，這個xml其實有非常豐富的資訊，但是沒有一些基礎概念會不理解是什麼意思。 &lt;/p&gt;&lt;p&gt;因此，在這篇，將會對於涵蓋率相關的資訊做一個介紹和說明。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619360" ;=""&gt;涵蓋率到底怎麼計算&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619189" ;=""&gt;Line Coverage&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619885" ;=""&gt;Statement Coverage&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619584" ;=""&gt;Sequence Point Coverage&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619517" ;=""&gt;Branch Coverage&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619754" ;=""&gt;為什麼要有Branch Coverage&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619419" ;=""&gt;Open Cover支援的計算方式&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619492" ;=""&gt;看Open Cover執行完的結果&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1484383727619340" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484383727619360"&gt;涵蓋率到底怎麼計算&lt;/h2&gt;&lt;p&gt;涵蓋率其實有非常多種算法，其中常見的有： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;Class Coverage&lt;/em&gt; - 當一個class有被測試到，那麼就算1個測試點&lt;br /&gt;&lt;li&gt;&lt;em&gt;Method Coverage&lt;/em&gt; - 當方法有被測試到，就算，&lt;em&gt;不管&lt;/em&gt;是不是所有方法的執行路徑都有被測試到，都算一個測試點&lt;br /&gt;&lt;li&gt;&lt;em&gt;Line Coverage&lt;/em&gt; - 每一行算1個測試點&lt;br /&gt;&lt;li&gt;&lt;em&gt;Statement Coverage&lt;/em&gt; - 每一個statement算是1個測試點&lt;br /&gt;&lt;li&gt;&lt;em&gt;Sequence Point Coverage&lt;/em&gt; - 每一個可以被中斷的地方都是1個測試點&lt;br /&gt;&lt;li&gt;&lt;em&gt;Branch Coverage&lt;/em&gt; - 每一個分叉點（不管那個分叉多少程式碼）都算1點 &lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;p&gt;以上就是常見的涵蓋率計算方式，其中1和2（class 和 method）比較算是一個總覽，更多在看的是3之後的方法。 &lt;/p&gt;&lt;p&gt;不過，3之後的算法，只靠這幾個說明文字可能不容易理解，所以來看一下例子。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1484383727619189"&gt;Line Coverage&lt;/h3&gt;&lt;p&gt;Line Coverage 可以說是最基本的涵蓋率算法，概念很簡單，就是每一行算一個測試點，換句話說： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wigOd7C4mCQ/WHnnV6nBbaI/AAAAAAAAVHU/SDBhg4Iz5_w/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-WD4nvwNDGao/WHnnWyL-N9I/AAAAAAAAVHY/Uq2Bh__Gqjc/image_thumb.png?imgmax=800" width="507" height="256"&gt;&lt;/a&gt;&lt;figcaption&gt;以這個例子來說，就是總共有4個測試點&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;可以發現，測試點比較粗糙，第3點和第4點都只個算1點而已。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1484383727619885"&gt;Statement Coverage&lt;/h3&gt;&lt;p&gt;Statement Coverage比Line Coverage好一點，它是以每一個statement算一個點，所以： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Rp43HXh_FWs/WHnnXw8gLLI/AAAAAAAAVHc/aMRDyLB0XH0/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-BpHAh4USwsI/WHnnZRvlLdI/AAAAAAAAVHg/Oh-w_W6hx78/image_thumb%25255B1%25255D.png?imgmax=800" width="507" height="256"&gt;&lt;/a&gt;&lt;figcaption&gt;可以看到同樣一個程式碼，有5個測試點&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1484383727619584"&gt;Sequence Point Coverage&lt;/h3&gt;&lt;p&gt;Statement Coverage不錯，但是畢竟一個statement不代表只有一種可能，因此又有了Sequence Point Coverage。這種coverage的概念是，只要能夠放&lt;em&gt;中斷點&lt;/em&gt;的都算1點測試點： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-iFDxK5vqHZ4/WHnnfj8InkI/AAAAAAAAVHk/jxIXNfYBReA/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-G2Y30J4LmrQ/WHnnh9jXBvI/AAAAAAAAVHo/wI0wsv2PVO0/image_thumb%25255B2%25255D.png?imgmax=800" width="507" height="256"&gt;&lt;/a&gt;&lt;figcaption&gt;同一個程式碼，變成了7個測試點&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1484383727619517"&gt;Branch Coverage&lt;/h3&gt;&lt;p&gt;每一個分叉點算1個測試點，舉例來說： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7LHGgsav9o0/WHnnipD408I/AAAAAAAAVHs/fILu0todb4c/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-yZoubmmuWsE/WHnnl7BOqiI/AAAAAAAAVHw/QS0RyQwWqPM/image_thumb%25255B3%25255D.png?imgmax=800" width="307" height="365"&gt;&lt;/a&gt;&lt;figcaption&gt;總共3個分叉點，所以3個&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1484383727619754"&gt;為什麼要有Branch Coverage&lt;/h3&gt;&lt;p&gt;或許會覺得為什麼需要Branch Coverage？原因很簡單，因為Branch Coverage是用來輔助呈現一個方法的分叉點是否都有測試到。 &lt;/p&gt;&lt;p&gt;這個其實是用來輔助Sequence Point Coverage，可以想象一下，如果你在if裡面有兩行，在Sequence Point算兩點，如果有10行，會算10點，當if裡面行數越多，點數越多，會&lt;em&gt;沖淡掉&lt;/em&gt; 最後百分比的數值。 &lt;/p&gt;&lt;p&gt;這個時候Branch Coverage變得很方便，因為整個if只算1點，要嗎過，要嗎不過。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484383727619419"&gt;Open Cover支援的計算方式&lt;/h2&gt;&lt;p&gt;上面介紹完了計算方法之後，可以看的出來，Line Coverage 和 Statement Coverage其實沒有那麼準確，Sequence Point反而是比較精準的計算方式。而Sequence point在看方法的路徑是不是都有涵蓋到 的時候不容易看，這個時候Branch Coverage就很適合。 &lt;/p&gt;&lt;p&gt;因此，Open Cover的結果包含了： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Class Coverage&lt;br /&gt;&lt;li&gt;Method Coverage&lt;br /&gt;&lt;li&gt;Sequence Point Coverage&lt;br /&gt;&lt;li&gt;Branch Coverage&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1484383727619492"&gt;看Open Cover執行完的結果&lt;/h2&gt;&lt;p&gt;有了上面的概念之後，再來看一下open cover產生的結果： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-CzYewR_ldEY/WHnnnDTpeOI/AAAAAAAAVH0/LS-yGR-G6h8/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-uvBOb99WGj8/WHnnpVR963I/AAAAAAAAVH4/GSCK9sT7OOk/image_thumb%25255B4%25255D.png?imgmax=800" width="501" height="328"&gt;&lt;/a&gt;&lt;figcaption&gt;可以看到，上面提到的4個Coverage資訊都有&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;  &lt;h2 id="WizKMOutline_1484383727619340"&gt;結語&lt;/h2&gt;&lt;p&gt;了解了Coverage的算法之後，其實就可以parse這個xml結果並且把內容呈現出來（題外話：在Powershell裡面處理xml其實非常方便）。 &lt;/p&gt;&lt;p&gt;甚至可以做到說，當某個Coverage的百分比數低於某個值的時候，不讓建制成功 - 不過這個部分在這邊不會做這個事情，有興趣可以利用Powershell處理xml的方法把內容parse出來在做判斷。 &lt;/p&gt;&lt;p&gt;但是，最後要使用者來看這個xml來了解情況實在不方便，況且也沒有辦法容易看出到底是那裡沒有cover到。 &lt;/p&gt;&lt;p&gt;因此，下篇將會介紹，有什麼方式可以讓結果更user friendly。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5153194122198882687/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-coverageMetrixsExplained.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5153194122198882687'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5153194122198882687'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-coverageMetrixsExplained.html' title='[iThome第8屆鐵人賽 17]OpenCover 結果 - 涵蓋率介紹篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-WD4nvwNDGao/WHnnWyL-N9I/AAAAAAAAVHY/Uq2Bh__Gqjc/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3911524176836388787</id><published>2017-01-02T12:05:00.000+08:00</published><updated>2017-12-12T23:34:04.170+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 16]OpenCover 整合篇</title><content type='html'>&lt;section&gt; &lt;p&gt;在上篇介紹了OpenCover的基本運作概念和為什麼要使用OpenCover，在這篇將會實際把OpenCover整合到Build Script裡面。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter16hapter16"&gt;github devops-psake sample/chapter16&lt;/a&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832598" ;=""&gt;準備Build Script&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832800" ;=""&gt;把OpenCover加入到Build專案&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832995" ;=""&gt;建立一個Helper用來執行OpenCover&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832451" ;=""&gt;準備好執行Helper的參數&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832337" ;=""&gt;調整測試呼叫方式&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832939" ;=""&gt;執行結果&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483329484832826" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483329484832598"&gt;準備Build Script&lt;/h2&gt; &lt;p&gt;要把OpenCover整合進入Build script需要做幾個事情： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;把OpenCover加入到Build專案 &lt;li&gt;建立一個Helper用來執行OpenCover &lt;li&gt;準備好執行Helper的參數 &lt;li&gt;調整測試呼叫方式&lt;/li&gt;&lt;/ol&gt;  &lt;h3 id="WizKMOutline_1483329484832800"&gt;把OpenCover加入到Build專案&lt;/h3&gt; &lt;p&gt;這個部分需要先用Nuget把Opencover加入（&lt;kbd&gt;Install-Package Opencover&lt;/kbd&gt;），之後，在Build Script裡面會多增加一個&lt;code&gt;property&lt;/code&gt;： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$openCoverExe = (Get-PackagePath $packageDirectoryPath "OpenCover") +&lt;br /&gt;		"\tools\OpenCover.Console.exe"&lt;/pre&gt; &lt;h3 id="WizKMOutline_1483329484832995"&gt;建立一個Helper用來執行OpenCover&lt;/h3&gt; &lt;p&gt;在上篇提到，其實opencover有一個profiler，這個profiler會執行Test Runner，然後profiler會監控test runner記錄執行測試的涵蓋率。 &lt;/p&gt; &lt;p&gt;因此，變成不直接呼叫TestRunner了，而是透過OpenCover，因此建立一個helper方法會方便呼叫測試。 &lt;/p&gt; &lt;p&gt;OpenCover其實有滿多的設定，下面會一個一個介紹： &lt;/p&gt; &lt;dl class="dl-horizontal"&gt; &lt;dt&gt;target  &lt;dd&gt;這個是用來執行Test Runner的路徑  &lt;dd&gt; &lt;dt&gt;targetargs  &lt;dd&gt;這邊是指要傳入給target的參數  &lt;dd&gt; &lt;dt&gt;output  &lt;dd&gt;這邊指的是Opencover的涵蓋率結果要儲存的位置  &lt;dd&gt; &lt;dt&gt;register  &lt;dd&gt;一直有提到OpenCover有一個profiler，這個profiler其實是一個com的library，因此要使用的話需要註冊和給權限。這邊我們使用參數&lt;code&gt;user&lt;/code&gt;指的是profiler的權限同等於 目前user，因此避免到時候換build server或者換環境會有環境設定問題  &lt;dd&gt; &lt;dt&gt;filter  &lt;dd&gt;還記得上篇提到關於filter用來決定那些Assembly要涵蓋進來那些要排除，這個就是這邊傳入。  &lt;dd&gt; &lt;dt&gt;excludebyattribute  &lt;dd&gt;上篇提到透過attribute方式設定那些要過濾  &lt;dd&gt; &lt;dt&gt;excludebyfile  &lt;dd&gt;上篇提到，透過檔名過濾的地方  &lt;dd&gt; &lt;dt&gt;skipautoprops  &lt;dd&gt;這個指的是 程式碼裡面用的Property (常說的getter和setter，例如：&lt;code&gt;public string Name{get;set;}&lt;/code&gt;)，因為一般沒有邏輯，所以加入這個參數表示那些不要進入涵蓋範圍  &lt;dd&gt; &lt;dt&gt;mergebyhash  &lt;dd&gt;這個指的是，同一個dll可能會被多次載入（不同test framework等），加入這個設定表示，不管載入幾次，只要hash一樣，永遠算1次  &lt;dd&gt; &lt;dt&gt;mergeoutput  &lt;dd&gt;還記得提到說有不同test framework如何整合結果在一起？只要有設定這個參數，加上所有的output path一致，就會把結果整合  &lt;dd&gt; &lt;dt&gt;hideskipped  &lt;dd&gt;上面雖然有提供一些過濾方式，但是最後報表還是會有包含，只是說那些被忽略而已。因此這個參數能夠把被忽略的不在報告顯示。如果要讓報告乾淨一些，就可以讓他們不顯示  &lt;dd&gt; &lt;dt&gt;returntargetcode  &lt;dd&gt;這個指的是，最後的exit code要用target的作為回傳，這樣如果執行test有失敗，才能夠看到  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt; &lt;p&gt;對於幾個參數有了解之後，在helper就增加了一個&lt;code&gt;Run-TestWithOpenCover&lt;/code&gt;： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;function Run-TestWithOpenCover {&lt;br /&gt;	[CmdletBinding()]&lt;br /&gt;	param([Parameter(Position=0,Mandatory=1)]$testRunnerExe,&lt;br /&gt;		 [Parameter(Position=1,Mandatory=1)]$testRunnerArg,&lt;br /&gt;		 [Parameter(Position=2,Mandatory=1)]$openCoverExe,&lt;br /&gt;		 [Parameter(Position=3,Mandatory=1)]$openCoverResult,&lt;br /&gt;		 [Parameter(Position=4,Mandatory=1)]$filter,&lt;br /&gt;		 [Parameter(Position=5,Mandatory=1)]$excludeAttribute,&lt;br /&gt;		 [Parameter(Position=6,Mandatory=1)]$excludeFiles)&lt;br /&gt;&lt;br /&gt;	Exec { &amp;amp;$openCoverExe "-target:$testRunnerExe" `&lt;br /&gt;						"-targetargs:$testRunnerArg" `&lt;br /&gt;						"-output:$openCoverResult" `&lt;br /&gt;						-register:user `&lt;br /&gt;						"-filter:$filter" `&lt;br /&gt;						-excludebyattribute:$excludeAttribute `&lt;br /&gt;						-excludebyfile:$excludeFiles `&lt;br /&gt;						-skipautoprops `&lt;br /&gt;						-mergebyhash `&lt;br /&gt;						-mergeoutput `&lt;br /&gt;						-hideskipped:All `&lt;br /&gt;						-returntargetcode}&lt;br /&gt;}&lt;/pre&gt; &lt;div class="bs-callout bs-callout-warning"&gt;在上有些參數有用雙引號包住，例如&lt;code&gt;"-targetargs:$testRunnerArg" `&lt;/code&gt;，這個原因是在Powershell如果參數有空白，要連&lt;em&gt;參數名&lt;/em&gt;一起用雙引號包住。 &lt;/div&gt; &lt;h3 id="WizKMOutline_1483329484832451"&gt;準備好執行Helper的參數&lt;/h3&gt; &lt;p&gt;Helper準備好了之後，在&lt;code&gt;default.ps1&lt;/code&gt;要準備好幾個會傳入的參數，最主要是filter的參數的部分。所以，和其他參數一樣，現在Property裡面定義： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$openCoverResult = "$buildTestCoverageDirectory\openCover.xml"&lt;br /&gt;$openCoverFilter = "+[*]* -[xunit.*]* -[*.NunitTest]* -[*.Tests]* -[*.XunitTest]*"&lt;br /&gt;$openCoverExcludeAttribute = "System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute"&lt;br /&gt;$openCoverExcludeFie = "*\*Designer.cs;*\*.g.cs;*\*.g.i.cs"&lt;/pre&gt; &lt;p&gt;這些參數的用意透過剛剛介紹的參數作用應該很清楚，這邊就不做額外介紹。 &lt;/p&gt; &lt;p&gt;在結束之前，還有一個地方要調整，就是&lt;code&gt;BundleConfig.cs&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;這邊將會用&lt;code&gt;ExcludeFromCodeCoverageAttribute&lt;/code&gt;加入到他的Class裡面，用來把它排除在Coverage裡面 &lt;/p&gt;&lt;pre class="brush: csharp;highlight:1"&gt;[ExcludeFromCodeCoverage]&lt;br /&gt;public class BundleConfig&lt;br /&gt;{&lt;br /&gt;....&lt;/pre&gt; &lt;h3 id="WizKMOutline_1483329484832337"&gt;調整測試呼叫方式&lt;/h3&gt; &lt;p&gt;最後，就是調整3個測試的執行方式。做法都一樣，把本來呼叫exec改成呼叫在第二步建立的helper，有差別的地方都是在&lt;code&gt;testRunnerExe&lt;/code&gt;和&lt;code&gt;testRunnerArg&lt;/code&gt;&lt;/p&gt; &lt;p&gt;首先是Xunit： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$xmlResult = "$xunitTestResultDirectory\xUnit.xml"&lt;br /&gt;$htmlResult = "$xunitTestResultDirectory\xUnit.html"&lt;br /&gt;&lt;br /&gt;$targetArg = "$testAssembly -xml $xmlResult -html $htmlResult -nologo -noshadow"&lt;br /&gt;Run-TestWithOpenCover -testRunnerExe $xunitExe `&lt;br /&gt;			-testRunnerArg $targetArg `&lt;br /&gt;			-openCoverExe $openCoverExe `&lt;br /&gt;			-openCoverResult $openCoverResult `&lt;br /&gt;			-filter $openCoverFilter `&lt;br /&gt;			-excludeAttribute $openCoverExcludeAttribute `&lt;br /&gt;			-excludeFiles $openCoverExcludeFie `&lt;/pre&gt; &lt;p&gt;再來是NUnit: &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$targetArg = "$testAssembly --result=$nunitTestResultDirectory\nUnit.xml"&lt;br /&gt;&lt;br /&gt;Run-TestWithOpenCover -testRunnerExe $nunitExe `&lt;br /&gt;			-testRunnerArg $targetArg `&lt;br /&gt;			-openCoverExe $openCoverExe `&lt;br /&gt;			-openCoverResult $openCoverResult `&lt;br /&gt;			-filter $openCoverFilter `&lt;br /&gt;			-excludeAttribute $openCoverExcludeAttribute `&lt;br /&gt;			-excludeFiles $openCoverExcludeFie `&lt;/pre&gt; &lt;p&gt;最後是MSTest： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$targetArg = "$testAssembly /Logger:trx"&lt;br /&gt;&lt;br /&gt;Run-TestWithOpenCover -testRunnerExe $msTestExe `&lt;br /&gt;			-testRunnerArg $targetArg `&lt;br /&gt;			-openCoverExe $openCoverExe `&lt;br /&gt;			-openCoverResult $openCoverResult `&lt;br /&gt;			-filter $openCoverFilter `&lt;br /&gt;			-excludeAttribute $openCoverExcludeAttribute `&lt;br /&gt;			-excludeFiles $openCoverExcludeFie `&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483329484832939"&gt;執行結果&lt;/h2&gt; &lt;p&gt;以上都做完之後，就可以執行做測試，並且會看到Coverage分數： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-pAlDF2Cf_yA/WGnRB10icjI/AAAAAAAAVGQ/Y4XvS83bzLI/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ME_YvRogsbU/WGnRDK4O2_I/AAAAAAAAVGU/IktDJatdEUs/image_thumb.png?imgmax=800" width="644" height="215"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;看到結果分數&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483329484832826"&gt;結語&lt;/h2&gt; &lt;p&gt;在這篇調整了build script，讓opencover進入並且產生出了測試涵蓋率的結果。 &lt;/p&gt; &lt;p&gt;但是，這個結果畢竟比較偏summary，看不出到底那些沒cover到，所以在下篇將會進一步去看OpenCover所產生的結果xml，和如何把它轉換成人看得懂的格式&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3911524176836388787/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-intergreateBuild.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3911524176836388787'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3911524176836388787'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-intergreateBuild.html' title='[iThome第8屆鐵人賽 16]OpenCover 整合篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-ME_YvRogsbU/WGnRDK4O2_I/AAAAAAAAVGU/IktDJatdEUs/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8699496184048737499</id><published>2017-01-01T23:40:00.000+08:00</published><updated>2017-12-12T23:34:04.972+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 15]OpenCover 介紹篇</title><content type='html'>&lt;section&gt; &lt;p&gt;OpenCover是一個.Net Open Source的測試涵蓋率檢測的工具，透過這個Library，可以檢測出，對於整個程式的測試涵蓋率到底有多少 （當然，要注意一個迷失就是，不一定都要&lt;em&gt;100 %&lt;/em&gt;的涵蓋率）。 &lt;/p&gt; &lt;p&gt;這篇將會先對如何使用OpenCover做一個初步的介紹，在下篇才會把OpenCover實際整合到build script裡面。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468986341" ;=""&gt;OpenCover是什麼？為什麼使用它&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987692" ;=""&gt;OpenCover小檔案&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987238" ;=""&gt;除了OpenCover還有什麼測試涵蓋率的Library嗎？&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987716" ;=""&gt;OpenCover的運作概念是什麼？&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987552" ;=""&gt;OpenCover設定過濾條件&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987769" ;=""&gt;用Filter&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987705" ;=""&gt;用Attitude&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987517" ;=""&gt;用檔案&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1483290468987450" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483290468986341"&gt;OpenCover是什麼？為什麼使用它&lt;/h2&gt; &lt;div class="bs-callout bs-callout-default"&gt; &lt;h4 id="WizKMOutline_1483290468987692"&gt;OpenCover小檔案&lt;/h4&gt; &lt;dl&gt; &lt;dt&gt;Github：  &lt;dd&gt;&lt;a href="https://github.com/OpenCover/opencover"&gt;OpenCover&lt;/a&gt; &lt;dd&gt; &lt;dt&gt;Nuget:  &lt;dd&gt;&lt;kbd&gt;Install-Package OpenCover&lt;/kbd&gt; &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt; &lt;/div&gt; &lt;p&gt;OpenCover是一個支援.Net 2.0 以上的程式碼涵蓋率檢測的Library。基本上可以說是在.Net世界裡面Open Source程式碼涵蓋率Library用的最多的一個。而他的作用也很簡單，就是用來 檢測程式碼的測試涵蓋率有多少。 &lt;/p&gt; &lt;p&gt;測試涵蓋率指的是什麼呢？詳細的在稍後的篇章會在提到，不過基本上來說，就是有沒有測試到程式碼的所有角度，舉例來說： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;if(x == 3)&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;else&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt; &lt;p&gt;假設今天我的測試程式碼只有測試當&lt;code&gt;x == 3&lt;/code&gt;的情況，那麼可以說，測試涵蓋率只有50%，因為&lt;em&gt;else的階段沒有測試到&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;OpenCover就是一個這種讓我們檢測的Library。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483290468987238"&gt;除了OpenCover還有什麼測試涵蓋率的Library嗎？&lt;/h2&gt; &lt;p&gt;在.Net世界裡面還有一些別的涵蓋率的Library，像是dotCover或者Visual Studio Ultimate版本裡面的Code Coverage功能。不過這些都是需要收費才能夠使用，所以如果沒有這個經費，或者 沒有這些Licence，那OpenCover就是歲好的替代方案。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt;像Visual Studio的Code Coverage有個好處是和VS整合在一起，對於開發要看結果比較方便，不過OpenCover也有對應的套件叫做&lt;a href="https://marketplace.visualstudio.com/items?itemName=jamdagni86.OpenCoverUI"&gt;OpenCover UI&lt;/a&gt;，也能夠達到類似的效果，不過這個部分就不在這個系列介紹了。 &lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483290468987716"&gt;OpenCover的運作概念是什麼？&lt;/h2&gt; &lt;p&gt;從頭到尾一直提到說它是一個測試涵蓋率的Library，但是他到底如何知道測試程式碼到底執行了什麼？甚至可以說有這麼多不同的Test Framework，怎麼讓OpenCover知道每一個Test Framework到底執行了那些測試？ &lt;/p&gt; &lt;p&gt;舉例來說，在這個系列裡面用了3個Test Framework，雖然在正式系統應該只會使用一種，但是OpenCover到底如何把這些執行不同的測試的涵蓋率一起計算？ &lt;/p&gt; &lt;p&gt;要了解這個，先回顧一下測試是怎麼運作開始： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-La5ab1ChpuQ/WGk4gYpVeSI/AAAAAAAAVFw/TWV_Yod8g20/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-8Is8mPbjQTE/WGk4hSwEG4I/AAAAAAAAVF0/GkXwrZTBr6U/image_thumb.png?imgmax=800" width="644" height="143"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;呼叫Test Runner，執行測試dll，產生測試結果&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;這個時候如果把OpenCover加入進來，圖片變成是： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Ur66UTMkvRo/WGk4iLd-08I/AAAAAAAAVF4/DHM7NiZtens/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ytHP74Ku8Mk/WGk4jxDDl9I/AAAAAAAAVF8/n2NmYrBel-s/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="210"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;OpenCover呼叫測試Console，測試Console在執行測試dll，產生測試結果。OpenCover產生涵蓋率結果&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;這個時候，變成&lt;em&gt;由OpenCover裡面的Profiler呼叫&lt;/em&gt;Test Runner，並且會&lt;em&gt;記錄Test Runner執行什麼&lt;/em&gt;，最後除了測試結果有產生出來之外，涵蓋率結果也會產生出來。 &lt;/p&gt; &lt;p&gt;（這邊有特別注意到OpenCover有個Profiler的概念，這也是為什麼他無法在mono環境運作的關係，和這個profiler有關。） &lt;/p&gt; &lt;p&gt;稍早有提到如果有不同的測試框架，是否涵蓋率都會一起算？OpenCover有考慮到這點，所以最後產生的結果能夠和其他OpenCover結果做合併。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483290468987552"&gt;OpenCover設定過濾條件&lt;/h2&gt; &lt;p&gt;在程式裡面，很有可能有些class或者有些檔案不應該要被檢查涵蓋率，舉例來說，應該沒有人會對測試在寫測試，所以要把這些剔除在涵蓋率計算。 &lt;/p&gt; &lt;p&gt;在OpenCover裡面有三個方式能夠做這些排除： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;用Filter &lt;li&gt;用Attribute &lt;li&gt;用檔案&lt;/li&gt;&lt;/ol&gt;  &lt;h3 id="WizKMOutline_1483290468987769"&gt;用Filter&lt;/h3&gt; &lt;p&gt;基本上Filter能夠設定那些 Assembly和Namespace要加入或者不加入檢查，格式是：&lt;code&gt;+-[Assembly]Namespace&lt;/code&gt;&lt;/p&gt; &lt;ul&gt; &lt;li&gt;+ 代表包含 &lt;li&gt;- 代表不包含 &lt;li&gt;框框裡面是dll名稱 &lt;li&gt;框框外面則是Namespace&lt;/li&gt;&lt;/ul&gt; &lt;p&gt;如果有多個，就是每一個用空白區分。舉例來說： &lt;/p&gt; &lt;p&gt;&lt;code&gt;+[Open*]* -[Open.Test]*&lt;/code&gt; - 包含所有dll是Open為開頭，但是排除掉所有dll是Open.Test。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1483290468987705"&gt;用Attitude&lt;/h3&gt; &lt;p&gt;在程式裡面可以給方法和Class特殊的Attribute，然後在設定的時候過濾有這些Attribute不要算在涵蓋率裡面。 &lt;/p&gt; &lt;p&gt;之前提到VS裡面在高版本有內建Code Coverage，裡面有個Attribute叫做&lt;code&gt;ExcludeFromCodeCoverage&lt;/code&gt;用來不算在涵蓋率裡面。在OpenCover也可以利用這個Attribute，讓有這個Attribute 的都不要算在裡面 &lt;/p&gt; &lt;h3 id="WizKMOutline_1483290468987517"&gt;用檔案&lt;/h3&gt; &lt;p&gt;VS會產生一些cs檔案，方便開發者不用自己建立。舉例來說，&lt;code&gt;Designer.cs&lt;/code&gt;的檔案在Asp .net Webform裡面會產生用到的Control，這些也不應該算在涵蓋率裡面。 &lt;/p&gt; &lt;p&gt;所以，這種類型可以用檔案方式來過濾掉。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1483290468987450"&gt;結語&lt;/h2&gt; &lt;p&gt;在這篇對於OpenCover有了一個初步的介紹，了解了OpenCover透過Profiler執行Test Runner來了解那些有執行那些沒有，並且了解了如何設定過濾不要算在檢測涵蓋率裡面的方式。 &lt;/p&gt; &lt;p&gt;在下篇，將會使用這篇了解的內容來調整我們的Build script。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8699496184048737499/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8699496184048737499'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8699496184048737499'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/01/devopsSeries-opencover-intro.html' title='[iThome第8屆鐵人賽 15]OpenCover 介紹篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-8Is8mPbjQTE/WGk4hSwEG4I/AAAAAAAAVF0/GkXwrZTBr6U/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5726133409121581830</id><published>2016-12-25T18:35:00.000+08:00</published><updated>2017-12-12T23:34:04.570+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 14]程式碼品質 - 介紹篇</title><content type='html'>&lt;section&gt; &lt;p&gt;我曾經聽過一個笑話，一個人到一家公司面試，面試官問他：「請問你如何保證/保持你的程式碼品質？」 &lt;/p&gt;&lt;p&gt;這個年輕人回答：「我...我會在發現bug的時候把問題&lt;em&gt;加班&lt;/em&gt;修好」。 &lt;/p&gt;&lt;p&gt;其實這個有點悲哀，也說明了為什麼軟體工程師時常需要加班，因為當軟體越寫越複雜的時候，要保持程式的品質是需要一些事情，但是這些事情是什麼？有沒有可能進入到我們日常環境里？ &lt;/p&gt;&lt;p&gt;這個就是接下來會介紹的部分，我們如何透過做CI把程式碼品質要做的事情整合進來。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482661971437394" ;=""&gt;如何保持程式碼品質？&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482661971437961" ;=""&gt;透過測試保證程式碼品質&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482661971437897" ;=""&gt;不需要每一個方法的涵蓋率都要100%&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482661971437891" ;=""&gt;程式碼分析&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482661971437197" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482661971437394"&gt;如何保持程式碼品質？&lt;/h2&gt;&lt;p&gt;保持程式碼品質其實本身就是一個很大的主題，在這個系列裡面不會介紹非常詳細，但是會針對幾個比較容易執行並且能夠整并到我們CI裡面的來做介紹。 &lt;/p&gt;&lt;p&gt;基本上，有兩方面的程式碼品質： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;需要做事情的 - 寫測試&lt;br /&gt;&lt;li&gt;工具分析型的 - 程式碼分析&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;h3 id="WizKMOutline_1482661971437961"&gt;透過測試保證程式碼品質&lt;/h3&gt;&lt;p&gt;測試有很多種，最常聽到的應該就是單元測試(Unit Test)。 &lt;/p&gt;&lt;p&gt;單元測試簡單的說是一個最小單元是否符合撰寫的邏輯。但是，一個最小單元裡面可能有不同的路徑，測試到底包含了多少路徑會影響到這個測試的完整性。 &lt;/p&gt;&lt;p&gt;舉例來說，一個簡單的方法，有個if邏輯判斷，如果測試只測試了true的部分，但是沒有測試false的部分，只能保證說true是沒問題的，但是false那段完全沒有涵蓋到。因此，&lt;em&gt;涵蓋率只有50%&lt;/em&gt;&lt;/p&gt;&lt;p&gt;所以，我們的測試涵蓋率到底多少，能說明這個測試的完整性有多少。 &lt;/p&gt;&lt;p&gt;這個部分，我們將會透過使用一個Open source的專案叫做OpenCover來做這方面的檢測。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;h4 id="WizKMOutline_1482661971437897"&gt;不需要每一個方法的涵蓋率都要100%&lt;/h4&gt;雖然說涵蓋率越高越好，但是並不代表所有涵蓋率都要100%，也不可能都到100%，所以這個參考就好。 &lt;/div&gt;&lt;h3 id="WizKMOutline_1482661971437891"&gt;程式碼分析&lt;/h3&gt;&lt;p&gt;像在做資安掃描的時候一樣，有所謂的白箱測試，在程式碼品質的部分也有這種類型的工具，而這種工具又有分兩種： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;程式碼風格分析 - 這個其實不和程式邏輯有關，而是和寫程式的風格有關。風格指的是，例如每一行內容要空幾行，怎麼寫註解之類。最出名的工具就是 &lt;code&gt;StyleCop&lt;/code&gt;&lt;br /&gt;&lt;li&gt;程式碼分析 (static analyzer) - 這個其實和跑白箱測試是一樣概念，分析程式並且把有些寫法有問題的標註出來。例如，方法參數沒有用到這種，甚至Sql injection檢查。最出名的工具 就是 &lt;code&gt;FxCop&lt;/code&gt;，再後來，整合進去到後來Visual studio 裡面的Code Analysis&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;這兩個最大不同之處在於，程式碼風格分析是對 &lt;em&gt;原始碼&lt;/em&gt;做分析，程式碼分析 則是對 &lt;em&gt;編譯過&lt;/em&gt;的dll做分析  &lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482661971437197"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇我們介紹了可以透過什麼工具來保持程式碼的品質，在接下來的章節裡面，我們將會開始介紹怎麼把這些工具整合進去到我們的build script裡面 &lt;/p&gt;&lt;p&gt;下篇，先從測試涵蓋率，OpenCover開始介紹 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5726133409121581830/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-codeQuality-Intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5726133409121581830'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5726133409121581830'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-codeQuality-Intro.html' title='[iThome第8屆鐵人賽 14]程式碼品質 - 介紹篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5668418594107711400</id><published>2016-12-25T16:20:00.000+08:00</published><updated>2017-12-12T23:34:04.504+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 13]執行測試 4 - 重構</title><content type='html'>&lt;section&gt; &lt;p&gt;在之前幾篇已經介紹完了.Net常見的三種Test Framework（Xunit，Nunit 和 MSTest）整合方式之後，相信會發現到這三個task有很地方是重複邏輯。 &lt;/p&gt;&lt;p&gt;這些重複邏輯我們都是用了copy 和 paste 的方式處理了，但是未來如果要維護這個build script，甚至要把它變成一個常用/通用的script，這種方式是非常不好 &lt;/p&gt;&lt;p&gt;所以，就像任何好的工程師會做的事情一樣，我們也要重構我們的Script。 &lt;/p&gt;&lt;p&gt;這篇將會介紹重構什麼，和如何重構。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;sample 程式在 &lt;a href="sample 程式在 github devops-psake sample/chapter13"&gt;github devops-psake sample/chapter13&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587064821" ;=""&gt;可以重構什麼？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587065950" ;=""&gt;如何重構？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587065881" ;=""&gt;重構 - 從package找到要執行的exe&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587065228" ;=""&gt;重構 - 從建制結果找到需要被執行測試的專案路徑&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587065209" ;=""&gt;重構 - 取得要執行測試的assembly路徑字串&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482653587065962" ;=""&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587064821"&gt;可以重構什麼？&lt;/h2&gt;&lt;p&gt;有好幾個一樣的邏輯其實都可以重構： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;從package找到要執行的exe程序 - 這個考慮到如果package裡面有多個版本，會取得最新的那個&lt;br /&gt;&lt;li&gt;取得那些路徑要被執行測試&lt;br /&gt;&lt;li&gt;要執行測試的時候要建立出資料夾&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587065950"&gt;如何重構？&lt;/h2&gt;&lt;p&gt;在Powershell一樣可以建立function並且可以放在另外一個script裡面。 &lt;/p&gt;&lt;p&gt;要把重複的邏輯統一到function裡面，在透過傳遞參數的方式來達到重複使用 &lt;/p&gt;&lt;p&gt;因此，先建立一個新的powershell script叫做&lt;code&gt;helper.ps1&lt;/code&gt;，然後在&lt;code&gt;default.ps1&lt;/code&gt;的最上面加上&lt;code&gt;.\helper.ps1&lt;/code&gt;來把這個檔案的內容整合進來。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587065881"&gt;重構 - 從package找到要執行的exe&lt;/h2&gt;&lt;p&gt;這個指的是如何從package下面找到要執行的exe，本來的執行內容如下： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$xunitExe = ((Get-ChildItem("$solutionDirectory\packages\xunit.runner.console*")).FullName |&lt;br /&gt;   Sort-Object $_ | select -Last 1) + "\tools\xunit.console.exe"&lt;br /&gt;  &lt;/pre&gt;&lt;p&gt;這邊為了處理通用的情況，因此版號不寫死，但是因為這樣多了一些排序處理等。 &lt;/p&gt;&lt;p&gt;如果直接看這個其實並不直覺知道為什麼要做sort等動作，因此這個可以重構成為： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# helper.ps1&lt;br /&gt;function Get-PackagePath {&lt;br /&gt; [CmdletBinding()]&lt;br /&gt; param([Parameter(Position=0,Mandatory=1)]$packagesDirectoryPath,&lt;br /&gt;    [Parameter(Position=1,Mandatory=1)]$packageName)&lt;br /&gt;&lt;br /&gt; return (Get-ChildItem($packagesDirectoryPath + $packageName + "*")).FullName |&lt;br /&gt;     Sort-Object $_ | select -Last 1&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;# default.ps1&lt;br /&gt;&lt;br /&gt;$xunitExe = (Get-PackagePath $packageDirectoryPath "xunit.runner.console") + &lt;br /&gt;  "\tools\xunit.console.exe"&lt;br /&gt;  &lt;/pre&gt;&lt;p&gt;可以看到，本身寫法還是很長，但是不需要在了解要排序，在取得最後一筆的動作，反而很直覺，&lt;em&gt;在package下面取得某一個package 名稱的路徑&lt;/em&gt;。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587065228"&gt;重構 - 從建制結果找到需要被執行測試的專案路徑&lt;/h2&gt;&lt;p&gt;在3個測試方法都有需要做一件事情是，找到那些建制的結果是需要跑測試。 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;$xunitTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter xunit*.dll | &lt;br /&gt; Select -ExpandProperty DirectoryName -Unique | % { [io.directoryinfo]$_ }&lt;/pre&gt;&lt;p&gt;如果沒有任何說明，其實搞不清楚這行的概念是什麼，經過重構 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# helper.ps1&lt;br /&gt;&lt;br /&gt;function Get-DirectoryInfoContainFile{&lt;br /&gt; [CmdletBinding()]&lt;br /&gt; param([Parameter(Position=0,Mandatory=1)]$fileFilter) &lt;br /&gt;&lt;br /&gt; Get-ChildItem $buildTempDirectory -Recurse -Filter $fileFilter | &lt;br /&gt;      Select -ExpandProperty DirectoryName -Unique |&lt;br /&gt;      % { [io.directoryinfo]$_ }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;# default.ps1&lt;br /&gt;&lt;br /&gt;$xunitTestPath = Get-DirectoryInfoContainFile "xunit*.dll"&lt;/pre&gt;&lt;p&gt;改成這樣之後，含義很清楚，&lt;em&gt;找到資料夾裡面有某個檔案&lt;/em&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587065209"&gt;重構 - 取得要執行測試的assembly路徑字串&lt;/h2&gt;&lt;p&gt;要執行測試之前，我們要取得那些需要測試的dll，只有有存在的情況下才會建立出測試結果要儲存的資料夾位置。 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 取得Xunit project的路徑&lt;br /&gt;$xunitTestPath = Get-DirectoryInfoContainFile "xunit*.dll"&lt;br /&gt;&lt;br /&gt;if(Test-Path $xunitTestPath){&lt;br /&gt;&lt;br /&gt; Write-Host "建立Xunit測試結果的資料夾 $xunitTestResultDirectory"&lt;br /&gt; New-Item $xunitTestResultDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "總共有 $($xunitTestPath.Count) 個專案"&lt;br /&gt;&lt;br /&gt; Write-Host ($xunitTestPath | Select $_.Name)&lt;br /&gt;&lt;br /&gt; Write-Host "準備執行Xunit測試"&lt;br /&gt;&lt;br /&gt; # 組執行的dll&lt;br /&gt;&lt;br /&gt; $testDlls = $xunitTestPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt; $testDllsJoin = [string]::Join(" ", $testDlls)&lt;br /&gt;&lt;br /&gt; Write-Host "執行的 Dll: $testDllsJoin"&lt;br /&gt;&lt;br /&gt; exec{ &amp;amp;$xunitExe $testDllsJoin -xml $xunitTestResultDirectory\xUnit.xml `&lt;br /&gt;   -html $xunitTestResultDirectory\xUnit.html `&lt;br /&gt;   -nologo -noshadow}&lt;br /&gt; &lt;br /&gt; Write-Host "完成執行Xunit測試"&lt;br /&gt;}&lt;/pre&gt;&lt;p&gt;光看這個看起來有很多資訊，而且也不知道焦點在那裡。但是正常來說，這個task只是要執行測試，更本不需要關心要不要建立測試結果的資料夾，或者寫出那些要執行 &lt;/p&gt;&lt;p&gt;所以重構之後： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# helper.ps1&lt;br /&gt;function Get-TestAssemblyPath {&lt;br /&gt; [CmdletBinding()]&lt;br /&gt; param([Parameter(Position=0,Mandatory=1)]$testFilePathFilter,&lt;br /&gt;    [Parameter(Position=1,Mandatory=1)]$testRestPath) &lt;br /&gt;&lt;br /&gt; $testPath = Get-DirectoryInfoContainFile $testFilePathFilter&lt;br /&gt;&lt;br /&gt; $testDllPath = ""&lt;br /&gt;&lt;br /&gt; if(Test-Path $testPath) {&lt;br /&gt;&lt;br /&gt;   Write-Host "建立測試結果的資料夾 $testRestPath"&lt;br /&gt;   New-Item $testRestPath -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt;   Write-Host "總共有 $($testPath.Count) 個專案"&lt;br /&gt;&lt;br /&gt;   Write-Host ($testPath | Select $_.Name)&lt;br /&gt;&lt;br /&gt;   Write-Host "準備執行測試"&lt;br /&gt;&lt;br /&gt;   # 組執行的dll&lt;br /&gt;&lt;br /&gt;   $testDlls = $testPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt;   $testDllPath = [string]::Join(" ", $testDlls)&lt;br /&gt;&lt;br /&gt;   Write-Host "執行的 assemblies: $testDllPath"&lt;br /&gt;  }&lt;br /&gt;&lt;br /&gt;  return $testDllPath&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;# default.ps1&lt;br /&gt;# 取得Xunit project的路徑&lt;br /&gt;$testAssembly = Get-TestAssemblyPath "xunit*.dll" $xunitTestResultDirectory&lt;br /&gt;&lt;br /&gt;if(Test-Path $testAssembly){&lt;br /&gt;&lt;br /&gt; exec{ &amp;amp;$xunitExe $testAssembly -xml $xunitTestResultDirectory\xUnit.xml `&lt;br /&gt;   -html $xunitTestResultDirectory\xUnit.html `&lt;br /&gt;   -nologo -noshadow}&lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt;&lt;p&gt;重構之後，變成非常直覺，取得那些要執行的Assembly字串，然後就實際執行。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;其實真要說，這個應該要在做一些區分。例如建立測試結果要儲存的位置的那段，應該要放在建立資料夾一起，而不是直接包在這個方法裡面，但是目前來說暫時夠了。 &lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482653587065962"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇介紹了如何透過把function寫在不同script裡面，然後在加進來的方式把方法重構，讓同樣邏輯可以重複使用。 &lt;/p&gt;&lt;p&gt;還有好幾個地方可以重構，不過以目前來說，先進行到這個地步，之後後面還有需要會在做說明。 &lt;/p&gt;&lt;p&gt;到目前為止，整合測試到自動化建制裡面到了一個段落，開始要考慮另外一個建制的問題，那就是程式碼品質到底如何。 &lt;/p&gt;&lt;p&gt;這將會是下篇的主題。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5668418594107711400/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-refactor.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5668418594107711400'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5668418594107711400'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-refactor.html' title='[iThome第8屆鐵人賽 13]執行測試 4 - 重構'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-552070178989702037</id><published>2016-12-25T11:45:00.000+08:00</published><updated>2017-12-12T23:34:04.437+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 12]執行測試 3 - MSTest</title><content type='html'>&lt;section&gt; &lt;p&gt;在介紹完Xunit和Nunit測試之後，這篇將要來看最後一個常見的測試Framework，Visual Studio內建的MSTest。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter12"&gt;github devops-psake sample/chapter12&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538461" ;=""&gt;MSTest 和其他測試有和不同？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538267" ;=""&gt;準備測試專案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538697" ;=""&gt;準備build script - task定義&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538303" ;=""&gt;1. 定義Task&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538964" ;=""&gt;2. 準備build script - 參數定義&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538766" ;=""&gt;3. 準備執行 MSTest&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538236" ;=""&gt;執行MSTest的測試&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482637147538773" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482637147538461"&gt;MSTest 和其他測試有和不同？&lt;/h2&gt;&lt;p&gt;MSTest和其他幾個Test Framework最大的差異在於，MSTest的console程式&lt;em&gt;不能額外安裝&lt;/em&gt;，而是和Visual Studio一起安裝，所以在取得console程式的地方是比較不同。 &lt;/p&gt;&lt;p&gt;這篇為了完整性，也會把整個步奏記錄下來。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482637147538267"&gt;準備測試專案&lt;/h2&gt;&lt;p&gt;如果有照著一開始建立專案來做，還記得那個時候在建立Asp .net Mvc的時候有勾選建立測試的專案，因此我們不需要做任何事情就會有一個MSTest的測試專案在裡面了。 &lt;/p&gt;&lt;p&gt;所以可以直接進入準備script的部分。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482637147538697"&gt;準備build script - task定義&lt;/h2&gt;&lt;p&gt;這個部分會準備task要執行所需要的東西。由於MSTest的console無法獨立下載，所以我們不需要在buildProject加入任何package。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1482637147538303"&gt;1. 定義Task&lt;/h3&gt;&lt;p&gt;先定義好MSTest執行的Task： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task MSTest -depends Compile -description "執行MSTest測試" `&lt;br /&gt;{&lt;br /&gt; &lt;br /&gt;}&lt;/pre&gt;&lt;h3 id="WizKMOutline_1482637147538964"&gt;2. 準備build script - 參數定義&lt;/h3&gt;&lt;p&gt;要執行build script之前，我們會需要幾個參數： &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;取得執行MSTest的Console Runner位置 - $msTestExe  &lt;dd&gt;這個會在visual studio安裝路徑找到  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;測試結果要儲存的位置 - $msTestResultDirectory  &lt;dd&gt;我們 會把不同測試Framework分開放，所以會建立一個專門放msTest  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;要執行測試的路徑確認 - $msTestPath  &lt;dd&gt;這個邏輯是透過看看建制出來的專案有沒有 &lt;code&gt;MSTest&lt;/code&gt; 用到的dll - 有就算是要被執行。這裡面取得的結果是DirectoryInfo，原因我們稍後提到。  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;pre class="brush: powershell;"&gt;$msTestExe = ((Get-ChildItem("C:\Program Files (x86)\Microsoft Visual Studio*\Common7\IDE\CommonExtensions\Microsoft\TestWindow\vstest.console.exe")).FullName |&lt;br /&gt;                    Sort-Object $_ | select -Last 1)&lt;br /&gt;&lt;br /&gt;$msTestResultDirectory= "$buildTestResultDirectory\MSTest" &lt;br /&gt;&lt;br /&gt;$msTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter Microsoft.VisualStudio.QualityTools.UnitTestFramework.resources.dll | &lt;br /&gt;  Select -ExpandProperty DirectoryName -Unique | &lt;br /&gt;  % { [io.directoryinfo]$_ } &lt;/pre&gt;&lt;h3 id="WizKMOutline_1482637147538766"&gt;3. 準備執行 MSTest&lt;/h3&gt;&lt;p&gt;要執行console runner有些參數是必要傳入進去的，其中一個重要的就是要執行測試的dll清單。 &lt;/p&gt;&lt;p&gt;在上面參數定義我們已經找到了是ms test專案的project清單，我們就可以用這個清單來產生出要執行的dll測試路徑。 &lt;/p&gt;&lt;p&gt;這裡面考慮到，如果有多個的話，每個用空格分開 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 組執行的dll&lt;br /&gt;$testDlls = $msTestPath  | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt; &lt;br /&gt;$testDllsJoin = [string]::Join(" ", $testDlls)&lt;/pre&gt;&lt;p&gt;再來就是執行測試的部分 &lt;/p&gt;&lt;p&gt;MS Test很可惜，沒有參數能夠把結果執行別的路徑，因此我們需要自己移動進去儲存結果的路徑然後執行 &lt;/p&gt;&lt;p&gt;再來，MS Test預設會把測試結果放在 &lt;code&gt;TestResults&lt;/code&gt;這個資料夾，因此我們會做一點處理，把測試內容移動上去 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# MSTest 無法設定結果輸出位置，因此移動進去&lt;br /&gt;Push-Location $msTestResultDirectory&lt;br /&gt;exec {&amp;amp; $msTestExe $testDllsJoin /Logger:trx}&lt;br /&gt;Pop-Location&lt;br /&gt;&lt;br /&gt;$msTestDefaultResultPath = "$msTestResultDirectory\TestResults"&lt;br /&gt;$msTestResult = "$msTestResultDirectory\MsTest.trx"&lt;br /&gt;&lt;br /&gt;Write-Host "把測試結果移動到 $msTestResult"&lt;br /&gt;Move-Item -Path $msTestDefaultResultPath\*.trx -Destination $msTestResult&lt;br /&gt;Remove-Item $msTestDefaultResultPath&lt;/pre&gt;&lt;p&gt;再來&lt;code&gt;Test&lt;/code&gt; task加上 &lt;code&gt;MSTest&lt;/code&gt; 作為相依的task &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Test -depends Compile, Clean, XunitTest, NunitTest, MSTest -description "執行Test" { &lt;br /&gt; Write-Host $testMsg&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482637147538236"&gt;執行MSTest的測試&lt;/h2&gt;&lt;p&gt;這個時候設定都完成了，執行結匯得到結果： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-a8slgsbWGCU/WF9ADkdEldI/AAAAAAAAVFI/e0MtiJp73WY/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-R6K1q6mdwDs/WF9AE6JmSFI/AAAAAAAAVFM/LqEIaLCW3p4/image_thumb.png?imgmax=800" width="644" height="311"&gt;&lt;/a&gt;&lt;figcaption&gt;測試結果&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;並且可以看到執行結果： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rC-i9O2zbhQ/WF9AFSvp2QI/AAAAAAAAVFQ/Ss2SMDCtMAM/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-O55IOiF7Z3A/WF9AGSR6cQI/AAAAAAAAVFU/6IQO_cmwC-k/image_thumb%25255B1%25255D.png?imgmax=800" width="467" height="174"&gt;&lt;/a&gt;&lt;figcaption&gt;執行結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482637147538773"&gt;結語&lt;/h2&gt;&lt;p&gt;到目前為止，已經介紹完了三個常見的測試framework，不過會發現其實這3個方法有很多重複性的功能。作為工程師，第一大忌就是&lt;code&gt;copy and paste&lt;/code&gt;，所以為了將來更好維護， 我們將進入Refactor階段。 &lt;/p&gt;&lt;p&gt;下篇將會介紹如何refactor我們的task。 &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/552070178989702037/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-MsTest.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/552070178989702037'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/552070178989702037'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-MsTest.html' title='[iThome第8屆鐵人賽 12]執行測試 3 - MSTest'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-R6K1q6mdwDs/WF9AE6JmSFI/AAAAAAAAVFM/LqEIaLCW3p4/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7380207720445822516</id><published>2016-12-25T09:10:00.000+08:00</published><updated>2017-12-12T23:34:04.772+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 11]執行測試 2 - NUnit .Net</title><content type='html'>&lt;section&gt;在上篇介紹完如何整合Xunit做測試之後，在這篇我們將會看看在.Net世界裡面另外一個常用的測試Framework，NUnit。  &lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter11"&gt;github devops-psake sample/chapter11&lt;/a&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694588219" ;=""&gt;Nunit和Xunit有和不同？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589555" ;=""&gt;準備Nunit測試專案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589677" ;=""&gt;準備build script - task 定義&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589540" ;=""&gt;1. 在build專案安裝Nunit Console&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589406" ;=""&gt;2. 定義NUnintTest的task&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589205" ;=""&gt;3. 準備build script - 參數定義&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589351" ;=""&gt;4. 準備執行 nunit console runner&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589931" ;=""&gt;執行Nunit測試&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482627694589826" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482627694588219"&gt;Nunit和Xunit有和不同？&lt;/h2&gt;&lt;p&gt;再詳細介紹如何整合Nunit之前，我們要先了解，Nunit和Xunit到底有和不同？ &lt;/p&gt;&lt;p&gt;其實兩個的步奏基本一樣，只是參數不同（在Nunit 2.X系列 甚至連執行的參數也都一樣，只是參數一個用&lt;code&gt;-&lt;/code&gt;來分割，一個用&lt;code&gt;/&lt;/code&gt;而已，不過在這篇我們會使用Nunit 3.x） ，所以雖然這篇和上篇會很類似，但是為了完整性，這篇還是會完整介紹如何整并Nunit。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482627694589555"&gt;準備Nunit測試專案&lt;/h2&gt;&lt;p&gt;需要先建立一個Library專案，這個專案裡面要放一個Nunit的測試。 &lt;/p&gt;&lt;p&gt;建立好一個Library專案之後，要安裝兩個Nuget Package &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;kbd&gt;Install-Package nunit -Version 3.5.0&lt;/kbd&gt; - 安裝nunit library&lt;br /&gt;&lt;li&gt;&lt;kbd&gt;Install-Package Microsoft.AspNet.Mvc -Version 5.2.3&lt;/kbd&gt; - 等一下要測試mvc的controller，所以要加入mvc的library &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;p&gt;Library建立好之後，我們就建立一個ControllerTest，這次就測試About的部分： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;[TestFixture]&lt;br /&gt;public class HomeControllerTest&lt;br /&gt;{&lt;br /&gt; [Test]&lt;br /&gt; public void About()&lt;br /&gt; {&lt;br /&gt;  // Arrange&lt;br /&gt;  HomeController controller = new HomeController();&lt;br /&gt;&lt;br /&gt;  // Act&lt;br /&gt;  ViewResult result = controller.About() as ViewResult;&lt;br /&gt;&lt;br /&gt;  // Assert&lt;br /&gt;  Assert.IsNotNull(result);&lt;br /&gt; }&lt;br /&gt;}&lt;/pre&gt;&lt;p&gt;專案準備好之後，就到了準備script的部分 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482627694589677"&gt;準備build script - task 定義&lt;/h2&gt;&lt;p&gt;接下來我們會調整我們的build script，我們會先在build專案安裝一個nunit的console runner，然後我們會在psake裡面取得那些需要跑test，並且最後執行nunit的測試。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1482627694589540"&gt;1. 在build專案安裝Nunit Console&lt;/h3&gt;&lt;p&gt;在build專案安裝Nunit Console: &lt;kbd&gt;Install-Package NUnit.Console&lt;/kbd&gt;&lt;/p&gt;&lt;h3 id="WizKMOutline_1482627694589406"&gt;2. 定義NUnintTest的task&lt;/h3&gt;&lt;p&gt;先定義好要執行NUnitTest執行的task &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task NunitTest -depends Compile -description "執行Nunit測試" `&lt;br /&gt;{&lt;br /&gt;&lt;br /&gt;}&lt;/pre&gt;&lt;h3 id="WizKMOutline_1482627694589205"&gt;3. 準備build script - 參數定義&lt;/h3&gt;&lt;p&gt;要執行build script之前，我們會需要幾個參數： &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;取得執行Nunit的Console Runner位置 - $nunitExe  &lt;dd&gt;由於我們buildProject有加入nunit的 console runner，因此在package可以找到  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;測試結果要儲存的位置 - $nunitTestResultDirectory  &lt;dd&gt;我們 會把不同測試Framework分開放，所以會建立一個專門放nunit  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;要執行測試的路徑確認 - $nunitTestPath  &lt;dd&gt;這個邏輯是透過看看建制出來的專案有沒有 &lt;code&gt;nunit&lt;/code&gt; 開頭的dll - 有就算是要被執行。這裡面取得的結果是DirectoryInfo，原因我們稍後提到。  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;pre class="brush: powershell;"&gt;$nunitExe = ((Get-ChildItem("$solutionDirectory\packages\NUnit.ConsoleRunner*")).FullName |&lt;br /&gt; Sort-Object $_ | select -Last 1) + "\tools\nunit3-console.exe"&lt;br /&gt;&lt;br /&gt;$nunitTestResultDirectory = "$buildTestResultDirectory\Nunit&lt;br /&gt; &lt;br /&gt;$nunitTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter nunit*.dll | &lt;br /&gt; Select -ExpandProperty DirectoryName -Unique | % { [io.directoryinfo]$_ }&lt;/pre&gt;&lt;h3 id="WizKMOutline_1482627694589351"&gt;4. 準備執行 nunit console runner&lt;/h3&gt;&lt;p&gt;要執行console runner有些參數是必要傳入進去的，其中一個重要的就是要執行測試的dll清單。 &lt;/p&gt;&lt;p&gt;在上面參數定義我們已經找到了是nunit test專案的project清單，我們就可以用這個清單來產生出要執行的dll測試路徑。 &lt;/p&gt;&lt;p&gt;這裡面考慮到，如果有多個的話，每個用空格分開 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 組執行的dll&lt;br /&gt;$testDlls = $nunitTestPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt;$testDllsJoin = [string]::Join(" ", $testDlls)&lt;/pre&gt;&lt;p&gt;再來就是要確認執行console runne所會使用的參數： &lt;/p&gt;&lt;dl class="dl-horizontal"&gt;&lt;dt&gt;$dll 路徑  &lt;dd&gt;這個就是上面組出來的參數&lt;br /&gt;&lt;dt&gt;-result $路徑 &lt;dd&gt;執行結果要用 xml 格式 儲存在某個路徑 &lt;p&gt;最後，我們的&lt;code&gt;NunitTest&lt;/code&gt;task變成： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 取得nunit project的路徑&lt;br /&gt;$nunitTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter nunit*.dll | &lt;br /&gt;     Select -ExpandProperty DirectoryName -Unique | % { [io.directoryinfo]$_ }&lt;br /&gt;&lt;br /&gt;if(Test-Path $nunitTestPath){&lt;br /&gt; Write-Host "建立Nunit測試結果的資料夾 $nunitTestResultDirectory"&lt;br /&gt; New-Item $nunitTestResultDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "總共有 $($nunitTestPath.Count) 個專案"&lt;br /&gt;&lt;br /&gt; Write-Host ($nunitTestPath | Select $_.Name)&lt;br /&gt;&lt;br /&gt; Write-Host "準備執行Nunit測試"&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;# 組執行的dll&lt;br /&gt;$testDlls = $nunitTestPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt;$testDllsJoin = [string]::Join(" ", $testDlls)&lt;br /&gt;&lt;br /&gt;Write-Host "執行的 Dll: $testDllsJoin"&lt;br /&gt;&lt;br /&gt;exec{ &amp;amp; $nunitExe $testDllsJoin --result=$nunitTestResultDirectory\nUnit.xml}&lt;/pre&gt;&lt;p&gt;最後在&lt;code&gt;Test&lt;/code&gt; task 加上 &lt;code&gt;NunitTest&lt;/code&gt; 相依性 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Test -depends Compile, Clean, XunitTest, NunitTest -description "執行Test" { &lt;br /&gt; Write-Host $testMsg&lt;br /&gt;}&lt;/pre&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482627694589931"&gt;執行Nunit測試&lt;/h2&gt;&lt;p&gt;上面都準備好了之後，我們就可以執行我們的build語法： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-adVMEUKX4P4/WF8cTWWs5-I/AAAAAAAAVEs/ejaLpmNQz4g/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-VmZ0G1HNtRc/WF8cUCMk7lI/AAAAAAAAVEw/5OsIxQeWw2Y/image_thumb.png?imgmax=800" width="644" height="399"&gt;&lt;/a&gt;&lt;figcaption&gt;執行Nunit的結果&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;然後我們能夠看到產出的結果是nunit3的xml結構格式： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-sMfpowaRWW0/WF8cVFZN-GI/AAAAAAAAVE0/RO7u7pWk_Bk/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-B5G7oYgKfgA/WF8cV4hPXII/AAAAAAAAVE4/Oy423Gb7AI4/image_thumb%25255B1%25255D.png?imgmax=800" width="415" height="143"&gt;&lt;/a&gt;&lt;figcaption&gt;執行結果&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482627694589826"&gt;結語&lt;/h2&gt;&lt;p&gt;到目前為止，NUnit的部分也完成了。Nunit和Xunit不同，內建並不支援匯出html的結果。所以，之後我們會需要使用別的方式產生出人比較看得懂的結果，不過以目前來說，我們 會進入下一個常見的測試工具，MSTest。 &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7380207720445822516/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-Nunit.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7380207720445822516'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7380207720445822516'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runTest-Nunit.html' title='[iThome第8屆鐵人賽 11]執行測試 2 - NUnit .Net'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-VmZ0G1HNtRc/WF8cUCMk7lI/AAAAAAAAVEw/5OsIxQeWw2Y/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-362848618695162600</id><published>2016-12-23T00:54:00.000+08:00</published><updated>2017-12-12T23:34:04.101+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 10]執行測試 1 - XUnit .Net</title><content type='html'>&lt;section&gt; &lt;p&gt;經過一段時間的介紹，相信對於使用psake來建制專案已經沒什麼問題了 - 我們就要開始進入建制的下個階段，也就是測試。 &lt;/p&gt;&lt;p&gt;專案建制起來只是基本條件，但是單元測試是否有通過才是保證程式碼品質的一種方式，因此，不跑單元測試更本就不完整。 &lt;/p&gt;&lt;p&gt;在接下來幾篇，將會介紹幾個常見的unit test的framework，先從xunit開始。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter10"&gt;github devops-psake sample/chapter10&lt;/a&gt; &lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034581303" ;=""&gt;準備Xunit 測試專案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582540" ;=""&gt;準備測試的執行環境&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582910" ;=""&gt;1. 在build專案安裝xunit的console runner&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582487" ;=""&gt;2. 準備build script - task 定義&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582821" ;=""&gt;3. 準備build script - 參數定義&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582672" ;=""&gt;4. 準備執行 xunit console runner&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582925" ;=""&gt;執行Xunit的測試&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482425034582269" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482425034581303"&gt;準備Xunit 測試專案&lt;/h2&gt;&lt;p&gt;首先，我們先建立一個新的Library 專案 ，然後透過nuget安裝： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;kbd&gt;Install-Package xunit -Version 2.1.0&lt;/kbd&gt; - xunit的test framework&lt;br /&gt;&lt;li&gt;&lt;kbd&gt;Install-Package Microsoft.AspNet.Mvc -Version 5.2.3&lt;/kbd&gt; - 等一下測試controller，所以需要有mvc的reference&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ol&gt;&lt;p&gt;再來，我們就建立一個簡單的test測試HomeController的Contact方法： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class HomeControllerTest&lt;br /&gt;{&lt;br /&gt; [Fact]&lt;br /&gt; public void Contact()&lt;br /&gt; {&lt;br /&gt;  // Arrange&lt;br /&gt;  HomeController controller = new HomeController();&lt;br /&gt;&lt;br /&gt;  // Act&lt;br /&gt;  ViewResult result = controller.Contact() as ViewResult;&lt;br /&gt;&lt;br /&gt;  // Assert&lt;br /&gt;  Assert.NotNull(result);&lt;br /&gt; }&lt;br /&gt;}&lt;/pre&gt;&lt;p&gt;準備好了之後，我們就可以準備build script的部分。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482425034582540"&gt;準備測試的執行環境&lt;/h2&gt;&lt;p&gt;在準備build script之前，我們需要知道，測試是如何執行的。 &lt;/p&gt;&lt;p&gt;一般來說，如果我們是開發，可能就直接用VS的Test Runner來執行，不過每一個test framework一定有提供console執行的版本，所以我們第一件事情就是要把這個console程式下載下來。 &lt;/p&gt;&lt;p&gt;再來，我們就可以在psake建立一個新的task，用作於執行xunit的測試。 &lt;/p&gt;&lt;p&gt;最後，如果執行成功的話，我們就可以看到結果 &lt;/p&gt;&lt;h3 id="WizKMOutline_1482425034582910"&gt;1. 在build專案安裝xunit的console runner&lt;/h3&gt;&lt;p&gt;安裝xunit的console runner：&lt;kbd&gt;Install-Package xunit.runner.console -Version 2.1.0&lt;/kbd&gt;&lt;/p&gt;&lt;h3 id="WizKMOutline_1482425034582487"&gt;2. 準備build script - task 定義&lt;/h3&gt;&lt;p&gt;首先，我們在default.ps1定義一個新的task，&lt;code&gt;XunitTest&lt;/code&gt;&lt;/p&gt;&lt;p&gt;由於這個task可以被單獨執行，因此相依性也要設定好，看起來就會是： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task XunitTest -depens Compile -description "執行Xunit測試"{&lt;br /&gt; Write-Host "準備執行Xunit測試"&lt;br /&gt;&lt;br /&gt; Write-Host "完成執行Xunit測試"&lt;br /&gt;}&lt;/pre&gt;&lt;h3 id="WizKMOutline_1482425034582821"&gt;3. 準備build script - 參數定義&lt;/h3&gt;&lt;p&gt;在確認執行之前，我們要先定義好幾個參數： &lt;/p&gt;&lt;dl&gt;&lt;dt&gt;取得執行Xunit的Console Runner位置 - $xunitExe  &lt;dd&gt;由於我們buildProject有加入xunit的 console runner，因此在package可以找到  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;測試結果要儲存的位置 - $xunitTestResultDirectory  &lt;dd&gt;我們 會把不同測試Framework分開放，所以會建立一個專門放Xunit  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;要執行測試的路徑確認 - $xunitTestPath  &lt;dd&gt;這個邏輯是透過看看建制出來的專案有沒有 &lt;code&gt;xunit&lt;/code&gt; 開頭的dll - 有就算是要被執行。這裡面取得的結果是&lt;code&gt;DirectoryInfo&lt;/code&gt;，原因我們稍後提到  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;pre class="brush: powershell;"&gt;$xunitExe = ((Get-ChildItem("$solutionDirectory\packages\xunit.runner.console*")).FullName |&lt;br /&gt;     Sort-Object $_ | select -Last 1) + "\tools\xunit.console.exe"&lt;br /&gt;&lt;br /&gt;$xunitTestResultDirectory = "$buildTestResultDirectory\Xunit"&lt;br /&gt;&lt;br /&gt;$xunitTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter xunit*.dll | &lt;br /&gt;      Select -ExpandProperty DirectoryName -Unique | % { [io.directoryinfo]$_ }&lt;/pre&gt;&lt;h3 id="WizKMOutline_1482425034582672"&gt;4. 準備執行 xunit console runner&lt;/h3&gt;&lt;p&gt;要執行xunit console runner，我們首先要找出所有要執行的dll清單，在上面我們已經找到了所有專案路徑的清單，所以可以用這個取得所有的dll清單。 &lt;/p&gt;&lt;p&gt;建制出來的dll名稱會和專案名稱一樣，因此我們可以用for迴圈方式把每一個找到的xunit專案路徑變成對應的dll路徑，然後最後在把他這個清單組成一個空白分開的字串 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;# 組執行的dll&lt;br /&gt;&lt;br /&gt;$testDlls = $xunitTestPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt;$testDllsJoin = [string]::Join(" ", $testDlls)&lt;/pre&gt;&lt;p&gt;再來就是要確認執行xunit console runne所會使用的參數： &lt;/p&gt;&lt;dl class="dl-horizontal"&gt;&lt;dt&gt;$dll 路徑  &lt;dd&gt;這個就是上面組出來的參數  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;-xml $路徑  &lt;dd&gt;執行結果要用 xml 格式 儲存在某個路徑  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;-html $路徑  &lt;dd&gt;執行結果用html格式儲存在某個路徑  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;-nologo  &lt;dd&gt;讓執行的時候，不出現xunit相關的logo資訊 - 減少輸出的內容  &lt;dd&gt;&lt;br /&gt;&lt;dt&gt;-noshadow  &lt;dd&gt;本來執行測試的時候，xunit會複製一份出來避免執行測試的時候資源被使用。不過我們用script執行之後，能夠確認不會有其他用到，所以可以不用做複製的動作，加快執行速度。  &lt;dd&gt;&lt;/dd&gt;&lt;/dl&gt;&lt;pre class="brush: powershell;"&gt;exec{ &amp;amp;$xunitExe $testDllsJoin -xml $xunitTestResultDirectory\xUnit.xml `&lt;br /&gt;                -html $xunitTestResultDirectory\xUnit.html `&lt;br /&gt;                -nologo -noshadow}&lt;/pre&gt;&lt;div class="bs-callout bs-callout-info"&gt;如果對於還有那些參數可以傳入有興趣，可以直接執行Xunit的console，&lt;em&gt;不要傳入任何參數&lt;/em&gt;，就會看到所有可以輸入的參數清單。 &lt;/div&gt;&lt;p&gt;最後，加入一些日誌方面的資訊，task變成： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task XunitTest -depends Compile -description "執行Xunit測試" `&lt;br /&gt;{&lt;br /&gt; # 取得Xunit project的路徑&lt;br /&gt; $xunitTestPath =  Get-ChildItem $buildTempDirectory -Recurse -Filter xunit*.dll | &lt;br /&gt;      Select -ExpandProperty DirectoryName -Unique | % { [io.directoryinfo]$_ }&lt;br /&gt;&lt;br /&gt; if(Test-Path $xunitTestPath){&lt;br /&gt;&lt;br /&gt;  Write-Host "建立Xunit測試結果的資料夾 $xunitTestResultDirectory"&lt;br /&gt;  New-Item $xunitTestResultDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt;  Write-Host "總共有 $($xunitTestPath.Count) 個專案"&lt;br /&gt;&lt;br /&gt;  Write-Host ($xunitTestPath | Select $_.Name)&lt;br /&gt;&lt;br /&gt;  Write-Host "準備執行Xunit測試"&lt;br /&gt;&lt;br /&gt;  # 組執行的dll&lt;br /&gt;&lt;br /&gt;  $testDlls = $xunitTestPath | % {$_.FullName + "\" + $_.Name + ".dll" }&lt;br /&gt;&lt;br /&gt;  $testDllsJoin = [string]::Join(" ", $testDlls)&lt;br /&gt;&lt;br /&gt;  Write-Host "執行的 Dll: $testDllsJoin"&lt;br /&gt;&lt;br /&gt;  exec{ &amp;amp;$xunitExe $testDllsJoin -xml $xunitTestResultDirectory\xUnit.xml `&lt;br /&gt;    -html $xunitTestResultDirectory\xUnit.html `&lt;br /&gt;    -nologo -noshadow}&lt;br /&gt;  &lt;br /&gt;  Write-Host "完成執行Xunit測試"&lt;br /&gt; }&lt;br /&gt;&lt;br /&gt;}&lt;/pre&gt;&lt;p&gt;最後，把&lt;code&gt;XUnitTest&lt;/code&gt;加入&lt;code&gt;Test&lt;/code&gt;的相依task &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Test -depends Compile, Clean, XunitTest -description "執行Test" { &lt;br /&gt; Write-Host $testMsg&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482425034582925"&gt;執行Xunit的測試&lt;/h2&gt;&lt;p&gt;到目前為止，準備都完成了，這個時候執行&lt;code&gt;build.ps1&lt;/code&gt;，我們就會看到除了建制之外，單元測試也有被執行。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-njgvNvzuwdA/WFwEDXnVbII/AAAAAAAAVEE/vUPP_mZ7sew/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-NXc1dxRQw7s/WFwEEe5GM3I/AAAAAAAAVEI/ecoRJRR0DFI/image_thumb.png?imgmax=800" width="644" height="217"&gt;&lt;/a&gt; &lt;figcaption&gt;執行的output結果&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;然後我們在&lt;code&gt;testResult\Xunit&lt;/code&gt;下面也有對應檔案產生出來 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-umq8Fjl7ffA/WFwEFOGCooI/AAAAAAAAVEM/MRhLMc-LenA/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-Bz1BGXxQrJ8/WFwEF4RrknI/AAAAAAAAVEQ/W9pfSaBvovg/image_thumb%25255B1%25255D.png?imgmax=800" width="466" height="206"&gt;&lt;/a&gt; &lt;figcaption&gt;執行完結果內容&lt;/figcaption&gt;&lt;/figure&gt; &lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482425034582269"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇，介紹了如何建立出XUnit的測試結果，並且我們可以看到最後執行完的產出。在未來，其實可以把產出的xml做二次加工而產生出更漂亮的報告，目前來說我們先執行到這一步。 &lt;/p&gt;&lt;p&gt;在下一篇，我們要來看看另外一個常見的test framework，NUnit的task建立方式。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/362848618695162600/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runtest-XUnit.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/362848618695162600'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/362848618695162600'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-runtest-XUnit.html' title='[iThome第8屆鐵人賽 10]執行測試 1 - XUnit .Net'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-NXc1dxRQw7s/WFwEEe5GM3I/AAAAAAAAVEI/ecoRJRR0DFI/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4532599989099621967</id><published>2016-12-20T12:18:00.000+08:00</published><updated>2017-12-12T23:34:04.237+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 09]建制失敗的處理 - 為什麼失敗了但是build server還是認為成功</title><content type='html'>&lt;section&gt; &lt;p&gt;在進入下個階段之前（也就是開始執行Unit Test），有個部分一直沒有碰到，那就是當建制失敗的時候會發生什麼事情。 &lt;/p&gt;&lt;p&gt;整個CI的概念就是盡早發現建制有問題好去做一些處理，但是如果出錯了都發現不到，不就等於沒有意義了？ &lt;/p&gt;&lt;p&gt;這篇我們將會看看這方面的處理。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 github &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter9"&gt;devops-psake sample/chapter9&lt;/a&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914421" ;=""&gt;當Build有錯會怎麼樣？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914640" ;=""&gt;這會有什麼問題？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914342" ;=""&gt;問題原因分析&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914235" ;=""&gt;解決方式 - exec&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914391" ;=""&gt;還有一道步奏&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1482207199914403" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482207199914421"&gt;當Build有錯會怎麼樣？&lt;/h2&gt;&lt;p&gt;我們首先來看看，當我們故意修改程式碼，讓他build不下去，會出現什麼內容。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-rsurwydVzfM/WFiwyNl7zqI/AAAAAAAAVC8/WDVNcN4_w4g/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-nEo5hY0g_zg/WFiwywfXLHI/AAAAAAAAVDA/bc5-CEdDjhc/image_thumb.png?imgmax=800" width="644" height="377"&gt;&lt;/a&gt;&lt;figcaption&gt;從圖片可以看到，雖然MSBuild說失敗了，但是psake還是認為成功了&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h2 id="WizKMOutline_1482207199914640"&gt;這會有什麼問題？&lt;/h2&gt;&lt;p&gt;最大的問題會在，當我們要結合一些Build Server的時候，因為他呼叫的是psake，而psake告訴他成功（雖然MSBuild告訴他失敗），所以build server就認為成功。 &lt;/p&gt;&lt;p&gt;換句話說，&lt;em&gt;就算失敗了我們也永遠不會知道&lt;/em&gt;。 &lt;/p&gt;&lt;p&gt;等於是整個建制scrip更本沒辦法使用了。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1482207199914342"&gt;問題原因分析&lt;/h2&gt;&lt;p&gt;這個問題，其實很簡單，有點像是程式裡面，如果出現了Exception，把它Tray catch不做任何事情是一樣的概念，當MSBuild出錯的時候，我們的psake就像是掩耳盜鈴一樣，管他是不是跑成功了， 他永遠回傳成功。 &lt;/p&gt;&lt;p&gt;所以，我們要面對現實，當建制失敗了，這個資訊要傳出去。 &lt;/p&gt;&lt;p&gt;但是另外一個問題來了，我們怎麼知道MSBuild建制失敗了？ &lt;/p&gt;&lt;p&gt;任何一個console程式，其實都有一個Exit Code的概念，就是當他執行完，他會回傳一個值，如果 = 0，表示&lt;em&gt;沒有問題&lt;/em&gt;，不是0表示有問題。（話說，我寫console都沒有照這個原則） &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482207199914235"&gt;解決方式 - exec&lt;/h2&gt;&lt;p&gt;既然知道有exit code之後，我們可以讓psake檢查，如果是0，就表示沒問題，是0以外表示有問題，就拋出exception。 &lt;/p&gt;&lt;p&gt;可以想象當我們要呼叫的程式越來越多，每一個都要加上這個判斷真的不方便，所以psake提供了一個&lt;code&gt;exec&lt;/code&gt;的方法，專門幫忙做上面的判斷。 &lt;/p&gt;&lt;p&gt;所以，我們調整 task Compile變成： &lt;/p&gt;&lt;pre class="brush: powershell;highlight:12"&gt;task Compile -depends Clean, Init -description "編譯程式碼" `&lt;br /&gt;    -requiredVariables solutionFile, buildConfiguration, buildTarget, buildTempDirectory `&lt;br /&gt;{ &lt;br /&gt; Write-Host "開始建制檔案：$solutionFile"&lt;br /&gt;&lt;br /&gt; $buildParam = "Configuration=$buildConfiguration" +&lt;br /&gt;     ";Platform=$buildTarget" + &lt;br /&gt;     ";OutDir=$buildTempDirectory"&lt;br /&gt; &lt;br /&gt; $buildParam = $buildParam + ";GenerateProjectSpecificOutputFolder=true"&lt;br /&gt;&lt;br /&gt; exec {msbuild $solutionFile "/p:$buildParam"}&lt;br /&gt;} &lt;br /&gt; &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Vv4Ns62cUFY/WFiwzrRhI-I/AAAAAAAAVDE/pBqz4Jcx9KU/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-6Jpfe1_WECA/WFiw0XiQ2xI/AAAAAAAAVDI/9lILOhpxd1g/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="154"&gt;&lt;/a&gt;&lt;figcaption&gt;psake 會報錯了&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-info"&gt;未來執行外部程式一定要記得呼叫exec包住 &lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482207199914391"&gt;還有一道步奏&lt;/h2&gt;&lt;p&gt;最後，就算是這樣，我們build server還是不認為失敗，原因很簡單，同樣概念，builder server呼叫的是 build.ps1，可是報錯的是default.ps1，如果錯誤訊息沒有往上傳，build server還是認為成功。 &lt;/p&gt;&lt;p&gt;因此，我們要在build.ps1，把這個錯誤訊息往上傳： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;...&lt;br /&gt;&lt;br /&gt;Write-Host "建制的Exit Code：$LastExitCode"&lt;br /&gt;&lt;br /&gt;# 把錯誤碼往上傳&lt;br /&gt;exit $LastExitCode &lt;br /&gt; &lt;/pre&gt;&lt;p&gt;&lt;code&gt;$LastExitCode&lt;/code&gt;是powershell裡面記錄最後一個執行完回傳的結果，所以我們可以用這個值來呈現到我們build結果 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1482207199914403"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇我們了解到psake怎麼和其他console程式做結合，並且了解透過exit code的方式來知道是否執行成功。 &lt;/p&gt;&lt;p&gt;因此，下次在寫console程式的時候，別忘記最後都回傳一個exit code，未來如果自己程式要和這種build結合才有辦法達到 &lt;/p&gt;&lt;p&gt;下篇，我們正式進入另外一個部分，程式不是build起來就好了，還要確認所有檢查要通過，而這個檢查就是單元測試。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4532599989099621967/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-howToPropergateBuildError.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4532599989099621967'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4532599989099621967'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-howToPropergateBuildError.html' title='[iThome第8屆鐵人賽 09]建制失敗的處理 - 為什麼失敗了但是build server還是認為成功'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-nEo5hY0g_zg/WFiwywfXLHI/AAAAAAAAVDA/bc5-CEdDjhc/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7792152506900755116</id><published>2016-12-17T16:56:00.000+08:00</published><updated>2017-12-12T23:34:04.840+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 08]建制結果問題 - 方法2 透過MSBuild的Target</title><content type='html'>&lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911367" ;=""&gt;拆解WebApplication1.csproj&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911395" ;=""&gt;建立console用到的target&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911629" ;=""&gt;1. target檔案和資料夾名稱參數的產生&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911738" ;=""&gt;2. 註冊執行的動作&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911828" ;=""&gt;3. 是定義執行的動作&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911688" ;=""&gt;4. 把剛剛定義的target放到Console的csproj&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911793" ;=""&gt;5. 執行結果&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962983911347" ;=""&gt;結語&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上篇了解到如果什麼都沒調整的情況下，建制出來的內容會放在一起，根本無法區分哪些內容屬於哪些專案。 &lt;/p&gt;&lt;p&gt;也提到了.Ner 4.5能夠使用&lt;code&gt;GenerateProjectSpecificOutputFolder&lt;/code&gt;，但是假設是.Net 4.5以下呢？ &lt;/p&gt;&lt;p&gt;這篇我們會沿著這個思路，看看為什麼Asp .Net Mvc專案有個_PublishedWebsite，並且我們是否能夠使用這個資訊來做些處理。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 github &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter8"&gt;devops-psake sample/chapter8&lt;/a&gt;&lt;/div&gt;&lt;/section&gt;&lt;br /&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;br /&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962983911367"&gt;拆解WebApplication1.csproj&lt;/h2&gt;&lt;p&gt;如果我們用editor把web專案的csproj打開，在靠近下面的部分，我們會看到幾個Target &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Cjt-QTOBve8/WFT9XRbaBYI/AAAAAAAAVAk/FoniUqLpWX4/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-6x914Sdk-Rk/WFT9YEtPc1I/AAAAAAAAVAo/3Cr9D2wsD3U/image_thumb.png?imgmax=800" width="644" height="46"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;2個不同的target&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;一般的Library專案只會有第一個target：&lt;code&gt;Microsoft.CSharp.targets&lt;/code&gt;，而Web專案多了一個target：&lt;code&gt;Microsoft.WebApplication.targets&lt;/code&gt;&lt;/p&gt;&lt;p&gt;如果把&lt;code&gt;Microsoft.WebApplication.targets&lt;/code&gt;打開，我們會看到：有個target叫做：&lt;code&gt;_CopyWebApplicationLegacy&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-h_buNy5Yc8U/WFT9ZN-ltlI/AAAAAAAAVAs/bU1TMxP0lC0/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-IGkG6heTfQA/WFT9anxBa5I/AAAAAAAAVAw/HwuRfKtm5TI/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="206"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;找到複製的target&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;這個Target有很多不同檔案類型的判斷，我們可以利用這個作為我們Console複製的target &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962983911395"&gt;建立console用到的target&lt;/h2&gt;&lt;h3 id="WizKMOutline_1481962983911629"&gt;1. target檔案和資料夾名稱參數的產生&lt;/h3&gt;&lt;p&gt;首先在&lt;code&gt;BuildProject&lt;/code&gt;建立&lt;code&gt;MSBuildTargets\ApplicationBuild.targets&lt;/code&gt;，這個檔案將會是我們target的位置 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-9HiExeK1Y3c/WFT9bVwDlkI/AAAAAAAAVA0/H_9Gk4wrL2M/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-JuvjssUrHfI/WFT9cJi9BdI/AAAAAAAAVA4/72BpGtsvMDI/image_thumb%25255B2%25255D.png?imgmax=800" width="326" height="338"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;applicationBuild.targets&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;在來，我們先定義出要建立的資料夾名稱參數&lt;code&gt;applicationoutputdirectory&lt;/code&gt;： &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" defaulttargets="Build"&gt;&lt;br /&gt;    &lt;propertygroup&gt;&lt;br /&gt;        &lt;applicationoutputdirectory&gt;$(OutDir)_PublishedApplication\$(MSBuildProjectName)&lt;br /&gt;        &lt;/applicationoutputdirectory&gt;&lt;/propertygroup&gt;&lt;br /&gt;    &lt;/project&gt;&lt;/pre&gt;&lt;h3 id="WizKMOutline_1481962983911738"&gt;2. 註冊執行的動作&lt;/h3&gt;&lt;p&gt;再來，我們會建立當MSBuild執行的時候要執行我們複製的動作 &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;project&gt;&lt;br /&gt;...&lt;br /&gt; &lt;propertygroup&gt;&lt;prepareforrundependson&gt;&lt;br /&gt;   $(PrepareForRunDependsOn);&lt;br /&gt;   _CopyApplication&lt;br /&gt;  &lt;/prepareforrundependson&gt;&lt;/propertygroup&gt;&lt;br /&gt;...&lt;br /&gt;&lt;/project&gt;&lt;/pre&gt;&lt;p&gt;這個意思是，我們會在&lt;code&gt;PrepareForRunDependsOn&lt;/code&gt;這個事件插入我們的事件，不過首先要先把之前的執行完，然後在執行我們等一下定義的&lt;code&gt;_CopyApplication&lt;/code&gt;這個task &lt;/p&gt;&lt;h3 id="WizKMOutline_1481962983911828"&gt;3. 是定義執行的動作&lt;/h3&gt;&lt;p&gt;接下來我們可以複製 &lt;code&gt;_CopyWebApplicationLegacy&lt;/code&gt;所有的東西，並且做一些調整： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Name的部分從 _CopyWebApplicationLegacy 改成 _CopyApplication&lt;br /&gt;&lt;li&gt;把路徑 WebProjectOutputDir 改成 ApplicationOutputDirectory&lt;br /&gt;&lt;li&gt;最後，有一組 copy，註解是 &lt;code&gt;&amp;lt;!-- Copy content files recursively to _PublishedWebsites\app\ folder --&amp;gt;&lt;/code&gt;也拿掉&lt;br /&gt;&lt;br /&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1481962983911688"&gt;4. 把剛剛定義的target放到Console的csproj&lt;/h3&gt;&lt;p&gt;把console的csproj打開，然後加入import target的部分在最下面： &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;import project="..\BuildProject\MSBuildTargets\ApplicationBuild.targets"&gt;&lt;/import&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-KQ-w4KAo4Lg/WFT9dkrUeFI/AAAAAAAAVA8/S83dADQYkAY/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-T3EKoUB5JsM/WFT9eVOo84I/AAAAAAAAVBA/2VGgbscgIus/image_thumb%25255B3%25255D.png?imgmax=800" width="644" height="119"&gt;&lt;/a&gt; &lt;figcaption&gt;用VS修改&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1481962983911793"&gt;5. 執行結果&lt;/h3&gt;&lt;p&gt;最後整個檔案內容是： &lt;/p&gt;&lt;pre class="brush: xml;"&gt;&lt;project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" defaulttargets="Build"&gt;&lt;br /&gt;  &lt;propertygroup&gt;&lt;br /&gt;  &lt;applicationoutputdirectory&gt;$(OutDir)_PublishedApplication\$(MSBuildProjectName)&lt;/applicationoutputdirectory&gt;&lt;br /&gt; &lt;/propertygroup&gt;&lt;br /&gt;&lt;br /&gt; &lt;propertygroup&gt;&lt;br /&gt;  &lt;prepareforrundependson&gt;&lt;br /&gt;   $(PrepareForRunDependsOn);&lt;br /&gt;   _CopyApplication&lt;br /&gt;  &lt;/prepareforrundependson&gt;&lt;br /&gt; &lt;/propertygroup&gt;&lt;br /&gt;&lt;br /&gt; &lt;target name="_CopyApplication" condition="'$(OutDir)' != '$(OutputPath)'"&gt;&lt;br /&gt;    &lt;!-- Log tasks --&gt;&lt;br /&gt;    &lt;message text="Copying Web Application Project Files for $(MSBuildProjectName)"&gt;&lt;/message&gt;&lt;br /&gt;&lt;br /&gt;    &lt;!-- Create the _PublishedWebsites\app\bin folder --&gt;&lt;br /&gt;    &lt;makedir directories="$(ApplicationOutputDirectory)\bin"&gt;&lt;/makedir&gt;&lt;br /&gt;&lt;br /&gt;    &lt;!-- Copy build outputs to _PublishedWebsites\app\bin folder --&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(IntermediateAssembly)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(AddModules)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy condition="'$(_SGenDllCreated)'=='true'" sourcefiles="$(IntermediateOutputPath)$(_SGenDllName)" destinationfolder="$(ApplicationOutputDirectory)\%(Content.SubFolder)%(Content.RecursiveDir)" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy condition="'$(_DebugSymbolsProduced)'=='true'" sourcefiles="$(IntermediateOutputPath)$(TargetName).pdb" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy condition="'$(_DocumentationFileProduced)'=='true'" sourcefiles="@(DocFileItem)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(IntermediateSatelliteAssembliesWithTargetPath)" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)" destinationfiles="@(IntermediateSatelliteAssembliesWithTargetPath-&amp;gt;'$(ApplicationOutputDirectory)\bin\%(Culture)\$(TargetName).resources.dll')"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(ReferenceComWrappersToCopyLocal); @(ResolvedIsolatedComModules); @(_DeploymentLooseManifestFile); @(NativeReferenceFile)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;&lt;br /&gt;    &lt;!-- copy any referenced assemblies to _PublishedWebsites\app\bin folder --&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(ReferenceCopyLocalPaths)" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)" destinationfiles="@(ReferenceCopyLocalPaths-&amp;gt;'$(ApplicationOutputDirectory)\bin\%(DestinationSubDirectory)%(Filename)%(Extension)')"&gt;&lt;/copy&gt;&lt;br /&gt;&lt;br /&gt;    &lt;!-- Copy items that have been marked to be copied to the bin folder --&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(_SourceItemsToCopyToOutputDirectory)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(_SourceItemsToCopyToOutputDirectoryAlways)" destinationfolder="$(ApplicationOutputDirectory)\bin" skipunchangedfiles="false" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    &lt;!-- Copy items that need to be bin deployed to the bin folder --&gt;&lt;br /&gt;    &lt;copy sourcefiles="@(_binDeployableAssemblies)" destinationfolder="$(ApplicationOutputDirectory)\bin\%(RecursiveDir)" skipunchangedfiles="true" retries="$(CopyRetryCount)" retrydelaymilliseconds="$(CopyRetryDelayMilliseconds)"&gt;&lt;/copy&gt;&lt;br /&gt;&lt;br /&gt;  &lt;/target&gt;&lt;br /&gt;&lt;/project&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-o1xdpYvZoME/WFT9fQRekdI/AAAAAAAAVBE/Wrn4qWHH8II/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/--wRzRb0oXA8/WFT9gL6GmwI/AAAAAAAAVBI/ZwCpRPKlLRo/image_thumb%25255B4%25255D.png?imgmax=800" width="443" height="347"&gt;&lt;/a&gt; &lt;figcaption&gt;執行結果多了一個發佈的資料夾&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-info"&gt;其實第5步的複製有些東西是可以調整更符合console專案，但是這就留給讀者去嘗試 &lt;/div&gt;&lt;div class="bs-callout bs-callout-info"&gt;透過這次修改MSBuild相信對於為什麼不直接用MSBuild而是用Psake有所了解，看MSBuild真的太不容易 &lt;/div&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962983911347"&gt;結語&lt;/h2&gt;&lt;p&gt;這篇算是比較快速帶過，如何利用MSBuild來做到一些我們想要擴充的動作，在非.Net 4.5之前，這個是我們唯一的做法，不過相較於上一篇提到的方式，這個方法實在太繁瑣了。 &lt;/p&gt;&lt;p&gt;在接下來的篇章，我會持續使用上篇的做法，並且我們開始要進入到執行測試的階段，不過在進入測試之前，還有一個問題要先解決，那就是當建制失敗應該會怎麼樣。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7792152506900755116/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildOutputProblem-2.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7792152506900755116'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7792152506900755116'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildOutputProblem-2.html' title='[iThome第8屆鐵人賽 08]建制結果問題 - 方法2 透過MSBuild的Target'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-6x914Sdk-Rk/WFT9YEtPc1I/AAAAAAAAVAo/3Cr9D2wsD3U/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2699936514117909994</id><published>2016-12-17T16:36:00.000+08:00</published><updated>2017-12-12T23:34:03.900+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 07]建制結果問題 - 說明 和 處理方法 1</title><content type='html'>&lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382457" ;=""&gt;Build結果有什麼&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382878" ;=""&gt;加入Library和Console專案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382503" ;=""&gt;解決方法 1 - .Net 4.5 以上的專案 - GenerateProjectSpecificOutputFolder&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382357" ;=""&gt;解決方法1的缺點&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382169" ;=""&gt;解決方案 2 - 使用Asp.Net Mvc的概念產生出 _PublishedXXX&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481962636382397" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;上篇我們提到了用psake來建制一個asp .net mvc的專案，並且修正了psake執行時候呈現的內容，在這篇，我們將進一步延伸來看一下，buid結束產生的內容是什麼和 加入另外兩種常見的.Net專案： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Console Project&lt;br /&gt;&lt;li&gt;Library Project&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-default"&gt;sample 程式在 github &lt;a href="https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter7"&gt;devops-psake sample/chapter7&lt;/a&gt;&lt;/div&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt; &lt;h2 id="WizKMOutline_1481962636382457"&gt;Build結果有什麼&lt;/h2&gt;&lt;p&gt;執行完build之後，我們會看到，在&lt;code&gt;.build\temp&lt;/code&gt;下面有一堆檔案。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ph2_21ylSck/WFT27o1hq7I/AAAAAAAAU_0/l54ezAVSv4U/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-LvImtC29GZU/WFT28hzcbtI/AAAAAAAAU_4/wZ_Ydxlpufs/image_thumb.png?imgmax=800" width="644" height="478"&gt;&lt;/a&gt; &lt;figcaption&gt;一堆怪怪的檔案&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;如果只熟悉用Visual Studio來建制的話，會覺得奇怪，怎麼有這麼多奇奇怪怪的檔案跑出來，並且網站那些css，javascript怎麼都不見了？ &lt;/p&gt;&lt;p&gt;在往下看，會看到有一個&lt;code&gt;.\build\temp\_PublishedWebsites\WebApplication1&lt;/code&gt;，這個看起來就和我們所了解的網站專案比較有關係。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_3ERKHzabCo/WFT29YFqaPI/AAAAAAAAU_8/LTitZxCVeAs/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-H_Ty2IMsJhw/WFT2_OVVP-I/AAAAAAAAVAA/7OBz31kcEso/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="336"&gt;&lt;/a&gt; &lt;figcaption&gt;_publishedWebsites\WebApplication1&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;目前來說，我們可以得出一個結論，也就是建制出來的東西雖然結果是在我們指定的資料夾裡面，但是所有東西都在&lt;em&gt;同一個層級&lt;/em&gt;。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962636382878"&gt;加入Library和Console專案&lt;/h2&gt;&lt;p&gt;假設我們在加入兩個常見的專案類型，Library和Console。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cydDYgUZGSg/WFT3AEN7cGI/AAAAAAAAVAE/2LNqxhSXvtE/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-aPnXrRq5Akg/WFT3BFXPSwI/AAAAAAAAVAI/QSccHFolu3o/image_thumb%25255B2%25255D.png?imgmax=800" width="382" height="284"&gt;&lt;/a&gt; &lt;figcaption&gt;多了兩個project&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;這個時候我們在build一次，在看看我們的結果，這個時候會發現，所有東西都堆在了一起。 &lt;/p&gt;&lt;p&gt;如果結果都堆在一起，我們要怎麼&lt;em&gt;區分&lt;/em&gt;什麼是什麼？因為最後我們要發佈或者把建制結果打包，如果區分不了如何能夠做這個事情？ &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962636382503"&gt;解決方法 1 - .Net 4.5 以上的專案 - GenerateProjectSpecificOutputFolder&lt;/h2&gt;&lt;p&gt;在MSbuild有個參數叫做&lt;code&gt;GenerateProjectSpecificOutputFolder&lt;/code&gt;，這個參數可以讓建制的時候，結果還是依照solution專案來放。 &lt;/p&gt;&lt;p&gt;所以我們可以再：&lt;code&gt;default.ps1&lt;/code&gt;，調整建制MSBuild的參數： &lt;/p&gt;&lt;pre class="brush: powershell;highlight:[10]"&gt;task Compile -depends Clean, Init -description "編譯程式碼" `&lt;br /&gt;    -requiredVariables solutionFile, buildConfiguration, buildTarget, buildTempDirectory `&lt;br /&gt;{ &lt;br /&gt; Write-Host "開始建制檔案：$solutionFile"&lt;br /&gt;&lt;br /&gt; $buildParam = "Configuration=$buildConfiguration" +&lt;br /&gt;     ";Platform=$buildTarget" + &lt;br /&gt;     ";OutDir=$buildTempDirectory"&lt;br /&gt; &lt;br /&gt; $buildParam = $buildParam + ";GenerateProjectSpecificOutputFolder=true"&lt;br /&gt;&lt;br /&gt; msbuild $solutionFile "/p:$buildParam"&lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt;&lt;p&gt;這個時候在看看發佈出來的結果，可以很清楚看到資料夾有做了區分。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-8sWUyHQM3B4/WFT3BuYpn3I/AAAAAAAAVAM/-R7Ckvl8Hu0/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-5y_lIyXHPI4/WFT3CdzXMEI/AAAAAAAAVAQ/EASByjHajq8/image_thumb%25255B3%25255D.png?imgmax=800" width="366" height="238"&gt;&lt;/a&gt; &lt;figcaption&gt;建制結果有區分專案&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-info"&gt;&lt;h3 id="WizKMOutline_1481962636382357"&gt;解決方法1的缺點&lt;/h3&gt;&lt;p&gt;雖然說解決方法1很簡單就能夠實現，但是他有個小缺陷 - .Net 4.5 以上的專案才能夠支援 - 雖然比較少寫4.5以下的專案，但是至少有這個缺陷。 &lt;/p&gt;&lt;p&gt;加上這個系列也想介紹一些MSBuild的基本概念，因此我們想象另外一個思路。 &lt;/p&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962636382169"&gt;解決方案 2 - 使用Asp.Net Mvc的概念產生出 _PublishedXXX&lt;/h2&gt;&lt;p&gt;另外一個思路是，既然Asp.Net Mvc會把它包好，是否可以用同樣概念去對Library還有Console程式的結果包在特定的資料夾下面？ &lt;/p&gt;&lt;p&gt;要了解這個，就需要了解到為什麼只有Asp .Net Mvc的專案才會產生帶有 _PbulishedWebsite的資料夾，而這個答案就在MSBuild建制Asp .Net Mvc的方式不同有關。也就是下篇介紹的內容。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481962636382397"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇了解到其實建制出來的結果都是混在一起的，沒有辦法區分那個專案的結果在那邊。而這個問題將會影響到我們之後不管執行測試也好，還是要打包結果，都會造成不便利。 &lt;/p&gt;&lt;p&gt;這個問題的一種解決方式是透過MSBUild的一個參數 - 但是這個只能夠用在.net 4.5以上的專案。 &lt;/p&gt;&lt;p&gt;所以在下篇，我們會了解，到底asp .net mvc專案是如何做到產生在不同資料夾，並且我們如何使用這個概念 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2699936514117909994/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildOutputProblem-1.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2699936514117909994'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2699936514117909994'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildOutputProblem-1.html' title='[iThome第8屆鐵人賽 07]建制結果問題 - 說明 和 處理方法 1'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-LvImtC29GZU/WFT28hzcbtI/AAAAAAAAU_4/wZ_Ydxlpufs/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1699808065017923606</id><published>2016-12-07T07:19:00.000+08:00</published><updated>2017-12-12T23:34:03.767+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 06]開始建制一個Asp .Net Mvc專案</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462822" ;=""&gt;MSBuild和Psake的關係&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462396" ;=""&gt;準備程式用於做建制測試&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462580" ;=""&gt;開始建制我們的專案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462189" ;=""&gt;修正Compile時候出現的幾個小問題&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462884" ;=""&gt;MSBuild使用的.Net版本錯了&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462248" ;=""&gt;Console看不出哪段是psake在執行&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1481065368462704" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;經過了幾天的理論介紹，我們開始要進入建制專案的部分。 &lt;/p&gt;&lt;p&gt;我們會先拿一個Asp .net Mvc的網站作為第一個要建制的專案，所以我們會先建立出來，然後在使用MSBuild帶來的幫助，幫我們快速建立專案 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;這次的建制我們都是focus在.net Framework的部分，或許.net core會有所不同，但是概念是一樣。 &lt;/div&gt;&lt;p&gt;（之後下面提到的code都可以從這邊看到內容：&lt;a href="https://github.com/alantsai-samples/devops-psake"&gt;github repo&lt;/a&gt;，這篇會是tag sample/chapter6）&lt;br /&gt;&lt;/p&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481065368462822"&gt;MSBuild和Psake的關係&lt;/h2&gt;&lt;p&gt;在我們往下之前，有一個關係要在說明一下。我們使用psake並不是說要完全放棄MSBuild，反而是兩個結合在一起得到兩者的好處。 &lt;/p&gt;&lt;p&gt;首先，我們知道VS其實有很多不同類型的專案，而這些不同類型的專案在建制過程呼叫方式都完全不太一樣。因此，微軟提供了很多不同project的msbuild target（同等於task的概念）來處理 怎麼建制這些專案和要copy那些檔案。 &lt;/p&gt;&lt;p&gt;因此，我們不會重複造車輪，而是直接使用MSBuild所帶來的便利。 &lt;/p&gt;&lt;p&gt;不過這個時候會好奇，那當初不就直接用MSBuild就好？ &lt;/p&gt;&lt;p&gt;原因非常簡單，要擴充MSBuild非常麻煩。需要用C#才有辦法寫，然後又要處理一堆xml。 &lt;/p&gt;&lt;p&gt;反過來看psake，非常簡單，只要定義一個powershell script就好。 &lt;/p&gt;&lt;p&gt;所以，接下來我們會看到MSBuild被執行就沒什麼好奇怪。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1481065368462396"&gt;準備程式用於做建制測試&lt;/h2&gt;&lt;p&gt;我們需要先把環境準備好方便接下來的測試。 &lt;/p&gt;&lt;p&gt;首先我們先建立一個Asp .net Mvc的專案，先看看有web專案情況會如何。 &lt;/p&gt;&lt;p&gt;我們會建立一個asp .net mvc的專案，並且包含預設的Test專案 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-SNt_4TS1tX0/WEdEwGIaeoI/AAAAAAAAU-c/O3397nw-iks/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-PAjGyESJwKg/WEdExVBu52I/AAAAAAAAU-g/VKWHkyTE9-c/image_thumb.png?imgmax=800" width="644" height="182"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;選擇asp .net web application&lt;a href="https://lh3.googleusercontent.com/-jBHjjWmTg6w/WEdEzMUtbuI/AAAAAAAAU-k/BXbFiyTDpKU/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-G1yWOr8EVPg/WEdE0Y8EOvI/AAAAAAAAU-o/DfZvElIoq1Y/image_thumb%25255B1%25255D.png?imgmax=800" width="627" height="484"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;br /&gt;&lt;figcaption&gt;選擇Mvc，然後勾選unit test&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;  &lt;h2 id="WizKMOutline_1481065368462580"&gt;開始建制我們的專案&lt;/h2&gt;&lt;p&gt;基本上在建制專案的時候，有3個重要參數，說明一下： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;建制模式 - 一般我們都會設定要用Debug還是Release(預設模式)&lt;br /&gt;&lt;li&gt;目標的platform - 一般有三個值，x64、x86和Any Cpu&lt;br /&gt;&lt;li&gt;建制結果的位置 - 要把建制結果放在那裡，以我們來說就是 .build\temp 裡面&lt;/li&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-info"&gt;1 和 2 其實 在VS裡面也可以設定，不過一般來說不怎麼調整就是 &lt;a href="https://lh3.googleusercontent.com/--61p-bavWNM/WEdE3qRmG_I/AAAAAAAAU-s/yIPsIHmEAkU/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-gcwFxTFOXio/WEdE5fu6TbI/AAAAAAAAU-w/4bVqr7EK_dU/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="96"&gt;&lt;/a&gt;&lt;figure&gt; &lt;figcaption&gt;VS設定建制模式和目標platform的位置&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&lt;p&gt;有了這三個部分之後，我們就可以來調整我們Compile的Task &lt;/p&gt;&lt;p&gt;首先，剛剛提到的三個參數，第1和第2要增加，而第3我們已經有了。和其他參數一樣，我們會把這個加在&lt;code&gt;properties&lt;/code&gt;裡面，這樣才有可能可以把值覆蓋。 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;Properties{&lt;br /&gt;...&lt;br /&gt; $buildConfiguration = "Release"&lt;br /&gt; $buildTarget = "Any CPU"&lt;br /&gt;}&lt;br /&gt;   &lt;/pre&gt;&lt;p&gt;再來的會就是我們實際的&lt;code&gt;Compile&lt;/code&gt; task： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Compile -depends Clean, Init -description "編譯程式碼" `&lt;br /&gt;  -requiredVariables solutionFile, buildConfiguration, buildTarget, buildTempDirectory `&lt;br /&gt;{ &lt;br /&gt; Write-Host "開始建制檔案：$solutionFile"&lt;br /&gt;&lt;br /&gt; msbuild $solutionFile "/p:Configuration=$buildConfiguration;Platform=$buildTarget;OutDir=$buildTempDirectory"&lt;br /&gt;}&lt;br /&gt;   &lt;/pre&gt;&lt;p&gt;這邊使用到了&lt;code&gt;msbuild&lt;/code&gt;做實際的編譯，然後用到了&lt;code&gt;requiredVariables&lt;/code&gt;去做參數的驗證。 &lt;/p&gt;&lt;p&gt;這個時候我們就可以去執行&lt;code&gt;build.ps1&lt;/code&gt;，會發現一切正常，但是有幾個小問題。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-NBc0Lm5ZPgQ/WEdFL3SyweI/AAAAAAAAU-0/p1nzzZV3FC0/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-T-wHxj6RSMI/WEdFUqIXPPI/AAAAAAAAU-4/is3T8naGZMY/image_thumb%25255B3%25255D.png?imgmax=800" width="535" height="271"&gt;&lt;/a&gt; &lt;figcaption&gt;建制成功&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;  &lt;h2 id="WizKMOutline_1481065368462189"&gt;修正Compile時候出現的幾個小問題&lt;/h2&gt;&lt;h3 id="WizKMOutline_1481065368462884"&gt;MSBuild使用的.Net版本錯了&lt;/h3&gt;&lt;p&gt;首先從build的日誌裡面可以看到，我們使用的MSBuild版本是4.6，但是我們的.Net Framework卻是&lt;em&gt;4.0&lt;/em&gt;，但是實際上我們的project是用4.5.2寫的。如果用到4.5.2才有的功能， 很可能導致編譯錯誤。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0Re3_D7TdmM/WEdFW_sqimI/AAAAAAAAU-8/3EtK9hcBSww/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-uspO1TaR1b0/WEdFjlGZyKI/AAAAAAAAU_A/rjnXmNSQL9c/image_thumb%25255B4%25255D.png?imgmax=800" width="644" height="114"&gt;&lt;/a&gt; &lt;figcaption&gt;build到了4.0&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;這個很好解決，在&lt;code&gt;Invoke-psake&lt;/code&gt;有個參數叫做&lt;code&gt;framework&lt;/code&gt;，用這個可以設定build的target framework。 &lt;/p&gt;&lt;p&gt;所以在&lt;code&gt;build.ps1&lt;/code&gt;&lt;/p&gt;&lt;pre class="brush: powershell;highlight:2"&gt;Invoke-psake -buildFile .\default.ps1 -taskList Test `&lt;br /&gt;    -framework "4.5.2" `&lt;br /&gt;    -parameters @{&lt;br /&gt;    "solutionFile" = (Get-ChildItem("..\*.sln")).FullName |&lt;br /&gt;     Sort-Object $_ | select -Last 1&lt;br /&gt;    }`&lt;br /&gt;    -properties @{&lt;br /&gt;    "testMsg"="測試訊息"&lt;br /&gt;    }&lt;br /&gt;   &lt;/pre&gt;&lt;h3 id="WizKMOutline_1481065368462248"&gt;Console看不出哪段是psake在執行&lt;/h3&gt;&lt;p&gt;msbuild的內容比較多，造成看不太清楚那段屬於task記錄執行。不過psake有提供一個叫做&lt;code&gt;FormatTaskName&lt;/code&gt;，能夠定義Task執行的時候顯示的內容。 &lt;/p&gt;&lt;p&gt;在&lt;code&gt;default.ps1&lt;/code&gt;可以增加以下方法 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;FormatTaskName ("`r`n`r`n" + ("-"*25) + "[{0}]" + ("-"*25))&lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-Q0t43oE4qPU/WEdFqBa7l7I/AAAAAAAAU_E/Q0OdNA3MoDo/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-Ag64zAjC2hg/WEdFuG06TYI/AAAAAAAAU_I/x1ODFsKrr2w/image_thumb%25255B5%25255D.png?imgmax=800" width="644" height="204"&gt;&lt;/a&gt; &lt;figcaption&gt;看起來區分比較明顯&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;  &lt;h2 id="WizKMOutline_1481065368462704"&gt;結語&lt;/h2&gt;&lt;p&gt;在這篇我們開始把psake和msbuild做了結合，並且把一個mvc網站建立了出來。 &lt;/p&gt;&lt;p&gt;在下篇，我們會看看被compile出來的結果，和加入console和library專案，看看建制結果是否有不同。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1699808065017923606/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html#comment-form' title='4 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html' title='[iThome第8屆鐵人賽 06]開始建制一個Asp .Net Mvc專案'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-PAjGyESJwKg/WEdExVBu52I/AAAAAAAAU-g/VKWHkyTE9-c/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>4</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3376434141392389749</id><published>2016-12-06T07:24:00.000+08:00</published><updated>2017-12-12T23:34:04.033+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 05]準備建制專案環境的Task</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085456837" ;=""&gt;建制結果的資料夾結構&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085457392" ;=""&gt;準備Init task&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085457492" ;=""&gt;parameter&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085457350" ;=""&gt;建制資料夾的邏輯區分開來&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085457726" ;=""&gt;Clean Task 調整&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480980085457943" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上篇對於psake有些了解以後，我們開始把所學的東西用於如何搭配方便建制專案。 &lt;/p&gt; &lt;p&gt;在這篇，我們會定義當專案建制的時候，我們的資料夾結構和先把那些資料夾環境準備好 &lt;/p&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt; &lt;h2 id="WizKMOutline_1480980085456837"&gt;建制結果的資料夾結構&lt;/h2&gt; &lt;p&gt;當我們專案開始建制的時候，要有地方能夠放置一些暫存檔案和最終編譯結果，我們將會使用以下結構： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-MKznf2E7V1o/WEX27zCiFBI/AAAAAAAAU-E/dGlHIGYIKp8/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-eYD4H7HyYqY/WEX284PbkUI/AAAAAAAAU-I/dJd0mDQwI-g/image_thumb.png?imgmax=800" width="644" height="205"&gt;&lt;/a&gt; &lt;figcaption&gt;build結構&lt;/figcaption&gt;&lt;/figure&gt;  &lt;ul&gt; &lt;li&gt;.build - 是最上層的部分，目前習慣好像.開頭的資料夾都是暫時性的內容，例如visual studio的設定。所以我們會一樣的概念來儲存我們的建制結果&lt;br&gt; &lt;li&gt;temp - 當建制完成的時候，結果會儲存在這個temp裡面&lt;br&gt; &lt;li&gt;testResult - 這個是儲存我們測試執行完成的結果&lt;br&gt; &lt;li&gt;testCoverage - 這個用來儲存我們測試的範圍度&lt;br&gt; &lt;li&gt;artifact - 這邊儲存的是最後的結果。例如，zip出來的發佈內容，或者nuget package&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt; &lt;h3 id="WizKMOutline_1480980085457392"&gt;準備Init task&lt;/h3&gt; &lt;h3 id="WizKMOutline_1480980085457492"&gt;parameter&lt;/h3&gt; &lt;p&gt;要準備這個建制結果的資料夾，我們會增加一個task專門做這個事情。 &lt;/p&gt; &lt;p&gt;不過我們要先有個位置記錄.build的位置 - 這樣未來如果要改位置非常的方便 &lt;/p&gt; &lt;p&gt;由於我們的.build位置會需要在properties動態在設定，因此沒有辦法直接使用properties的參數 - 在psake裡面還有一個叫做parameter的參數適合做這個事情。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt;parameter 和 properties的差異在於，properties的順序在parameter&lt;em&gt;後面&lt;/em&gt;，換句話說，在properties裡面可以取得到parameter的值。 &lt;/div&gt; &lt;p&gt;所以我們的&lt;code&gt;build.ps1&lt;/code&gt;會變成： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;  ....&lt;br /&gt;  Invoke-psake -buildFile .\default.ps1 -taskList Test `&lt;br /&gt;    -parameters @{&lt;br /&gt;    "solutionFile" = (Get-ChildItem("..\*.sln")).FullName |&lt;br /&gt;     Sort-Object $_ | select -Last 1&lt;br /&gt;    }`&lt;br /&gt;    -properties @{&lt;br /&gt;    "testMsg"="測試訊息"&lt;br /&gt;    }&lt;br /&gt;  &lt;/pre&gt; &lt;p&gt;在&lt;code&gt;default.ps1&lt;/code&gt;會增加一個Init的task，同時properties裡面就會有用到這個參數： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;Properties{&lt;br /&gt;...&lt;br /&gt; $solutionDirectory = (Get-Item $solutionFile).DirectoryName&lt;br /&gt; $buildDirectory = "$solutionDirectory\.build"&lt;br /&gt;}  &lt;br /&gt;&lt;br /&gt;task Init -depends Clean -description "初始化建制所需要的設定"{&lt;br /&gt; &lt;br /&gt; Write-Host "建立建制結果的資料夾 $buildDirectory"&lt;br /&gt; New-Item $buildDirectory -ItemType Directory | Out-Null&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;task Compile -depends Clean, Init -description "編譯程式碼" { &lt;br /&gt; Write-Host $compileMsg&lt;br /&gt;}  &lt;/pre&gt; &lt;p&gt;上面我們用了parameter的solutionFile來建制我們的.build資料夾同solution檔案層級 &lt;/p&gt; &lt;p&gt;然後我們增加一個init的task來建立最上層的資料夾，並且把init作為compile的dependency &lt;/p&gt; &lt;h3 id="WizKMOutline_1480980085457350"&gt;建制資料夾的邏輯區分開來&lt;/h3&gt; &lt;p&gt;接下來我們就在properties裡面持續增加我們其他幾個資料夾路徑的參數，然後一個一個建立出來 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;Properties{&lt;br /&gt;...&lt;br /&gt; $solutionDirectory = (Get-Item $solutionFile).DirectoryName&lt;br /&gt; $buildDirectory = "$solutionDirectory\.build"&lt;br /&gt; $buildTempDirectory = "$buildDirectory\temp"&lt;br /&gt; $buildTestResultDirectory = "$buildDirectory\testResult"&lt;br /&gt; $buildTestCoverageDirectory = "$buildDirectory\testCoverage"&lt;br /&gt; $buildArtifactDirectory = "$buildDirectory\artifact"&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;task Init -depends Clean -description "初始化建制所需要的設定"{&lt;br /&gt; Write-Host "建立建制結果的資料夾 $buildDirectory"&lt;br /&gt; New-Item $buildDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的Temp資料夾 $buildTempDirectory"&lt;br /&gt; New-Item $buildTempDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的TestResult資料夾 $buildTestResultDirectory"&lt;br /&gt; New-Item $buildTestResultDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的TestCoverage資料夾 $buildTestCoverageDirectory"&lt;br /&gt; New-Item $buildTestCoverageDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的Artifact資料夾 $buildArtifactDirectory"&lt;br /&gt; New-Item $buildArtifactDirectory -ItemType Directory | Out-Null&lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt; &lt;p&gt;這邊會發現，雖然建制都沒有什麼問題，但是Init這個task變的有點長。同程式一樣，我們可以把同樣類型的功能放到一個方法一樣，我們可以用一樣概念來重構我們的內容。 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;function InitDirectory{&lt;br /&gt; Write-Host "建立建制結果的資料夾 $buildDirectory"&lt;br /&gt; New-Item $buildDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的Temp資料夾 $buildTempDirectory"&lt;br /&gt; New-Item $buildTempDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的TestResult資料夾 $buildTestResultDirectory"&lt;br /&gt; New-Item $buildTestResultDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的TestCoverage資料夾 $buildTestCoverageDirectory"&lt;br /&gt; New-Item $buildTestCoverageDirectory -ItemType Directory | Out-Null&lt;br /&gt;&lt;br /&gt; Write-Host "建立建制結果裡面的Artifact資料夾 $buildArtifactDirectory"&lt;br /&gt; New-Item $buildArtifactDirectory -ItemType Directory | Out-Null&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;task Init -depends Clean -description "初始化建制所需要的設定"{&lt;br /&gt; InitDirectory&lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt; &lt;p&gt;這個時候我們的Init方法又變的很乾淨了。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480980085457726"&gt;Clean Task 調整&lt;/h2&gt; &lt;p&gt;到目前為止，在建立build使用的資料夾完成了，不過這個時候會發現，第二次執行的時候，資料夾已經存在了，所以會執行不了 &lt;/p&gt; &lt;p&gt;所以在clean的task裡面，我們要針對這個部分吧上次結果給清理掉 &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Clean -description "刪除上次編譯遺留下來的內容"{ &lt;br /&gt;&lt;br /&gt; if(Test-Path $buildDirectory){&lt;br /&gt;  Write-Host "清除上次編譯的結果 $buildDirectory"&lt;br /&gt;  Remove-Item $buildDirectory -Recurse -Force&lt;br /&gt; }&lt;br /&gt;&lt;br /&gt; Write-Host $cleanMsg&lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt; &lt;p&gt;可以看到我們先測試一下這個資料夾有沒有存在，如果有存在，我們就把這個資料夾下面所有內容都刪掉 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480980085457943"&gt;結語&lt;/h2&gt; &lt;p&gt;在這篇我們了解到了，怎麼實際開始定義Task並且用作於之後我們build會儲存的位置。 &lt;/p&gt; &lt;p&gt;這個準備好了之後，下面我們就實際開始做build的動作 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3376434141392389749/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildDirectoryTask.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3376434141392389749'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3376434141392389749'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildDirectoryTask.html' title='[iThome第8屆鐵人賽 05]準備建制專案環境的Task'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-eYD4H7HyYqY/WEX284PbkUI/AAAAAAAAU-I/dJd0mDQwI-g/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2600231966292590795</id><published>2016-12-04T21:29:00.000+08:00</published><updated>2017-12-12T23:34:03.834+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 04]開始了解如何使用psake</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522479" ;=""&gt;開始使用psake&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522660" ;=""&gt;psake基本資訊&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522754" ;=""&gt;準備好測試專案&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522244" ;=""&gt;第一步 - 建立C# Library Project和安裝psake nuget&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522752" ;=""&gt;第二步 - 產生default.ps1檔案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522669" ;=""&gt;第三步 - 執行我們定義的Task&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522456" ;=""&gt;介紹psake的task寫法&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522488" ;=""&gt;檔案default.ps1&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522342" ;=""&gt;task的定義&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522654" ;=""&gt;task其他參數&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522186" ;=""&gt;預設Task&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522889" ;=""&gt;增加Task的描述&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522497" ;=""&gt;Task參數化&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522132" ;=""&gt;在執行Task之前先檢查是否有提供某個參數&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522312" ;=""&gt;增加方便執行psake的build.ps1檔案&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480857627522997" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上一篇了解了如何建制一個專案之後，和我們之後要使用psake作為build tool，在這篇我們將會看到底怎麼開始使用psake，和建立出我們之後會一直使用的專案。 &lt;/p&gt;&lt;p&gt;（之後下面提到的code都可以從這邊看到內容：&lt;a href="https://github.com/alantsai-samples/devops-psake/tree/master"&gt;github repo&lt;/a&gt;，這篇會是tag &lt;code&gt;sample/chapter4&lt;/code&gt;） &lt;/p&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480857627522479"&gt;開始使用psake&lt;/h2&gt;&lt;p&gt;psake是一個powershell的module，因此，除了psake的module檔案需要下載之外，在Windows不需要在做什麼其他安裝和設定。 &lt;/p&gt;&lt;p&gt;安裝psake到電腦裡面其實很簡單，只需要到psake的github repo下載下來，然後在powershell裡面呼叫&lt;code&gt;Import-Module .\psake.psm1&lt;/code&gt;，那麼psake就好了。 &lt;/p&gt;&lt;p&gt;當然，還需要這個下載動作好麻煩，從專案角度來說，難道我需要要求所有開發者都需要自己做這件事情嗎？那不是很麻煩 &lt;/p&gt;&lt;p&gt;非常好的是，psake有提供nuget版本，因此我們可以用nuget來把psake鍵入到專案裡面（如果想裝在電腦裡，可以透過chocolatey來方便安裝） &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1480857627522660"&gt;psake基本資訊&lt;/h4&gt;&lt;ul&gt;&lt;li&gt;psake github repo：&lt;a href="https://github.com/psake/psake"&gt;https://github.com/psake/psake&lt;/a&gt;&lt;br /&gt;&lt;li&gt;nuget：&lt;a href="https://www.nuget.org/packages/psake/"&gt;https://www.nuget.org/packages/psake/&lt;/a&gt;&lt;br /&gt;&lt;li&gt;nuget 安裝指令：&lt;kbd&gt;Install-Package psake&lt;/kbd&gt;&lt;br /&gt;&lt;li&gt;說明文件：&lt;a href="http://psake.readthedocs.io/en/latest/"&gt;http://psake.readthedocs.io/en/latest/&lt;/a&gt;&lt;br /&gt;&lt;li&gt;chocolatey：&lt;a href="https://chocolatey.org/packages/psake"&gt;https://chocolatey.org/packages/psake&lt;/a&gt;&lt;br /&gt;&lt;li&gt;chocolatey指令：&lt;kbd&gt;choco install psake&lt;/kbd&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;了解基本資訊之後，我們就開始建立測試環境 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480857627522754"&gt;準備好測試專案&lt;/h2&gt;&lt;p&gt;我們就先建立一個Visual Studio的專案。以前，nuget是可以安裝在solution層級，但是後來改掉了，但是問題不大，我們可以建立一個C# Library用來記錄這個dependency。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;接下來psake相關內容我們寫的其實都是powershell的語法 - 看個人使用，可以用powershell的ise來寫，或者用Visual Studio。 &lt;/p&gt;&lt;p&gt;既然大家都是開發者，建議用Visual Studio - 可以安裝一個套件&lt;a href="http://adamdriscoll.github.io/poshtools/"&gt;PowerShell Tools for Visual Studio&lt;/a&gt;， 未來debug什麼都可以直接在Visual studio做。甚至想寫單元測試都可以直接在上面跑。 &lt;/p&gt;&lt;p&gt;powershell有個好處是，如果到時候到build server有問題，可以用上面的powershell ise來直接debug。 &lt;/p&gt;&lt;/div&gt;&lt;h3 id="WizKMOutline_1480857627522244"&gt;第一步 - 建立C# Library Project和安裝psake nuget&lt;/h3&gt;&lt;p&gt;先建立一個C# Library的Project，把預設的Class1.cs刪掉，然後用nuget安裝psake： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-la7AqI7GIaA/WEQZXyr9EDI/AAAAAAAAU88/7qivgREurPk/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-7vOm4kGiA2o/WEQZY3Eq5_I/AAAAAAAAU9A/Ls9tbshm8Ec/image_thumb.png?imgmax=800" width="644" height="240"&gt;&lt;/a&gt;&lt;figcaption&gt;專案準備&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1480857627522752"&gt;第二步 - 產生default.ps1檔案&lt;/h3&gt;&lt;p&gt;建立一個檔案，然後把檔名取做&lt;code&gt;default.ps1&lt;/code&gt;。（可以在新建檔案選class檔案，然後把檔名改掉）： &lt;/p&gt;&lt;p&gt;然後我們貼上一下內容在default.ps1裡面： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;task Test -depends Compile, Clean { &lt;br /&gt; Write-Host "Executed Test !"&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;task Compile -depends Clean { &lt;br /&gt; Write-Host "Executed Compile !"&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;task Clean { &lt;br /&gt; Write-Host "Executed Clean !"&lt;br /&gt;}&lt;/pre&gt;&lt;h3 id="WizKMOutline_1480857627522669"&gt;第三步 - 執行我們定義的Task&lt;/h3&gt;&lt;p&gt;開啟VS 裡面的 &lt;code&gt;Powershell Interactive Windows&lt;/code&gt;（可以透過搜索右上角的&lt;code&gt;Quick Launch&lt;/code&gt;快速找到） &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-apoBuQ2fcmQ/WEQZann0VcI/AAAAAAAAU9E/kcD31rpYaxg/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-PAeJzDSRVbQ/WEQZcTQ_e1I/AAAAAAAAU9I/jj-kdbouCAQ/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="354"&gt;&lt;/a&gt;&lt;figcaption&gt;Quick Launch&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;Powershell Interactive Windows打開之後，先注意一下你的位置，記得要先CD進去有sake專案的位置下，然後執行下面語法（建議各位手動輸入，因為會發現很方便有intellisense） &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-uqKfw_GDIuk/WEQZdYWrdWI/AAAAAAAAU9M/DudvK_44uS4/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-aB60h8L2GmI/WEQZeY3Qa3I/AAAAAAAAU9Q/6yY-ELNLijA/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="224"&gt;&lt;/a&gt;&lt;figcaption&gt;輸入方法有intellisense&lt;/figcaption&gt;&lt;/figure&gt;   &lt;ol&gt;&lt;li&gt;&lt;kbd&gt;Import-Module ..\packages\psake.4.6.0\tools\psake.psm1&lt;/kbd&gt; - 這個動作是吧psake加入進來&lt;br /&gt;&lt;li&gt;&lt;kbd&gt;Invoke-psake Test&lt;/kbd&gt; - 執行我們Test的這個Task&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;執行下去之後，會看到我們三個Task都執行了，並且我們寫的動作也執行了。 &lt;a href="https://lh3.googleusercontent.com/-GCdd5bZqkZo/WEQZfQiGAPI/AAAAAAAAU9U/HKOp8-WQ22s/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-x48v9OFYcHA/WEQZg_e9NtI/AAAAAAAAU9Y/unVptdbafGw/image_thumb%25255B3%25255D.png?imgmax=800" width="644" height="331"&gt;&lt;/a&gt;&lt;figure&gt;&lt;figcaption&gt;可以看到執行了什麼還有總共執行時間 - &lt;em&gt;注意執行的當下資料夾是不是在buildProject&lt;/em&gt;&lt;/figcaption&gt;&lt;/figure&gt; &lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480857627522456"&gt;介紹psake的task寫法&lt;/h2&gt;&lt;p&gt;在這段會介紹剛剛我們準備的時候一些psake相關的資訊，並且在往下做一些延伸。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1480857627522488"&gt;檔案default.ps1&lt;/h3&gt;&lt;p&gt;首先是檔名的部分。剛剛應該會注意到，執行psake的時候並沒有給他要執行那個檔案，但是他自動找到了。原因是預設他會找&lt;code&gt;default.ps1&lt;/code&gt;這個檔案。 &lt;/p&gt;&lt;p&gt;因此在任何一個psake檔案default.ps1都是進入點。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1480857627522342"&gt;task的定義&lt;/h3&gt;&lt;p&gt;基本上 task &lt;em&gt;最少（或者最常見）&lt;/em&gt; 會定義幾個事情： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Task的名稱 - 也就是 task 後面的字&lt;br /&gt;&lt;li&gt;Task之間的關聯 - 用 &lt;code&gt;-depends&lt;/code&gt;關鍵字 - 可以定義在執行這個Task之前需要先執行什麼Task。如果有多個Task，用逗點(,)區隔。這邊注意一件事情，depend的task &lt;em&gt;最多只會執行一次&lt;/em&gt; - 所以，以我們的例子，Test和Compile都相依clean，但是clean只執行了一次。（當然，其實Test不需要寫相依Clean，，因為Compile已經有相依了。&lt;br /&gt;&lt;li&gt;Task要執行什麼 - 這個內容是放在{}裡面。 &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h3 id="WizKMOutline_1480857627522654"&gt;task其他參數&lt;/h3&gt;&lt;h4 id="WizKMOutline_1480857627522186"&gt;預設Task&lt;/h4&gt;&lt;p&gt;&lt;em&gt;預設Task的定義&lt;/em&gt; - 舉例來說，剛剛執行的時候要輸入Task名稱，但是有一個特殊的task，他的名字叫做 &lt;code&gt;default&lt;/code&gt;，這個task只能有&lt;code&gt;-depends&lt;/code&gt; 參數，並且沒有執行內容。這個就會是當invoke-psake沒有給task名稱所會執行的。舉例來說：&lt;code&gt;task default -depends Test&lt;/code&gt; - 就會定義在 不給task名稱的情況下，預設要執行Test這個task &lt;/p&gt;&lt;h4 id="WizKMOutline_1480857627522889"&gt;增加Task的描述&lt;/h4&gt;&lt;p&gt;&lt;code&gt;-description 參數&lt;/code&gt; - 有時候光看Task名稱還不確定會做什麼，所以可以用參數-description給一個詳細說明。這個時候能夠在透過 &lt;code&gt;Invoke-Psake -docs&lt;/code&gt;來看到整體的task。 &lt;/p&gt;&lt;h4 id="WizKMOutline_1480857627522497"&gt;Task參數化&lt;/h4&gt;&lt;p&gt;目前我們在每個task的動作只是寫到console。假設今天我想寫到console的字可以自訂，就會使用到&lt;code&gt;properties&lt;/code&gt;，舉例來說，我想定義每一個執行的時候顯示的訊息： 我就會先定義一個properties： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;Properties{&lt;br /&gt; $testMsg = "Executed Test !"&lt;br /&gt; $compileMsg = "Executed Compile !"&lt;br /&gt; $cleanMsg = "Executed Clean !"&lt;br /&gt;}&lt;br /&gt;  &lt;br /&gt;  &lt;/pre&gt;&lt;p&gt;然後對應的&lt;code&gt;Write-Host&lt;/code&gt;改成用這些參數 &lt;/p&gt;&lt;p&gt;當我要改變這些值的時候，在Invoke-Psake的時候就加上properties就好：&lt;code&gt;Invoke-psake -properties @{testMsg="測試訊息"}&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-QGvNlKiVm1k/WEQZiW4rSWI/AAAAAAAAU9c/I0Rh-6XzqaI/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-i-LeGkYN44E/WEQZjJI9-RI/AAAAAAAAU9g/-JgiHw2oq8k/image_thumb%25255B4%25255D.png?imgmax=800" width="644" height="331"&gt;&lt;/a&gt;&lt;figcaption&gt;參數替換&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-warning"&gt;&lt;p&gt;這邊注意到在外面呼叫的時候不需要錢字符（$） &lt;/p&gt;&lt;/div&gt;&lt;h4 id="WizKMOutline_1480857627522132"&gt;在執行Task之前先檢查是否有提供某個參數&lt;/h4&gt;&lt;p&gt;如果有些參數會影響到我們執行，可以直接在task裡面用&lt;code&gt;-requiredVariables&lt;/code&gt;，然後variable名稱即可。有多個就用逗點分割。 &lt;/p&gt;&lt;p&gt;這樣可以減少我們需要在執行中做檢測 &lt;/p&gt;&lt;p&gt;到目前為止有多介紹了一些常用的task定義方式 - 在接下來，如果有些有在額外用到會在用到的時候說明。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480857627522312"&gt;增加方便執行psake的build.ps1檔案&lt;/h2&gt;&lt;p&gt;在這篇結束以前，我們會發現到每一次執行psake都要先import-module，在執行其實是非常繁瑣，而且如果給另外一個工程師不懂powershell，可能光import module就卡死他了。 &lt;/p&gt;&lt;p&gt;所以我們會在增加所謂的bootstrap script - 就是我們只要執行那個檔案，而那個檔案會把該做的都設定好。幫我們防呆。 &lt;/p&gt;&lt;p&gt;所以，我會建立另外一個檔案，我叫做&lt;code&gt;build.ps1&lt;/code&gt;，用作於每一次建制的時候執行。 &lt;/p&gt;&lt;p&gt;裡面有的內容如下： &lt;/p&gt;&lt;pre class="brush: powershell;"&gt;  # 如果psake module有存在，先把他反註解&lt;br /&gt;if (Get-Module -ListAvailable -Name psake) {&lt;br /&gt; Remove-Module psake&lt;br /&gt;} &lt;br /&gt;&lt;br /&gt;# 找到psake module並且註冊&lt;br /&gt;$psakeModulePath = (Get-ChildItem("..\packages\psake*\tools\psake.psm1")).FullName |&lt;br /&gt;     Sort-Object $_ | select -Last 1&lt;br /&gt;&lt;br /&gt;if(Test-Path $psakeModulePath){&lt;br /&gt; Import-Module $psakeModulePath&lt;br /&gt;}else{&lt;br /&gt; Write-Host "找不到psake module，請確認好nuget package有restore完成"&lt;br /&gt; return&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;# 執行psake&lt;br /&gt;Invoke-psake -buildFile .\default.ps1 -taskList Test `&lt;br /&gt;    -properties @{&lt;br /&gt;    "testMsg"="測試訊息"&lt;br /&gt;    }&lt;br /&gt;  &lt;/pre&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-qF-Fvfa4UB8/WEQZjz7abvI/AAAAAAAAU9k/Keni4EATw2g/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-PdqAj6IJP4I/WEQZlcodfTI/AAAAAAAAU9o/542_8725ttg/image_thumb%25255B5%25255D.png?imgmax=800" width="644" height="452"&gt;&lt;/a&gt;&lt;figcaption&gt;執行變得簡單，只要呼叫build.ps1&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480857627522997"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過這篇，對於psake如何定義和使用有了基本的概念。我們將會在接下來使用這個專案建制我們的build script。 &lt;/p&gt;&lt;p&gt;在下篇，我們將會開始進入建制的部分，psake如何利用現有MSBuild有的資源作出我們要的建制環境。 &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2600231966292590795/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-psakeIntro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2600231966292590795'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2600231966292590795'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-psakeIntro.html' title='[iThome第8屆鐵人賽 04]開始了解如何使用psake'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-7vOm4kGiA2o/WEQZY3Eq5_I/AAAAAAAAU9A/Ls9tbshm8Ec/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3140873454402714284</id><published>2016-12-03T23:01:00.000+08:00</published><updated>2017-12-12T23:34:03.966+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 03]CI - VS是如何建制(Build) .Net專案</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957946" ;=""&gt;VS到底如何建制專案&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957496" ;=""&gt;如何編譯CS程式碼&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957131" ;=""&gt;什麼是Build Tool&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957147" ;=""&gt;到底應該用什麼build tool？&lt;/a&gt;&lt;br /&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957283" ;=""&gt;為什麼不直接用MSBuild？&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957963" ;=""&gt;psake到底是什麼？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1480776746957630" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上篇了解到說什麼是DevOps之後，我們就開始探討第一個部分，也就是Continous Integration (CI)。 &lt;/p&gt;&lt;p&gt;CI最基本的核心就是build專案 - 所以我們需要了解一下到底VS是如何build專案的，只有了解之後我們才能夠把它腳本化，也才有可能自動化。 &lt;/p&gt;&lt;p&gt;因此，這篇將會介紹： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;VS到底如何建制專案&lt;br /&gt;&lt;li&gt;什麼是build tool&lt;br /&gt;&lt;li&gt;為什麼接下來系列會選擇使用psake作為build tool&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480776746957946"&gt;VS到底如何建制專案&lt;/h2&gt;&lt;p&gt;我相信這個問題，很大的可能寫了2~3年的.Net programmer可能都回答不出來。原因是VS實在太方便了，.Net工程師太依賴於這種便利性，反而對於底層運作不需要那麼清楚。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;說實話，我覺的這個是 好事，因為工程師就能夠focus在重要的地方，不過壞處就是如果有問題或者想做點調整可能無從下手，因為從來沒有那種概念。像我當初轉到Eclipse就有發現，很多VS幫我們做掉了，而 Eclipse就需要手動設定 &lt;/div&gt;&lt;p&gt;其實別說建制專案了，很多工程師連程式最小單位，如何編譯一個cs檔案都不知道如何去做，所以，我會從最底層開始說起。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1480776746957496"&gt;如何編譯CS程式碼&lt;/h3&gt;&lt;p&gt;我們都知道程式碼是需要編譯才能夠使用，但是到底如何編譯呢？ &lt;/p&gt;&lt;p&gt;其實很簡單，當我們安裝了VS的時候會自動安裝一個&lt;code&gt;csc.exe&lt;/code&gt;的程式，而這個程式就是c# compiler。 &lt;/p&gt;&lt;p&gt;我們可以打開visual studio安裝時候帶的Developer Command Prompt， 然後這個時候建立一個簡單的hello world cs檔案，然後輸入：&lt;kbd&gt;csc helloWorld.cs&lt;/kbd&gt;，我們就會得到一個&lt;code&gt;helloWorld.exe&lt;/code&gt;， 執行起來就是我們的程式 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-chpqBG_kxvE/WELdeT45AlI/AAAAAAAAU8U/5L10tT1W93I/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-5b1HCWjOVBU/WELdfEHASLI/AAAAAAAAU8Y/UhBdjyVAPtM/image_thumb%25255B11%25255D.png?imgmax=800" width="644" height="293"&gt;&lt;/a&gt;&lt;figcaption&gt;先建立一個helloWorld.cs的檔案&lt;a href="https://lh3.googleusercontent.com/-xzwgHFYqYTE/WELdgYOFdwI/AAAAAAAAU8c/BWKqMQV_wOE/s1600-h/image%25255B20%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ZNjqV4uZulk/WELdhI4KJRI/AAAAAAAAU8g/WDsYQMghGAQ/image_thumb%25255B12%25255D.png?imgmax=800" width="625" height="484"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;打開Developer Command Prompt&lt;a href="https://lh3.googleusercontent.com/-A1JOTcpaI9w/WELdiAjiKRI/AAAAAAAAU8k/cBPGqILwY4Y/s1600-h/image%25255B23%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-hpgAE-lDueo/WELdjDjfWyI/AAAAAAAAU8o/csPK9tACu-A/image_thumb%25255B13%25255D.png?imgmax=800" width="603" height="484"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;在編譯之前沒有helloWorld.exe，編譯完之後多出了helloWorld.exe，並且執行起來正常&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;了解編譯器之後，我們會發現可以編譯程式碼了，但是當我們有大一點點規模的專案的時候，用csc實在太不方便了。更別說我們有時候要用Debug模式編譯，有時候要用Release模式編譯，有時候要 整個rebuild - 這些如果都自己下csc指令來達到會瘋掉，而且又不能在專案之間共用。工程師懶是一種美德，這個時候就有build tool的出現，而VS就是使用了MSBuild這個build tool 來建制專案。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480776746957131"&gt;什麼是Build Tool&lt;/h2&gt;&lt;div class="bs-callout bs-callout-info"&gt;Build Tool 就是透過設定Task，然後執行這些Task達到編譯程式碼的工具 &lt;/div&gt;&lt;p&gt;通常來說build tool的task是有相依性，例如Task A 只有在 Task B執行之後才能夠做，透過把編譯需要做的事情包成一個一個的Task，然後透過這種相依性關係，達到執行起來整體是一個chain。 &lt;/p&gt;&lt;p&gt;build tool的task的設定有些是參數化的，因此像是要用debug模式還是release模式其實只是一個參數不同，但是其他都一樣的動作。 &lt;/p&gt;&lt;p&gt;Visual Studio預設所使用的Build Tool就是MSBuild，而MSBuild是一個xml base的build工具。 &lt;/p&gt;&lt;p&gt;當我們用記事本打開那些solution或者csproj的時候就會發現，其實整個檔案是xml格式，而那些就是在定義MSBuild所看得懂的參數，當VS要執行build的時候，就依照這個csproj的定義去執行 應該的動作。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480776746957147"&gt;到底應該用什麼build tool？&lt;/h2&gt;&lt;p&gt;說實話，build tool實在太多了，從VS預設用的MSBuild，到JS base的gulp，到java的gradle，到用F#寫的FAKE和C#的CAKE，到我們將來會用的用PowerShell寫的Psake，是在是太多了。 &lt;/p&gt;&lt;p&gt;到底應該用什麼基本上取決於團隊，不過有幾個點可以考慮： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;這個build tool需不需要額外安裝什麼？要考慮我的build應該要在任何地方都能夠執行，越少這種OS的dependency越好&lt;br /&gt;&lt;li&gt;這個build tool用的多不多？也就是eco system好不好 - 這樣很多網路上範例都可以直接拿來用&lt;br /&gt;&lt;li&gt;這個build tool好不好寫？符不符合習慣 - build tool最終是要給人用的，好不好用，用不用的習慣非常重要&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;h3 id="WizKMOutline_1480776746957283"&gt;為什麼不直接用MSBuild？&lt;/h3&gt;&lt;p&gt;從上述幾個考量點，會發現，MSBuild既然VS預設就用，那應該和popular，範例應該也很多，那為什麼還要考慮其他的build tool？ &lt;/p&gt;&lt;p&gt;其實原因有兩個： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;MSBuild是xml base - xml字定義task的時候看起來很繁瑣，明明很簡單的東西定義起來很費勁，看又不容易看&lt;br /&gt;&lt;li&gt;相較於我們會用的psake（powershell），MSBuild原本的視野有點狹隘，他關注於建制.net的東西，但是隨著前端興起，隨著我們要自動化的東西越多，MSBuild不是做不到，而是 做起來比較麻煩。反過來來看PowerShell，本身就是為了讓MIS能夠腳本化達到自動化的工具，很多Windows東西都可以透過PowerShell來設定，因此決定使用psake。&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480776746957963"&gt;psake到底是什麼？&lt;/h2&gt;&lt;p&gt;說了那麼多，希望對build tool有點概念（就算沒有，等到我們進入實作的時候都會明朗），那接下來就介紹我們之後會使用到的工具psake。 &lt;/p&gt;&lt;p&gt;psake是一個powershell的module，所以基本上在撰寫psake的task設定的時候，整個powershell的能力我們都能用到（換句話說包含整個.Net Framework我們都能用到）。 &lt;/p&gt;&lt;p&gt;psake的唸法和日語的清酒sake是一樣的。 &lt;/p&gt;&lt;p&gt;psake的好處有： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;我們是建制.Net專案，所以建制的機器都在Windows上面（這邊不考慮.Net Core） - windows 7 之後一定有powershell，所以基本上要使用psake不用裝什麼（除了psake module）&lt;br /&gt;&lt;li&gt;因為psake只是powershell的module，整個powershell的平台功能都能使用，換句話說網路上任何powershell有關的資源都能用 - 要知道powershell建立的目的是為了讓MIS和工程師 不用每一次為了一些小功能就要開發一個console程式的平台&lt;br /&gt;&lt;li&gt;可以藉著了解psake了解powershell的能力 - 相信大部分工程師都不太用powershell，但是其實他功能很強大，很多windows設定都能夠透過powershell來達到 - 很多功能也都可以透過 寫powershell script把日常自動化 - 像我日常用git就是用powershell的module posh-git - 所以powershell其實都最好了解一下&lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1480776746957630"&gt;結語&lt;/h2&gt;&lt;p&gt;希望這篇能夠讓大家了解到什麼是build tool，和怎麼選擇一個build tool。 &lt;/p&gt;&lt;p&gt;這幾天的理論相信大家一定都煩了，接下來開始我們將會進入到實際操作的部分。 &lt;/p&gt;&lt;p&gt;在下一篇，我們會先了解怎麼使用psake，未來的demo code的架構會如何等。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3140873454402714284/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-howDoesVSBuildProject.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3140873454402714284'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3140873454402714284'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-howDoesVSBuildProject.html' title='[iThome第8屆鐵人賽 03]CI - VS是如何建制(Build) .Net專案'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-5b1HCWjOVBU/WELdfEHASLI/AAAAAAAAU8Y/UhBdjyVAPtM/s72-c/image_thumb%25255B11%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-855307807199977131</id><published>2016-12-02T22:21:00.000+08:00</published><updated>2017-12-12T23:34:04.906+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 02]什麼是DevOps？</title><content type='html'>&lt;a href="https://www.blogger.com/null" id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt;&lt;br /&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin: 0px 0px 0px 20px;"&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723606492" style="font-size: 14pt; line-height: 1.5;"&gt;DevOps是什麼？&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723607528" style="font-size: 14pt; line-height: 1.5;"&gt;這個系列對於DevOps的關注點&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723607972" style="font-size: 14pt; line-height: 1.5;"&gt;到底什麼是Continuous Integration (CI)&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723607681" style="font-size: 14pt; line-height: 1.5;"&gt;到底什麼是Continuous Delivery（CD）&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723607228" style="font-size: 14pt; line-height: 1.5;"&gt;到底什麼是Continouous Deployment（CD）&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://www.blogger.com/blogger.g?blogID=7924743034677720383#WizKMOutline_1480687723607556" style="font-size: 14pt; line-height: 1.5;"&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;&lt;section&gt;DevOps到底是一個什麼概念？對於工程師來說指的是什麼？為什麼DevOps最近這麼夯是我們在這篇所要討論的事情。&lt;br /&gt;&lt;/section&gt;&lt;br /&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;br /&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723606492"&gt;DevOps是什麼？&lt;/h2&gt;其實DevOps是兩個英文字的縮寫，Development（開發）和Operations（運維），同時DevOps其實是一個&lt;em&gt;文化和概念&lt;/em&gt;，並不是特定指某一個做法。&lt;br /&gt;&lt;br /&gt;這個其實和敏捷（Agile）是一個概念，敏捷也是一個文化和概念，而其中一種流行符合Agile運作的流程就是最近也很夯的Scrum。&lt;br /&gt;&lt;br /&gt;敏捷基本核心概念是把週期縮短，透過快速開發，透過實物提前發現問題，提前做調整，也就是Fail Fast的概念。&lt;br /&gt;&lt;br /&gt;我很喜歡敏捷執行下來能夠帶來的一個好處&lt;br /&gt;&lt;br /&gt;&lt;blockquote&gt;所有系統都有bug，但是當bug被修復的速度超過客戶能夠發現和反饋的時候，就不算是bug。&lt;/blockquote&gt;在DevOps來說，DevOps的核心理念是：&lt;br /&gt;&lt;br /&gt;&lt;blockquote&gt;減少開發和運維之間的阻礙 - 讓很敏捷的開發能夠快速的上線並且整個非常流暢。&lt;/blockquote&gt;&lt;figure&gt;&lt;a href="https://1.bp.blogspot.com/-NVLEXGrsthY/WEGBxr36XQI/AAAAAAAAU7k/PNF91Jd9YGYfGcrq7u6-tjx_AMgdboPtACLcB/s1600/DevOpsPic.png" imageanchor="1"&gt;&lt;img alt="DevOps圖" border="0" height="156" src="https://1.bp.blogspot.com/-NVLEXGrsthY/WEGBxr36XQI/AAAAAAAAU7k/PNF91Jd9YGYfGcrq7u6-tjx_AMgdboPtACLcB/s320/DevOpsPic.png" width="320" /&gt;&lt;/a&gt;&lt;figcaption&gt;DevOps是一個相互流暢的流程 - 圖片來源：https://blog.xebialabs.com/2016/03/21/essential-devops-terms/&lt;/figcaption&gt;&lt;/figure&gt;用白話一點來說，Dev代表著開發者，Ops代表著MIS，代表開發結果上線。&lt;br /&gt;&lt;br /&gt;其實DevOps會夯起來和敏捷有直接關係，我們常說敏捷對專案開發有多好又多好，然後從專案管理來看如何執行，但是很少有人提到從工程師和實際開發的角度上面來說到底需要什麼才能夠支撐這種快速開發模式。&lt;br /&gt;&lt;br /&gt;在比較嚴謹環境上過軟體的人就知道，其實要更新一個版本，要經過很多流程很關卡，當這個遇到開發速度變快的時候，常常運維和開發可能脫節造成敏捷更本跑不了。&lt;br /&gt;&lt;br /&gt;所以我認為，要跑好敏捷，DevOps沒做起來基本上是不可能。別說Ops了，如果你的Dev都被一些瑣事浪費了時間（例如手動建制專案，手動建制Test等），那怎麼可能跑的快？&lt;br /&gt;&lt;br /&gt;舉個例子來說，像在團隊中開發的時候，常常遇到的事情是有些人commit的時候忘記把一些程序上到版控。結果隔天另外一個工程師發現整個系統無法建制，而本來的作者因為出差或者請假所以找不到的時候&lt;br /&gt;，那大家工作不都被耽誤了？這個還算小事，如果因此耽誤到debug正式系統突發性問題的時候，麻煩就大了。&lt;br /&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;結論，DevOps是技術上支撐敏捷開發可能性的環境。而要達到快，&lt;em&gt;自動化&lt;/em&gt;是最為關鍵的地方，也是整個DevOps的核心。&lt;/div&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723607528"&gt;這個系列對於DevOps的關注點&lt;/h2&gt;DevOps既然是一個概念，所以延伸出來的實作方式其實有很多，沒有那種是對的，只有最符合團隊才是最好的。&lt;br /&gt;&lt;br /&gt;既然DevOps是Dev + Ops一定會有針對Dev和Ops相關的做法。在這系列裡面，將會著重在Dev的部分，而Ops那段比較偏是使用工具像Puppet和Chief將不會在這個系列被提到。&lt;br /&gt;&lt;br /&gt;既然提到了Dev，在Dev這裡基本上有幾個階段：&lt;br /&gt;&lt;br /&gt;&lt;figure&gt;&lt;a href="https://3.bp.blogspot.com/-a3c3uA5Ikk0/WEGCMVkmI0I/AAAAAAAAU7w/whmK6ISwAJ8vSV6eFslbd96tpl8xJ2ZgQCLcB/s1600/Image%2B827.png" imageanchor="1"&gt;&lt;img alt="建制循環" border="0" height="314" src="https://3.bp.blogspot.com/-a3c3uA5Ikk0/WEGCMVkmI0I/AAAAAAAAU7w/whmK6ISwAJ8vSV6eFslbd96tpl8xJ2ZgQCLcB/s320/Image%2B827.png" width="320" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;建制循環&lt;/figcaption&gt;&lt;/figure&gt;這幾個階段其實又對應到了幾個不同的名詞Continous Integration、Continous Delivery和Continous Deployment。&lt;br /&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723607972"&gt;到底什麼是Continuous Integration (CI)&lt;/h2&gt;開發人員都知道，在開發的時候，最好一小個段落就要build看看有沒有問題，越早發現問題，越容易處理。當積累了一堆問題在解決通常來說處理時間相對的短。&lt;br /&gt;&lt;br /&gt;當一個人開發的時候都有可能會建制不成功的時候，更何況今天要一個團隊的開發。&lt;br /&gt;&lt;br /&gt;所以同樣道理，越早把大家的code一起建制，越早發現問題，越容易解決問題。&lt;br /&gt;&lt;br /&gt;CI講的就是這個，如何越早和越快把大家程式做建制，執行測試確保從最基本層面保證程式沒有問題。&lt;br /&gt;&lt;br /&gt;&lt;figure&gt;&lt;a href="https://3.bp.blogspot.com/-1RufmPvNV0Q/WEGCMMrg_sI/AAAAAAAAU7o/uPWZ0tvaDnQLkFX4WNTHOuijh6xh-rP2ACPcB/s1600/Image%2B828.png" imageanchor="1"&gt;&lt;img alt="Build 和 Test" border="0" height="291" src="https://3.bp.blogspot.com/-1RufmPvNV0Q/WEGCMMrg_sI/AAAAAAAAU7o/uPWZ0tvaDnQLkFX4WNTHOuijh6xh-rP2ACPcB/s320/Image%2B828.png" width="320" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;從階段來說就是Build和Test&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723607681"&gt;到底什麼是Continuous Delivery（CD）&lt;/h2&gt;當程式建制沒有問題，然後測試也沒問題之後，下一個考慮的就是上線。&lt;br /&gt;&lt;br /&gt;依照不同類型專案有不同上線方式，如果是Library專案，可能就是上nuget，所以在這個階段就是自動產生出對應的nuget package&lt;br /&gt;&lt;br /&gt;如果是Web專案，可能就發佈成為zip或者Web Deploy package，這樣提供給運維就可以快速上線&lt;br /&gt;&lt;br /&gt;所以CD指的是Package這個階段的動作&lt;br /&gt;&lt;br /&gt;&lt;figure&gt;&lt;a href="https://2.bp.blogspot.com/-6cF1st4Z9B8/WEGCMRWwg7I/AAAAAAAAU7s/KAwVycQB0y8gDjg5fHmVN_kv2nuwaVqgACPcB/s1600/Image%2B829.png" imageanchor="1"&gt;&lt;img alt="package" border="0" height="309" src="https://2.bp.blogspot.com/-6cF1st4Z9B8/WEGCMRWwg7I/AAAAAAAAU7s/KAwVycQB0y8gDjg5fHmVN_kv2nuwaVqgACPcB/s320/Image%2B829.png" width="320" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;從階段來說就是Package&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723607228"&gt;到底什麼是Continouous Deployment（CD）&lt;/h2&gt;基本上這個和Continous Delivery差異在於，Continous Delivery 只&lt;em&gt;產生&lt;/em&gt;出可用來上線的內容，但是上線或者更新還是要人為操作。&lt;br /&gt;&lt;br /&gt;Contiouous Deployment則是連&lt;em&gt;上線&lt;/em&gt;的部分都自動幫忙處理。舉例來說，以Library來說，自動把nuget package發佈到nuget.org。以web來說，自動發佈到IIS上面&lt;br /&gt;&lt;br /&gt;到了這個地步，其實可以看出一條龍的服務了，開發完，一鍵整個完成上線。&lt;br /&gt;&lt;br /&gt;&lt;figure&gt;&lt;a href="https://4.bp.blogspot.com/-X2xkS6eooX0/WEGCNUs83GI/AAAAAAAAU70/ccjm20PhP-AbWMr-5LLrMb5k24cwfQU9wCPcB/s1600/Image%2B830.png" imageanchor="1"&gt;&lt;img alt="deploy" border="0" height="305" src="https://4.bp.blogspot.com/-X2xkS6eooX0/WEGCNUs83GI/AAAAAAAAU70/ccjm20PhP-AbWMr-5LLrMb5k24cwfQU9wCPcB/s320/Image%2B830.png" width="320" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;從階段來說就是Deploy&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1480687723607556"&gt;結語&lt;/h2&gt;希望透過這篇，大家對於DevOps常看到的詞彙和這個系列的側重點有所了解。整個DevOps重點就是&lt;em&gt;快&lt;/em&gt;，而要快就要能夠重複執行，也就是達到&lt;em&gt;自動化&lt;/em&gt;。&lt;br /&gt;&lt;br /&gt;下篇會進入接下來會使用到的工具介紹。&lt;br /&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/855307807199977131/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-whatIsDevops.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/855307807199977131'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/855307807199977131'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-whatIsDevops.html' title='[iThome第8屆鐵人賽 02]什麼是DevOps？'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://1.bp.blogspot.com/-NVLEXGrsthY/WEGBxr36XQI/AAAAAAAAU7k/PNF91Jd9YGYfGcrq7u6-tjx_AMgdboPtACLcB/s72-c/DevOpsPic.png' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6825155756650507011</id><published>2016-12-02T00:01:00.004+08:00</published><updated>2017-12-12T23:34:04.705+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='.net'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第八屆鐵人賽」'/><category scheme='http://www.blogger.com/atom/ns#' term='devops'/><category scheme='http://www.blogger.com/atom/ns#' term='「從.Net工程師的角度來看DevOps」'/><title type='text'>[iThome第8屆鐵人賽 01]開篇 - 為什麼要寫這個主題</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt;&lt;div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"&gt;&lt;ul style="margin:0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1480607468696110" ;="" style="font-size: 14pt; line-height: 1.5;"&gt;為什麼寫這個主題&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1480607468696905" ;="" style="font-size: 14pt; line-height: 1.5;"&gt;適合什麼人看&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1480607468696786" ;="" style="font-size: 14pt; line-height: 1.5;"&gt;使用到的工具&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1480607468696956" ;="" style="font-size: 14pt; line-height: 1.5;"&gt;結語&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;又到了新的一屆鐵人賽，針對這次是否要參賽其實非常的糾結：一方面因為工作的關係，額外的時間越來越少，但是一方面又想把寫日誌的習慣找回來，在這種糾結的心情中，最後，還是想寫戰勝了不想寫。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;這已經是第三次參加鐵人賽了，對我來說，每一年的主題都比上一年的更加困難，今年選擇的主題更是我這兩年想做但是一直沒有做的部分，也就是如何在日常生活中把DevOps引進來，並且提升日常工作效率。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;同去年一樣，今年很多東西會是邊執行並且邊研究和邊記錄，希望大家能夠在這個系列學習到東西。&lt;br /&gt;&lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1480607468696110"&gt;為什麼寫這個主題&lt;/h2&gt;&lt;p&gt;本來第8屆鐵人賽我想寫的是Typescript和Angularjs - 不過去年第8屆鐵人賽並沒有舉行，因此那個系列就夭折了（或許過一陣子有時間會在寫），那為什麼今年我不寫Typescript反而想寫DevOps呢？&lt;br /&gt;&lt;/p&gt;&lt;p&gt;原因很簡單，經過這幾年的開發生涯，我發現其實我花很多時間在非開發的事情上面。這些事情，很多都是重複性的，並且各別花的時間並不多，但是加在一起，時間非常恐怖。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;舉個例子來說，大家有否算過，把VS打開只為了幫網站發佈出來。以我來說，一般來說，我可能會開2個VS以上（相信大家有多個維護案的時候，常常會開不同VS），這個時候，如果接到，“幫我把XXX系統更新一下”，&lt;br /&gt;這個時候，要做的事情有：&lt;br /&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;要把那個網站的VS打開&lt;/li&gt;&lt;li&gt;選擇發佈&lt;/li&gt;&lt;li&gt;把發佈資料夾壓縮&lt;/li&gt;&lt;li&gt;最後把它傳到機器上面&lt;/li&gt;&lt;li&gt;解壓縮更新&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;這一整個流程下來，可能花的時間要10分鐘左右，來看一下，我們會發現好幾個地方時間都浪費了。&lt;br /&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;要把那個網站的VS打開 - &lt;em&gt;開VS其實是一個很花時間的動作，尤其是在電腦滿載，然後VS專案又大的情況，可能關開這個專案就要2~3分鐘，更別說開啟中會影響本來工作&lt;/em&gt;&lt;/li&gt;&lt;li&gt;選擇發佈 - &lt;em&gt;透過點擊右鍵選發佈，會發現機器慢的時候，還要等，甚至右鍵內容太多還會造成VS當掉&lt;/em&gt;&lt;/li&gt;&lt;li&gt;把發佈資料夾壓縮 - &lt;em&gt;壓縮的時候要輸入壓縮出來的檔案名稱，通常我會寫下日期方便日後比對，這個可能寫錯，容易造成混搖&lt;/em&gt; &lt;/li&gt;&lt;li&gt;最後把它傳到機器上面&lt;/li&gt;&lt;li&gt;解壓縮更新&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;整個流程下來，會發現：&lt;br /&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;很多時間浪費在等待&lt;/li&gt;&lt;li&gt;很多重複動作，很有可能人為疏失造成要重新在做一次&lt;/li&gt;&lt;li&gt;當做錯的時候，尤其是在很急的情況，心情很嘔&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;這些事情，其實如果算起來，會發現其實浪費掉很多時間，難道沒有什麼方式可以解決嗎？&lt;br /&gt;&lt;/p&gt;&lt;p&gt;如果注意分析，會發現，這些東西其實重複性非常高，而重複性高的工作在IT世界是哪種職業最多？其實是MIS，而MIS如何解決這種問題，就是透過&lt;em&gt;自動化（Automation）&lt;/em&gt;。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;舉例來說，今天MIS要檢查Server狀況，如果他每過1分鐘，就手動呼叫PING，可以感覺的出來，1 可能會忘記（例如忙什麼就忘記做了）2 實在很無聊 - 這個時候MIS就會寫script來自動化處理這個事情。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;難道我們工程師就不能夠自動化？難道那些常常要做的事情一定要我本人做？不能請別人做或者做的時候我可以繼續做我本來在做的事情？&lt;br /&gt;&lt;/p&gt;&lt;p&gt;以我上面流程來說，還真的一定要我本人做，因為如果一個同事不懂得如何用VS的發佈（雖然很簡單），不就只能夠我來做？難道不能夠有個傻瓜式的東西，任何人只要執行了，得到的結果和我執行會一樣，甚至&lt;br /&gt;不是人執行，而是機器依照什麼條件執行。對我來說，我只要那個結果，過程是不重要的。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;這些想法其實一直環繞在我腦海里，直到有天我聽到了DevOps，然後發現其實就是自動化，這個時候我就想把一些想法代入到我的日常開發中。（不過拖了好幾年直到今年藉著鐵人賽把它落實下來）&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1480607468696905"&gt;適合什麼人看&lt;/h2&gt;&lt;p&gt;基本上在這個系列裡面，最適合是.Net 工程師看，因為我的例子都是用.net寫的，最後甚至有個小小的package方便不同.net專案導入這個自動化機制。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;不過更重要的是和大家分享是&lt;em&gt;想法，觀念&lt;/em&gt;，看過我上個系列會知道，我基本上是先將概念和原因，然後實作反而只是一個驗證說如何實現的佐證。&lt;br /&gt;所以就算今天你不懂.net，只要你懂了我提到的概念，在你的平台上面一定可以用類似的工具做到一樣的功能。&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1480607468696786"&gt;使用到的工具&lt;/h2&gt;&lt;p&gt;我會使用到：&lt;br /&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Visual Studio&lt;/li&gt;&lt;li&gt;github - 範例程序&lt;/li&gt;&lt;li&gt;powershell(psake) - build的工具&lt;/li&gt;&lt;li&gt;Appveyor(Visual Studio Team Service)&lt;/li&gt;&lt;/ol&gt;這些工具都會在對應時間說明，所以不會用沒有關係&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1480607468696956"&gt;結語&lt;/h2&gt;&lt;p&gt;上面講了一大堆，其實總結起來就是，自動化如何給開發帶來便利？了解這個，其實就不難了解為什麼DevOps現在這麼夯。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;希望大家在讀這個系列的時候都有所收穫，如果有發現錯誤，也不吝指正。&lt;br /&gt;&lt;/p&gt;&lt;p&gt;下一篇會從什麼是DevOps開始講起。&lt;br /&gt;&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6825155756650507011/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6825155756650507011'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6825155756650507011'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-intro.html' title='[iThome第8屆鐵人賽 01]開篇 - 為什麼要寫這個主題'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4605382583388922550</id><published>2016-05-14T18:46:00.000+08:00</published><updated>2016-05-14T18:50:11.424+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='nuget'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (下篇) 建立第一個package</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611670502" ;=""&gt;建立測試的Library Project&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671226" ;=""&gt;用Nuget Package Explorer(NPE)建立package&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671393" ;=""&gt;建立Package的meta資訊&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671732" ;=""&gt;建立Package的內容&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671153" ;=""&gt;在Local測試剛剛建立的nuget package&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671317" ;=""&gt;結語&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671881" ;=""&gt;NPE建立package優點&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671691" ;=""&gt;NPE建立package缺點&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1463221611671528" ;=""&gt;Reference&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上一篇&lt;a href="http://blog.alantsai.net/2016/04/create-nuget-with-nuget-package-explorer-understand-nuget-package-structure.html"&gt;建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (上篇) 介紹package結構&lt;/a&gt;&lt;span style="font-size: 14pt; line-height: 1.5"&gt;介紹了package的結構之後，在這篇我們將來用上篇所了解的結構，來建立一個簡單的package。&lt;/span&gt;&lt;/p&gt; &lt;p&gt;首先會建立一個簡單的library project，這個project會建立出等一下建立的package內容。 &lt;/p&gt; &lt;p&gt;建立出package之後，接下來會介紹如何在本地測試這個package。 &lt;/p&gt; &lt;p&gt;最後，當正式要把package發佈出去，讓外面的人使用，有什麼地方有提供host這些package。 &lt;/p&gt;&lt;/section&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;section&gt; &lt;h2 id="WizKMOutline_1463221611670502"&gt;建立測試的Library Project&lt;/h2&gt; &lt;p&gt;要建立nuget package，我們首先需要有要封裝的內容，因此第一步是建立一個建立nuget package的project。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;你可以建立任何library project來跟著做，不過如果想要直接跟著後面的部分，可以直接clone github的repo，上面我准備了一個等一下會用的project: &lt;/p&gt;&lt;pre class="brush: plain;"&gt;			https://github.com/alantsai-samples/Nuget-Package-Create-Sample&lt;br /&gt;&lt;br /&gt;			git clone git@github.com:alantsai-samples/Nuget-Package-Create-Sample.git&lt;/pre&gt;&lt;/div&gt; &lt;p&gt;Github那個專案非常簡單，提供兩個Library，一模一樣，差別在於一個用.Net 3.5 一個用.Net 4.5，為了區分，我在3.5的方法加了35在方法名稱後面。 &lt;/p&gt; &lt;p&gt;這個library做的事情非常簡單，他提供一個方法，會把目前library的.net framework印到console。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-e0CpCCOrhvs/Vzb_7Ff8YeI/AAAAAAAAUqk/-EGKDfhUx8s/s1600-h/image%25255B24%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-qUHFnlYo88A/Vzb_8VSU2RI/AAAAAAAAUqo/J2WWFynGQAI/image_thumb%25255B16%25255D.png?imgmax=800" width="644" height="274"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;專案結構&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;同時這個repo裡面有一個 &lt;code&gt;Want.txt&lt;/code&gt; - 表示想要安裝nuget的時候一起帶過去的檔案。&lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1463221611671226"&gt;用Nuget Package Explorer(NPE)建立package&lt;/h2&gt; &lt;h3 id="WizKMOutline_1463221611671393"&gt;建立Package的meta資訊&lt;/h3&gt; &lt;p&gt;打開NPE的時候選擇 &lt;code&gt;Create a new package&lt;/code&gt;&lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-wWQwvpqxuNM/Vzb_9X91d5I/AAAAAAAAUqs/1TuOpAme7c0/s1600-h/image%25255B27%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-IbMUgpwV6Hw/Vzb__Di5SDI/AAAAAAAAUqw/0O_0VK853vA/image_thumb%25255B17%25255D.png?imgmax=800" width="644" height="413"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;p&gt;這個時候會打開一個空白的package，左邊Author的部分會先放入電腦名稱： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-D-LQrtDPmXY/Vzb__88gKRI/AAAAAAAAUq0/ScT5sNvT8ig/s1600-h/image%25255B30%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-qWQy_5-D8Mg/VzcABF627pI/AAAAAAAAUq4/ymwkQ7UxS80/image_thumb%25255B18%25255D.png?imgmax=800" width="644" height="452"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;p&gt;還記得上篇所介紹的一些欄位，我們可以把一些資訊填上，先點左上角的小icon(像一個筆和筆記本那個，快捷鍵 &lt;kbd&gt;Ctrl + k&lt;/kbd&gt;)，就會出現不同欄位的輸入框， 如果拉到下面也可以設定這個package的dependency package(不過在這個例子我們不會設定)： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-7rq3Q-1aYSw/VzcACyR2KgI/AAAAAAAAUq8/bdiX7h6Kzao/s1600-h/image%25255B33%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-syGSu1ccqHQ/VzcAF-vhe7I/AAAAAAAAUrA/yZ5RIDSFZZo/image_thumb%25255B19%25255D.png?imgmax=800" width="458" height="484"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;p&gt;填完了之後，點左上角的綠色勾就可以儲存剛剛填寫的內容。然後我們就準備加入我們剛剛library所建立的dll進來。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1463221611671732"&gt;建立Package的內容&lt;/h3&gt; &lt;p&gt;要加入library，有兩個方式： &lt;/p&gt; &lt;ul&gt; &lt;li&gt;手動式：  &lt;ul&gt; &lt;li&gt;對右邊的視窗點 右鍵 然後選擇 &lt;code&gt;Add lib folder&lt;/code&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-hKDgk1pPX5A/VzcAG-aV9DI/AAAAAAAAUrE/Ju_igmgI6Ck/s1600-h/image%25255B36%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-RJlsJ54hmnA/VzcAPX18eEI/AAAAAAAAUrI/L2R5hh7szm0/image_thumb%25255B20%25255D.png?imgmax=800" width="339" height="344"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;li&gt;在對建立出來的lib 點 右鍵，然後選擇 &lt;code&gt;Add .Net Folder&lt;/code&gt;，然後選擇正確的library .net 版本 (這個demo了一個nuget package可以有多個.net framework版本的library - 因此安裝的時候會自動選到適合的。&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-cwUuvLlSLlU/VzcAXNPeS6I/AAAAAAAAUrM/EW62Zp_Gzzg/s1600-h/image%25255B39%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-1xEavvQSRlQ/VzcAdEZkeGI/AAAAAAAAUrU/Ubyns5PBqqM/image_thumb%25255B21%25255D.png?imgmax=800" width="644" height="472"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;li&gt;在對建立出來的.Net 版本folder點右鍵，選擇存在的檔案，然後選擇對應版本的library &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZEnx0xFwU44/VzcAd0KOjSI/AAAAAAAAUrY/kMnKysni1A4/s1600-h/image%25255B42%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-gXaXbmxqG3Q/VzcAffYgphI/AAAAAAAAUrc/GDfo7_Tffzk/image_thumb%25255B22%25255D.png?imgmax=800" width="364" height="159"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;自動式：  &lt;p&gt;直接把dll拖到NPE裡面，不過這個只會放到lib資料夾下面，而不會設定對應的.Net Folder &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-ZFzhHbruKY0/VzcAg2_GsOI/AAAAAAAAUrk/jh3gV-RhzRM/s1600-h/image%25255B45%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-rQ8LOWrdbXY/VzcAigwtLJI/AAAAAAAAUro/_ZuOQ3tDGt0/image_thumb%25255B23%25255D.png?imgmax=800" width="644" height="462"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt;&lt;figure&gt;還是要自己手動放到正確的.Net版本&lt;/figure&gt; &lt;/li&gt;&lt;/ul&gt; &lt;p&gt;可以用同樣概念加入&lt;code&gt;Want.txt&lt;/code&gt;，不過如果是手動式，這次會需要建立 &lt;code&gt;content&lt;/code&gt;而不是library：&lt;/p&gt; &lt;p&gt;最後，我們的package應該會長成這個樣子： &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-v0NJ36mu6z8/VzcAj9Gcn7I/AAAAAAAAUrs/hZSFtfcXhRg/s1600-h/image%25255B48%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-bxIzIFujgCQ/VzcAnFgiAEI/AAAAAAAAUr0/cbX-q97MymQ/image_thumb%25255B24%25255D.png?imgmax=800" width="644" height="199"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt;然後可以透過menu的 File -&amp;gt; Save As (或&lt;kbd&gt;ctrl+s&lt;/kbd&gt;)來存檔成為一個 nupkg的檔案，而這個就是一個nuget package  &lt;div class="bs-callout bs-callout-info"&gt;這個nuget package也有在repo裡面，在路徑 &lt;code&gt;src\ReusableLibrary\ReusableLibrary.1.0.0.nupkg&lt;/code&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1463221611671153"&gt;在Local測試剛剛建立的nuget package&lt;/h2&gt; &lt;p&gt;目前已經建立出一個nuget package，接下來就是要測試這個package到底是不是如我們所想的那樣。 &lt;/p&gt; &lt;p&gt;測試package非常的簡單，我們只需要在Visual Studio的nuget package source加入一個local file system就可以，詳細步奏如下： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;VS 快速搜索(快捷鍵 &lt;kbd&gt;ctro+q&lt;/kbd&gt;) nuget – 選擇 Package Source &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-0WyoyN3nHp0/VzcArW-CPRI/AAAAAAAAUr8/Qm82_zB7WeQ/s1600-h/image%25255B54%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-wxIm62msMXg/VzcAsspMMTI/AAAAAAAAUsA/95_3-97lYl4/image_thumb%25255B26%25255D.png?imgmax=800" width="424" height="296"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;li&gt;加入一個新的package source - &lt;code&gt;Name&lt;/code&gt; 隨意看要取什麼，&lt;code&gt;Source&lt;/code&gt;就直接寫nupkg所放的位置路徑 &lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-3ehuEq4M0qI/VzcAutDHijI/AAAAAAAAUsE/Wr7DelFzc3I/s1600-h/image%25255B51%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ZpGD6LvYUEM/VzcAwgPBKFI/AAAAAAAAUsI/bmMlqfrNpx0/image_thumb%25255B25%25255D.png?imgmax=800" width="494" height="296"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figure&gt; &lt;li&gt;開新的一個專案，然後在nuget裡面記得切換來源到你剛剛那個 &lt;code&gt;Name&lt;/code&gt;給的名稱的source，應該就會看到建立出來的package，並且選擇安裝。  &lt;li&gt;可以試著建立一個.Net 3.5的專案和.Net 4.5的專案 - 注意看reference的dll，會是依照對應framework的library &lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1463221611671317"&gt;結語&lt;/h2&gt; &lt;p&gt;透過這篇，相信已經了解如何透過NPE來建立package，但是NPE來建立package有好有懷。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1463221611671881"&gt;NPE建立package優點&lt;/h3&gt; &lt;ul&gt; &lt;li&gt;直覺 - 在GUI操作只要把欄位填完就好。  &lt;li&gt;好操作 - 照gui做，不用懂那麼多package的結構和原理可以做出來&lt;/li&gt;&lt;/ul&gt; &lt;h3 id="WizKMOutline_1463221611671691"&gt;NPE建立package缺點&lt;/h3&gt; &lt;ul&gt; &lt;li&gt;無法自動化 - 因為是GUI操作，沒辦法類似用script執行完就建立出來  &lt;li&gt;建立出來結果可能不一致 - 假設一個團隊，A和B建立出來可能不同，因為其中一個可能忘記一些步奏&lt;/li&gt;&lt;/ul&gt; &lt;p&gt;因此，用NPE建立package屬於 &lt;strong&gt;&lt;em&gt;一次性建立&lt;/em&gt;&lt;/strong&gt;或者 &lt;strong&gt;&lt;em&gt;學習用途&lt;/em&gt;&lt;/strong&gt; - 在一個長久更新的library專案用這種方式來產生package真的不適合。 &lt;/p&gt; &lt;p&gt;在下一篇，再來介紹如何用一個project現有資訊來產生nuget package，並且這個動作可以自動化，並且任何人做出來結果都一樣。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1463221611671528"&gt;Reference&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;a href="https://github.com/alantsai-samples/Nuget-Package-Create-Sample"&gt;Github範例專案&lt;/a&gt; &lt;/li&gt; &lt;li&gt;&lt;a href="wiz://open_document?guid=0b383127-dfb6-429a-8e06-c4614c682cfd&amp;amp;kbguid=&amp;amp;private_kbguid=b1ed89f6-16c8-11e1-8d03-00237def97cc"&gt;何為nuget，該如何使用，和2.7版本之後建議的回覆nuget package(套件)的方式&lt;/a&gt; - 介紹使用nuget&lt;br&gt; &lt;li&gt;&lt;a href="wiz://open_document?guid=8a2eba52-9374-49e8-95ae-68fcc62bfc1e&amp;amp;kbguid=&amp;amp;private_kbguid=b1ed89f6-16c8-11e1-8d03-00237def97cc"&gt;建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (上篇) 介紹package結構&lt;/a&gt; - 介紹nuget結構&lt;br&gt; &lt;li&gt;簡報介紹  &lt;br /&gt; &lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/kPw3WVpnJv2frE" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt; &lt;strong&gt; &lt;a href="//www.slideshare.net/alantsai2007/nuget-package" title="Nuget介紹- 如何使用和建立自己的package" target="_blank"&gt;Nuget介紹- 如何使用和建立自己的package&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="//www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;  &lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4605382583388922550/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/05/create-nuget-with-nuget-package-explorer.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4605382583388922550'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4605382583388922550'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/05/create-nuget-with-nuget-package-explorer.html' title='建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (下篇) 建立第一個package'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-qUHFnlYo88A/Vzb_8VSU2RI/AAAAAAAAUqo/J2WWFynGQAI/s72-c/image_thumb%25255B16%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8143129268182883403</id><published>2016-04-14T23:35:00.001+08:00</published><updated>2016-04-27T21:58:51.800+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='nuget'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (上篇) 介紹package結構</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971338680" ;=""&gt;NuGet Package Explorer(NPE)&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339938" ;=""&gt;Nuget Package Explorer&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339453" ;=""&gt;用NPE看看一些package - 了解package內容的結構&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339606" ;=""&gt;lib 資料夾的作用&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339539" ;=""&gt;tools 資料夾的作用&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339319" ;=""&gt;content 資料夾的作用&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339834" ;=""&gt;build 資料夾&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339705" ;=""&gt;用NPE看package的meta資訊&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339267" ;=""&gt;Id欄位&lt;/a&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971339367" ;=""&gt;Version欄位&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971340467" ;=""&gt;版本結構 Semantic Version 2.0&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971340322" ;=""&gt;Dependency 欄位&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1460646971340858" ;=""&gt;結語&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在上一篇 (&lt;a href="http://blog.alantsai.net/2016/03/what-is-nuget-how-to-use-nuget-and-how-to-restore-properly.html" target="_blank"&gt;何為nuget，該如何使用，和2.7版本之後建議的回覆nuget package(套件)的方式&lt;/a&gt;) &lt;span style="font-size: 14pt; line-height: 1.5"&gt;介紹如何使用nuget後，應該會發現要在專案裡面使用某個Library實在是很方便，同個Library在不同專案使用只要透過nuget安裝就搞定。&lt;/span&gt;&lt;/p&gt; &lt;p&gt;作為開發者，相信大家都有一些小工具或者一些方法是常常被使用到的，而每次不同專案要使用，都需要&lt;em&gt;copy&lt;/em&gt;整個程式碼實在很不方便，更別說如果哪天發現有bug ，要更新所有有用到的專案就更加困難和浪費時間。 &lt;/p&gt; &lt;p&gt;如果可以把自己的小工具包成一個nuget就超級方便了，而且要更新程式碼也很容易，更棒的是要把nuget放到微軟的nuget.org網站上面是完全免費，不好好利用就太浪費這個服務了。 &lt;/p&gt; &lt;p&gt;在這篇，將會介紹如何使用nuget package explorer來先了解package的結構，並且之後在用這些知識來建立自己package。 &lt;/p&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1460646971338680"&gt;NuGet Package Explorer(NPE)&lt;/h2&gt; &lt;p&gt;Nuget Package Explorer (之後會用縮寫NPE稱呼) 是一個 GUI工具可用來建立和看 &lt;code&gt;.nupkg&lt;/code&gt; (nuget package的檔案Extension)的工具。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1460646971339938"&gt;Nuget Package Explorer&lt;/h4&gt; &lt;ul&gt; &lt;li&gt;&lt;strong&gt;原始碼：&lt;/strong&gt;&lt;a href="https://github.com/NuGetPackageExplorer/NuGetPackageExplorer"&gt;Github&lt;/a&gt;  &lt;li&gt;&lt;strong&gt;下載：&lt;/strong&gt;&lt;a href="https://npe.codeplex.com/downloads/get/clickOnce/NuGetPackageExplorer.application"&gt;位置&lt;/a&gt;  &lt;li&gt;&lt;strong&gt;特色：&lt;/strong&gt;可以打開和建立package，並且在看某個package的時候，可以直接點兩下打開檔案內容&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在建立自己的nuget package之前，我們先來看一下別人的nuget package長什麼樣子，並且了解一些nuget package特殊資料夾的作用，這樣對於等一下建立package更有概念。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1460646971339453"&gt;用NPE看看一些package - 了解package內容的結構&lt;/h2&gt; &lt;p&gt;任何package的根目錄最多四個，分別是：&lt;code&gt;lib&lt;/code&gt;、&lt;code&gt;tools&lt;/code&gt;、&lt;code&gt;content&lt;/code&gt;和&lt;code&gt;build&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;我們將透過看幾個package來了解4個資料夾不同之處。 &lt;/p&gt; &lt;p&gt;把NPE執行起來之後，可以看到可以：打開本地的package、可以打開nuget上面的package、建立package和打開nuget documentation。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-_4Gko-mLR78/Vw-3przhOCI/AAAAAAAAUn8/ZaDw0O_rN4Y/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-ckOY1s2BuJo/Vw-3r8CoYJI/AAAAAAAAUoA/qT4mH4UXTNM/image_thumb.png?imgmax=800" width="644" height="333"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;NPE執行起來的畫面&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;在這次我麼將會打開線上nuget，看看這兩個package：&lt;code&gt;Newtonsoft.Json&lt;/code&gt; 和 &lt;code&gt;Jquery&lt;/code&gt; package。先從打開&lt;code&gt;Newtonsoft.Json&lt;/code&gt;開始。 &lt;/p&gt;&lt;figure&gt;&lt;/figure&gt;&lt;figure&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-LslhW-_vvI4/Vw-3s9MWTBI/AAAAAAAAUoE/CLaFmN_SsRg/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-7TkEFfYl1aE/Vw-3wA-XDuI/AAAAAAAAUoI/Gd9XIkdrC18/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="471"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-rnqAGLwD1fg/Vw-30a4UmVI/AAAAAAAAUoM/VY9x8p31ung/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-PDzJQ1seaLw/Vw-31t96gzI/AAAAAAAAUoQ/Dlv8lEbZglo/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="260"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;打開Newtonsoft.Json Package&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt; &lt;p&gt;我們會看到畫面有左右兩個視窗，其中左邊屬於package meta資訊(稍後介紹)，右邊則是package內容。這個部分是目前的重點。 &lt;/p&gt; &lt;p&gt;我們可以看到 總共有兩個資料夾&lt;code&gt;lib&lt;/code&gt;和&lt;code&gt;tools&lt;/code&gt;。其中&lt;code&gt;lib&lt;/code&gt;下面有不同的資料夾可以看出是.Net Framework版本 &lt;/p&gt; &lt;h3 id="WizKMOutline_1460646971339606"&gt;lib 資料夾的作用&lt;/h3&gt; &lt;p&gt;lib在nuget裡面來說，放的都是會&lt;em&gt;被專案直接Reference的dll檔案&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;像我們nuget install進來一個package的時候，我們不需要手動Reference下載的Dll，而是nuget自動幫我們 Reference。nuget如何知道什麼是屬於要Reference的dll？ &lt;/p&gt; &lt;p&gt;nuget會看lib下面的資料夾，找到符合目前專案的target 的 .net Framework dll去做Reference。由此，我們可以看到Newtonsoft.Json基本上支援所有.ent 專案，從.Net2.0到 portable library。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1460646971339539"&gt;tools 資料夾的作用&lt;/h3&gt; &lt;p&gt;tools資料夾主要作用是放一些powershell script 和工具類型的東西。有特殊的ps1檔案能夠在nuget &lt;em&gt;不同時間(例如剛安裝的時候，或者解除安裝的時候)被執行&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;舉例來說，Newtonsoft.Json 就有一個&lt;code&gt;tools\install.ps1&lt;/code&gt;。這個install.ps1的內容會在&lt;em&gt;安裝&lt;/em&gt;這個套件的時候被執行。 &lt;/p&gt; &lt;p&gt;以Newtonsoft.Json來說，安裝完會直接打開Visual Studio 頁簽到Newtownsoft.Json的官網 - 這個邏輯完全是因為install.ps1裡面有這樣寫所以才執行。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;package的檔案都可以點兩下打開看內容，甚至檔案內容還有語法高亮哦 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-mAV9nGpiv-s/Vw-3396YiaI/AAAAAAAAUoU/4reZW29nljM/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-25POuFoz5vQ/Vw-35RVQWnI/AAAAAAAAUoY/hOTVLjRUQHg/image_thumb%25255B3%25255D.png?imgmax=800" width="644" height="322"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;打開install.ps1&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt; &lt;h3 id="WizKMOutline_1460646971339319"&gt;content 資料夾的作用&lt;/h3&gt; &lt;p&gt;content 放的內容就是要加到專案裡面的&lt;em&gt;檔案&lt;/em&gt;。最好的例子就是一些javascript類型的package。 &lt;/p&gt; &lt;p&gt;我們打開&lt;code&gt;Jquery&lt;/code&gt;的package，我們會看到他沒有 lib 資料夾，裡面有的是 content。 &lt;/p&gt;&lt;figure&gt;&lt;a href="https://lh3.googleusercontent.com/-VH_2Y89QdV8/Vw-36W2X4eI/AAAAAAAAUoc/KZv-CE0QYKE/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-tQp6AGTDfqw/Vw-3_YFRSqI/AAAAAAAAUog/XatBUDftP8U/image_thumb%25255B4%25255D.png?imgmax=800" width="644" height="436"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;打開Jquery package的內容&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;content的概念是，content以下的資料夾就是&lt;em&gt;對應&lt;/em&gt;到專案的&lt;em&gt;根目錄&lt;/em&gt;。安裝這個package的時候，會自動把content下面的內容copy到專案更目錄。 &lt;/p&gt; &lt;p&gt;以jquery套件來說，安裝之後，從根目錄會有一個資料夾&lt;code&gt;Scripts&lt;/code&gt;被建立出來，然後4個js也被copy進去。 &lt;/p&gt; &lt;p&gt;因此，content以下檔案和資料夾屬於&lt;em&gt;非dll&lt;/em&gt;類型的檔案。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1460646971339834"&gt;build 資料夾&lt;/h3&gt; &lt;p&gt;其實還有一個特殊資料夾叫做build，主要作用是加 MSBuild 的target和property，為你的package加入所需要build時候所需要的特殊邏輯。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1460646971339705"&gt;用NPE看package的meta資訊&lt;/h2&gt; &lt;p&gt;在上面我們用了Newtonsoft.Json和JQuery的套件來了解了package內容的結構和每個內容的特殊之處，不過除了package本身的內容很重要之外，package本身的meta資訊也很重要，例如 package版本，專案網址等和重要資訊，這一段我們就看一下都有些什麼meta資訊。 &lt;/p&gt; &lt;p&gt;這次我們打開&lt;code&gt;Asp .Net Mvc的Package&lt;/code&gt;可以看到一些資訊，大部分看名稱就知道是什麼，不過有幾個有特殊的地方會分別介紹： &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-YOfcKAp_UI8/Vw-4AdwEMWI/AAAAAAAAUok/wF71lzSYduI/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-7RI4I_w4Ico/Vw-4CDGZDGI/AAAAAAAAUoo/tVt7Hj0G_HM/image_thumb%25255B5%25255D.png?imgmax=800" width="644" height="376"&gt;&lt;/a&gt;&lt;br&gt;&lt;/figcaption&gt;&lt;figcaption&gt;打開Asp .Net Mvc看到的內容&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1460646971339267"&gt;Id欄位&lt;/h3&gt; &lt;p&gt;Id其實就是這個package的唯一名稱，也是在用Package Manager Console下指令的時候所輸入的那個package名稱。有些package的Id和顯示名稱 (Title) &lt;em&gt;是不一樣的&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;舉例我們之前看的Newtonsoft.Json是id，但是他的Title則是 Json.Net，而在安裝package的時候，UI顯示的是Title，但是Package Manager Console用的&lt;/p&gt; &lt;p&gt;又是Id，因此兩者不一定要一致導致有時候會搞混。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1460646971339367"&gt;Version欄位&lt;/h3&gt; &lt;p&gt;version就是目前這個package對應的版本。其中有件事情要注意，當某個package發佈之後，&lt;em&gt;不能更新&lt;/em&gt;同個版本的package，只能夠更新新的版本。 &lt;/p&gt; &lt;p&gt;舉例，建立一個版本0.1.0然後發佈上去，你不能更新0.1.0的package內容，而是只能夠發佈新的版本來達到更新效果，而不能改之前已經發佈的內容。 &lt;/p&gt; &lt;h4 id="WizKMOutline_1460646971340467"&gt;版本結構 Semantic Version 2.0&lt;/h4&gt; &lt;p&gt;基本上nuget是遵從Semantic version 2.0(&lt;a href="http://semver.org/"&gt;完整規範&lt;/a&gt;)的方式來定義版本，其中定義了版本格式為 &lt;code&gt;Major.Minor.Patch&lt;/code&gt;&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Major - 當更新回影響現有api導致使用方式不同的時候，這個數字會變動  &lt;li&gt;Minor - 當有增加新的api/功能，但是不影響目前使用，這個數字會變動  &lt;li&gt;Patch - 屬於不會變動api的bug fix&lt;/li&gt;&lt;/ul&gt; &lt;p&gt;版本還可以定義為Pre-relase的package，就是在Patch後面加上&lt;code&gt;-&lt;/code&gt;就可以 - 以Asp .Net mvc Package來看，6.0還在Pre-Release &lt;/p&gt; &lt;h3 id="WizKMOutline_1460646971340322"&gt;Dependency 欄位&lt;/h3&gt; &lt;p&gt;nuget package的好處之一是幫忙處理package之間的dependency。在這個欄位定義這個package會用到哪些其他nuget package和使用哪些&lt;em&gt;版本&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;如果Dependency欄位在往下一點，可以看到 Framework Assembly Reference，這些是說明那些.Net Framework的library會用到。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1460646971340858"&gt;結語&lt;/h2&gt; &lt;p&gt;在這篇介紹了NPE這個工具，並且介紹了package的結構。有了對於package的結構的基本知識，在下一篇，將會用這個知識搭配NPE來建立新的package。 &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8143129268182883403/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/04/create-nuget-with-nuget-package-explorer-understand-nuget-package-structure.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8143129268182883403'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8143129268182883403'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/04/create-nuget-with-nuget-package-explorer-understand-nuget-package-structure.html' title='建立自己的Library - 使用Nuget Package Explorer (GUI) 建立nuget package (上篇) 介紹package結構'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-ckOY1s2BuJo/Vw-3r8CoYJI/AAAAAAAAUoA/qT4mH4UXTNM/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8471570721721131938</id><published>2016-03-13T00:55:00.000+08:00</published><updated>2016-03-13T01:05:21.656+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='nuget'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>何為nuget，該如何使用，和2.7版本之後建議的回覆nuget package(套件)的方式</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457800186754673" ;=""&gt;何為nuget&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457800186765833" ;=""&gt;nuget都有存在什麽資源&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186765739" ;=""&gt;也有一些變形的使用&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186765251" ;=""&gt;Nuget詞不同含義&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186765961" ;=""&gt;爲什麽要有nuget&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186765189" ;=""&gt;nuget一些特性&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186765174" ;=""&gt;如何使用nuget&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766844" ;=""&gt;1. 使用GUI&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766199" ;=""&gt;1.1 安裝package&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766506" ;=""&gt;1.2 刪除package&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766429" ;=""&gt;1.3 更新package&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766808" ;=""&gt;2. Package Manager Console&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766607" ;=""&gt;2.1 安裝package&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766733" ;=""&gt;2.2 刪除package&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766724" ;=""&gt;如何回覆package&lt;/a&gt;&lt;br&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766767" ;=""&gt;做法1.：對專案設定package restore&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766473" ;=""&gt;做法2.建議：nuget 2.7之後的做法 - 什麼都不用做&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766218" ;=""&gt;什麽檔案應該進入版控&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457800186766720" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;第一次接觸.Net開發的人常常會聽到一個名詞，那就是&lt;strong&gt;&lt;em&gt;nuget&lt;/em&gt;&lt;/strong&gt;。而習慣nuget的開發者通常也會常說，“你就用nuget去裝xxx套件就好了”。 &lt;/p&gt; &lt;p&gt;可是，常常會忽略掉非.Net開發者其實聽不太懂這個術語。在這篇，我希望能夠可以給新進的.net開發者，能夠瞭解什麽是nuget，爲什麽要用nuget，nuget產生的什麽東西應該進入版控，和最重要的&lt;strong&gt;&lt;em&gt;建議回覆nuget package的方式&lt;/em&gt;&lt;/strong&gt;(網路上面很多教學都是舊版本的做法) &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186754673"&gt;何為nuget&lt;/h2&gt; &lt;p&gt;nuget其實就是一個中央的資源版本儲存庫，每一個資源稱之為&lt;code&gt;package(套件)&lt;/code&gt;。每一個package都有不同版本。 &lt;/p&gt; &lt;p&gt;這邊我用資源兩個字，因為雖然大部份大家都是用它來管控專案用到的library，但是其實nuget也可以放一些程式， 例如7zip。 &lt;/p&gt; &lt;p&gt;如果和別的程式語言比較，nuget就如同Java的Maven，nodeJS的npm，Ruby的Gems。 &lt;/p&gt; &lt;p&gt;如果用安裝軟體的角度，nuget就類似Linux世界的Package Management。 &lt;/p&gt; &lt;p&gt;nuget其實是一個open source的project(&lt;a href="https://github.com/NuGet"&gt;Github&lt;/a&gt;)。其中主要兩個部份，client端和server端。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186765833"&gt;nuget都有存在什麽資源&lt;/h2&gt; &lt;p&gt;大家第一個映像都是nuget就是一些C# library，但是其實nuget放什麽都可以。library是最常見的，但是也有一些package其實就是一個可執行的程式。例如7zip，或一些unit test的console程式，這些類型的package可以方便在做一些自動化(Automation例如Continus Integration和Continus Delivery)的時候，環境設定變得更加簡單。 &lt;/p&gt; &lt;p&gt;nuget也有一些特殊的library，像是各個的unit test framework的Test Adapter也可以用nuget安裝。以前，要在Visual Studio直接執行第三放的unit test framework(例如NUnit)，開發者都需要傳Visual Studio的Extension才可以做到，現在因為Visual Studio的調整，只要透過nuget裝Test Adapter就可以，新的開發環境不需要記得Visual Studio要裝個Extension就可以跑測試。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1457800186765739"&gt;也有一些變形的使用&lt;/h4&gt;像是 &lt;a href="https://chocolatey.org/"&gt;Chocolatey&lt;/a&gt; (微軟版本的apt-get)和 &lt;a href="https://www.powershellgallery.com/"&gt;Powershell Gallery&lt;/a&gt; (Powershell module集中地)其實都是nuget的同分支出來的服務。 &lt;/div&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;h4 id="WizKMOutline_1457800186765251"&gt;Nuget詞不同含義&lt;/h4&gt;需要注意，在不同情境下面，nuget可能有不同含義。總共兩種情況：  &lt;ol&gt; &lt;li&gt;程式本身 - 有時候提到nuget指的是package management這個程式  &lt;li&gt;微軟預設的package來源 - 因為nuget server其實可以自己建制，有些服務項&lt;a href="https://myget.org/"&gt;MyGet&lt;/a&gt;可以提供私人的nuget server。所以nuget有時候指的是微軟預設提供的那個資源的&lt;a href="https://www.nuget.org/packages"&gt;Nuget Package&lt;/a&gt;的位置&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186765961"&gt;爲什麽要有nuget&lt;/h2&gt; &lt;p&gt;nuget主要解決： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;更好在不同專案之間使用同個package的不同版本  &lt;li&gt;讓開發者或者做自動化建制的時候，能夠不用做任何事情專案就能夠執行  &lt;li&gt;處理library之間的相依性。例如要用xxx需要有yyy，而且這個xxx和yyy還有可能有版本問題  &lt;li&gt;升級library的版本&lt;/li&gt;&lt;/ol&gt; &lt;p&gt;可以想像一下，在沒有nuget的時代。如果你想用一個第三方的library，通常做法是執行exe或者msi來把library裝到電腦的GAC。不過這個有幾個問題： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;因為在GAC，如果別的開發者也要開發，但是他沒裝過怎麼辦？如果文件寫的好還可以參照文件知道要安裝，但是如果沒寫好呢？  &lt;li&gt;如果同個library，在不同專案要使用不同版本，是不是要安裝好多個exe？  &lt;li&gt;如果要把系統放到別的環境執行，每一次都要安裝library，如果文件沒寫好，安裝的人不知道呢？&lt;/li&gt;&lt;/ol&gt; &lt;p&gt;這些問題，在nuget的到來都解決了。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186765189"&gt;nuget一些特性&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;nuget是跟著專案走 - 所以專案需要的package可以跟專案走  &lt;li&gt;package之間的相依性會自動處理。例如，今天要裝一個Asp .net Mvc，nuget會自動連Json.Net也裝上，因為那個是其中一個相依  &lt;li&gt;這個專案裝了什麽package會在一個 &lt;code&gt;package.config&lt;/code&gt;做記錄(.Net core用的名稱不同) - 當專建制的時候，如果package.config提到的package不存在的話，會自動下載package。&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186765174"&gt;如何使用nuget&lt;/h2&gt; &lt;p&gt;nuget有兩種使用方式： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;用GUI  &lt;li&gt;用Package Manager Console&lt;/li&gt;&lt;/ol&gt; &lt;h3 id="WizKMOutline_1457800186766844"&gt;1. 使用GUI&lt;/h3&gt; &lt;p&gt;Visual Studio 2013 和 Visual Studio 2015的畫面不太一樣，但是操作都差不多。 &lt;/p&gt; &lt;p&gt;在安裝的時候注意安裝到的&lt;strong&gt;&lt;em&gt;專案&lt;/em&gt;&lt;/strong&gt;其他就還蠻直覺。舉例今天安裝常用的&lt;code&gt;Json.Net&lt;/code&gt;套件： &lt;/p&gt; &lt;h4 id="WizKMOutline_1457800186766199"&gt;1.1 安裝package&lt;/h4&gt; &lt;p&gt;右鍵點選專案，選擇 &lt;kbd&gt;Mange Nuget Package(管理nuget套件)&lt;/kbd&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-XVczOxmcJf4/VuRIc4d6kNI/AAAAAAAAUj4/lMUYmjoaFq0/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-nh92TPrHi_Y/VuRIfD9UPeI/AAAAAAAAUj8/qfIXbpZVAmQ/image_thumb.png?imgmax=800" width="409" height="484"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;打開nuget package manager&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;預設會選取左邊頁簽(VS 2015是上面)&lt;kbd&gt;Online&lt;/kbd&gt;，這個時候可以在右上角的輸入框來輸入要搜索的套件。在確定安裝前，在上面的下拉選單可以切換是否接受 &lt;kbd&gt;Pre Realse (預覽版)&lt;/kbd&gt;的版本。 &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-_h19oHhpZ3M/VuRIgXkIK5I/AAAAAAAAUkA/4mqrTh8xRgU/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-iAdcW2dtsK0/VuRIiO0OqJI/AAAAAAAAUkE/KGntuJaIfds/image_thumb%25255B1%25255D.png?imgmax=800" width="644" height="380"&gt;&lt;/a&gt;VS 2013 安裝畫面&lt;/figcaption&gt;&lt;/figure&gt; &lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-Lc8zJi3vEDc/VuRIjJ98hdI/AAAAAAAAUkI/ctmHljZiGEU/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-7RyUgv3kVQQ/VuRIlzsCFkI/AAAAAAAAUkM/qtPaVAMmyuo/image_thumb%25255B2%25255D.png?imgmax=800" width="644" height="347"&gt;&lt;/a&gt;VS 2015 安裝畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;br&gt; &lt;p&gt;可以看到VS 2015 的版本多上了可以選擇要安裝的Version，而2013只能夠裝最新版本。 &lt;/p&gt; &lt;h4 id="WizKMOutline_1457800186766506"&gt;1.2 刪除package&lt;/h4&gt; &lt;p&gt;在頁簽的&lt;kbd&gt;Installed&lt;/kbd&gt;裡面會列出目前有安裝的package，不要的直接點&lt;kbd&gt;Uninstall&lt;/kbd&gt;即可。 &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-M6ykJEz60ug/VuRIpEwSUCI/AAAAAAAAUkQ/du97SMbJ1fw/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-epyYAR_uPhQ/VuRIrSQm7CI/AAAAAAAAUkU/AmK3y9Pdku4/image_thumb%25255B3%25255D.png?imgmax=800" width="644" height="380"&gt;&lt;/a&gt;VS 2013畫面&lt;/p&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-fAEM6JQ49lM/VuRItJM1EuI/AAAAAAAAUkY/Q4US7RaRbao/s1600-h/8f46acf7-751f-44c3-9f40-f4a1313dd270%25255B3%25255D.png"&gt;&lt;img title="8f46acf7-751f-44c3-9f40-f4a1313dd270" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="8f46acf7-751f-44c3-9f40-f4a1313dd270" src="https://lh3.googleusercontent.com/-JMAL__XMnGI/VuRIva1BW2I/AAAAAAAAUkc/azH9H6N7hxo/8f46acf7-751f-44c3-9f40-f4a1313dd270_thumb.png?imgmax=800" width="409" height="484"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;VS 2015畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt; &lt;h4 id="WizKMOutline_1457800186766429"&gt;1.3 更新package&lt;/h4&gt;&lt;figure&gt;&lt;figcaption&gt; &lt;div&gt;&lt;a href="https://lh3.googleusercontent.com/-13bbl6sJyPE/VuRIwj-F9mI/AAAAAAAAUkg/hwNcKyFJhYE/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-F9oy-IEiQ64/VuRIyij3glI/AAAAAAAAUkk/KGo84oSRezw/image_thumb%25255B4%25255D.png?imgmax=800" width="644" height="380"&gt;&lt;/a&gt;VS 2013畫面&lt;/div&gt; &lt;div&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-Ybq23lL98AM/VuRI0qds2EI/AAAAAAAAUko/lVwDUYeBQIQ/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-tGnC4Yz3uPM/VuRI1-57eCI/AAAAAAAAUks/UC3u31aD0Gs/image_thumb%25255B5%25255D.png?imgmax=800" width="644" height="347"&gt;&lt;/a&gt;VS 2015畫面&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt; &lt;p&gt;在頁簽&lt;kbd&gt;Update&lt;/kbd&gt;可以看到那些版本是可以更新的。在VS 2015更可以選擇要更新的版本(甚至降板) &lt;/p&gt; &lt;h3 id="WizKMOutline_1457800186766808"&gt;2. Package Manager Console&lt;/h3&gt; &lt;div&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="https://lh3.googleusercontent.com/-Ke7RZM4XOlU/VuRI4JX6-tI/AAAAAAAAUkw/E3DDiY0CiBY/s1600-h/image%25255B20%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-l6Kz9cOciNg/VuRI73ZQQtI/AAAAAAAAUk0/78jS2a1r-8Y/image_thumb%25255B6%25255D.png?imgmax=800" width="644" height="346"&gt;&lt;/a&gt;開啟Package Manager Console&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt; &lt;p&gt;Package Manager Console 其實就是Powershell。透過這種方式安裝有兩個好處： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;如果知道Package名稱 - 速度比較快。因為UI還要搜索  &lt;li&gt;可以傳入參數。例如用&lt;code&gt;--version&lt;/code&gt;來表示要安裝的版本，&lt;code&gt;--force&lt;/code&gt;強制刪掉某一個package(忽略這個package的相依package) - 方便更新package版本&lt;/li&gt;&lt;/ol&gt; &lt;h4 id="WizKMOutline_1457800186766607"&gt;2.1 安裝package&lt;/h4&gt; &lt;p&gt;基本上語法就是 &lt;code&gt;Install-package {packageName}&lt;/code&gt;例如： &lt;/p&gt; &lt;p&gt;&lt;code&gt;Install-Package Newtonsot.Json&lt;/code&gt;&lt;/p&gt; &lt;h4 id="WizKMOutline_1457800186766733"&gt;2.2 刪除package&lt;/h4&gt; &lt;p&gt;基本上語法就是 &lt;code&gt;Uninstall-package {packageName}&lt;/code&gt;例如： &lt;/p&gt; &lt;p&gt;&lt;code&gt;Uninstall-Package Newtonsot.Json&lt;/code&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186766724"&gt;如何回覆package&lt;/h2&gt; &lt;p&gt;基本上有3種做法： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;對專案設定package restore - 2.7 之前的做法  &lt;li&gt;nuget 2.7 之後，什麼都不用做 - &lt;strong&gt;&lt;em&gt;建議做法&lt;/em&gt;&lt;/strong&gt;  &lt;li&gt;使用nuget.exe呼叫 &lt;code&gt;nuget restore&lt;/code&gt; (在專案的資料夾下執行，會自動找到對應的sln並且回復package)&lt;/li&gt;&lt;/ol&gt; &lt;h3 id="WizKMOutline_1457800186766767"&gt;做法1.：對專案設定package restore&lt;/h3&gt; &lt;p&gt;在之前版本的nuget，要回覆nuget package需要做一些設定，並且把產生出來的&lt;code&gt;.nuget&lt;/code&gt;資料夾要放到版控才可以。 &lt;/p&gt; &lt;p&gt;&lt;a href="https://lh3.googleusercontent.com/-TVCZ5COh3AA/VuRLqO3NK3I/AAAAAAAAUlE/D5Axs1ZHEgQ/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="https://lh3.googleusercontent.com/-o55-zHJ9uMs/VuRLrFAatBI/AAAAAAAAUlI/ThbEC-DfdRQ/image_thumb%25255B1%25255D.png?imgmax=800" width="372" height="369"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;這種做法有2個問題： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;這個做法是在專案&lt;strong&gt;&lt;em&gt;Build(建制)的時候&lt;/em&gt;&lt;/strong&gt; 在回覆不存在的package。因為是在Build的時候做，所以第一次build會失敗，因為package還沒下載好。  &lt;li&gt;版控要記錄&lt;code&gt;.nuget&lt;/code&gt;資料夾&lt;/li&gt;&lt;/ol&gt; &lt;p&gt;第一個問題比較嚴重，像之前我第一次接觸自動建制，就因為這個卡住。 &lt;/p&gt; &lt;p&gt;因為這個原因，在nuget 2.7之後改變回覆package的做法。 &lt;/p&gt; &lt;p&gt;如果看到這篇，請大家告訴大家，&lt;strong&gt;&lt;em&gt;建議不要在用上面描述那種方式做nuget回覆&lt;/em&gt;&lt;/strong&gt;。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1457800186766473"&gt;做法2.建議：nuget 2.7之後的做法 - 什麼都不用做&lt;/h3&gt; &lt;p&gt;nuget 2.7之後的回覆方式就是：&lt;strong&gt;&lt;em&gt;什麽都不需要做&lt;/em&gt;&lt;/strong&gt;。沒錯，沒看錯，什麽都不需要做，只要建制，Visual Studio就會自己在 Build&lt;strong&gt;&lt;em&gt;之前&lt;/em&gt;&lt;/strong&gt;先把缺少的nuget package下載好。所以，如果有任何package需要在build的時候觸發，完全不會有問題。 &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457800186766218"&gt;什麽檔案應該進入版控&lt;/h2&gt; &lt;p&gt;在官方建議的.gitignore設定是： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;# 忽略 NuGet Packages&lt;br /&gt;*.nupkg&lt;br /&gt;# 忽略下載 packages 的資料夾 &lt;br /&gt;**/packages/*&lt;br /&gt;# 但是保留 build/ 資料夾, 用作於package的 MSBuild target.&lt;br /&gt;!**/packages/build/&lt;br /&gt;# 下面這行可有可無 - 就算沒有也會自動產生&lt;br /&gt;#!**/packages/repositories.config&lt;br /&gt; &lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1457800186766720"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過這篇，可以讓從來沒有接觸nuget的使用者瞭解並且知道爲什麽要使用nuget，瞭解nuget帶來的好處和如何在新版本回覆package。 &lt;/p&gt;&lt;p&gt;今天介紹的是如何使用nuget，在未來在介紹如何建立一個nuget package，把各位常用的自己寫的package能夠透過nuget在不同專案方便使用。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8471570721721131938/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/03/what-is-nuget-how-to-use-nuget-and-how-to-restore-properly.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8471570721721131938'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8471570721721131938'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/03/what-is-nuget-how-to-use-nuget-and-how-to-restore-properly.html' title='何為nuget，該如何使用，和2.7版本之後建議的回覆nuget package(套件)的方式'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-nh92TPrHi_Y/VuRIfD9UPeI/AAAAAAAAUj8/qfIXbpZVAmQ/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-27570990726543255</id><published>2016-03-07T22:51:00.000+08:00</published><updated>2016-03-07T22:51:39.717+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='ssh'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>如何用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457361341463918" ;=""&gt;建立另外一個ssh key&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457361341464709" ;=""&gt;config檔案的使用&lt;/a&gt;  &lt;ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457361341464104" ;=""&gt;Config檔案的概念&lt;/a&gt;  &lt;ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457361341464685" ;=""&gt;請注意config檔案本身的格式&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457361341465276" ;=""&gt;config檔案的建立&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457361341465950" ;=""&gt;config的alias作用&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457361341465254" ;=""&gt;ssh passphrase管理&lt;/a&gt;  &lt;ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457361341465109" ;=""&gt;ssh-add指令總結&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457361341465203" ;=""&gt;測試config檔案的設定&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457361341465743" ;=""&gt;結語&lt;/a&gt;  &lt;li&gt;&lt;a style="font-size: 14pt; line-height: 1.5" href="#WizKMOutline_1457361341465187" ;=""&gt;其他資料&lt;/a&gt;&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇(&lt;a href="http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html"&gt;何謂ssh，在Windows下如何使用ssh，如何在Windows透過ssh下載和上傳程式到github&lt;/a&gt;&lt;span style="font-size: 14pt; line-height: 1.5"&gt;)介紹完了如何用ssh來和github做push和pull，接下來的問題會是：那如果我有多個站台ssh要連到怎麼辦？舉例來說，假設我的bitbucket也要用ssh聯繫，要怎麼做？&lt;/span&gt;&lt;/p&gt; &lt;p&gt;另外一個問題是，每一次用ssh連線都要輸入pass phrase，上篇有介紹了ssh-agent來設定。在這篇將會在延伸ssh-agent的介紹，包括如何新增和刪除key的pass phrase，方便管理多個ssh key的pass phrase。 &lt;/p&gt; &lt;p&gt;這篇會假設已經有用上篇的方式建立了一個ssh key給github用，而這篇將會在建立一個ssh key給bitbucket用。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h2 id="WizKMOutline_1457361341463918"&gt;建立另外一個ssh key&lt;/h2&gt; &lt;p&gt;在建立bitbucket用的ssh key之前，先來看一下ssh key的檔名的一些命名規則。 &lt;/p&gt; &lt;p&gt;通常ssh key的檔名前面的部分會是：&lt;code&gt;id_rsa&lt;/code&gt;，而在點的後面則會是這個ssh key的用途。因此，假設今天我要建立的ssh key是給bitbucket用的，我的檔名會變成： &lt;code&gt;id_rsa.bitbucket&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;有了這個概念之後，可以用下列指令來建立bitbucket要用的ssh key： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;ssh-keygen -f id_rsa.bitbucket -C "alan@alantsai.net"&lt;/pre&gt;&lt;p&gt;將會產生以下的兩個檔案： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;id_rsa.bitbucket  &lt;li&gt;id_rsa.bitbucket.pub&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;這個時候在&lt;code&gt;%userprofile%\.ssh&lt;/code&gt;的下面應該就會有兩組key，一組是&lt;code&gt;id_rsa&lt;/code&gt;(github用的)，一組是&lt;code&gt;id_rsa.bitbucket&lt;/code&gt;(bitbucket用的)。 &lt;/p&gt;&lt;p&gt;下一步就是把產生的&lt;code&gt;id_rsa.bitbucket.pub&lt;/code&gt;的key加入到bitbucket裏面的允許的ssh key裏面。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1457361341464709"&gt;config檔案的使用&lt;/h2&gt;&lt;p&gt;當ssh key越來越多，如何控制那裡要用那個key就是config在做的設定，接下來將會介紹如何使用config來方便做ssh連線。 &lt;/p&gt;&lt;h3 id="WizKMOutline_1457361341464104"&gt;Config檔案的概念&lt;/h3&gt;&lt;p&gt;有了兩組key之後，我們會需要有一個東西告訴ssh，當我去github我要用&lt;code&gt;id_rsa&lt;/code&gt;，當我去bitbucket，我要用&lt;code&gt;id_rsa.bitbucket&lt;/code&gt;。而這個檔案，就是所謂的config檔案。 &lt;/p&gt;&lt;p&gt;config檔案裡面有個重要概念就是&lt;code&gt;hostname&lt;/code&gt; - 使用連線到不同hostname的時候來切換使用的ssh key而config就在設定這件事情。 &lt;/p&gt;config檔案的每一個hostname其中幾個重要格式如下：  &lt;div&gt;&lt;code style="box-sizing: border-box; font-size: 14px; border-top: rgb(221,221,221) 1px solid; font-family: menlo, monaco, consolas, 'Courier New', monospace; border-right: rgb(221,221,221) 1px solid; border-bottom: rgb(221,221,221) 1px solid; color: rgb(51,51,51); padding-bottom: 2px; padding-top: 2px; padding-left: 5px; margin: 0px; border-left: rgb(221,221,221) 1px solid; widows: 1; letter-spacing: 1px; line-height: 20px; padding-right: 5px; background-color: rgb(255,255,255); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px"&gt;Host &lt;em style="box-sizing: border-box; color: red; font-style: normal"&gt;alias&lt;/em&gt;&lt;/code&gt;&lt;br style="box-sizing: border-box; font-size: 14px; font-family: 'Helvetica Neue', helvetica, arial, sans-serif; color: rgb(51,51,51); widows: 1; letter-spacing: 1px; line-height: 20px; background-color: rgb(255,255,255)"&gt;&lt;code style="box-sizing: border-box; font-size: 14px; border-top: rgb(221,221,221) 1px solid; font-family: menlo, monaco, consolas, 'Courier New', monospace; border-right: rgb(221,221,221) 1px solid; border-bottom: rgb(221,221,221) 1px solid; color: rgb(51,51,51); padding-bottom: 2px; padding-top: 2px; padding-left: 5px; margin: 0px; border-left: rgb(221,221,221) 1px solid; widows: 1; letter-spacing: 1px; line-height: 20px; padding-right: 5px; background-color: rgb(255,255,255); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px"&gt;HostName&lt;/code&gt;&lt;code style="box-sizing: border-box; font-size: 14px; border-top: rgb(221,221,221) 1px solid; font-family: menlo, monaco, consolas, 'Courier New', monospace; border-right: rgb(221,221,221) 1px solid; border-bottom: rgb(221,221,221) 1px solid; padding-bottom: 2px; padding-top: 2px; padding-left: 5px; margin: 0px; border-left: rgb(221,221,221) 1px solid; widows: 1; letter-spacing: 1px; line-height: 20px; padding-right: 5px; background-color: rgb(255,255,255); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px"&gt;&lt;font color="#ff0000"&gt;hostname&lt;/font&gt;&lt;/code&gt;&lt;br style="box-sizing: border-box; font-size: 14px; font-family: 'Helvetica Neue', helvetica, arial, sans-serif; color: rgb(51,51,51); widows: 1; letter-spacing: 1px; line-height: 20px; background-color: rgb(255,255,255)"&gt;&lt;code style="box-sizing: border-box; font-size: 14px; border-top: rgb(221,221,221) 1px solid; font-family: menlo, monaco, consolas, 'Courier New', monospace; border-right: rgb(221,221,221) 1px solid; border-bottom: rgb(221,221,221) 1px solid; color: rgb(51,51,51); padding-bottom: 2px; padding-top: 2px; padding-left: 5px; margin: 0px; border-left: rgb(221,221,221) 1px solid; widows: 1; letter-spacing: 1px; line-height: 20px; padding-right: 5px; background-color: rgb(255,255,255); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px"&gt;IdentityFile ~/.ssh/&lt;em style="box-sizing: border-box; color: red; font-style: normal"&gt;identity&lt;/em&gt;&lt;/code&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;紅字是每一個可以設定的地方： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;alias - 這個和用ssh clone 使用的url有關係，等一下在加深說明  &lt;li&gt;hostname - 這個指的是我們連線過去服務的hostname。以我們例子來說，就會有github.com或者是bitbucket.org  &lt;li&gt;identity - 這個指的就是在這個hostname的情況下要用那個private key&lt;/li&gt;&lt;/ol&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;h4 id="WizKMOutline_1457361341464685"&gt;請注意config檔案本身的格式&lt;/h4&gt;&lt;p&gt;由於ssh屬於linux類型的工具，因此在檔案格式和line ending上面和windows不同，因此要注意： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;檔案的encoding要用&lt;code&gt;ANSI&lt;/code&gt;或者要是utf-8不要有bom  &lt;li&gt;檔案的Line ending要用UNIX格式&lt;/li&gt;&lt;/ol&gt;其中目前檔案的encoding和line ending在notepad++可以在右下角看到：  &lt;p&gt;如果自己建立的檔案設定完了還是不成功，那麼建議直接到ssh.exe的global config檔案，路徑(&lt;code&gt;%programfiles%\Git\etc\ssh\ssh_config&lt;/code&gt;)去copy過來用，格式和line ending就都okay。 &lt;/p&gt;&lt;/div&gt;&lt;h3 id="WizKMOutline_1457361341465276"&gt;config檔案的建立&lt;/h3&gt;&lt;p&gt;上面了解格式之後，config檔案的設定會如下： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;# GitHub user&lt;br /&gt;Host github.com&lt;br /&gt; HostName github.com&lt;br /&gt; IdentityFile ~/.ssh/id_rsa&lt;br /&gt; &lt;br /&gt;# Bitbucket&lt;br /&gt;Host bitbucket.org&lt;br /&gt; HostName bitbucket.org&lt;br /&gt; IdentityFile ~/.ssh/id_rsa.bitbucket&lt;br /&gt;&lt;/pre&gt;&lt;h3 id="WizKMOutline_1457361341465950"&gt;config的alias作用&lt;/h3&gt;&lt;p&gt;在接下去測試之前，這邊先提一個很重要的config概念，就是&lt;code&gt;alias&lt;/code&gt;的值。&lt;code&gt;alias&lt;/code&gt;可以讓我們的git網址變得更加好記。 &lt;/p&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;預設網址&lt;/th&gt;&lt;th&gt;使用alias的網址&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;git@bitbucket.org:&amp;lt;accountname&amp;gt;/&amp;lt;reponame&amp;gt;.git &lt;/td&gt;&lt;td&gt;git@&lt;strong&gt;&lt;em&gt;alias&lt;/em&gt;&lt;/strong&gt;:&amp;lt;accountname&amp;gt;/&amp;lt;reponame&amp;gt;.git &lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;所以，alias會對到config裏面的alias，然後用alias的hostname來作為實際連線的host。所以假設今天有個config是： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;# Bitbucket&lt;br /&gt;Host personal&lt;br /&gt; HostName bitbucket.org&lt;br /&gt; IdentityFile ~/.ssh/id_rsa.bitbucket&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;那麼，clone的網址可以變成是：&lt;code&gt;git@&lt;strong&gt;&lt;em&gt;personal&lt;/em&gt;&lt;/strong&gt;:&amp;lt;accountname&amp;gt;/&amp;lt;reponame&amp;gt;.git&lt;/code&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1457361341465254"&gt;ssh passphrase管理&lt;/h2&gt;&lt;p&gt;在之前&lt;a href="http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html#WizKMOutline_1443285321782656"&gt;那篇&lt;/a&gt;有介紹了如何透過&lt;code&gt;ssh-add -l&lt;/code&gt;的 參數來看那些passphrase有記錄管理，然後可以透過 &lt;code&gt;ssh-add {key path}&lt;/code&gt; 來加入某個key的passphrase，在這邊在介紹最後一個參數 &lt;code&gt;ssh-add -D&lt;/code&gt;能夠把目前有管理的都刪除。 &lt;/p&gt;&lt;p&gt;這邊的刪除指的只是把ssh-agent對key的passphrase的記錄刪除 - 而不是真的把key刪除，因此不用擔心，要重新加回來只要在呼叫&lt;code&gt;ssh-add {key path}&lt;/code&gt;就可以。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;h4 id="WizKMOutline_1457361341465109"&gt;ssh-add指令總結&lt;/h4&gt;&lt;table class="table"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;指令&lt;/th&gt;&lt;th&gt;作用&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ssh-add -l&lt;/code&gt;&lt;/td&gt;&lt;td&gt;列出目前ssh agent有在管控的key passphrase&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ssh-add {key path}&lt;/code&gt;&lt;/td&gt;&lt;td&gt;加入某一個key的passphrase&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ssh-add -D&lt;/code&gt;&lt;/td&gt;&lt;td&gt;把所有目前ssh agent管控的key passphrase都清掉 - 如果要重新加入在用 &lt;code&gt;ssh-add {key path}&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;h2 id="WizKMOutline_1457361341465203"&gt;測試config檔案的設定&lt;/h2&gt;&lt;p&gt;當bitbucket和github使用的ssh key在config設定好了之後，並且key的passphrase都透過&lt;code&gt;ssh-add&lt;/code&gt;給ssh-agent管控了之後，會需要測試是否有問題。 &lt;/p&gt;&lt;p&gt;這個時候就可以用： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;kbd&gt;ssh -T git@github.com&lt;/kbd&gt; - 測試github的連線  &lt;li&gt;&lt;kbd&gt;ssh -T git@bitbucket.org&lt;/kbd&gt; - 測試bitbucket的連線 &lt;/li&gt;&lt;/ul&gt;&lt;h2 id="WizKMOutline_1457361341465743"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過上篇和這篇的ssh介紹，能夠讓沒有用過ssh的Windows使用者在使用git和repository溝通的時候花的的時間更少，讓大家可以更專注在程式開發上面。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1457361341465187"&gt;其他資料&lt;/h2&gt;&lt;ol&gt;&lt;li&gt;&lt;a href="http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html"&gt;何謂ssh，在Windows下如何使用ssh，如何在Windows透過ssh下載和上傳程式到github&lt;/a&gt;  &lt;li&gt;&lt;a href="https://confluence.atlassian.com/bitbucket/configure-multiple-ssh-identities-for-gitbash-mac-osx-linux-271943168.html"&gt;Configure multiple SSH identities for GitBash, Mac OSX, &amp;amp; Linux&lt;/a&gt; - 介紹config裏面的多個alias設定  &lt;li&gt;&lt;a href="https://confluence.atlassian.com/bitbucket/set-up-ssh-for-git-728138079.html"&gt;Set up SSH for Git&lt;/a&gt; - 介紹使用ssh&lt;/li&gt;&lt;/ol&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/27570990726543255/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/03/ssh-config-ssh-agent-passphrase-management.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/27570990726543255'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/27570990726543255'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/03/ssh-config-ssh-agent-passphrase-management.html' title='如何用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8777047618155571388</id><published>2016-03-03T22:06:00.002+08:00</published><updated>2016-03-03T22:31:31.579+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><title type='text'>[Asp .Net Mvc]http status 400 的JsonResult在正式機器無法取得回傳的Json資料</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457012277950998" ;=""&gt;問題描述&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962556" ;=""&gt;問題原因&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962120" ;=""&gt;解決辦法&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962338" ;=""&gt;在Web.config設定&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962941" ;=""&gt;在程式裏面設定&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962691" ;=""&gt;修正之前客制的JsonResult&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1457012277962793" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;section&gt; &lt;p&gt;在之前介紹客制JsonResult的時候(&lt;a href="http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-28-JsonResult-Problem.html"&gt;[iThome 第七屆鐵人賽 28] Javascript和Mvc溝通 - 概念篇&lt;/a&gt; 和 &lt;a href="http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-29-JsonResult-Implement.html"&gt;[iThome 第七屆鐵人賽 29] Javascript和Mvc溝通 - 實作篇&lt;/a&gt;&lt;span style="font-size: 14pt; line-height: 1.5"&gt;)，其中一個原因是爲了讓回傳的資訊可以利用http裏面的狀態碼(status code)設定為400來表示Json結果是錯誤， 然後前端接到的時候可以直接透過在error事件的function來處理有出錯的邏輯。而不是要在success function裏面透過回傳的json物件來判斷是否有成功。&lt;/span&gt;&lt;/p&gt; &lt;p&gt;在實際使用的時候，開發都沒有什麽問題，但是在正式機器的時候出現bug，會導致沒有辦法取得回傳的&lt;em&gt;Json物件內容&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;這篇將會介紹發生的原因和如何處理。 &lt;/p&gt;&lt;/section&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457012277950998"&gt;問題描述&lt;/h2&gt; &lt;p&gt;在我實際使用上面，在開發階段，&lt;code&gt;return JsonError()&lt;/code&gt;，的確會回傳並且狀態是400(因此前端會進入error的function)，並且json物件也有回傳回來。 &lt;/p&gt; &lt;p&gt;但是在正式機器並非如此。在正式機器，也一樣會回傳400(所以也會進入error的function)，但是json物件&lt;em&gt;沒有傳送回來&lt;/em&gt;。 &lt;/p&gt; &lt;p&gt;從下面兩張截圖可以看到，正式機器和測試機器所回傳的內容： &lt;a href="https://lh3.googleusercontent.com/-LvchwtElPeg/VthDy0zDeLI/AAAAAAAAUjI/AAKOxlbbp5A/s1600-h/image%25255B14%25255D.png"&gt;&lt;img title="測試機器的Request - 可以看到json資料有回傳回來" class="img-responsive" alt="測試機器的Request - 可以看到json資料有回傳回來" src="https://lh3.googleusercontent.com/-rt9igTFYCH0/VthD1AKhT4I/AAAAAAAAUjM/VUzambpWwdU/image_thumb%25255B8%25255D.png?imgmax=800"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;測試機器的Request - 可以看到json資料有回傳回來&lt;a href="https://lh3.googleusercontent.com/-6XkjxMcAGHc/VthD2dTVBSI/AAAAAAAAUjQ/-oAh7h37Zy0/s1600-h/image%25255B27%25255D.png"&gt;&lt;img title="正式機器的Request - 可以看到json資料沒有回來" class="img-responsive" alt="正式機器的Request - 可以看到json資料沒有回來" src="https://lh3.googleusercontent.com/-Sz7mDLfoiVU/VthD3EYnunI/AAAAAAAAUjU/ctS6WkoBdEU/image_thumb%25255B19%25255D.png?imgmax=800"&gt;&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure&gt;&lt;br&gt;&lt;figcaption&gt;正式機器的Request - 可以看到json資料沒有回來&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section&gt; &lt;/p&gt; &lt;h2 id="WizKMOutline_1457012277962556"&gt;問題原因&lt;/h2&gt; &lt;p&gt;可以看到在正式機器，本來要回傳的json資料沒有回傳回來，只出現&lt;code&gt;錯誤的請求&lt;/code&gt;。光這樣看，一時之間還看不出問題。 &lt;/p&gt; &lt;p&gt;如果把&lt;code&gt;錯誤的請求&lt;/code&gt;翻譯成英文其實就是 &lt;code&gt;Bad Request&lt;/code&gt;。這個詞就熟悉多了，不就是http 錯誤碼400的描述文字。 &lt;/p&gt; &lt;p&gt;這個時候我的直覺就是，會不會和Asp .Net的客制錯誤訊息頁（CustomError）有沒有關係？ &lt;/p&gt;&lt;/section&gt;&lt;section&gt; &lt;h2 id="WizKMOutline_1457012277962120"&gt;解決辦法&lt;/h2&gt; &lt;p&gt;最後查到一篇&lt;a href="http://stackoverflow.com/questions/22071211/when-performing-post-via-ajax-bad-request-is-returned-instead-of-the-json-resul"&gt;SO&lt;/a&gt;，的確可能是IIS的Custom Error介入導致，這個時候，其實解決方法就簡單了，就是想辦法不要讓IIS介入就好。 &lt;/p&gt; &lt;p&gt;有兩種解決方法： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;在Web.config設定  &lt;li&gt;在程式裏面處理&lt;/li&gt;&lt;/ol&gt; &lt;h3 id="WizKMOutline_1457012277962338"&gt;在Web.config設定&lt;/h3&gt;只需要在Web.config裏面放入： &lt;pre class="brush: xml;"&gt;&lt;system.webserver&gt;&lt;br /&gt;    ...&lt;br /&gt;    &lt;httperrors existingresponse="PassThrough"&gt;&lt;/httperrors&gt;&lt;br /&gt;    ...&lt;br /&gt;&lt;/system.webserver&gt;&lt;/pre&gt;web.config的好處是全域都有效果，但是有可能只是部份想要有這個效果，這個時候程式面的設定方法就會比較好。  &lt;h3 id="WizKMOutline_1457012277962941"&gt;在程式裏面設定&lt;/h3&gt;&lt;p&gt;只要在程式裏面有呼叫： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;Response.TrySkipIisCustomErrors = true;&lt;/pre&gt;即可。 &lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1457012277962691"&gt;修正之前客制的JsonResult&lt;/h2&gt;&lt;p&gt;知道了解決方法之後，我們就可以針對之前程式碼的部份，在回傳之前加入&lt;code&gt;Response.TrySkipIisCustomErrors = true;&lt;/code&gt; 即可： &lt;/p&gt;&lt;pre class="brush: csharp;highlight:[15]"&gt;protected virtual void SerializeData(HttpResponseBase response)&lt;br /&gt;{&lt;br /&gt;    if (ErrorMessages.Any())&lt;br /&gt;    {&lt;br /&gt;        var originalData = Data;&lt;br /&gt;        Data = new&lt;br /&gt;        {&lt;br /&gt;            Success = false,&lt;br /&gt;            OriginalData = originalData,&lt;br /&gt;            ErrorMessage = string.Join("\n", ErrorMessages),&lt;br /&gt;            ErrorMessages = ErrorMessages.ToArray()&lt;br /&gt;        };&lt;br /&gt; &lt;br /&gt;        response.StatusCode = 400;&lt;br /&gt;        response.TrySkipIisCustomErrors = true;&lt;br /&gt;    }&lt;br /&gt; &lt;br /&gt;    var settings = new JsonSerializerSettings&lt;br /&gt;    {&lt;br /&gt;        ContractResolver = new CamelCasePropertyNamesContractResolver(),&lt;br /&gt; &lt;br /&gt;        Converters = new JsonConverter[]&lt;br /&gt;        {&lt;br /&gt;            new StringEnumConverter(), &lt;br /&gt;        }&lt;br /&gt;    };&lt;br /&gt; &lt;br /&gt;    response.Write(JsonConvert.SerializeObject(Data, settings));&lt;br /&gt;}&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;h2 id="WizKMOutline_1457012277962793"&gt;結語&lt;/h2&gt;&lt;p&gt;有時候寫code真的要特別小心，尤其是這種正式機器才會發生的問題。不過好在，只要能夠抓到關鍵字，直接google大部份都 可以找到結果。 &lt;/p&gt;&lt;/section&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8777047618155571388/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2016/03/asp-net-mvc-http-status-400-jsonresult-not-return-show-bad-request.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8777047618155571388'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8777047618155571388'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/03/asp-net-mvc-http-status-400-jsonresult-not-return-show-bad-request.html' title='[Asp .Net Mvc]http status 400 的JsonResult在正式機器無法取得回傳的Json資料'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://lh3.googleusercontent.com/-rt9igTFYCH0/VthD1AKhT4I/AAAAAAAAUjM/VUzambpWwdU/s72-c/image_thumb%25255B8%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3430019456418583475</id><published>2015-09-27T01:15:00.000+08:00</published><updated>2016-03-07T22:52:23.938+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='ssh'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Git'/><title type='text'>何謂ssh？在Windows下如何使用ssh？如何在Windows透過ssh下載和上傳程式到github?</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782100" ;=""&gt;什麼是ssh&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782995" ;=""&gt;為什麼在Windows 要用 ssh&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782980" ;=""&gt;為什麼ssh比telnet還安全？何謂ssh key？&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782637" ;=""&gt;在Windows使用ssh需要什麼？&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782855" ;=""&gt;關鍵exe和參數介紹&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782232" ;=""&gt;一步一步設定用作於Github的ssh key&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782714" ;=""&gt;第0步 - 設定OpenSSH的資料夾路徑到path裡面&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782915" ;=""&gt;第1步 - 建立ssh key&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782713" ;=""&gt;第2步 - 把public key加入到github&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782748" ;=""&gt;第3步 - 測試設定是否成功&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782656" ;=""&gt;第4步 - 設定ssh passphrase，避免每一次都需要重新輸入&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782657" ;=""&gt;第5步 - 取得Github專案的ssh連線&lt;/a&gt; &lt;/li&gt;   &lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782951" ;=""&gt;結語&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1443285321782213" ;=""&gt;其他資料&lt;/a&gt;&lt;/li&gt;   &lt;/ul&gt;&lt;/div&gt;&lt;p&gt;對於一個完全沒有使用過Linux系統的人，要了解如何使用ssh其實是有一些門檻。不過隨著一些工具的出現，Windows使用者會使用到一些Linux的工具。最明顯莫過於git的版控系統。 &lt;/p&gt;&lt;p&gt;git非常的好用，不過由於它是由Linux創始人所設計開發出來，因此裡面有一些工具是Linux天天在使用。而ssh就是其中一個工具。 &lt;/p&gt;&lt;p&gt;這篇文章將會用我自己所理解的方式來說明ssh，和如何使用ssh來和github溝通。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h2 id="WizKMOutline_1443285321782100"&gt;什麼是ssh&lt;/h2&gt;&lt;div class="bs-callout bs-callout-warning"&gt;由於我沒有用過Linux，因此這篇有些說明可能有些地方不夠精準，如果有誤，請大家幫忙指正。 &lt;/div&gt;&lt;p&gt;ssh是&lt;code&gt;Secure SHell protocl&lt;/code&gt;的縮寫，基本上可以把它想成是有加密過的&lt;code&gt;telnet&lt;/code&gt;。不過如果你和我一樣只是聽過telnet這個名詞，那其實還是不了解ssh是什麼。 &lt;/p&gt;&lt;p&gt;以我自己的理解是，ssh和telnet其實就是用&lt;em&gt;shell 的方式連到遠端電腦&lt;/em&gt;。在Windows世界裡面，連到另外一台電腦都是透過Remote Desktop Connection（遠端連線工具），而Remote Desktop Connection是有GUI的界面，而ssh和telnet則是透過shell（command line）的方式連到電腦。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1443285321782995"&gt;為什麼在Windows 要用 ssh&lt;/h2&gt;&lt;p&gt;因為在Windows下面有時候會需要連線到Linux的服務。以我來說，使用git版控的時候，當想要把source code push到online repository（例如github或者bitbucket）的時候，都是建議使用ssh做連線。 &lt;/p&gt;&lt;p&gt;或許你會說，可是online repository都有接受用https的方式做連線，為什麼要用ssh？ &lt;/p&gt;&lt;p&gt;主要有兩個原因： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;有些情況用不了https - 例如開了two step verification（兩步驗證）在bitbucket就用不了https（不過github開了兩步驗證還是可以用產生application的密碼來連https） &lt;li&gt;用https每一次都需要打密碼 - ssh可以不用&lt;/li&gt;   &lt;/ol&gt;&lt;h2 id="WizKMOutline_1443285321782980"&gt;為什麼ssh比telnet還安全？何謂ssh key？&lt;/h2&gt;&lt;p&gt;telnet和ssh是同類型的東西。差別在於，ssh的連線通道是經過加密。ssh使用所謂的public 和 private key的Architecture來做連線通道的加解密。 &lt;/p&gt;&lt;p&gt;簡單來說，public 和 private key是2個不同的檔案。如果資訊透過一個key來加密，那麼另外一個key就可以用於解密。而通常public key是給&lt;em&gt;外部系統用&lt;/em&gt;，而private key則是&lt;em&gt;自己用&lt;/em&gt;，因此才能夠雙方溝通。 &lt;/p&gt;&lt;p&gt;為了進一步保護key，設定key的時候通常會在設定一組密碼稱之為&lt;em&gt;passphrase&lt;/em&gt;。 &lt;/p&gt;&lt;p&gt;通常來說： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;public key - 檔名 預設是&lt;code&gt;id_rsa.pub&lt;/code&gt;&lt;li&gt;private key - 檔名 預設是&lt;code&gt;id_rsa&lt;/code&gt;&lt;/li&gt;   &lt;/ol&gt;&lt;p&gt;如果上面看不太懂，講白一點就是，ssh key類似一個憑證需要在雙方電腦設定好才能夠溝通。然後passphrase就是密碼。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1443285321782637"&gt;在Windows使用ssh需要什麼？&lt;/h2&gt;&lt;p&gt;在Windows有2種類型的程式可以支援ssh： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;command line工具 - 通常是指 OpenSSH &lt;li&gt;GUI工具 - PuTTY&lt;/li&gt;   &lt;/ol&gt;&lt;p&gt;在安裝完了git，會自動帶OpenSSH。因此這這篇介紹的工具就是用OpenSSH。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1443285321782855"&gt;關鍵exe和參數介紹&lt;/h2&gt;&lt;p&gt;下面先介紹之後會用到的一些參數和exe檔案說明。 &lt;/p&gt;&lt;table class="table table-bordered"&gt;&lt;tbody&gt;&lt;tr&gt; &lt;th&gt;程式/參數&lt;/th&gt; &lt;th&gt;說明&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;OpenSSH程式位置&lt;/td&gt; &lt;td&gt; &lt;p&gt;&lt;code&gt;{Git安裝路徑}\usr\bin&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;%programfiles%\Git\usr\bin&lt;/code&gt;&lt;/p&gt;&lt;p&gt;以我的電腦的地方是在：&lt;code&gt;C:\Program Files\Git\usr\bin&lt;/code&gt;&lt;/p&gt;&lt;p&gt;下面的程式都是在OpenSSH的程式位置資料夾裡面 &lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh key預設位置&lt;/td&gt; &lt;td&gt; &lt;p&gt;Linux是：&lt;code&gt;~/.ssh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Windows在：&lt;code&gt;%userprofile%\.ssh&lt;/code&gt;&lt;/p&gt;&lt;p&gt;這邊要注意有些設定要用Linux的語法 - 因為有些工具還是使用linux的位置。 &lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh key預設檔案名稱 &lt;/td&gt; &lt;td&gt; &lt;ol&gt;&lt;li&gt;public key - 檔名 預設是&lt;code&gt;id_rsa.pub&lt;/code&gt;&lt;li&gt;private key - 檔名 預設是&lt;code&gt;id_rsa&lt;/code&gt;&lt;/li&gt;   &lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh.exe &lt;/td&gt; &lt;td&gt;ssh的主要程式，用作於連ssh。 &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh-kegen.exe &lt;/td&gt; &lt;td&gt;用來產生ssh需要的key。 &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh-agent.exe &lt;/td&gt; &lt;td&gt;一個程式用來記錄每一個ssh key的passphrase的工具。讓連ssh的時候不需要一直輸入passphrase。 &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt; &lt;td&gt;ssh-add.exe &lt;/td&gt; &lt;td&gt;管理ssh-agent.exe記錄的passphrase &lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h2 id="WizKMOutline_1443285321782232"&gt;一步一步設定用作於Github的ssh key&lt;/h2&gt;&lt;p&gt;這邊我會介紹如何從無到有設定github，然後用ssh方式連到repo。 &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;下面的cmd操作我都是使用PowerShell。因為PowerShell裡面有一個posh-git讓用PowerShell操作git變得很方便。 &lt;/div&gt;&lt;h3 id="WizKMOutline_1443285321782714"&gt;第0步 - 設定OpenSSH的資料夾路徑到path裡面&lt;/h3&gt;&lt;p&gt;因為之後操作都是用PowerShell，因此如果把OpenSSH的資料夾放到path裡面方便操作，因此開啟PowerShell之後，直接執行下面指令即可 &lt;/p&gt;&lt;pre class="brush: ps;"&gt;[Environment]::SetEnvironmentVariable("Path", "$env:Path;$env:programfiles\Git\usr\bin", "User")&lt;br /&gt;&lt;/pre&gt;&lt;h3 id="WizKMOutline_1443285321782915"&gt;第1步 - 建立ssh key&lt;/h3&gt;&lt;p&gt;首先第一步是先建立.ssh的資料夾： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;New-Item -ItemType Directory "$env:USERPROFILE/.ssh" -Force&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;在來是移動到剛剛建立的.ssh資料夾： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;cd $env:USERPROFILE/.ssh&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;透過&lt;code&gt;ssh-keygen&lt;/code&gt;產生出ssh key。其中&lt;code&gt;-f&lt;/code&gt;的參數是key的名稱，然後&lt;code&gt;-C&lt;/code&gt;則是這個key的id（其實我不太確定是什麼，不過大部分都是說輸入email） &lt;/p&gt;&lt;pre class="brush: ps;"&gt;ssh-keygen -f id_rsa -C "alan@alantsai.net"&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;這個時候會請你輸入passphrase，建議要輸入，這個會在每次做ssh的時候要求輸入。如果不想設passphrase，直接按下&lt;kbd&gt;enter&lt;/kbd&gt;就好。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-peaiEiY9XTA/VgbQmUXvK7I/AAAAAAAAPWw/9l2KLxzPq58/s1600-h/image%25255B4%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-j__sGQOwemQ/VgbQnmEUMkI/AAAAAAAAPW4/KiRloqY6LtM/image_thumb%25255B2%25255D.png?imgmax=800" width="447" height="103"&gt;&lt;/a&gt;&lt;figcaption&gt;用ssh-keygen產生ssh key&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;做完了之後，在&lt;code&gt;%userprofile%/.ssh&lt;/code&gt;應該就會看到兩個檔案： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;id_rsa  &lt;li&gt;id_rsa.pub&lt;/li&gt;   &lt;/ol&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-vyGtpwbuhWE/VgbQoCUUMjI/AAAAAAAAPXA/nyGGRsSJLBE/s1600-h/image%25255B8%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-hRpNvU9KIgE/VgbQpKQF1ZI/AAAAAAAAPXI/yWpCDUzg-4s/image_thumb%25255B4%25255D.png?imgmax=800" width="324" height="103"&gt;&lt;/a&gt;&lt;figcaption&gt;確認產生的key&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1443285321782713"&gt;第2步 - 把public key加入到github&lt;/h3&gt;&lt;p&gt;用一個檔案編輯器打開&lt;code&gt;id_rsa.pub&lt;/code&gt;，然後把所有內容複製下來。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-5KVjVV8PD2E/VgbQp3UBDwI/AAAAAAAAPXQ/6Ut6PxWR7HE/s1600-h/image%25255B12%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-UnLZqbwn5nc/VgbQrJumqkI/AAAAAAAAPXY/IPTavNw44MI/image_thumb%25255B6%25255D.png?imgmax=800" width="273" height="298"&gt;&lt;/a&gt;&lt;figcaption&gt;複製public key&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;這時候在到github，然後在&lt;kbd&gt;Settings&lt;/kbd&gt;裡面找到&lt;kbd&gt;SSH Keys&lt;/kbd&gt;，然後選&lt;kbd&gt;Add SSH key&lt;/kbd&gt;。在&lt;code&gt;key&lt;/code&gt;的部分貼上剛剛從public key複製的內容。至於&lt;code&gt;title&lt;/code&gt;主要是給自己看的名稱。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-MH9S7AO7WgA/VgbQsC7uQCI/AAAAAAAAPXg/ELcW7FeMHZw/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-lhCcO_aP1dM/VgbQtSBncqI/AAAAAAAAPXo/zcdLdU8UEo8/image_thumb%25255B9%25255D.png?imgmax=800" width="572" height="319"&gt;&lt;/a&gt;&lt;figcaption&gt;在Github設定ssh key&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h3 id="WizKMOutline_1443285321782748"&gt;第3步 - 測試設定是否成功&lt;/h3&gt;&lt;div class="bs-callout bs-callout-info"&gt;要注意，在做這個之前先把剛剛的PowerShell關掉，然後在開起來。這樣才會抓到心得key。 &lt;/div&gt;&lt;p&gt;上面都設定完成了之後，可以用下面指令來測試： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;ssh -T git@github.com&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;因為從來沒有連過會需要確認是否允許連線，這個時候輸入&lt;kbd&gt;yes&lt;/kbd&gt;就可以。&lt;/p&gt;&lt;p&gt;看到下面畫面就成功了。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-WXrUjZOzt7w/VgbQuU1OzPI/AAAAAAAAPXw/3VyToYhGnRw/s1600-h/image%25255B23%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-YkLDYApe5b4/VgbQwHwrVwI/AAAAAAAAPX4/BoH1A9i5-uw/image_thumb%25255B13%25255D.png?imgmax=800" width="584" height="102"&gt;&lt;/a&gt;&lt;figcaption&gt;測試github ssh key&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-warning"&gt;如果出現：&lt;code&gt;Permission denied (publickey).&lt;/code&gt;表示沒有設定成功。 &lt;/div&gt;&lt;h3 id="WizKMOutline_1443285321782656"&gt;第4步 - 設定ssh passphrase，避免每一次都需要重新輸入&lt;/h3&gt;&lt;p&gt;做到上面為止，其實連線都沒問題了，但是每一次都要輸入&lt;em&gt;passphrase&lt;/em&gt;其實很煩，因此我們可以透過&lt;code&gt;ssh-agent&lt;/code&gt;這個服務，能夠記錄住ssh key 的 passphrase。 &lt;/p&gt;&lt;p&gt;可以透過&lt;code&gt;ssh-add -l&lt;/code&gt;來先確認是否有任何key有記錄passphrase。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-ef_BkEgfGNU/VgbQyGjttbI/AAAAAAAAPYA/Zg3mmKJzwu0/s1600-h/image%25255B27%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-lECjqwPpSlQ/VgbQ0vQ1TYI/AAAAAAAAPYI/eXH2lwnn9so/image_thumb%25255B15%25255D.png?imgmax=800" width="334" height="65"&gt;&lt;/a&gt;&lt;figcaption&gt;測試目前設定的ssh-agent&lt;/figcaption&gt;&lt;/figure&gt;  &lt;p&gt;可以透過&lt;code&gt;ssh-add {key path}&lt;/code&gt;來加入key 的passphrase，因此： &lt;/p&gt;&lt;pre class="brush: ps;"&gt;ssh-add id_rsa&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;這個時候在用&lt;code&gt;ssh-add -l&lt;/code&gt;，會看到多了一筆。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-ki33Xt-P_wo/VgbQ4cA3WAI/AAAAAAAAPYQ/HAK1c414F4I/s1600-h/image%25255B31%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-hGRsB0AgMGY/VgbQ6r9WFlI/AAAAAAAAPYY/lSBE74eoqnA/image_thumb%25255B17%25255D.png?imgmax=800" width="451" height="74"&gt;&lt;/a&gt;&lt;figcaption&gt;確認是否加入成功&lt;/figcaption&gt;&lt;/figure&gt;  &lt;div class="bs-callout bs-callout-info"&gt;如果你在Windows的git用的是&lt;code&gt;Posh-git&lt;/code&gt;，那麼不用做任何事情ssh-agent會自動被啟動。不過如果不是，會需要做一些設定。可以參考：&lt;a href="https://confluence.atlassian.com/bitbucket/set-up-ssh-for-git-728138079.html"&gt;Set up SSH for Git&lt;/a&gt; 其中 &lt;code&gt;Step 4. Update your .bashrc profile file&lt;/code&gt;。&lt;/div&gt;&lt;h3 id="WizKMOutline_1443285321782657"&gt;第5步 - 取得Github專案的ssh連線&lt;/h3&gt;&lt;p&gt;到任何一個repo，然後在右邊copy ssh的連線，之後就用那個連線做&lt;code&gt;clone&lt;/code&gt;就可以。然後&lt;code&gt;push&lt;/code&gt;的時候自動就會上去。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.googleusercontent.com/-6RPsZ165YtM/VgbQ7V4PFwI/AAAAAAAAPYg/u-XH4ZgfFKg/s1600-h/image%25255B35%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.googleusercontent.com/-PSWmW_I1qGY/VgbQ9HVQBMI/AAAAAAAAPYo/Pf6oFuRhuwU/image_thumb%25255B19%25255D.png?imgmax=800" width="458" height="285"&gt;&lt;/a&gt; &lt;figcaption&gt;github repo ssh 連線&lt;/figcaption&gt;&lt;/figure&gt;  &lt;h2 id="WizKMOutline_1443285321782951"&gt;結語&lt;/h2&gt;&lt;p&gt;希望透過這一篇，能夠對於在Windows使用ssh變的更加容易，並且要用在git的public repository例如github和bitbucket都會非常的方便和容易。 &lt;/p&gt;&lt;p&gt;不過需要注意一件事情，假設今天你使用的不是用PowerShell的Posh-git方式操作git，那麼可能需要再做一些其他設定。 &lt;/p&gt;&lt;p&gt;在下一篇我會在介紹，當有2個以上的ssh key的時候要怎麼設定。可以想象，當你github和bitbucket用2個不同ssh key的時候，要如何處理。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1443285321782213"&gt;其他資料&lt;/h2&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;如果沒有用過指令方式操作git，建議可以試試。可以看看我之前做的簡報 &lt;iframe src="//www.slideshare.net/slideshow/embed_code/key/5FSHVOv02jti0n" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt;&lt;strong&gt; &lt;a href="//www.slideshare.net/alantsai2007/git-48778340" title="工程師必備第一工具 - Git" target="_blank"&gt;工程師必備第一工具 - Git&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="//www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://haacked.com/archive/2011/12/19/get-git-for-windows.aspx/"&gt;Configure Git in PowerShell So You Don’t Have to Enter Your Password All the Damn Time&lt;/a&gt; - 介紹Posh-Git帶來自動啟動ssh-agent的說明。  &lt;li&gt;&lt;a href="http://corlewsolutions.com/articles/article-11-guide-to-setting-up-ssh-on-windows-7"&gt;Guide To Setting Up SSH on Windows 7&lt;/a&gt; - SSH相關exe的使用  &lt;li&gt;&lt;a href="https://help.github.com/articles/generating-ssh-keys/"&gt;Generating SSH keys&lt;/a&gt; - Github介紹產生ssh key  &lt;li&gt;&lt;a href="https://confluence.atlassian.com/bitbucket/set-up-ssh-for-git-728138079.html"&gt;Set up SSH for Git&lt;/a&gt; -&amp;nbsp; Atlassain (Bitbucket公司)介紹產生ssh key  &lt;li&gt;&lt;a href="https://confluence.atlassian.com/bitbucket/troubleshoot-ssh-issues-271943403.html"&gt;Troubleshoot SSH Issues&lt;/a&gt; - Atlassain (Bitbucket公司)介紹如何測試ssh問題  &lt;li&gt;&lt;a href="http://linux.vbird.org/linux_server/0310telnetssh.php#ssh_server"&gt;第十一章、遠端連線伺服器SSH / XDMCP / VNC / RDP&lt;/a&gt; - 鳥哥介紹SSH &lt;/li&gt;   &lt;/ul&gt;&lt;/div&gt;&lt;div id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:716e5a41-8080-4fd5-bdad-0b42fa9f214c" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"&gt;blogspot 的標籤: &lt;a href="」http://alantsai2007.blogspot.com/search/label/{tag-encodeded}」" rel="」tag」"&gt;git&lt;/a&gt;,&lt;a href="」http://alantsai2007.blogspot.com/search/label/{tag-encodeded}」" rel="」tag」"&gt;ssh&lt;/a&gt;&lt;/div&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3430019456418583475/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html#comment-form' title='3 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3430019456418583475'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3430019456418583475'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html' title='何謂ssh？在Windows下如何使用ssh？如何在Windows透過ssh下載和上傳程式到github?'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh3.googleusercontent.com/-j__sGQOwemQ/VgbQnmEUMkI/AAAAAAAAPW4/KiRloqY6LtM/s72-c/image_thumb%25255B2%25255D.png?imgmax=800' height='72' width='72'/><thr:total>3</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1649429406173317211</id><published>2014-12-05T23:39:00.000+08:00</published><updated>2014-12-26T22:34:42.548+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Entity Framework'/><title type='text'>[Entity Framework] 如何在Database Designer把一個int欄位轉成Enum形態 (Entity Framework Convert int to Enum)</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927429" ;=""&gt;前言&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927439" ;=""&gt;範例的環境設定&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927905" ;=""&gt;設定把int轉成enum&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927895" ;=""&gt;當DB table重新建立的時候，在設定成為enum形態遇到的問題&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927419" ;=""&gt;int轉Enum的原理&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927451" ;=""&gt;解決方法&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1417793386927719" ;=""&gt;結論&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;h1 id="WizKMOutline_1417793386927429"&gt;前言&lt;/h1&gt; &lt;p&gt;enum其實內部儲存的形態還是int，所以任何一個int都可以直接cast成為某一個enum type，這樣就可以用那個enum的形態來操作這些值，在撰寫和閱讀程式上面就會變得比較乾淨和一目了然。 &lt;/p&gt; &lt;p&gt;Entity Framework在Code First模式下要定義一個enum非常的簡單，只需要把type設定成為那個enum，Entity Framework就會聰明到把DB的對應欄位開成int，並且儲存和讀取的時候幫忙自動轉換。 &lt;/p&gt; &lt;p&gt;但是當使用Database First模式的時候，因為Designer從DB讀取回來只會把int當做int，因此要他自動產出enum是需要做一些設定。 &lt;/p&gt; &lt;p&gt;這一篇將會介紹把int轉成enum如何做到，並且需要注意那些地方。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1417793386927439"&gt;範例的環境設定&lt;/h1&gt; &lt;p&gt;我們會用一個簡單的Database，裡面只有一個Table叫做&lt;code&gt;Post&lt;/code&gt;，代表每一筆部落格裡面的文章。 &lt;/p&gt; &lt;p&gt;在裡面有個欄位叫做&lt;code&gt;Status&lt;/code&gt;表示目前這篇文章的狀態，就是今天我們要來看的int轉enum的欄位。 &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh6.ggpht.com/-mBkAOQdBClI/VIHRSyl5-cI/AAAAAAAAOQA/vwhy6Sfyc3k/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-tBS9NFgjVg4/VIHRT8veNmI/AAAAAAAAOQI/ol_QYQYgIfU/image_thumb.png?imgmax=800" width="239" height="120"&gt;&lt;/a&gt; &lt;figcaption&gt;Post table所擁有的欄位&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;再來，我們在程式裡面，定義一個enum叫做&lt;code&gt;status&lt;/code&gt;，這個定義是用來和DB裡面的int做對應。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;namespace ConsoleApplication1&lt;br /&gt;{&lt;br /&gt;    public enum Status&lt;br /&gt;    {&lt;br /&gt;        草稿,&lt;br /&gt;        已發佈,&lt;br /&gt;        已刪除&lt;br /&gt;    } &lt;br /&gt;}&lt;br /&gt;  &lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1417793386927905"&gt;設定把int轉成enum&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;把int轉成enum其實非常的簡單，只需要打開我們的&lt;code&gt;.edmx&lt;/code&gt;然後找到要轉換的欄位 &lt;a href="http://lh5.ggpht.com/-B1iCY9HhNuw/VIHRUhTdh5I/AAAAAAAAOQQ/yY-6qRr7HCw/s1600-h/image%25255B7%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-ctWrJizTYLc/VIHRWN-SgII/AAAAAAAAOQY/EccJ9dWUcBw/image_thumb%25255B3%25255D.png?imgmax=800" width="224" height="225"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;打開edmx&lt;/figcaption&gt; &lt;/figure&gt;&lt;/p&gt;&lt;br /&gt;&lt;p&gt;對他點&lt;kbd&gt;右鍵&lt;/kbd&gt;然後會看到有個選項是：&lt;kbd&gt;Convert To Enum&lt;/kbd&gt; &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh6.ggpht.com/-U0AI-oykR44/VIHRXR3vLWI/AAAAAAAAOQg/I_4TAs5uRwE/s1600-h/image%25255B11%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-BLs625SnlQ0/VIHRY_WIYWI/AAAAAAAAOQo/jfIp985PwCU/image_thumb%25255B5%25255D.png?imgmax=800" width="233" height="212"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;開啟Convert To Enum的畫面&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;這個時候就會看到新增Enum的畫面。這邊有兩個欄位我有設定： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;Enum Type Name：這個Enum要命名的名稱 &lt;br /&gt;&lt;li&gt;Reference External Type： 如果我們別的地方已經有定義了要用的enum，可以直接輸入他的Fully Qualified Name，那麼就會自動對應。&lt;em&gt;需要注意，如果輸入錯誤，那麼產生出來的type也會錯&lt;/em&gt;。 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;其實如果外部沒有定義過enum，也可以透過這個介面直接定義enum內容。 &lt;/div&gt;&lt;figure&gt;&lt;a href="http://lh4.ggpht.com/-MQw8xUE3D_I/VIHRZ9C_-XI/AAAAAAAAOQw/KwaL-_Ps-JA/s1600-h/image%25255B18%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-orH1uzF_slc/VIHRbJr1jII/AAAAAAAAOQ4/KtnAtW0KrJw/image_thumb%25255B10%25255D.png?imgmax=800" width="303" height="288"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定enum畫面&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;設定完了之後，產生出來的class檔案如下： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh5.ggpht.com/-F41bg64NMAc/VIHRcCo_CVI/AAAAAAAAORA/YjIKGcoE83E/s1600-h/image%25255B22%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-Z_hgxjgWCHM/VIHRdOdTYoI/AAAAAAAAORI/T1feF3cQS2c/image_thumb%25255B12%25255D.png?imgmax=800" width="408" height="232"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;最後產生出來的Class&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1417793386927895"&gt;當DB table重新建立的時候，在設定成為enum形態遇到的問題&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;把int轉成enum其實很簡單，但是如果對於背後的機制不瞭解的話，就會遇到這個處理不了的情況。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;假設，今天我們把這個&lt;code&gt;Post&lt;/code&gt;Class刪掉了，然後又從新加回來。這個時候，會發現&lt;code&gt;Status&lt;/code&gt;欄位會變回&lt;code&gt;int&lt;/code&gt;。這個時候我們再用一樣 的方式把&lt;code&gt;int&lt;/code&gt;轉成enum，會發現會有問題： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh5.ggpht.com/-vGnz7tWMJ1I/VIHRemdNcUI/AAAAAAAAORQ/XqUJOFu-Suc/s1600-h/image%25255B28%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-9xGpk8oAaoE/VIHRf_3siAI/AAAAAAAAORY/MwSRYJyf0v0/image_thumb%25255B16%25255D.png?imgmax=800" width="284" height="265"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;無法轉換&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;這個時候會發現完全沒有辦法在新增一筆，這個到底是爲什麽呢？ &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1417793386927419"&gt;int轉Enum的原理&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;後來在思考一下，其實不管enum是由外部reference的還是直接透過ui建立enum值，其實&lt;code&gt;edmx&lt;/code&gt;都會記錄。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們可以從Visual Studio的&lt;code&gt;Entity Data Model Browser&lt;/code&gt;來開啟看看edmx有的內容。這個時候應該會看到&lt;code&gt;Model&lt;/code&gt;下面的&lt;code&gt;Enum Types&lt;/code&gt;有一筆剛剛建立的&lt;code&gt;Status&lt;/code&gt; &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh4.ggpht.com/-TB-njpF1hcE/VIHRhZDhgFI/AAAAAAAAORg/XB5fBXUzVHo/s1600-h/image%25255B38%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-eqm9VR02T58/VIHRjyQ8e6I/AAAAAAAAORo/Uf2GJ6Ad6Vc/image_thumb%25255B22%25255D.png?imgmax=800" width="247" height="245"&gt;&lt;/a&gt;&lt;a href="http://lh6.ggpht.com/-HtJPekhQly0/VIHRlYGPYNI/AAAAAAAAORw/03T04FqHTHs/s1600-h/image%25255B37%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-Q7VFKO9_b8I/VIHRmrwW84I/AAAAAAAAOR4/_i9v6aQV3Fk/image_thumb%25255B21%25255D.png?imgmax=800" width="213" height="240"&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure&gt;&lt;figcaption&gt;開啟Entity Data Model Browser&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;當我們在把int轉換成為enum的時候，給的&lt;code&gt;Enum type name&lt;/code&gt;其實就是定義的enum名稱，而edmx是認得這個名字而已，而不認得其他。 &lt;/div&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;其實edmx裡面總共會記錄3種資訊，其實我以前曾經介紹entity framework的power point有提到過，但是久了自己都忘記了：&lt;iframe style="margin-bottom: 5px; max-width: 100%; border-top: #ccc 1px solid; border-right: #ccc 1px solid; border-bottom: #ccc 1px solid; border-left: #ccc 1px solid" height="355" marginheight="0" src="//www.slideshare.net/slideshow/embed_code/37067587?startSlide=9" frameborder="0" width="425" marginwidth="0" scrolling="no" allowfullscreen&gt; &lt;/iframe&gt; &lt;br /&gt;&lt;div style="margin-bottom: 5px"&gt;&lt;strong&gt;&lt;a title="Entity framework + Linq 介紹" href="//www.slideshare.net/alantsai2007/entity-framework-linq" target="_blank"&gt;Entity framework + Linq 介紹&lt;/a&gt; &lt;/strong&gt;from &lt;strong&gt;&lt;a href="//www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1417793386927451"&gt;解決方法&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;既然我們知道edmx只認得它內部看的懂得形態，這個時候我們就可以透過ui去選擇欄位的形態，這個時候就會發現我們建立的enum： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh4.ggpht.com/-xWPEkeFYqTE/VIHRnouA40I/AAAAAAAAOSA/tskHf4jKg9E/s1600-h/image%25255B45%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-vIGCwNeJY7Y/VIHRpX9-E8I/AAAAAAAAOSI/_R0ydMnCMcY/image_thumb%25255B27%25255D.png?imgmax=800" width="296" height="288"&gt;&lt;/a&gt;&lt;a href="http://lh5.ggpht.com/-oJ887E3xLpE/VJ1x99k08dI/AAAAAAAAOUs/JHyy5ZAITBg/s1600-h/image%25255B4%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-itA4UwokyGo/VJ1yAAjkk5I/AAAAAAAAOU0/e7mZCRCAJUw/image_thumb%25255B2%25255D.png?imgmax=800" width="226" height="205"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;設定欄位形態&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1417793386927719"&gt;結論&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;其實int轉enum看似簡單，裡面有很多細節。而這些細節有時候看一篇教學文章是不會講到的內容，造成在實務上面使用的時候，一出現問題很不容易解決。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，有時候還真需要靜下心來瞭解背後的原理，才知道如何解決。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1649429406173317211/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/12/entity-framework-database.html#comment-form' title='2 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1649429406173317211'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1649429406173317211'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/12/entity-framework-database.html' title='[Entity Framework] 如何在Database Designer把一個int欄位轉成Enum形態 (Entity Framework Convert int to Enum)'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh3.ggpht.com/-tBS9NFgjVg4/VIHRT8veNmI/AAAAAAAAOQI/ol_QYQYgIfU/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>2</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4279310907326696411</id><published>2014-10-29T22:06:00.001+08:00</published><updated>2014-10-29T22:06:56.992+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 30] 終篇 總結</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577031814" ;=""&gt;整個框架結構圖&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032597" ;=""&gt;Autofac&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032182" ;=""&gt;Log&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032986" ;=""&gt;ViewModel和AutoMapper&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032885" ;=""&gt;Repository和Unit of Work&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032391" ;=""&gt;Alerts服務和BaseController&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032252" ;=""&gt;Service層的工作&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032367" ;=""&gt;自動化搜索&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032810" ;=""&gt;資料驗證&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032810" ;=""&gt;SelectListFill：下拉式選項內容自動產生&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032400" ;=""&gt;ModelMetadata 和 JsonResult&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590577032737" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;時間過的非常快，一眨眼30天就過去了，到目前為止框架的介紹也到了一個階段，希望大家在這一系列有得到一些有幫助的內容。 &lt;/p&gt;&lt;p&gt;下面將會用一個同事幫忙畫的30天所介紹的框架整個架構圖，並且快速回顧一下每一個部份在那裡作了介紹。 &lt;/p&gt;&lt;p&gt;這一整個系列主要目的是給各位未來需要建立自己框架的時候的一個起點，框架這個東西其實是要看整個專案和團隊的需求來建制。因此，這一系列的介紹只是給各位一些思考的方向和內容。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414590577031814"&gt;整個框架結構圖&lt;/h1&gt;&lt;figure&gt;&lt;a href="http://lh3.ggpht.com/-mlV7ptTJjwQ/VFD0KHW-rXI/AAAAAAAAOJ4/4Hm51HpaebM/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-3HM63YXc1Eo/VFD0K7HMqZI/AAAAAAAAOKA/FG00Mgl6iC0/image_thumb%25255B1%25255D.png?imgmax=800" width="523" height="228"&gt;&lt;/a&gt;&lt;br /&gt;&lt;figcaption&gt;框架結構圖&lt;/figcaption&gt; &lt;/figure&gt; &lt;h2 id="WizKMOutline_1414590577032597"&gt;Autofac&lt;/h2&gt;&lt;p&gt;一開始就是先介紹了DI的概念和Autofac相關。整個框架的核心是DI，至於要使用什麼的DI Container是看個人喜好。 &lt;/p&gt;&lt;p align="left"&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html"&gt;[iThome 第七屆鐵人賽 02] IoC基本概念介紹&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-03-Autofac-intro.html"&gt;[iThome 第七屆鐵人賽 03] Autofac基本介紹&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-04-AutofacMvcIntegration.html"&gt;[iThome 第七屆鐵人賽 04] Autofac和Asp .Net Mvc結合&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032182"&gt;Log&lt;/h2&gt;&lt;p&gt;介紹完了Autofac之後，用了最常見的功能，Log服務來在深入介紹Autofac能夠做到什麼地步。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html"&gt;[iThome 第七屆鐵人賽 05] 打造第一個通用服務 - Log&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032986"&gt;ViewModel和AutoMapper&lt;/h2&gt;&lt;p&gt;接下來是Mvc很常見的ViewModel和Model之間的轉換。介紹了為什麼要使用ViewModel，並且如何透過Automapper來讓ViewModel和Model之間的轉換變的簡單。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-06-ViewModelIntro.html"&gt;[iThome 第七屆鐵人賽 06] ViewModel的重要性&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/ithome-07-automapper-entityviewmodel.html"&gt;[iThome 第七屆鐵人賽 07] AutoMapper 介紹 - 簡單化Entity和ViewModel之間的轉換&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-08-AutoMapperConfigEasier.html"&gt;[iThome 第七屆鐵人賽 08] 框架簡化建立AutoMapper對應的設定&lt;/a&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032885"&gt;Repository和Unit of Work&lt;/h2&gt;&lt;p&gt;介紹完了Model和ViewModel之間用AutoMapper的轉換，實際看了如何實作常見的Repository + Unit Of Work來抽離Data Access Layer的功能。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-09-RepositoryPattern.html"&gt;[iThome 第七屆鐵人賽 09] 用Repository Pattern抽離對Entity Framework的依賴&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html"&gt;[iThome 第七屆鐵人賽 10] 加上 Unit of Work，抽離Entity Framework的依賴就完美了&lt;/a&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032391"&gt;Alerts服務和BaseController&lt;/h2&gt;&lt;p&gt;如何有一個共通傳遞訊息到前端的方法是很重要的，並且前端想用其他方式呈現這些資訊的做法也需要考慮進去。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-11-alertservice.html"&gt;[iThome 第七屆鐵人賽 11] 傳遞資訊到前端的通用型服務&lt;/a&gt;&lt;/p&gt;&lt;p&gt;也介紹了有一個共通Controller的重要性，不管是要增加共通方法到所有的Controller還是要把一些客制的ActionResult呼叫使用，都提供了一個很好的Wrapper。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-12-importantofbasecontroller.html"&gt;[iThome 第七屆鐵人賽 12] BaseController的重要性&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-29-JsonResult-Implement.html"&gt;[iThome 第七屆鐵人賽 29] Javascript和Mvc溝通 - 實作篇&lt;/a&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032252"&gt;Service層的工作&lt;/h2&gt;&lt;p&gt;SoC的概念非常重要，因此有了Service層來處理邏輯相關的內容。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-13-service-intro.html"&gt;[iThome 第七屆鐵人賽 13] Service層 - 概念篇&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html"&gt;[iThome 第七屆鐵人賽 14] 把目前的CRUD功能放到Service層&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;這邊介紹了如何建立自己的Service層，有了Service層之後如何把一些內容自動化。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-15-FileProcess.html"&gt;[iThome 第七屆鐵人賽 15] 處理檔案上傳&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-16-FileProcess-InService.html"&gt;[iThome 第七屆鐵人賽 16] 處理檔案上傳 2 - 放到Service層&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h3 id="WizKMOutline_1414590577032367"&gt;自動化搜索&lt;/h3&gt;&lt;p&gt;任何application都需要能夠搜索，因此能夠處理共通的搜索邏輯是非常重要的，而Service能夠完全處理這些內容。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-20-IndexPage-concept.html"&gt;[iThome 第七屆鐵人賽 20] 搜索頁面 - 思考篇&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-21-IndexPage-ViewModel.html"&gt;[iThome 第七屆鐵人賽 21] 搜索頁面 - ViewModel的定義&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-22-IndexPage-DynamicWhereLinq.html"&gt;[iThome 第七屆鐵人賽 22] 搜索頁面 - Service層的工作 -動態產生Linq條件&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-23-IndexPage-AutomaticSsearch.html"&gt;[iThome 第七屆鐵人賽 23] 搜索頁面 - Service層的工作 - 自動套用一般搜索條件&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-24-IndexPage-AutomaticSsearch-view.html"&gt;[iThome 第七屆鐵人賽 24] 搜索頁面 - Service層的工作 - View方面的處理&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-25-IndexPage-AutomaticSearch-improved.html"&gt;[iThome 第七屆鐵人賽 25] 搜索頁面 - Service層的工作 - 搜索在進化&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032810"&gt;資料驗證&lt;/h2&gt;&lt;p&gt;任何Application都需要做資料驗證，因此介紹了如何把不同層級的錯誤訊息串接再起來，並且方便呈現。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-17-DataValidation-concept.html"&gt;[iThome 第七屆鐵人賽 17] 資料驗證 - 思路篇&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-18-DataValidation-implement.html"&gt;[iThome 第七屆鐵人賽 18] 資料驗證 - 實作篇&lt;/a&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032810"&gt;SelectListFill：下拉式選項內容自動產生&lt;/h2&gt;&lt;p&gt;能夠讓每一次都產生下拉式選單的內容可以避免掉一些只有在Runtime才測試的出來的問題。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-19-GenerateSelectListFroDropDownList.html"&gt;[iThome 第七屆鐵人賽 19] 框架產生下拉式資料的內容&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h2 id="WizKMOutline_1414590577032400"&gt;ModelMetadata 和 JsonResult&lt;/h2&gt;&lt;p&gt;ModelMetadata可以讓我們用Convention的方式來產生一致的UI。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-26-ModelMetadata-Intro.html"&gt;[iThome 第七屆鐵人賽 26] View相關的處理 - Model的Metadata介紹&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-27-ModelMetadata-Implement.html"&gt;[iThome 第七屆鐵人賽 27] View相關的處理 - 框架自動增加Model Metadata&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;自訂的JsonResult可以讓我們前端和後端溝通的時候變得更加容易。 &lt;/p&gt;&lt;p&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-28-JsonResult-Problem.html"&gt;[iThome 第七屆鐵人賽 28] Javascript和Mvc溝通 - 概念篇&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p align="left"&gt;&lt;a href="http://alantsai2007.blogspot.com/2014/10/BuildYourOwnApplicationFrameworkOnMvc-29-JsonResult-Implement.html"&gt;[iThome 第七屆鐵人賽 29] Javascript和Mvc溝通 - 實作篇&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;h1 id="WizKMOutline_1414590577032737"&gt;結語&lt;/h1&gt;&lt;p&gt;框架這個東西真的是要看團隊和看案子。並不是所有的功能都需要，也並不是所有的做法都對。框架其實只是一些個人意見和個人喜好針對某些事情的處理做包裝和把一些細節隱藏起來讓開發著專注於重要的問題：也就是解決客戶的問題，而不是一直重複debug一些疏忽的小事造成系統出問題。 &lt;/p&gt;&lt;p&gt;這系列的文章其實只是給大家一個起點，希望對於大家有些幫助。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4279310907326696411/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-30-Conclusion.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4279310907326696411'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4279310907326696411'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-30-Conclusion.html' title='[iThome 第七屆鐵人賽 30] 終篇 總結'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-3HM63YXc1Eo/VFD0K7HMqZI/AAAAAAAAOKA/FG00Mgl6iC0/s72-c/image_thumb%25255B1%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8281088447958428658</id><published>2014-10-29T21:48:00.000+08:00</published><updated>2016-03-03T22:33:15.284+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 29] Javascript和Mvc溝通 - 實作篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414590340060520" ;=""&gt;解決思路&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1414590340061863" ;=""&gt;CoreJsonResult&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1414590340061864" ;=""&gt;在BaseController增加呼叫方法&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1414590340061121" ;=""&gt;呼叫的範例&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1414590340062289" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;上一篇介紹完了在Mvc的框架裡面，用Json方式傳遞資料的問題之後，接下來將會看這些問題將會如何解決。 &lt;/p&gt; &lt;ul&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;2016 更新程式碼：在正式機器的JsonError拿不到物件資料的問題&lt;/em&gt;&lt;/strong&gt; - 詳細可以看：&lt;a href="http://blog.alantsai.net/2016/03/asp-net-mvc-http-status-400-jsonresult-not-return-show-bad-request.html#WizKMOutline_1457012277962691"&gt;[Asp .Net Mvc]http status 400 的JsonResult在正式機器無法取得回傳的Json資料&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414590340060520"&gt;解決思路&lt;/h1&gt; &lt;p&gt;首先，最大的問題是Json內建的Serialization是沒有辦法讓我們解決這些問題。因此，我們將會使用Json .Net作為Serialization的library。 &lt;/p&gt; &lt;p&gt;再來，會建立一個Class繼承JsonResult，來對裡面做一些處理。不過，需要注意到，因為Mvc裡面的JsonResult寫的比較死，因此有些部分還是需要重複原始的JsonResult內容，讓整個使用起來和之前的Api一樣。 &lt;/p&gt; &lt;p&gt;最後，會在之前建立的BaseController寫一些method，方便呼叫來建立新的JsonResult的class。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1414590340061863"&gt;CoreJsonResult&lt;/h1&gt; &lt;p&gt;先從客制的JsonResult開始，首先這個客制的JsonResult會記錄需要顯示的錯誤訊息，並且保留和之前JsonResult一樣的api，因此： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class CoreJsonResult : JsonResult&lt;br /&gt;{&lt;br /&gt;    public IList&amp;lt;string&amp;gt; ErrorMessages { get; set; }&lt;br /&gt;&lt;br /&gt;    public CoreJsonResult()&lt;br /&gt;    {&lt;br /&gt;        ErrorMessages = new List&amp;lt;string&amp;gt;();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public void AddError(string errorMessage)&lt;br /&gt;    {&lt;br /&gt;        ErrorMessages.Add(errorMessage);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public override void ExecuteResult(ControllerContext context)&lt;br /&gt;    {&lt;br /&gt;        if (context == null)&lt;br /&gt;        {&lt;br /&gt;            throw new ArgumentNullException("context");&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        if (this.JsonRequestBehavior == JsonRequestBehavior.DenyGet &amp;amp;&amp;amp;&lt;br /&gt;            string.Equals(context.HttpContext.Request.HttpMethod, "GET", StringComparison.OrdinalIgnoreCase))&lt;br /&gt;        {&lt;br /&gt;            throw new InvalidOperationException("GET access is not allowed.  Change the JsonRequestBehavior if you need GET access.");&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        var response = context.HttpContext.Response;&lt;br /&gt;        &lt;br /&gt;        response.ContentType = string.IsNullOrEmpty(ContentType) ? "application/json" : ContentType;&lt;br /&gt;&lt;br /&gt;        if (ContentEncoding != null)&lt;br /&gt;        {&lt;br /&gt;            response.ContentEncoding = ContentEncoding;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        SerializeData(response);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;再來&lt;code&gt;SerializeData&lt;/code&gt;才是實際要序列化物件的時候要做的事情： &lt;/p&gt;&lt;pre class="brush: csharp;;highlight:[15]"&gt;protected virtual void SerializeData(HttpResponseBase response)&lt;br /&gt;{&lt;br /&gt;    if (ErrorMessages.Any())&lt;br /&gt;    {&lt;br /&gt;        var originalData = Data;&lt;br /&gt;        Data = new&lt;br /&gt;        {&lt;br /&gt;            Success = false,&lt;br /&gt;            OriginalData = originalData,&lt;br /&gt;            ErrorMessage = string.Join("\n", ErrorMessages),&lt;br /&gt;            ErrorMessages = ErrorMessages.ToArray()&lt;br /&gt;        };&lt;br /&gt;&lt;br /&gt;        response.StatusCode = 400;&lt;br /&gt;        response.TrySkipIisCustomErrors = true;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    var settings = new JsonSerializerSettings&lt;br /&gt;    {&lt;br /&gt;        ContractResolver = new CamelCasePropertyNamesContractResolver(),&lt;br /&gt;&lt;br /&gt;        Converters = new JsonConverter[]&lt;br /&gt;        {&lt;br /&gt;            new StringEnumConverter(), &lt;br /&gt;        }&lt;br /&gt;    };&lt;br /&gt;&lt;br /&gt;    response.Write(JsonConvert.SerializeObject(Data, settings));&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;可以看到，這一邊的序列化使用的就是Json .Net。那用Json .Net序列化的時候有增加一些設定： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;使用了CamelCase作為序列化出來的參數樣式  &lt;li&gt;遇到Enum的時候，序列化出來的是string的樣子而不是數字的值 &lt;/li&gt;&lt;/ol&gt;&lt;p&gt;最後，為了方便傳遞序列化物件的形態，可以在增加一個泛型的版本： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class CoreJsonResult&amp;lt;T&amp;gt; : CoreJsonResult&lt;br /&gt;{&lt;br /&gt;    public new T Data&lt;br /&gt;    {&lt;br /&gt;        get { return (T)base.Data; }&lt;br /&gt;        set { base.Data = value; }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;h1 id="WizKMOutline_1414590340061864"&gt;在BaseController增加呼叫方法&lt;/h1&gt;&lt;p&gt;還記得之前有介紹過使用BaseController。在之後使用這個CoreJsonResult，當然不希望手動new這個物件出來，因此可以再Controller增加方法，讓使用CoreJsonResult變的更加的簡單。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class BaseController : Controller&lt;br /&gt;{&lt;br /&gt;    protected CoreJsonResult JsonValidationError()&lt;br /&gt;    {&lt;br /&gt;        var result = new CoreJsonResult();&lt;br /&gt;&lt;br /&gt;        foreach (var validationError in &lt;br /&gt;    ModelState.Values.SelectMany(v =&amp;gt; v.Errors))&lt;br /&gt;        {&lt;br /&gt;            result.AddError(validationError.ErrorMessage);&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return result;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    protected CoreJsonResult JsonError(string errorMessage)&lt;br /&gt;    {&lt;br /&gt;        var result = new CoreJsonResult();&lt;br /&gt;&lt;br /&gt;        result.AddError(errorMessage);&lt;br /&gt;&lt;br /&gt;        return result;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    protected CoreJsonResult&amp;lt;T&amp;gt; JsonSuccess&amp;lt;T&amp;gt;(T data)&lt;br /&gt;    {&lt;br /&gt;        return new CoreJsonResult&amp;lt;T&amp;gt; { Data = data };&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;基本上有三個方便呼叫的方法： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;JsonValidationError - 這個是當ModelState驗證失敗的時候，呼叫的版本  &lt;li&gt;JsonError - 這個是當發生其他類型的錯誤的時候  &lt;li&gt;JsonSuccess - 這個是當要Json返回ViewModel的時候呼叫 &lt;/li&gt;&lt;/ol&gt;&lt;h1 id="WizKMOutline_1414590340061121"&gt;呼叫的範例&lt;/h1&gt;&lt;p&gt;再來看一下實際使用的時候的範例： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// POST: /Users/Edit/5&lt;br /&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Edit(Edit viewModel)&lt;br /&gt;{&lt;br /&gt;    if (!ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        return JsonValidationError();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    if (viewModel.Id == null)&lt;br /&gt;    {&lt;br /&gt;        return JsonError("Id不能是空");&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    // 如果需要以Json格式返回viewModel的時候&lt;br /&gt;    return JsonSuccess(viewModel);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;這邊給了三個方法使用的時候和情況。可以注意到的是如果是手動回傳錯誤訊息（JsonValidationError或者是JsonError），返回的http status是400，因此在前端的Ajax，也是由 error方法執行。假設，今天是系統出錯了，例如丟出了exception，前端接到的還是error的方法，這樣error就是處理和錯誤有關的，不管是驗證錯誤還是不預期的錯誤。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414590340062289"&gt;結語&lt;/h1&gt;&lt;p&gt;透過自訂的JsonResult，不只是在速度上面比原生的還快，還可以控制很多設定，例如使用camel case而不是用pascal case。 &lt;/p&gt;&lt;p&gt;有了自訂的JsonResult，前端需要和後端溝通也變的更加簡單。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8281088447958428658/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-29-JsonResult-Implement.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8281088447958428658'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8281088447958428658'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-29-JsonResult-Implement.html' title='[iThome 第七屆鐵人賽 29] Javascript和Mvc溝通 - 實作篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6010527065617841618</id><published>2014-10-29T21:45:00.000+08:00</published><updated>2014-11-30T09:49:09.008+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 28] Javascript和Mvc溝通 - 概念篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590065536796" ;=""&gt;內建的json Serializer效能不好&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590065537613" ;=""&gt;內建的json回傳格式不符合javascript的命名原則&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590065537607" ;=""&gt;錯誤訊息的傳遞&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414590065537442" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;隨著前端處理的需求越來越高和前端框架的進化，前端變的更加容易，並且給更好的使用者體驗，身為開發者通常都需要使用到AJAX的技術，避免使用者需要一直切換和刷新頁面。 &lt;/p&gt;&lt;p&gt;Mvc裡面提供了非常好框架，讓要回傳JSON變的非常方便，但是有些地方做的還是有點不夠好。 &lt;/p&gt;&lt;p&gt;因此，這一篇將會介紹Mvc處理不好的地方和如何修正的概念內容，下一篇在介紹如何實作。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414590065536796"&gt;內建的json Serializer效能不好&lt;/h1&gt;&lt;p&gt;內建Mvc所使用的json 序列化物件效能並不是太好，WebAPI意識到這個問題，因此WebAPI使用的就是比較受歡迎的JSON .Net。爲了避免效能問題，和一些等一下介紹的問題，這邊將會介紹如何提供json .net版本的JsonResult。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414590065537613"&gt;內建的json回傳格式不符合javascript的命名原則&lt;/h1&gt;&lt;p&gt;在C#裡面，通常Property使用的是Pascal Case（也就是每一個字母都是大寫，例如IsLocked），但是Javascript則是用camel case（駝峰式）。這個會造成javascript在撰寫的時候會比較變扭。 &lt;/p&gt;&lt;p&gt;因此，產生的Json應該要是camel case才對。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414590065537607"&gt;錯誤訊息的傳遞&lt;/h1&gt;&lt;p&gt;假設我們有功能需要用post的方式把資料post到Mvc，Mvc可能會回傳3種結果： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;成功&lt;br /&gt;&lt;li&gt;失敗&lt;br /&gt;&lt;li&gt;驗證失敗 &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;p&gt;其中，成功代表的是http status 200，因此Ajax的success方法會接到。但是另外兩個失敗就是問題所在。 &lt;/p&gt;&lt;p&gt;首先第一個“失敗”，這個通常都是http status 400 或者 500 表示有問題，因此ajax裡面的error方法會接到。 &lt;/p&gt;&lt;p&gt;但是第二個“驗證失敗”其實是資料面的失敗。以目前來說，通常還是會回傳http status 200，然後要自己早ajax的success方法裡面判斷，是否成功，然後在作出對應處理。 &lt;/p&gt;&lt;p&gt;這樣的邏輯其實並不好，因為既然驗證失敗了，那麼應該由ajax的error一起處理，而不是在success，因為寫在success裡面又在判斷其實讓整個javascript看起來不是那麼好閱讀。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414590065537442"&gt;結語&lt;/h1&gt;&lt;p&gt;這一篇介紹了預設的JsonResult有什麼問題，在下一篇將會介紹如何用Json .net作為序列化的library，並且如何解決上述提到的問題。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6010527065617841618/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-28-JsonResult-Problem.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6010527065617841618'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6010527065617841618'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-28-JsonResult-Problem.html' title='[iThome 第七屆鐵人賽 28] Javascript和Mvc溝通 - 概念篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3961597524640374468</id><published>2014-10-29T21:37:00.000+08:00</published><updated>2014-11-30T09:49:09.004+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 27] View相關的處理 - 框架自動增加Model Metadata</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675138753" ;=""&gt;功能描述&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675138486" ;=""&gt;ExtensibleModelMetadataProvider功能建設&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139463" ;=""&gt;IModelMetadataProcessor interface的定義&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139963" ;=""&gt;ExtensibleModelMetadataProvider主題建設&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139307" ;=""&gt;Autofac的註冊&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139498" ;=""&gt;應用&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139327" ;=""&gt;欄位自動建立placeholder&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139942" ;=""&gt;Process的部分&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139387" ;=""&gt;View的部分&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139646" ;=""&gt;最後結果&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139327" ;=""&gt;自動產生TextArea而不是input text&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414589675139400" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了什麽是Model Metadata和Mvc的Html Helper如何利用Metadata來產生開發者想要的Html內容，在這一篇將會介紹框架如何能夠提供一些基礎架設方便產生和我們view能夠對應的Model Metadata。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414589675138753"&gt;功能描述&lt;/h1&gt; &lt;p&gt;在這一篇主要會介紹框架本生會定義增加Metadata資訊的部份，然後透過interface的方式，讓產生Metadata的邏輯能夠用實作interface的方式來產生影響。 &lt;/p&gt; &lt;p&gt;介紹完框架的基礎建設之後，將會實作產生當輸入框沒有任何值的時候所顯示的placeholder資訊。也就是這個功能會自動產生WaterMark這個Metadata資訊，並且透過 EditorTemplate達到沒有值的輸入框出現placeholder的資訊。 &lt;/p&gt; &lt;p&gt;另外也會介紹另外一個範例，如何透過Property名稱把UI以TextArea方式呈現。&lt;/p&gt; &lt;h1 id="WizKMOutline_1414589675138486"&gt;ExtensibleModelMetadataProvider功能建設&lt;/h1&gt; &lt;p&gt;首先第一步是要建立好修改ModelMetadata的基礎建設。有了這個部分，才來介紹如何實際使用。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1414589675139463"&gt;IModelMetadataProcessor interface的定義&lt;/h2&gt; &lt;p&gt;首先先從會實際執行內容的interface開始看起。因為每一個application的Convention可能不一樣，因此不管需要什麼Convention的動作，都是實作這個interface來達到。 &lt;/p&gt; &lt;p&gt;先來看一下這個interface的定義： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public interface IModelMetadataProcessor&lt;br /&gt;{&lt;br /&gt;	void TransformMetadata(System.Web.Mvc.ModelMetadata modelMetadata,&lt;br /&gt;		IEnumerable&amp;lt;Attribute&amp;gt; attributes);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個interface很簡單，就是有個方法，這個方法會傳入目前產出的modelMetadata資訊和這個property所有的attribute。然後要做什麼，就看這個interface的實作要對modelMetadata 有沒有需要做任何的處理。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1414589675139963"&gt;ExtensibleModelMetadataProvider主題建設&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;有了interface的定義之後，就來看ExtensibleModelMetadataProvider如何使用那個process的interface。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們沒有必要整個處理都重寫，因此我們可以繼承&lt;code&gt;DataAnnotationsModelMetadataProvider&lt;/code&gt;然後做一些修改。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class ExtensibleModelMetadataProvider&lt;br /&gt;        : DataAnnotationsModelMetadataProvider&lt;br /&gt;{&lt;br /&gt;    private readonly IModelMetadataProcessor[] metdataProcessor;&lt;br /&gt;&lt;br /&gt;    public ExtensibleModelMetadataProvider(&lt;br /&gt;        IModelMetadataProcessor[] metadataFilters)&lt;br /&gt;    {&lt;br /&gt;        metdataProcessor = metadataFilters;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    protected override System.Web.Mvc.ModelMetadata CreateMetadata(&lt;br /&gt;        IEnumerable&amp;lt;Attribute&amp;gt; attributes,&lt;br /&gt;        Type containerType,&lt;br /&gt;        Func&amp;lt;object&amp;gt; modelAccessor,&lt;br /&gt;        Type modelType,&lt;br /&gt;        string propertyName)&lt;br /&gt;    {&lt;br /&gt;        var metadata = base.CreateMetadata(&lt;br /&gt;            attributes,&lt;br /&gt;            containerType,&lt;br /&gt;            modelAccessor,&lt;br /&gt;            modelType,&lt;br /&gt;            propertyName);&lt;br /&gt;&lt;br /&gt;        foreach (var item in metdataProcessor)&lt;br /&gt;        {&lt;br /&gt;            item.TransformMetadata(metadata, attributes);&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return metadata;&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;可以看到，會透過constructor，由DI注入目前有使用的process。然後，先用&lt;code&gt;DataAnnotationsModelMetadataProvider&lt;/code&gt;建立出基本的ModelMetadata之後，再把它呼叫到有註冊的process去做處理。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1414589675139307"&gt;Autofac的註冊&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;上面基本上框架就定義出來了，欠缺的是要和DI Container說，我們要使用新的ModelMetadataProvider。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;首先定義一個Autofac的Module，方便管理這個功能的註冊： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class ExtensibleModelMetadataModule : Autofac.Module&lt;br /&gt;{&lt;br /&gt;    protected override void Load(ContainerBuilder builder)&lt;br /&gt;    {&lt;br /&gt;        builder.RegisterType&amp;lt;ExtensibleModelMetadata.ExtensibleModelMetadataProvider&amp;gt;()&lt;br /&gt;            .As&amp;lt;ModelMetadataProvider&amp;gt;();&lt;br /&gt;&lt;br /&gt;	builder.RegisterAssemblyTypes(Assembly.GetExecutingAssembly())&lt;br /&gt;               .AsImplementedInterfaces();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;當然也別忘了Global.asax需要註冊這個Module： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;Builder.RegisterModule&amp;lt;ExtensibleModelMetadataModule&amp;gt;();&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;到這邊，整個基礎建設就準備好了，接下來來看如何應用。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414589675139498"&gt;應用&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;這邊的應用會介紹兩個： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;欄位自動建立placeholder &lt;br /&gt;&lt;li&gt;自動產生TextArea而不是input text &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1414589675139327"&gt;欄位自動建立placeholder&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;這個功能有兩個部分，一個是在產生ModelMetadata的時候，有一個欄位叫做&lt;code&gt;Watermark&lt;/code&gt;。這個欄位將會被用來放placeholder的資訊。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;另外一個部分是需要寫一個EditorTemplates，這樣&lt;code&gt;Watermark&lt;/code&gt;的值才會被用到。 &lt;/p&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1414589675139942"&gt;Process的部分&lt;/h3&gt;&lt;pre class="brush: csharp;"&gt;public class PlaceholderProcess : IModelMetadataProcessor&lt;br /&gt;{&lt;br /&gt;    public void TransformMetadata(System.Web.Mvc.ModelMetadata modelMetadata, &lt;br /&gt;        IEnumerable&amp;lt;Attribute&amp;gt; attributes)&lt;br /&gt;    {&lt;br /&gt;        if (string.IsNullOrEmpty(modelMetadata.PropertyName) == false &amp;amp;&amp;amp;&lt;br /&gt;                string.IsNullOrEmpty(modelMetadata.Watermark))&lt;br /&gt;        {&lt;br /&gt;            modelMetadata.Watermark = "請輸入" + modelMetadata.DisplayName + "...";&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊程式碼很簡單，先判斷目前傳進來的欄位有沒有名字，再來就是有沒有被設定過WaterMark。如果&lt;em&gt;有&lt;/em&gt;欄位並且，&lt;em&gt;沒有&lt;/em&gt;設定過WaterMark，才用預設的。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;這一這邊的判斷，有判斷Watermark本身是否有值。這個的好處是，假設今天有幾個欄位和其他欄位不一樣，可能會直接用Attribute定義在Property上面，那麼就以Property的Attribute 為主。這裡的Process，只處理通用型符合Convention邏輯的內容。 &lt;/div&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1414589675139387"&gt;View的部分&lt;/h3&gt;&lt;br /&gt;&lt;p&gt;基本上就是在&lt;kbd&gt;~Views/Shared/EditorTemplates/string.cshtml&lt;/kbd&gt;增加如下內容： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;@model string&lt;br /&gt;@Html.TextBox("", ViewData.TemplateInfo.FormattedModelValue,&lt;br /&gt;        new { @class = "form-control", &lt;br /&gt;			placeholder = ViewData.ModelMetadata.Watermark })&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1414589675139646"&gt;最後結果&lt;/h3&gt;&lt;br /&gt;&lt;p&gt;呈現就會變成： &lt;/p&gt;&lt;br /&gt;&lt;p&gt;&lt;a href="http://lh5.ggpht.com/-A8EovO-Bb9s/VFDuah5WSOI/AAAAAAAAOJg/L7m4CmfpSzE/s1600-h/image%25255B2%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-XMVXqWLmxNk/VFDubSQadgI/AAAAAAAAOJo/hulVxxPGRac/image_thumb.png?imgmax=800" width="411" height="55"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt;&lt;br&gt;&lt;/figure&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1414589675139327"&gt;自動產生TextArea而不是input text&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;這個部分的功能需要先知道欄位的Convention是什麼，因此我這邊假設所有的TextArea的Property名稱都需要包含TextArea這個字，因此： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class TextAreaByNameProcess : IModelMetadataProcessor&lt;br /&gt;{&lt;br /&gt;    private readonly HashSet&amp;lt;string&amp;gt; textAreaFieldNames =&lt;br /&gt;            new HashSet&amp;lt;string&amp;gt;&lt;br /&gt;                {&lt;br /&gt;                    "textarea"&lt;br /&gt;                };&lt;br /&gt;&lt;br /&gt;    public void TransformMetadata(System.Web.Mvc.ModelMetadata modelMetadata,&lt;br /&gt;                    IEnumerable&amp;lt;Attribute&amp;gt; attributes)&lt;br /&gt;    {&lt;br /&gt;        if (string.IsNullOrEmpty(modelMetadata.PropertyName) == false &amp;amp;&amp;amp;&lt;br /&gt;            string.IsNullOrEmpty(modelMetadata.DataTypeName) &amp;amp;&amp;amp;&lt;br /&gt;            textAreaFieldNames.Contains(modelMetadata.PropertyName.ToLower()))&lt;br /&gt;        {&lt;br /&gt;            modelMetadata.DataTypeName = "MultilineText";&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊基本上就是在沒有設定任何DataType的情況下，並且property名字符合清單的設定，就把他的DataType設定成為"MultilineText"，而&lt;code&gt;Html.EditorFor&lt;/code&gt;，看到這個就會用TextArea來做html而不是input text。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414589675139400"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;通過開發團隊的Convention和ExtensibleModelMetadataProvider，可以讓UI呈現上面更一致（因為不會因為忘記加Attribute就導致Placeholder出不來），並且減少ViewModel上面的Attribute的使用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;而使用Process作為實際的處理，讓整個要處理的邏輯變得彈性話，可以依照不同團隊的需求打造不同的處理。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;有了ExtensibleModelMetadataProvier簡化一些View的工作之後，我們在下一篇來看一下現在很常用到的內容，也就是用Ajax和Server溝通可能遇到什麼問題的處理。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3961597524640374468/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-27-ModelMetadata-Implement.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3961597524640374468'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3961597524640374468'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-27-ModelMetadata-Implement.html' title='[iThome 第七屆鐵人賽 27] View相關的處理 - 框架自動增加Model Metadata'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-XMVXqWLmxNk/VFDubSQadgI/AAAAAAAAOJo/hulVxxPGRac/s72-c/image_thumb.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3550176774150098327</id><published>2014-10-29T21:34:00.000+08:00</published><updated>2014-11-30T09:49:08.993+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 26] View相關的處理 - Model的Metadata介紹</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414589078905794" ;=""&gt;Model Metadata概述&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414589078915297" ;=""&gt;Model Metadata是如何產生？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414589078915495" ;=""&gt;知道ModelMetadata有和意義？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414589078915126" ;=""&gt;如何做到&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1414589078915850" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;Service層的部份到目前為止已經介紹了基本的CRUD，搜索方面的自動處理和一些資料驗證的部份。是時候來切換一下看在View的部份框架還能夠幫到什麽。 &lt;/p&gt;&lt;p&gt;在這一篇將會介紹所謂的Model Metadata，並且概念上來說如何用框架打造一些好用的功能，並且在下一篇來實作。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414589078905794"&gt;Model Metadata概述&lt;/h1&gt;&lt;p&gt;首先來看一下所謂的Model Metadata。當我們傳一個ViewModel到View的時候，Mvc其實有做一些處理，透過Reflection的方式產出這個ViewModel的Model Metadata。 &lt;/p&gt;&lt;p&gt;有了這些Model Metadata，在View才能夠使用一些Html的Helper來產生一些html。例如，&lt;code&gt;Html.ValidationMessageFor&lt;/code&gt;就會依照Model Metadata的&lt;code&gt;ModelStateDictionary&lt;/code&gt;來顯示欄位的錯誤訊息。 &lt;/p&gt;&lt;p&gt;另外一個例子就是，像我們在ViewModel欄位會定義&lt;code&gt;DisplayAttribute&lt;/code&gt;讓使用&lt;code&gt;Html.DisplayFor&lt;/code&gt;的時候，顯示的名稱不是Property欄位名稱，而是 &lt;code&gt;DisplayAttribute&lt;/code&gt;設定的內容。 &lt;/p&gt;&lt;p&gt;Html Helper能夠得到這些內容，其實都是從Model Metadata取得資料。因此，換個角度想，如果我們能夠在Model State裡面塞一些資訊，在View裡面就可以變得更加簡單，因此我們就來看一下框架要做到的效果是什麽。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414589078915297"&gt;Model Metadata是如何產生？&lt;/h1&gt;&lt;p&gt;Model Metadata基本上就是一個ViewModel欄位相關資訊，而如何告訴這些資訊是透過&lt;code&gt;DataAnnoationation&lt;/code&gt;的Attribute來做到。 &lt;/p&gt;&lt;figure&gt; &lt;p&gt;&lt;a href="http://lh4.ggpht.com/-6bnX-i1JuQY/VFDsNJ5rpaI/AAAAAAAAOI8/9MRxd_Uk9cM/s1600-h/image%25255B4%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-h0Frt-XTee8/VFDsOS0dAzI/AAAAAAAAOJE/vuWiykmNPNM/image_thumb%25255B2%25255D.png?imgmax=800" width="527" height="248"&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;figcaption&gt;ModelMetadata如何產生&lt;/figcaption&gt; &lt;/figure&gt;&lt;/p&gt;&lt;p&gt;上面這張圖的上半段是介紹一般我們定義ViewModel的DataAnnotation之後，在View的呈現，Mvc的HtmlHelper就會幫我們產生出DataAnnotation所做的設定內容。 &lt;/p&gt;&lt;p&gt;下面則是基本Mvc在背後幫我們做的事情。首先，在Mvc有一個&lt;code&gt;ModelMetadataProvider&lt;/code&gt;（準確一點描述應該是一個&lt;code&gt;DataAnnotationsModelMetadataProvider&lt;/code&gt;），會依照DataAnnotation產生出ModelMetadata。 &lt;/p&gt;&lt;p&gt;有了這個ModelMetadata，HtmlHelper和EditorTemplates，就可以用這些資訊，顯示出這些內容。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414589078915495"&gt;知道ModelMetadata有和意義？&lt;/h1&gt;&lt;p&gt;到目前為止我們對於ModelMetadata有些概念之後，下一個問題就是，這個對於我們有什麼幫助？ &lt;/p&gt;&lt;p&gt;我們先來思考一個問題，假設今天我有一個欄位代表著Email，請問我需要做什麼Mvc才會產生出html 5 的 email input？ &lt;/p&gt;&lt;p&gt;答案是我們需要對哪一個property增加一個&lt;code&gt;EmailAttribute&lt;/code&gt;。 &lt;/p&gt;&lt;p&gt;可是換一個角度想，如果一個欄位代表是email，這個欄位通常名稱一定會是xxxEmail，甚至可能就叫做Email。我們能不能夠就依照這個欄位名字決定讓Mvc產生出html 5的email Input？而不需要自己額外用一個EmailAttribute說這是一個Email。 &lt;/p&gt;&lt;p&gt;或者說假設今天我需要產生出來的表單是以TextArea顯示而不是用input的text顯示，以目前Mvc來說我們需要把Property加上DataTypeAttribute設定為“MultilineText”就可以。 &lt;/p&gt;&lt;p&gt;假設我們整個團隊的Property命名規則就是，如果要用TextArea，Property 名稱一定要有TextArea，例如ContentTextArea，那不能夠依照Property名稱來決定這個欄位是TextArea嗎？ &lt;/p&gt;&lt;p&gt;上面舉得兩個例子，其實都是在提到一個內容，那就是，UI顯示的內容可以進一步依照我們團隊自己的Convention（習慣），例如NamingConvention（命名習慣）去產生出正確的UI 內容，而不需要而外多加設定。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414589078915126"&gt;如何做到&lt;/h1&gt;&lt;p&gt;概念上面如下圖： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.ggpht.com/-yNZs6AvrsmA/VFDsPMfyEFI/AAAAAAAAOJM/q48jJnP_LOQ/s1600-h/image%25255B9%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-YnY7BLGm8kc/VFDsQDYHdxI/AAAAAAAAOJU/rR3cQKQgBhQ/image_thumb%25255B5%25255D.png?imgmax=800" width="507" height="230"&gt;&lt;/a&gt;&lt;figcaption&gt;ExtensibleModelMetadataProvider示意圖&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;橘色的部分是框架的建設造的。基本上，我們會有一個自訂的ModelMetadataProvider。這個ExtensibleModelMetadataProvider會由DI注入一些Process的實作，這些實作才是實際上對ModelMetadata的處理。 &lt;/p&gt;&lt;p&gt;有了這些Process的處理之後，ModelMetadata就會被改變。這個時候View顯示的時候就會依照這些ModelMetadata做呈現。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1414589078915850"&gt;結語&lt;/h1&gt;&lt;p&gt;這一篇介紹了ModelMetadata的概念。有了ModelMetadata作為產生UI的一些額外資訊，在框架可以用Convention的方式來修改ModelMetadata達到產生對應的UI呈現。 &lt;/p&gt;&lt;p&gt;在下一篇將會進入實際的實作。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3550176774150098327/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-26-ModelMetadata-Intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3550176774150098327'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3550176774150098327'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-26-ModelMetadata-Intro.html' title='[iThome 第七屆鐵人賽 26] View相關的處理 - Model的Metadata介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh3.ggpht.com/-h0Frt-XTee8/VFDsOS0dAzI/AAAAAAAAOJE/vuWiykmNPNM/s72-c/image_thumb%25255B2%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1358645160143311022</id><published>2014-10-24T21:37:00.000+08:00</published><updated>2014-10-24T21:39:52.052+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 25] 搜索頁面 - Service層的工作 - 搜索在進化</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414157688421962" ;=""&gt;以Like的方式搜索&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414157688440242" ;=""&gt;Like搜索帶來的問題&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414157688440435" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了如何顯示搜索表單之後，一個基本的通用搜索功能就完成了。 &lt;/p&gt; &lt;p&gt;不過，其實有些部份還可以在加強，舉例來說，目前搜索是一定要完全符合才搜索的到，但是這樣就失去了很多好處，畢竟如果完全符合才搜索的到，那基本上等於搜索不到。 &lt;/p&gt; &lt;p&gt;還有，假設今天我們搜索結果是要給使用者看的，通常都會有所謂的上下架起訖時間和是否啟用，當符合條件才可以看，這一部份其實自動搜索也可以幫到我們。 &lt;/p&gt; &lt;p&gt;因此這一篇將會介紹未來如何在擴充自動搜索功能和在搜索做一些客制處理，符合只搜索出前臺使用者看的條件。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414157688421962"&gt;以Like的方式搜索&lt;/h1&gt; &lt;p&gt;第一個要處理的是針對string類型的用like方式做搜索。要用Like方式做搜索，就要用到Linq裡面的&lt;code&gt;Contain()&lt;/code&gt;語法： &lt;/p&gt;&lt;pre class="brush: csharp; highlight:[24,25]"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照Search Form ViewModel的值來設定Where的內容。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;通常是EF的Entity&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="data"&amp;gt;要被處理的資料&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="searchForm"&amp;gt;Search Form Viewmodel的值&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;有增加OrderBy的IQueryable&amp;lt;/returns&amp;gt;&lt;br /&gt;public static IQueryable&amp;lt;T&amp;gt; DynamicWhere&amp;lt;T&amp;gt;(this IQueryable&amp;lt;T&amp;gt; data, ISearchFormViewModelBase searchForm)&lt;br /&gt;{&lt;br /&gt;	var properties = searchForm.GetType().GetProperties&lt;br /&gt;						(BindingFlags.DeclaredOnly | BindingFlags.Instance | BindingFlags.Public)&lt;br /&gt;						.Where(x =&amp;gt; (x.GetGetMethod().GetBaseDefinition() == x.GetGetMethod())).ToArray(); // where 條件是用來避免override的property （例如：OrderByColumnName）也被算進去。&lt;br /&gt;	&lt;br /&gt;	string whereCalus = string.Empty;&lt;br /&gt;	string andOperator = string.Empty;&lt;br /&gt;	List&amp;lt;object&amp;gt; propertiesValue = new List&amp;lt;object&amp;gt;();&lt;br /&gt;	&lt;br /&gt;	for (int i = 0; i &amp;lt; properties.Length; i++)&lt;br /&gt;	{&lt;br /&gt;		var value = properties[i].GetValue(searchForm);&lt;br /&gt;	&lt;br /&gt;		if (string.IsNullOrEmpty(value.NonNullString()) == false)&lt;br /&gt;		{&lt;br /&gt;			whereCalus = string.Format("{0}{1} {2}.Contains(@{3})", whereCalus, andOperator,&lt;br /&gt;								properties[i].Name, propertiesValue.Count);&lt;br /&gt;	&lt;br /&gt;			andOperator = " and";&lt;br /&gt;	&lt;br /&gt;			propertiesValue.Add(value);&lt;br /&gt;		}&lt;br /&gt;	}&lt;br /&gt;	&lt;br /&gt;	if (string.IsNullOrEmpty(whereCalus) == false)&lt;br /&gt;	{&lt;br /&gt;		data = data.Where(whereCalus, propertiesValue.ToArray());&lt;br /&gt;	}&lt;br /&gt;	&lt;br /&gt;	return data;&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;被高亮的行數就是和之前不一樣的地方。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414157688440242"&gt;Like搜索帶來的問題&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;上面修改完成之後，假設去執行，搜索都正常，但是如果有欄位是數值形態(int)會出錯，因為int是不能夠做Like的。因此，修改成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;...&lt;br /&gt;&lt;br /&gt;for (int i = 0; i &amp;lt; properties.Length; i++)&lt;br /&gt;{&lt;br /&gt;	var value = properties[i].GetValue(searchForm);&lt;br /&gt;&lt;br /&gt;	if (string.IsNullOrEmpty(value.NonNullString()) == false)&lt;br /&gt;	{&lt;br /&gt;		// 如果形態是string，就用Like方式查詢&lt;br /&gt;		if (properties[i].PropertyType == typeof(string))&lt;br /&gt;		{&lt;br /&gt;			whereCalus = string.Format("{0}{1} {2}.Contains(@{3})", &lt;br /&gt;									whereCalus, andOperator,&lt;br /&gt;									properties[i].Name, propertiesValue.Count);&lt;br /&gt;		}&lt;br /&gt;&lt;br /&gt;		// 如果形態是int，就用等於查詢&lt;br /&gt;		if (properties[i].PropertyType == typeof(int))&lt;br /&gt;		{&lt;br /&gt;			whereCalus = string.Format("{0}{1} {2} = @{3}", &lt;br /&gt;									whereCalus, andOperator,&lt;br /&gt;									properties[i].Name, propertiesValue.Count);&lt;br /&gt;		}&lt;br /&gt;&lt;br /&gt;		andOperator = " and";&lt;br /&gt;&lt;br /&gt;		propertiesValue.Add(value);&lt;br /&gt;	}&lt;br /&gt;}&lt;br /&gt;...&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個基本上就是多了一個判斷，如果是string，就用like方式搜索，如果是int，就用符合的方式搜索。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;未來這個其實可以在被擴充，可以透過Attribute的方式，告知要用什麼方式做搜索。或許有些欄位是要做某個範圍之內的值，或者大於小於等。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414157688440435"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;這一篇主要介紹的是在未來如何擴充自動搜索的部分。其實，自動搜索可以千變萬化，除了基本的一些大小於搜索，有時候我們可能會依照一個欄位的flag去決定是否要顯示，或者上下架時間。這些都可以透過自動搜索來做處理，而前面呼叫Service的不用記得需要加入這些預設的搜索條件，因為Service層已經做好了。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1358645160143311022/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-25-IndexPage-AutomaticSearch-improved.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1358645160143311022'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1358645160143311022'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-25-IndexPage-AutomaticSearch-improved.html' title='[iThome 第七屆鐵人賽 25] 搜索頁面 - Service層的工作 - 搜索在進化'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8163811029864697279</id><published>2014-10-23T21:41:00.000+08:00</published><updated>2014-11-30T09:49:09.029+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 24] 搜索頁面 - Service層的工作 - View方面的處理</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414071540834174" ;=""&gt;功能描述&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414071540834502" ;=""&gt;顯示SearchViewModelBase的EditorTemplate&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414071540834873" ;=""&gt;把SearchViewModel內容轉成RouteValueDictionary的Helper&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414071540834285" ;=""&gt;為搜索結果產生分頁&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1414071540834886" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了Service如何自動處理搜索和Controller如何呼叫這個Service之後，接下來就要看view將會如何呼叫，並且透過一些Helper方便產生有正確RouteValue的連接。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1414071540834174"&gt;功能描述&lt;/h1&gt; &lt;p&gt;先看一下這一篇會介紹的內容，再來才詳細的描述。在這一篇會有以下的內容： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;專門顯示SearchViewModelBase的EditorTemplate - 方便有一個統一的搜索顯示畫面  &lt;li&gt;Helper方便產生SearchViewModel看的懂的RouteValue  &lt;li&gt;PagedList.Mvc 顯示搜索結果的分頁清單 &lt;/li&gt;&lt;/ol&gt;  &lt;h1 id="WizKMOutline_1414071540834502"&gt;顯示SearchViewModelBase的EditorTemplate&lt;/h1&gt; &lt;p&gt;通常來說，一個網站裡面的搜索風格會一致。也就是說，基本的內容都一樣，但是不同之處在於實際的搜索欄位，才會有整個網站的一致性。 &lt;/p&gt; &lt;p&gt;透過搭配EditorTemplate，這個能夠很容易的做到。 &lt;/p&gt; &lt;p&gt;首先，會在&lt;code&gt;Views -&amp;gt; Shared -&amp;gt;EditorTemplates -&amp;gt;SearchFormViewModelBase.cshtml&lt;/code&gt;建立出搜索ViewModel的一個Template，裡面的內容如下： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;@model SearchFormViewModelBase&lt;br /&gt;@{&lt;br /&gt;	@*用Reflection取得目前這個ViewModel屬於搜索條件的Properties Name - &lt;br /&gt;	注意，這裡並不包含BaseViewModel的Property，而是只有繼承下來的Property&lt;br /&gt;	*@&lt;br /&gt;    var searchablePropertiesName = ReflectionHelper.&lt;br /&gt;									GetPropertiesOfCurrentType(Model.GetType()).&lt;br /&gt;									Select(x =&amp;gt; x.Name);&lt;br /&gt;    var properties = ViewData.ModelMetadata.Properties.&lt;br /&gt;						Where(x =&amp;gt; searchablePropertiesName.Contains(x.PropertyName));&lt;br /&gt;}&lt;br /&gt;@if(properties.Count() &amp;gt; 0)&lt;br /&gt;{ &lt;br /&gt;    &amp;lt;h3 class="box-title"&amp;gt;搜索條件&amp;lt;/h3&amp;gt;&lt;br /&gt;    @using (Html.BeginForm())&lt;br /&gt;    {&lt;br /&gt;        &amp;lt;div class="form-horizontal"&amp;gt;&lt;br /&gt;            @foreach (var prop in properties)&lt;br /&gt;            {&lt;br /&gt;		@*因為搜索的ViewModel屬於Index ViewModel的一個Property，因此需要加上Prefix避免ModelBinding不到 &lt;br /&gt;		- Prefix就是SearchViewModel在Index裡面的名字 - SearchForm*@&lt;br /&gt;&lt;br /&gt;		@*假設這個搜索欄位是一個下拉選單，在ViewData應該會有資料，要不然就是一般的輸入框*@	&lt;br /&gt;                if (ViewData.ContainsKey(PagingHelper.PropertyNamePrefix + prop.PropertyName))&lt;br /&gt;                {&lt;br /&gt;                    &amp;lt;div class="form-group"&amp;gt;&lt;br /&gt;                        @Html.Label(prop.PropertyName, &lt;br /&gt;							htmlAttributes: new { @class = "control-label col-md-4" })&lt;br /&gt;                        &amp;lt;div class="col-md-8"&amp;gt;&lt;br /&gt;                            @Html.DropDownList(prop.PropertyName,&lt;br /&gt;							ViewData[PagingHelper.PropertyNamePrefix &lt;br /&gt;								+ prop.PropertyName] as IEnumerable&amp;lt;SelectListItem&amp;gt;, &lt;br /&gt;								"", htmlAttributes: new { @class = "form-control" })&lt;br /&gt;                        &amp;lt;/div&amp;gt;&lt;br /&gt;                    &amp;lt;/div&amp;gt;&lt;br /&gt;                }&lt;br /&gt;                else&lt;br /&gt;                {&lt;br /&gt;                    &amp;lt;div class="form-group"&amp;gt;&lt;br /&gt;                        @Html.Label(prop.PropertyName, &lt;br /&gt;							htmlAttributes: new { @class = "control-label col-md-4" })&lt;br /&gt;                        &amp;lt;div class="col-md-8"&amp;gt;&lt;br /&gt;                            @Html.Editor(prop.PropertyName, &lt;br /&gt;							new { htmlAttributes = new { @class = "form-control" } })&lt;br /&gt;                        &amp;lt;/div&amp;gt;&lt;br /&gt;                    &amp;lt;/div&amp;gt;&lt;br /&gt;                }&lt;br /&gt;            }&lt;br /&gt;            @Html.HiddenFor(x =&amp;gt; x.Page)&lt;br /&gt;            @Html.HiddenFor(x =&amp;gt; x.PageSize)&lt;br /&gt;            &amp;lt;div class="box-footer"&amp;gt;&lt;br /&gt;                &amp;lt;input type="submit" value="搜索" class="btn btn-default" /&amp;gt;&lt;br /&gt;            &amp;lt;/div&amp;gt;&lt;br /&gt;        &amp;lt;/div&amp;gt;&lt;br /&gt;    }          &lt;br /&gt;}&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;假設搜索欄位有什麼特別的實際，可以直接在這裡面修改，最後，每一頁要呈現搜索條件只需要在Index.cshtml寫： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;@Html.EditorFor(x =&amp;gt; x.SearchForm)&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414071540834873"&gt;把SearchViewModel內容轉成RouteValueDictionary的Helper&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;有時候如果需要產生目前的搜索內容的值用作於產生鏈接的時候，一個Helper產生RouteValueDictionary是非常重要的。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;可以在定義一個如下的Helper： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照SearchModel的值，產生出RouteValueDictionary&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="model"&amp;gt;SearchModel的Instance&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="rvd"&amp;gt;需要增加到RouteValueDictionary的額外值&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;返回產生的RouteValueDictionary&amp;lt;/returns&amp;gt;&lt;br /&gt;public static RouteValueDictionary GenRVDForSearchModel(object model, &lt;br /&gt;		RouteValueDictionary rvd = null)&lt;br /&gt;{&lt;br /&gt;    if (rvd == null)&lt;br /&gt;    {&lt;br /&gt;        rvd = new RouteValueDictionary();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    var properties = ReflectionHelper.GetPropertiesOfCurrentType(model.GetType());&lt;br /&gt;&lt;br /&gt;    for (int i = 0; i &amp;lt; properties.Length; i++)&lt;br /&gt;    {&lt;br /&gt;        var value = properties[i].GetValue(model);&lt;br /&gt;&lt;br /&gt;        if (string.IsNullOrEmpty(value.NonNullString()) == false)&lt;br /&gt;        {&lt;br /&gt;            rvd.Add(PropertyNamePrefix + properties[i].Name, value);&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return rvd;&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;基本上就是把Model的內容產生對應的RouteValueDictionary。如果還不清楚這個方法的作用，接下來介紹建立分頁鏈接的時候就會清楚的看到如何使用這個方法。 &lt;br /&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414071540834285"&gt;為搜索結果產生分頁&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;&lt;code&gt;PagedList.Mvc&lt;/code&gt;裡面有一個Helper可以方便產生分頁： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; @Html.PagedListPager(Model.Result, page =&amp;gt;&lt;br /&gt;{&lt;br /&gt;    return Url.Action("Index", new {SearchForm.page = page});&lt;br /&gt;});&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;基本上這個分頁的Helper會幫忙處理一些基本的Layout，我們需要做的就是告訴他每一個分頁連接如何產生即可。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;不過這邊要注意到，上面的範例是當搜索條件不存在的情況下，這個連接是對的，如果在搜索條件有作用的情況下，每一個分頁的連接應該要包括目前的搜索條件才對。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，這個時候上一篇提到的Helper就有幫助，不過因為每一次建立的分頁會把要建立的分頁頁數帶進來，因此，需要建立新的Helper，來包住上面介紹產生RouteValueDictionary的Helper： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照Search Form來產生 Route Value Dictionary&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="model"&amp;gt;Search Form的ViewModel&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="page"&amp;gt;那一頁&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="pageSize"&amp;gt;頁數&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;&lt;br /&gt;/// 返回產生的RouteValueDictionary&lt;br /&gt;/// &amp;lt;/returns&amp;gt;&lt;br /&gt;public static RouteValueDictionary GenRVDBaseOnSearchFormModel(SearchFormViewModelBase model, &lt;br /&gt;		int? page = null, int? pageSize = null)&lt;br /&gt;{&lt;br /&gt;    RouteValueDictionary rvd = new RouteValueDictionary();&lt;br /&gt;&lt;br /&gt;    rvd.Add(PropertyNamePrefix + "Page", page ?? model.Page);&lt;br /&gt;    rvd.Add(PropertyNamePrefix + "PageSize", pageSize ?? model.PageSize);&lt;br /&gt;&lt;br /&gt;    return GenRVDForSearchModel(model, rvd);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;有了上面的Helper之後，我們產生分頁的方法就能夠變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;@Html.PagedListPager(Model.Result, page =&amp;gt;&lt;br /&gt;    {&lt;br /&gt;        return Url.Action("Index",&lt;br /&gt;			PagingHelper.GenRVDBaseOnSearchFormModel(Model.SearchForm, page));&lt;br /&gt;    });&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1414071540834886"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;到目前為止，在框架自動處理搜索的部分從Controller，到Service層到View裡面的使用都介紹了。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;相信了解之後，對於要做基本的搜索不會有太大問題。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;不過，在實務上面，Service層的自動搜索在使用上面還是會有些問題，最大的問題是，目前搜索只支援完全符合。但是，這樣的搜索一點都不好用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，在下一篇，將會介紹如何把自動處理搜索的部分在進化一步。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8163811029864697279/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-24-IndexPage-AutomaticSsearch-view.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8163811029864697279'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8163811029864697279'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-24-IndexPage-AutomaticSsearch-view.html' title='[iThome 第七屆鐵人賽 24] 搜索頁面 - Service層的工作 - View方面的處理'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3098834327240826242</id><published>2014-10-15T23:24:00.000+08:00</published><updated>2014-10-15T23:28:05.857+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 23] 搜索頁面 - Service層的工作 - 自動套用一般搜索條件</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549529" ;=""&gt;Service層的處理&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549267" ;=""&gt;Service處理搜索的方法&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549636" ;=""&gt;Reflection取得欄位值和組成搜索條件&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549424" ;=""&gt;做搜索和用AutoMapper對應&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549569" ;=""&gt;Controller呼叫搜索&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413386529549363" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了如何動態產生Linq條件之後，在這一篇，將會透過Reflection和Dynamic Linq Query來讓Service層，能夠在不做任何事情的情況下，自動對資料做過濾，並且轉成對應的ViewModel配上分頁。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413386529549529"&gt;Service層的處理&lt;/h1&gt; &lt;p&gt;在處理搜索的部份，Service層將會需要： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;透過Reflection取得要搜索的欄位 - 這邊要記得是不要base的欄位（不要那些例如目前在第幾頁，和一頁幾筆的那種）  &lt;li&gt;依照Reflection的欄位和Dynamic LInq Query組成搜索條件  &lt;li&gt;做搜索並且用Automapper把Entity 對應到ViewModel搭配分頁 &lt;/li&gt;&lt;/ol&gt;  &lt;h2 id="WizKMOutline_1413386529549267"&gt;Service處理搜索的方法&lt;/h2&gt; &lt;p&gt;首先，之前的那個&lt;code&gt;GenericService&lt;/code&gt;將會多一個方法叫做&lt;code&gt;ProcessIndexViewModel&lt;/code&gt; &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 通用行的Service layer實作&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;主要的Entity形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public class GenericService&amp;lt;T&amp;gt; : IService&amp;lt;T&amp;gt;&lt;br /&gt;    where T : class&lt;br /&gt;{&lt;br /&gt;....&lt;br /&gt;	/// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 處理在Index ViewModel所需要做的事情&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TSearchForm"&amp;gt;搜索form的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TPageResult"&amp;gt;搜索結果的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="searchViewModel"&amp;gt;搜索相關的viewmodel&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="includes"&amp;gt;需要Include進來的其他Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    public virtual void ProcessIndexViewModel&amp;lt;TSearchForm, TPageResult&amp;gt;(ISearchViewModelBase&amp;lt;TSearchForm, TPageResult&amp;gt; searchViewModel,  &lt;br /&gt;        params System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;[] includes) &lt;br /&gt;        where TSearchForm : ISearchFormViewModelBase, new()&lt;br /&gt;    {&lt;br /&gt;        var data = db.Repository&amp;lt;T&amp;gt;().Reads();&lt;br /&gt;&lt;br /&gt;        foreach (var item in includes)&lt;br /&gt;        {&lt;br /&gt;            data.Include(item);&lt;br /&gt;        }&lt;br /&gt;		&lt;br /&gt;		SearchViewModelProcess.ApplySearchForm&amp;lt;T, TSearchForm, TPageResult&amp;gt;(data,&lt;br /&gt;                    searchViewModel);&lt;br /&gt;    }&lt;br /&gt;....&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;基本上&lt;code&gt;ProcessIndexViewModel&lt;/code&gt;會接受一個之前定義過的&lt;code&gt;SearchViewModelBase&lt;/code&gt;的形態，同時假設搜索的內容需要做到Include的話，可以設定。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;再來就詳細看一下實際做搜索的邏輯。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 把Search Form Viewmodel的OrderBy和Where條件apply上去。&lt;br /&gt;/// 會把最終內容儲存到SearchViewModelBase.Result裡面。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;EF 的Entity&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TSearchForm"&amp;gt;Search Form ViewModel的Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TPageResult"&amp;gt;Search結果的VieModel type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="data"&amp;gt;原始的IQueryable&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="searchForm"&amp;gt;Search Form ViewModel&amp;lt;/param&amp;gt;&lt;br /&gt;public static void ApplySearchForm&amp;lt;T, TSearchForm, TPageResult&amp;gt;(IQueryable&amp;lt;T&amp;gt; data, ISearchViewModelBase&amp;lt;TSearchForm, TPageResult&amp;gt; searchForm)&lt;br /&gt;     where TSearchForm : ISearchFormViewModelBase, new()&lt;br /&gt;{&lt;br /&gt;    data = data.DynamicWhere(searchForm.SearchForm);&lt;br /&gt;&lt;br /&gt;    ApplyOrderByAndToPageResult&amp;lt;T, TSearchForm, TPageResult&amp;gt;(data, searchForm);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;code&gt;ApplySearchForm&lt;/code&gt;會在呼叫兩個方法，一個是下搜索條件，一個是做實際的搜索的呼叫AutoMapper，先來看一下實際的搜索。 &lt;br /&gt;&lt;h2 id="WizKMOutline_1413386529549636"&gt;Reflection取得欄位值和組成搜索條件&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照Search Form ViewModel的值來設定Where的內容。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;通常是EF的Entity&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="data"&amp;gt;要被處理的資料&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="searchForm"&amp;gt;Search Form Viewmodel的值&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;有增加OrderBy的IQueryable&amp;lt;/returns&amp;gt;&lt;br /&gt;public static IQueryable&amp;lt;T&amp;gt; DynamicWhere&amp;lt;T&amp;gt;(this IQueryable&amp;lt;T&amp;gt; data, ISearchFormViewModelBase searchForm)&lt;br /&gt;{&lt;br /&gt;    var properties = searchForm.GetType().GetProperties&lt;br /&gt;						(BindingFlags.DeclaredOnly | BindingFlags.Instance | BindingFlags.Public)&lt;br /&gt;                        .Where(x =&amp;gt; (x.GetGetMethod().GetBaseDefinition() == x.GetGetMethod())).ToArray(); // where 條件是用來避免override的property （例如：OrderByColumnName）也被算進去。&lt;br /&gt;&lt;br /&gt;    string whereCalus = string.Empty;&lt;br /&gt;    string andOperator = string.Empty;&lt;br /&gt;    List&amp;lt;object&amp;gt; propertiesValue = new List&amp;lt;object&amp;gt;();&lt;br /&gt;&lt;br /&gt;    for (int i = 0; i &amp;lt; properties.Length; i++)&lt;br /&gt;    {&lt;br /&gt;        var value = properties[i].GetValue(searchForm);&lt;br /&gt;&lt;br /&gt;        if (string.IsNullOrEmpty(value.NonNullString()) == false)&lt;br /&gt;        {&lt;br /&gt;            whereCalus = string.Format("{0}{1} {2} = @{3}", whereCalus, andOperator,&lt;br /&gt;                    properties[i].Name, propertiesValue.Count);&lt;br /&gt;&lt;br /&gt;            andOperator = " and";&lt;br /&gt;&lt;br /&gt;            propertiesValue.Add(value);&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    if (string.IsNullOrEmpty(whereCalus) == false)&lt;br /&gt;    {&lt;br /&gt;        data = data.Where(whereCalus, propertiesValue.ToArray());&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return data;&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊注意到核心是取得&lt;code&gt;properties&lt;/code&gt;的部分，只需要後來繼承的欄位，和注意不要取得複寫的欄位，例如&lt;code&gt;OrderByColumnName&lt;/code&gt;。之後，就是用Dynamic Linq Query來組裝搜索條件。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;執行完了&lt;code&gt;DynamicWhere&lt;/code&gt;，就有了搜索的條件，接下來就是執行搜索條件並且轉成對應的ViewModel和分頁。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413386529549424"&gt;做搜索和用AutoMapper對應&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Apply Orderby並且把最後結果塞到SearchViewModelBase.Result裡面。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;EF 的Entity&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TSearchForm"&amp;gt;Search Form ViewModel的Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TPageResult"&amp;gt;Search結果的VieModel type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="data"&amp;gt;原始的IQueryable&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="searchForm"&amp;gt;Search Form ViewModel&amp;lt;/param&amp;gt;&lt;br /&gt;private static void ApplyOrderByAndToPageResult&amp;lt;T, TSearchForm, TPageResult&amp;gt;(IQueryable&amp;lt;T&amp;gt; data, &lt;br /&gt;    ISearchViewModelBase&amp;lt;TSearchForm, TPageResult&amp;gt; searchForm) where TSearchForm : ISearchFormViewModelBase, new()&lt;br /&gt;{&lt;br /&gt;    if (searchForm.SearchForm.IsAscending)&lt;br /&gt;    {&lt;br /&gt;        data = data.OrderBy(searchForm.SearchForm.OrderByColumnName);&lt;br /&gt;    }&lt;br /&gt;    else&lt;br /&gt;    {&lt;br /&gt;        data = data.OrderBy(searchForm.SearchForm.OrderByColumnName + " descending");&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    searchForm.Result = data.Project().To&amp;lt;TPageResult&amp;gt;().ToPagedList(searchForm.SearchForm.Page, searchForm.SearchForm.PageSize);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;可以看到，先依照欄位做排序(這邊需要注意到&lt;code&gt;OrderBy&lt;/code&gt;也是Dynamic Linq Query的方法)，然後在把資料轉型把結果放到Result裡面。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413386529549569"&gt;Controller呼叫搜索&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;在前面呼叫就變得比較簡單： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public ActionResult Index(Index searchViewModel)&lt;br /&gt;{&lt;br /&gt;    service.ProcessIndexViewModel(searchViewModel);&lt;br /&gt;&lt;br /&gt;    return View(searchViewModel);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;Service是和之前一樣注入進來的。這邊把Index ViewModel作為方法參數是有兩個用意： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;如果要做搜索或者按下下一頁的時候，會直接post back到這一邊，因此要接住才可以。 &lt;br /&gt;&lt;li&gt;當第一次get的時候，為了邏輯一致，因此還是要呼叫&lt;code&gt;ProcessIndexViewModel&lt;/code&gt;，但是如果Index ViewModel沒有被實例化，會造成裡面Property是null 導致出錯。 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413386529549363"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過這一篇，可以讓框架幫我們針對一般的欄位和條件自動做搜索和分頁，不過這一篇沒有介紹在View上面如何使用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在下一篇，將會介紹如何透過template讓產生的搜索欄位在不同功能看起來一致，並且一些helper來幫助產生url。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3098834327240826242/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-23-IndexPage-AutomaticSsearch.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3098834327240826242'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3098834327240826242'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-23-IndexPage-AutomaticSsearch.html' title='[iThome 第七屆鐵人賽 23] 搜索頁面 - Service層的工作 - 自動套用一般搜索條件'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-9057364670649853197</id><published>2014-10-14T22:20:00.000+08:00</published><updated>2014-11-30T09:44:40.752+08:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='Linq'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 22] 搜索頁面 - Service層的工作 -動態產生Linq條件</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076381" ;=""&gt;功能描述&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076880" ;=""&gt;Service依照SearchViewModel裡面的欄位去做搜索&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076168" ;=""&gt;動態組裝的Linq&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076442" ;=""&gt;自己寫Expression Tree&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076326" ;=""&gt;使用PredicateBuilder&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076458" ;=""&gt;Dynamic Linq Query&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413296225076184" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了會使用到的ViewModel之後，接下來就是實際的商業邏輯，也就是實際做搜索和產生資料的部份。 &lt;/p&gt; &lt;p&gt;在這一篇，將會介紹如何透過Service層和ViewModel的搭配，讓使用起來變的更加方便。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413296225076381"&gt;功能描述&lt;/h1&gt; &lt;p&gt;Service的流程大概如下： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;依照SearchViewModel裡面的欄位去做DB搜索  &lt;li&gt;得出的結果將會用Automapper轉成要的SearchResultViewModel，並且透過PagedList.Mvc的方式把資料包住  &lt;li&gt;View方面的呈現 - 搜索表單可以做成通用的Partial &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;由於Service要做的事情也滿多的，因此整個Service層的實作會分幾篇來介紹。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1413296225076880"&gt;Service依照SearchViewModel裡面的欄位去做搜索&lt;/h1&gt; &lt;p&gt;這個部份其實要拆成兩塊： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;動態組裝Linq條件 - Linq搜索的好處是強型別的條件，但是當我們希望Service自動依照欄位去做搜索的時候，Linq就不方便使用了。因此，我們需要先瞭解如何動態組裝Linq條件  &lt;li&gt;透過Reflection取得搜索欄位和條件 - SearchViewModelBase裡面有必要有的欄位（例如目前第幾頁，用什麽欄位做排序，詳細請看上一篇），但是這些欄位和實際搜索的DB沒有關係，SearchViewModelBase 裡面是方便做分頁用的，而實際的搜索條件是每一個繼承下來需要的，因此透過Reflection可以做到。 &lt;/li&gt;&lt;/ol&gt;  &lt;h2 id="WizKMOutline_1413296225076168"&gt;動態組裝的Linq&lt;/h2&gt; &lt;p&gt;基本上，動態組裝Linq條件有3種方法： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;使用PredicateBuilder - 強型別的方式組裝linq條件  &lt;li&gt;使用Dynamic Linq Library - 用string的方式組裝Linq  &lt;li&gt;自己組裝Expression Tree &lt;/li&gt;&lt;/ol&gt;  &lt;h3 id="WizKMOutline_1413296225076442"&gt;自己寫Expression Tree&lt;/h3&gt; &lt;p&gt;基本上Linq的Where條件最終組出來就是一個Expression Tree。因此如果對於Expression Tree有所瞭解可以自己動手寫。 &lt;/p&gt; &lt;p&gt;但是基本上要會寫這個要對於整個比較瞭解，因此基本不用考慮。 &lt;/p&gt; &lt;h3 id="WizKMOutline_1413296225076326"&gt;使用PredicateBuilder&lt;/h3&gt; &lt;p&gt;PredicateBuilder基本上就是可以用強型別的方式組裝Linq條件。舉例來說，我們使用Linq來寫Where條件，當Where條件寫好只好，是沒有辦法在對那個Where條件在做調整。 &lt;/p&gt; &lt;p&gt;因此，假設我們的搜索表單有4個條件，有輸入才做搜索條件，如果條件是兩個以上，還要做and的邏輯。要用原生的linq做到這個其實是很困難的，因為Linq條件是不能在改，因此等於每一種情況都要寫一個，這個很難維護也很麻煩。 &lt;/p&gt; &lt;p&gt;因此，PredicateBuilder就很方便，它能夠讓我們動態修改Linq條件，因此舉例來說（官方的例子）： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;IQueryable&amp;lt;Product&amp;gt; SearchProducts (params string[] keywords)&lt;br /&gt;{&lt;br /&gt;  var predicate = PredicateBuilder.False&amp;lt;Product&amp;gt;();&lt;br /&gt;&lt;br /&gt;  foreach (string keyword in keywords)&lt;br /&gt;  {&lt;br /&gt;    string temp = keyword;&lt;br /&gt;    predicate = predicate.Or (p =&amp;gt; p.Description.Contains (temp));&lt;br /&gt;  }&lt;br /&gt;  return dataContext.Products.Where (predicate);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;有一堆搜索的Keyword，每一個要以Or的方式做搜索，不是用PredicateBuilder，原生的Linq是辦不到的（如果全部要做and是做的到，但是or就沒有辦法）。 &lt;br /&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;br /&gt;&lt;h4 id="WizKMOutline_1413296222466971"&gt;LinqKit 套件&lt;/h4&gt;PredicateBuilder屬於LinqKit套件的一部份，這個套件提供了一些方便處理Linq的方法。 &lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;Nuget安裝指令：&lt;kbd&gt;Install-Package LinqKit&lt;/kbd&gt; &lt;br /&gt;&lt;li&gt;Nuget頁面：&lt;a href="https://www.nuget.org/packages/LinqKit/"&gt;LinqKit&lt;/a&gt; &lt;br /&gt;&lt;li&gt;官方介紹Predicate Builder：&lt;a href="http://www.albahari.com/nutshell/predicatebuilder.aspx"&gt;Dynamically Composing Expression Predicates&lt;/a&gt; &lt;br /&gt;&lt;li&gt;官方介紹LinqKit：&lt;a href="http://www.albahari.com/nutshell/linqkit.aspx"&gt;What is LINQKit?&lt;/a&gt; &lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-success"&gt;PredicateBuilder非常適合在確定有那些欄位的情況下使用。例如確定有4個搜索欄位。但是，這個不適合我們使用。因為如果要寫共通處理邏輯，更本就不知道有那些搜索欄位。 &lt;/div&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1413296225076458"&gt;Dynamic Linq Query&lt;/h3&gt;&lt;br /&gt;&lt;p&gt;早期在寫Sql的時候，有時候Sql的語法使用string組裝在一起（當然要用NameParameter避免Sql injection）。這一種組裝的好處是完全可以寫好一個共用邏輯，只要符合條件的就用string concat的方式組裝條件，非常的方便。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;Linq如果可以做到就好了，因此由Scot Gu介紹了一個所謂的Dynamic Linq Query - &lt;a href="http://weblogs.asp.net/scottgu/dynamic-linq-part-1-using-the-linq-dynamic-query-library"&gt;Dynamic LINQ&lt;/a&gt; &lt;/p&gt;&lt;br /&gt;&lt;p&gt;Dynamic Linq Query基本上就是可以讓我們用string方式組裝linq，因此（下面範例是由保哥一篇介紹的文章裡面截取）： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;Northwind db = new Northwind(connString); &lt;br /&gt;db.Log = Console.Out;&lt;br /&gt;&lt;br /&gt;var query =&lt;br /&gt;    db.Customers.Where("City == @0 and Orders.Count &amp;gt;= @1", "London", 10).&lt;br /&gt;    OrderBy("CompanyName").&lt;br /&gt;    Select("New(CompanyName as Name, Phone)");&lt;br /&gt;&lt;br /&gt;Console.WriteLine(query);&lt;br /&gt;Console.ReadLine();&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;br /&gt;&lt;h4&gt;Dynamic Linq Query&lt;/h4&gt;基本上這個功能並沒有包含在.Net裡面，如果要使用之前是需要到Scott Gu的那篇文章下載dll。不過有人把它包到了Nuget，方便使用 &lt;br /&gt;&lt;ul&gt;&lt;br /&gt;&lt;li&gt;Nuget安裝指令：&lt;kbd&gt;Install-Package System.Linq.Dynamic &lt;/kbd&gt;&lt;br /&gt;&lt;li&gt;Nuget頁面：&lt;a href="https://www.nuget.org/packages/System.Linq.Dynamic/"&gt;System.Linq.Dynamic&lt;/a&gt; &lt;br /&gt;&lt;li&gt;官網介紹：&lt;a href="http://weblogs.asp.net/scottgu/dynamic-linq-part-1-using-the-linq-dynamic-query-library"&gt;Dynamic LINQ&lt;/a&gt; &lt;br /&gt;&lt;li&gt;保哥介紹：&lt;a href="http://blog.miniasp.com/post/2008/06/24/Introduce-LINQ-Dynamic-Query-Library.aspx"&gt;Dynamic LINQ 讓 LINQ 的世界變的更美好&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-success"&gt;Dynamic Linq Query非常適合做那種通用型的處理，例如不知道欄位有什麽的情況下。但是壞處是，喪失了強型別的好處。不過這個非常適合框架處理搜索條件。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413296225076184"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;本來這一篇還要介紹框架Service層如何搭配Dynamic Linq Query來使用，不過在介紹動態Linq條件的時候，篇幅有點長，因此就把Service層的實作留在下一篇。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/9057364670649853197/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-22-IndexPage-DynamicWhereLinq.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9057364670649853197'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9057364670649853197'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-22-IndexPage-DynamicWhereLinq.html' title='[iThome 第七屆鐵人賽 22] 搜索頁面 - Service層的工作 -動態產生Linq條件'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-9193152572560874073</id><published>2014-10-13T22:10:00.000+08:00</published><updated>2014-10-13T22:16:11.977+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 21] 搜索頁面 - ViewModel的定義</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428258" ;=""&gt;ViewModel的內容&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428176" ;=""&gt;搜索條件的ViewModel&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428422" ;=""&gt;搜索結果&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428437" ;=""&gt;PagedList.Mvc - 好用的分頁套件&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428172" ;=""&gt;搜索ViewModel的主檔&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428350" ;=""&gt;Post的搜索ViewModel&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413209266428147" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了搜索功能的概念和思路之後，在這一篇開始要看實作的部份。 &lt;/p&gt; &lt;p&gt;通常寫Mvc都是從Model開始，因此這一篇將來看一下搜索功能所會使用到的ViewModel &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413209266428258"&gt;ViewModel的內容&lt;/h1&gt; &lt;p&gt;首先，搜索的ViewModel必然會有兩個Property： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;搜索條件  &lt;li&gt;搜索結果 &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;因此，我們會先從這兩個部份的Property來看起。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1413209266428176"&gt;搜索條件的ViewModel&lt;/h2&gt; &lt;p&gt;搜索條件會有一定有的欄位和各個domain所需要的欄位，因此會先定義一個Base，好方便之後domain來繼承並且提供其他相關欄位。 &lt;/p&gt; &lt;p&gt;一定會有的欄位像是： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;每頁筆數  &lt;li&gt;目前頁數  &lt;li&gt;排序欄位  &lt;li&gt;排序順序 &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;Domain相關的欄位就依照各自的需求，例如假設是一篇文章，可能會有以“標題”做搜索或者以“內文”做搜索。 &lt;/p&gt; &lt;p&gt;因此，程式碼會如下： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 搜索 Form 的 ViewModel base。定義搜索必須要有的相關欄位。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public abstract class SearchFormViewModelBase : ISearchFormViewModelBase&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 目前頁數的值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    private int page;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    ///  取得或設定目前頁數。最小值是1。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 目前頁數&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public virtual int Page&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            if (this.page &amp;lt; 1)&lt;br /&gt;            {&lt;br /&gt;                this.page = 1;&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;            return this.page;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        set { this.page = value; }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 每頁筆數的值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    private int pageSize;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定每頁筆數。最小值是15。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 每頁筆數&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public virtual int PageSize&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            if (this.pageSize &amp;lt; 1)&lt;br /&gt;            {&lt;br /&gt;                this.pageSize = 15;&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;            return this.pageSize;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        set { this.pageSize = value; }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 欄位排序的值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    protected string orderByColumnName;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定要依照那個欄位做排序。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 依照那個欄位做排序.&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public abstract string OrderByColumnName { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定排序的方向。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// &amp;lt;c&amp;gt;true&amp;lt;/c&amp;gt; 表示用 ascending排序; otherwise, &amp;lt;c&amp;gt;false&amp;lt;/c&amp;gt;.&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public bool IsAscending { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個ViewModel實作的Interface就不看了，基本上就是這些Property的定義。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;這邊有個地方可以注意到就是排序的欄位。因為我們這個&lt;code&gt;SearchFormViewModelBase&lt;/code&gt;沒有形態的概念，而通常來說搜索條件會和某一個DB的Table對應。因此，為了方便之後框架幫忙做搜索，這邊又定義一個有強型別的&lt;code&gt;SearchFormViewModelBase&lt;/code&gt;： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 搜索 Form 的 ViewModel base。有帶上形態，以第一個欄位做排序&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;Entity Framework裡面Table Entity&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public abstract class SearchFormViewModelBase&amp;lt;T&amp;gt; : SearchFormViewModelBase&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定要依照那個欄位做排序。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 依照那個欄位做排序.&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public override string OrderByColumnName&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            if (string.IsNullOrEmpty(this.orderByColumnName))&lt;br /&gt;            {&lt;br /&gt;                this.orderByColumnName = typeof(T).GetProperties().First().Name;&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;            return this.orderByColumnName;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        set&lt;br /&gt;        {&lt;br /&gt;            this.orderByColumnName = value;&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;可以注意到這個Class的定義是&lt;code&gt;Abstract&lt;/code&gt;，表示之後的class應該要依照自己的Domain去做繼承，例如如果今天是Post的搜索ViewModel，希望有一個 “標題”的搜索欄位，和排序要以“建立時間”欄位，那麼ViewModel就會是： &lt;/div&gt;&lt;pre class="brush: csharp;"&gt;public class SearchFormViewModel : SearchFormViewModelBase&amp;lt;Post&amp;gt;&lt;br /&gt;{&lt;br /&gt;    [DisplayName("標題")]&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;&lt;br /&gt;    public override string OrderByColumnName&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            return "CreateDateTime";&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413209266428422"&gt;搜索結果&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;這個部份就比較簡單，就是某一個和Detail頁面一樣ViewModel不過是被一個&lt;code&gt;IPagedList&lt;/code&gt;包住。因此他不會像搜索ViewModel一樣有個base而是直接看定義的 ViewModel然後以泛型的方式傳入。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;br /&gt;&lt;h4 id="WizKMOutline_1413209266428437"&gt;PagedList.Mvc - 好用的分頁套件&lt;/h4&gt;&lt;br /&gt;&lt;ul&gt;&lt;br /&gt;&lt;li&gt;Nuget安裝指令：&lt;kbd&gt;Install-Package PagedList.Mvc&lt;/kbd&gt; &lt;br /&gt;&lt;li&gt;套件Github首頁：&lt;a href="https://github.com/TroyGoode/PagedList"&gt;https://github.com/TroyGoode/PagedList&lt;/a&gt; &lt;br /&gt;&lt;li&gt;如果完全沒有用過，可以參考： &lt;br /&gt;&lt;ul&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="http://kevintsengtw.blogspot.tw/2013/10/aspnet-mvc-pagedlistmvc.html"&gt;ASP.NET MVC 資料分頁 - 使用 PagedList.Mvc &lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="http://kevintsengtw.blogspot.tw/search/label/%E8%B3%87%E6%96%99%E5%88%86%E9%A0%81"&gt;其他一系列的文章&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413209266428172"&gt;搜索ViewModel的主檔&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;有了這兩個Property的ViewModel之後，就可以建立搜索的ViewModel的Base： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 搜索頁面的ViewModel需要繼承這一個Base。&lt;br /&gt;/// 方便處理Paging和搜索條件相關。&lt;br /&gt;/// 這個方法就兩個Property，用作於表示搜索的form和搜索結果的result。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TSearchForm"&amp;gt;搜索的form ViewModel type。&lt;br /&gt;/// 必須是繼承&amp;lt;see cref="MvcInfrastructure.Common.Base.SearchFormViewModelBase"/&amp;gt;&lt;br /&gt;/// &amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TPageResult"&amp;gt;搜索的結果ViewModel type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public class SearchViewModelBase&amp;lt;TSearchForm, TPageResult&amp;gt; : &lt;br /&gt;	ISearchViewModelBase&amp;lt;TSearchForm, TPageResult&amp;gt;&lt;br /&gt;    where TSearchForm : Core.Common.Base.ISearchFormViewModelBase, new() &lt;br /&gt;{&lt;br /&gt;    private TSearchForm searchForm;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定搜索的Form。如果是null，會實例一個。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 搜索的Form&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public TSearchForm SearchForm&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            if (this.searchForm == null)&lt;br /&gt;            {&lt;br /&gt;                this.searchForm = new TSearchForm();&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;            return this.searchForm;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        set { this.searchForm = value; }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定搜索結果的ViewModel。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 搜索結果的ViewModel。用&amp;lt;see cref="PagedList.IPagedList"/&amp;gt;包住，方便做分頁&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public IPagedList&amp;lt;TPageResult&amp;gt; Result { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413209266428350"&gt;Post的搜索ViewModel&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;定義好了搜索的BaseViewModel之後，假設今天是&lt;code&gt;Post&lt;/code&gt;頁面要做搜索的ViewModel，就可能會像是： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class Index : SearchViewModelBase&amp;lt;SearchFormViewModel, SearchResult&amp;gt;&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public class SearchResult : IMapFrom&amp;lt;Post&amp;gt;&lt;br /&gt;{&lt;br /&gt;    public int Id { get; set; }&lt;br /&gt;    [DisplayName("標題")]&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;    [DisplayName("內文")]&lt;br /&gt;    public string PostContent { get; set; }&lt;br /&gt;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public class SearchFormViewModel : SearchFormViewModelBase&amp;lt;Post&amp;gt;&lt;br /&gt;{&lt;br /&gt;    [DisplayName("標題")]&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;&lt;br /&gt;    public override string OrderByColumnName&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            return "CreateDateTime";&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413209266428147"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;有了搜索的ViewModel之後，在下一篇將會介紹框架的Service怎麼能夠做修改並且讓搜索處理邏輯變的簡單。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/9193152572560874073/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-21-IndexPage-ViewModel.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9193152572560874073'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/9193152572560874073'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-21-IndexPage-ViewModel.html' title='[iThome 第七屆鐵人賽 21] 搜索頁面 - ViewModel的定義'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6016075799386206395</id><published>2014-10-12T23:05:00.001+08:00</published><updated>2014-10-12T23:05:38.951+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 20] 搜索頁面 - 思考篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119654908" ;=""&gt;一般搜索頁面所會需要處理的內容&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119655968" ;=""&gt;框架如何簡化3個要處理的內容&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119655625" ;=""&gt;搜索條件的處理&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119655786" ;=""&gt;搜索結果的處理&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119656902" ;=""&gt;分頁處理的部份&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119656617" ;=""&gt;解決思路&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1413126119656433" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;搜索頁面無疑是任何系統必須要有的功能，同時要做出搜索頁面需要很多不同的地方：需要注意搜索條件，分頁的處理和結果的呈現。 &lt;/p&gt;&lt;p&gt;這些處理其實如果沒有統一的做法，會很容易造成每個人用不同的方式做處理，因此這一篇將來介紹，如何透過框架被處理變的更加簡單。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413126119654908"&gt;一般搜索頁面所會需要處理的內容&lt;/h1&gt;&lt;p&gt;搜索頁面基本上就是所謂的Index頁面。這種頁面通常會有3個部份的內容： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;搜索條件 - 通常應該會有一個搜索條件，讓使用者可以過濾資料的顯示&lt;br /&gt;&lt;li&gt;搜索結果 - 依照搜索條件，去產生對應的結果做呈現和顯示&lt;br /&gt;&lt;li&gt;分頁處理 - 通常會針對結果做分頁處理，例如如果有100筆，可能只希望一次呈現20筆，那麼就會有5頁。這些資訊的處理其實並沒有想像中的容易。 &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;針對上面提到的3個部份的內容，其實都有一些底層的內容去處理，而這些如果沒有做好，很多時候都是在runtime的時候才會出錯，而不是compile time。如果是客戶遇到才來告訴我們有問題，那就不好看了。因此，做好的情況是透過概念處理掉一些底層的東西，讓我們不會犯低級的錯誤。   &lt;h1 id="WizKMOutline_1413126119655968"&gt;框架如何簡化3個要處理的內容&lt;/h1&gt;&lt;p&gt;在接下來，將會看一下每一個部份如果沒有框架來幫忙處理，會遇到的問題，和如何用框架解決。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1413126119655625"&gt;搜索條件的處理&lt;/h2&gt;&lt;p&gt;在搜索條件的部份，通常來說我們將會使用Linq來做處理。Linq的好處是我們在Compile time就會知道我們下的語法是否有錯，但是好處也是它的壞處，如果我們想要做動態搜索，例如用string的方式去組裝搜索條件，我們就會需要一些第三方套件的幫助。 &lt;/p&gt;&lt;p&gt;能夠動態使用Linq之後，讓我們有可能只要寫一次搜索條件的邏輯，剩下就是看需要搜索的條件去做處理。這樣的好處是，不同頁面只要符合規則，所有的搜索條件都會幫忙處理。 &lt;/p&gt;&lt;p&gt;因此，這部份將會使用共通ViewModel的方式，讓我們可以用Reflection的方式，搭配動態Linq做好搜索條件。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1413126119655786"&gt;搜索結果的處理&lt;/h2&gt;&lt;p&gt;這一部份比較簡單，基本上就是搜索條件組成了之後，把結果轉成要顯示的ViewModel並且做呈現。 &lt;/p&gt;&lt;p&gt;這個部份也是搭配我們之前的ViewModel裡面的&lt;code&gt;IMapFrom&lt;/code&gt;和&lt;code&gt;IHaveCustomMapping&lt;/code&gt;來設定對應關係。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1413126119656902"&gt;分頁處理的部份&lt;/h2&gt;&lt;p&gt;要做到分頁，基本上有幾個地方需要注意到。首先是需要搭配搜索條件，才會知道每一個分頁切換的時候需要帶上的搜索條件。 &lt;/p&gt;&lt;p&gt;再來，在搜索條件的處理需要考慮進去一次顯示幾筆和總共有幾頁的問題。 &lt;/p&gt;&lt;p&gt;同時，因為需要顯示分頁，因此在做搜索結果處理的地方，還需要做搜索結果的排序。因此這個也需要算到搜索結果處理的一部份。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1413126119656617"&gt;解決思路&lt;/h1&gt;&lt;p&gt;在上面已經有大概提多應該要如何處理，不過這邊在總結一下，基本上，會需要定義一種特殊的ViewModel，專門是給搜索頁面使用。 &lt;/p&gt;&lt;p&gt;這個ViewModel會有兩部份的資料，一個部份是搜索結果，再來一個是搜索條件。 &lt;/p&gt;&lt;p&gt;搭配一些第三方的套件來處理搜索的設定和分頁處理，讓很這些底層的內容給框架處理，讓我們只需要使用就好。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1413126119656433"&gt;結語&lt;/h1&gt;&lt;p&gt;因為這一部份要實作起來比較多東西，因此這一篇先介紹問題和處理思路，接下來才介紹如何實作。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6016075799386206395/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-20-IndexPage-concept.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6016075799386206395'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6016075799386206395'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-20-IndexPage-concept.html' title='[iThome 第七屆鐵人賽 20] 搜索頁面 - 思考篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6162186930283943884</id><published>2014-10-12T22:58:00.000+08:00</published><updated>2014-11-30T09:49:09.011+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 19] 框架產生下拉式資料的內容</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114862" ;=""&gt;預設Scaffolding的問題&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114684" ;=""&gt;解決思路&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114461" ;=""&gt;實作內容&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114969" ;=""&gt;SelectListViewModel的定義&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114870" ;=""&gt;定義ViewModelBase&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114441" ;=""&gt;Filter定義&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114908" ;=""&gt;View的使用&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413125750114433" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;這一篇，回到Controller常常需要做的一件事情，那就是當如果欄位屬於下拉式選單的時候，需要準備好下拉式清單的資料。 &lt;/p&gt; &lt;p&gt;如果用的是預設的方式去產生下拉式選單其實有很多問題，這一篇想透過框架的方式，讓產生下拉式清單的資料能夠自動化。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413125750114862"&gt;預設Scaffolding的問題&lt;/h1&gt; &lt;p&gt;如果是Mvc Scaffolding內建的話，會在Controller的時候產生下拉式清單資料並且塞到ViewBag裡面。 &lt;/p&gt; &lt;p&gt;這個最大的問題是：假設某一個地方有需要下拉式選單的資料，但是忘記產生了(最長發生這個問題是在Edit的時候，驗證失敗需要重新顯示View的時候)，畫面就會炸掉。 &lt;/p&gt; &lt;p&gt;而且這個只有在runtime的時候才會發生，完全沒有辦法在compile的時候檢測出來。 &lt;/p&gt; &lt;p&gt;假設有東西能夠保證需要下拉式清單的資料的時候，一定會產生出來，就不需要擔心到底有沒有忘記呼叫要把資料塞到ViewBag裡面。 &lt;/p&gt; &lt;p&gt;這就是我們框架要解決的問題。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1413125750114684"&gt;解決思路&lt;/h1&gt; &lt;p&gt;首先，需要下拉式清單的資料的時候，就需要產生出來。能夠確認每一次需要的時候就會產生，就要透過Filter來做。 &lt;/p&gt; &lt;p&gt;如果透過Filter來處理產生的邏輯，那麼還需要準備資料給Filter，讓它產生對應的資料並且塞到ViewBag裡面。因此，ViewModel是最適合的，因為在Filter裡面可以取得ViewModel的內容，因此可以做一個特殊的欄位，專門存放這些準備資料。 &lt;/p&gt; &lt;p&gt;最後，在顯示的部份，就可以用一般的HtmlHelper產生即可。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1413125750114461"&gt;實作內容&lt;/h1&gt; &lt;p&gt;接下來就看看如何實作。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1413125750114969"&gt;SelectListViewModel的定義&lt;/h2&gt; &lt;p&gt;首先，定義一個&lt;code&gt;SelectListViewModel&lt;/code&gt;的Class，這個Class將代表需要產生的下拉式選單： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 代表一個要被產生的SelectList&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class SelectListViewModel&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定此SelectList要和那個ViewModel Property對應&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 此SelectList要和那個ViewModel Property對應&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string SelectListId { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定資料來源&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 資料來源&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string Source { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定SelectList值的欄位來源&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// SelectList值的欄位來源&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string DataValueField { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定SelectList顯示的欄位來源&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// SelectList顯示的欄位來源&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string DataTextField { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定SelectList被選取的值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// SelectList被選取的值&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public object SelectedValue { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// SelectList要從那裡被產生出來&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    private string codeWhere;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定SelectList要從那裡被產生出來&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// SelectList要從那裡被產生出來&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string CodeWhere&lt;br /&gt;    {&lt;br /&gt;        get&lt;br /&gt;        {&lt;br /&gt;            return codeWhere;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        set { codeWhere = value; }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413125750114870"&gt;定義ViewModelBase&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;再來，所有的ViewModel都要從某一個Base做繼承，而這個ViewModelBase會有一個Property，會回傳Array of &lt;code&gt;SelectListViewModel&lt;/code&gt;。這個property將代表這個ViewModel會用到的下拉式選單清單。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Core View Model 的 Base class。所有ViewModel將會繼承這一個。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public abstract class CoreViewModelBase&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 如果需要產生SelectList到ViewData裡面，&lt;br /&gt;	/// 那麼child class會複寫這個Property，輸入需要產生的SelectList資訊。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// &lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public virtual SelectListFill.SelectListViewModel[] NeedFillSelectList &lt;br /&gt;    { &lt;br /&gt;        get &lt;br /&gt;        { &lt;br /&gt;            return null; &lt;br /&gt;        } &lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;因此，某一個的實作可能會是： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class Create : CoreViewModelBase, IHaveCustomMapping&lt;br /&gt;{&lt;br /&gt;...&lt;br /&gt;	public string PostType {get; set;}&lt;br /&gt;&lt;br /&gt;	/// &amp;lt;summary&amp;gt;&lt;br /&gt;	/// 如果需要產生SelectList到ViewData裡面，&lt;br /&gt;	/// 那麼child class會複寫這個Property，&lt;br /&gt;	///	輸入需要產生的SelectList資訊。&lt;br /&gt;	/// &amp;lt;/summary&amp;gt;&lt;br /&gt;	public override SelectListViewModel[] NeedFillSelectList&lt;br /&gt;	{&lt;br /&gt;		get&lt;br /&gt;		{&lt;br /&gt;			List&amp;lt;SelectListViewModel&amp;gt; temp = new List&amp;lt;SelectListViewModel&amp;gt;();&lt;br /&gt;	&lt;br /&gt;			temp.Add(new SelectListViewModel()&lt;br /&gt;                {&lt;br /&gt;                    CodeWhere = "where",&lt;br /&gt;                    DataTextField = "Text",&lt;br /&gt;                    DataValueField = "Value",&lt;br /&gt;                    SelectedValue = PostType,&lt;br /&gt;                    SelectListId = "PostType",&lt;br /&gt;                    Source = "Code"&lt;br /&gt;                });&lt;br /&gt;	&lt;br /&gt;			return temp.ToArray();&lt;br /&gt;		}&lt;br /&gt;	}&lt;br /&gt;	&lt;br /&gt;	...&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;上面的例子是有一個&lt;code&gt;PostType&lt;/code&gt;的下拉式選單 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413125750114441"&gt;Filter定義&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;再來就是實際產生下拉式清單的地方： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 把ViewModel裡面有設定要產生的SelectList產生出來並且寫到ViewData。&lt;br /&gt;/// 需要由此Class的Child來複寫產生SelectList的邏輯&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public abstract class FillSelectListActionFilterBase : ActionFilterAttribute&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 產生SelectList的邏輯&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="viewModel"&amp;gt;提供要如何產出SelectList的資訊&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;&lt;br /&gt;    /// 依照ViewModel的資訊產出對應的SelectList&lt;br /&gt;    /// &amp;lt;/returns&amp;gt;&lt;br /&gt;    public override System.Web.Mvc.SelectList &lt;br /&gt;		GetSelectList(SelectListViewModel viewModel)&lt;br /&gt;    {&lt;br /&gt;        SelectList result;&lt;br /&gt;&lt;br /&gt;        // 依照SelectListViewModel的值，去產生SelectList&lt;br /&gt;&lt;br /&gt;        return result;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 把產出的SelectList注入到ViewData裡面&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="filterContext"&amp;gt;The filter context.&amp;lt;/param&amp;gt;&lt;br /&gt;    public override void OnActionExecuted&lt;br /&gt;		(ActionExecutedContext filterContext)&lt;br /&gt;    {&lt;br /&gt;        var viewResult = filterContext.Result as ViewResult;&lt;br /&gt;&lt;br /&gt;        if (viewResult != null &amp;amp;&amp;amp; viewResult.Model is CoreViewModelBase)&lt;br /&gt;        {&lt;br /&gt;            var selectListViewModelArray = &lt;br /&gt;			((CoreViewModelBase)viewResult.Model).NeedFillSelectList;&lt;br /&gt;&lt;br /&gt;            // 假設有設定ViewModel才要做產出的動作&lt;br /&gt;            if (selectListViewModelArray != null&lt;br /&gt;			 &amp;amp;&amp;amp; selectListViewModelArray.Count() &amp;gt; 0)&lt;br /&gt;            {&lt;br /&gt;                foreach (var item in selectListViewModelArray)&lt;br /&gt;                {&lt;br /&gt;                    // 假設目前ViewData裡面沒有這個SelectList才產生。&lt;br /&gt;					// 因此，在別的地方產出的SelectList的權重比這一個&lt;br /&gt;                    // filter還高。&lt;br /&gt;                    if (viewResult.ViewData[item.SelectListId] &lt;br /&gt;						as System.Web.Mvc.SelectList == null)&lt;br /&gt;                    {&lt;br /&gt;                        viewResult.ViewData[item.SelectListId] &lt;br /&gt;							= this.GetSelectList(item);&lt;br /&gt;                    }&lt;br /&gt;                }&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        base.OnActionExecuted(filterContext);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;基本上就是依照&lt;code&gt;SelectListViewModel&lt;/code&gt;去產生&lt;code&gt;SelectList&lt;/code&gt;。然後把產生的SelectList塞到&lt;code&gt;ViewData&lt;/code&gt;裡面，使用的Key會是 &lt;code&gt;SelectListViewModel&lt;/code&gt;裡面的&lt;code&gt;SelectListId&lt;/code&gt;。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413125750114908"&gt;View的使用&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;最後，就是View的呼叫： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// Create.cshtml&lt;br /&gt;&lt;br /&gt;...&lt;br /&gt;&lt;br /&gt;@Html.DropDownListFor(model =&amp;gt; model.PostType, null, &lt;br /&gt;		htmlAttributes: new { @class = "form-control" })&lt;br /&gt;&lt;br /&gt;....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊注意到我們給&lt;code&gt;null&lt;/code&gt;到&lt;code&gt;Html.DropDownListFor&lt;/code&gt;，因為如果沒有給&lt;code&gt;SelectList&lt;/code&gt;，Mvc會去找&lt;code&gt;ViewData&lt;/code&gt;裡面看有沒有一樣的key有這個值，有的話就會使用那個作為清單。而我們的Filter則會產生出來那個清單，因此一定會有東西。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413125750114433"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過使用這種方法，再也不需要擔心需要下拉式清單的時候忘記產生，因為Filter會幫忙做掉。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6162186930283943884/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-19-GenerateSelectListFroDropDownList.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6162186930283943884'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6162186930283943884'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-19-GenerateSelectListFroDropDownList.html' title='[iThome 第七屆鐵人賽 19] 框架產生下拉式資料的內容'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8427699814124704599</id><published>2014-10-11T22:08:00.000+08:00</published><updated>2014-11-30T09:49:09.035+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 18] 資料驗證 - 實作篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953499" ;=""&gt;基本流程&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953323" ;=""&gt;需要新增的Class和interface&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953571" ;=""&gt;定義裝載錯誤訊息的載體&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953577" ;=""&gt;接住Repository層的驗證錯誤邏輯&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953169" ;=""&gt;驗證的Dictionary&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953528" ;=""&gt;框架修改的地方來使用這個驗證&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953622" ;=""&gt;Repository層的修改&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953880" ;=""&gt;Service層的修改&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953496" ;=""&gt;Controller層的修改&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1413036163953675" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹了資料驗證的三個時機，在這一篇將會實作上一篇的內容。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1413036163953499"&gt;基本流程&lt;/h1&gt; &lt;p&gt;首先，需要定義出一個能夠用來裝錯誤訊息的資料載體。這個Class的用處只是方便我們在3段不同地方做驗證的時候，可以儲存錯誤訊息，並且在3層互相傳遞。 &lt;/p&gt; &lt;p&gt;再來，會定一個Wrapper，把錯誤訊息包起來，並且提供一個方法回傳，驗證是否成功。 &lt;/p&gt; &lt;p&gt;最後，在Controller那邊的驗證（&lt;code&gt;ModelStateDictionary&lt;/code&gt;）和Repository儲存（如果驗證失敗會丟出exception）出現錯誤訊息的時候，把這些放在Wrapper 裡面，方便統一顯示資料驗證。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1413036163953323"&gt;需要新增的Class和interface&lt;/h1&gt; &lt;p&gt;首先先介紹會增加的interface和Class，然後才介紹如何實際做到Freamwork裡面。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1413036163953571"&gt;定義裝載錯誤訊息的載體&lt;/h2&gt; &lt;p&gt;基本上定義一個interface（&lt;code&gt;IBaseError&lt;/code&gt;）代表一個錯誤訊息會有的欄位。基本上這個interface有兩個property，一個是儲存錯誤訊息的資訊，另外一個是儲存這個錯誤訊息對應到的Property。 &lt;/p&gt; &lt;p&gt;因為，不是所有錯誤訊息都會有對應的欄位，因此，會用兩種實作，一個是&lt;code&gt;PropertyError&lt;/code&gt;，代表這個錯誤訊息和Property有關聯（例如某一個欄位是必填欄位，那沒就是屬於這種類型的錯誤哦訊息）。 &lt;/p&gt; &lt;p&gt;另外一種實作則是通用型錯誤訊息叫做&lt;code&gt;GeneralError&lt;/code&gt;。這種錯誤是不會和某一個欄位有關的，因此只會有錯誤訊息的值，而不會有property欄位。 &lt;/p&gt; &lt;p&gt;如果用Class Diagram表示就是： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.ggpht.com/--pVGkm-_0Uo/VDk5ot4L64I/AAAAAAAANgw/sM8yz4GA3tc/s1600-h/image%25255B4%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-QuaggEqjgFM/VDk5qG0iv_I/AAAAAAAANg4/cG5vdDXWblk/image_thumb%25255B2%25255D.png?imgmax=800" width="478" height="306"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;裝在錯誤訊息的Class&lt;/figcaption&gt; &lt;/figure&gt; &lt;h2 id="WizKMOutline_1413036163953577"&gt;接住Repository層的驗證錯誤邏輯&lt;/h2&gt; &lt;p&gt;在Repository層如果驗證錯誤的話，Entity Framework會丟出一個Exception。 &lt;/p&gt; &lt;p&gt;因此，爲了處理這個部份，將會定義一個自訂的Exception，可以幫忙把Entity Framework的錯誤訊息包住成為&lt;code&gt;IBaseError&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;Class Diagram的樣子會是： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh4.ggpht.com/-ACilIqGr8lo/VDk5rcM11HI/AAAAAAAANhw/Kp1Uto08eDg/s1600-h/image%25255B15%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-fOgYHlcJcNg/VDk5szfUQvI/AAAAAAAANh4/HphDew0B6CE/image_thumb%25255B9%25255D.png?imgmax=800" width="536" height="249"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;Entity Framework驗證錯誤Exception包住的客制Exception&lt;/figcaption&gt; &lt;/figure&gt; &lt;h2 id="WizKMOutline_1413036163953169"&gt;驗證的Dictionary&lt;/h2&gt; &lt;p&gt;在Mvc裡面，&lt;code&gt;ModelStateDictionary&lt;/code&gt;會存放錯誤訊息，並且透過HtmlHelper很方便的能夠把裡面錯誤訊息顯示出來。 &lt;/p&gt; &lt;p&gt;但是爲了避免和&lt;code&gt;ModelStateDictionary&lt;/code&gt;綁死，因此會定義一個interface，提供需要的方法，然後在做一個&lt;code&gt;ModelStateDictionary&lt;/code&gt; Wrapper的實作，這樣就方便Service做資料驗證。 &lt;/p&gt; &lt;p&gt;Class Diagram會是： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh5.ggpht.com/-Nz3Mw57DRCE/VDk5uI9HnpI/AAAAAAAANhQ/HVDGLwBfLGs/s1600-h/image%25255B13%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-HDu3Msnn23E/VDk5vuO9rrI/AAAAAAAANhY/u4pygG4V2nA/image_thumb%25255B7%25255D.png?imgmax=800" width="528" height="242"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;資料驗證的Dictionary Class Diagram&lt;/figcaption&gt; &lt;/figure&gt; &lt;h1 id="WizKMOutline_1413036163953528"&gt;框架修改的地方來使用這個驗證&lt;/h1&gt; &lt;p&gt;接下來就是修改目前已有的框架，來加上剛剛上面所新增的Class。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1413036163953622"&gt;Repository層的修改&lt;/h2&gt; &lt;p&gt;Repository層需要做的事情是在存檔的時候接住驗證錯誤的Exception，並且重新包過在往上丟給Service層去接，因此： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 實作Entity Framework Unit Of Work的class&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class EFUnitOfWork : IUnitOfWork&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存所有異動。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    public void Save()&lt;br /&gt;    {&lt;br /&gt;        var errors = _context.GetValidationErrors();&lt;br /&gt;        if (!errors.Any())&lt;br /&gt;        {&lt;br /&gt;            _context.SaveChanges();&lt;br /&gt;        }&lt;br /&gt;        else&lt;br /&gt;        {&lt;br /&gt;            throw new DatabaseValidationErrors(errors);&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;	&lt;br /&gt;	....&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413036163953880"&gt;Service層的修改&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;首先是Service裡面要多一個參數，用來存放錯誤訊息的Dictionary。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 通用行的Service layer實作&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;主要的Entity形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public class GenericService&amp;lt;T&amp;gt; : IService&amp;lt;T&amp;gt;&lt;br /&gt;    where T : class&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得驗證資訊的字典&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 驗證資訊的字典&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public IValidationDictionary ValidationDictionary { get; private set; }&lt;br /&gt;&lt;br /&gt;	   /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 初始化IValidationDictionary&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="inValidationDictionary"&amp;gt;要用來儲存錯誤訊息的object&amp;lt;/param&amp;gt;&lt;br /&gt;    public void InitialiseIValidationDictionary&lt;br /&gt;		(IValidationDictionary inValidationDictionary)&lt;br /&gt;    {&lt;br /&gt;        ValidationDictionary = inValidationDictionary;&lt;br /&gt;    }&lt;br /&gt;....&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;在來&lt;code&gt;GenericService&lt;/code&gt;裡面，原本的方法也需要修改： &lt;/p&gt;&lt;pre class="brush: csharp; highlight:[7,11,20,32,33,34,35]"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照某一個ViewModel的值，產生對應的Entity並且新增到資料庫&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="viewModel"&amp;gt;ViewModel的Reference&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;是否儲存成功&amp;lt;/returns&amp;gt;&lt;br /&gt;public bool CreateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel)&lt;br /&gt;{&lt;br /&gt;    // 商業邏輯驗證....&lt;br /&gt;&lt;br /&gt;    if (ValidationDictionary.IsValid)&lt;br /&gt;    {&lt;br /&gt;        var entity = AutoMapper.Mapper.Map&amp;lt;T&amp;gt;(viewModel);&lt;br /&gt;&lt;br /&gt;        db.Repository&amp;lt;T&amp;gt;().Create(viewModel);&lt;br /&gt;&lt;br /&gt;        SaveChange();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return ValidationDictionary.IsValid;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 實際儲呼叫DB儲存。如果有發生驗證錯誤，把它記錄到ValidationDictionary&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;protected void SaveChange()&lt;br /&gt;{&lt;br /&gt;    try&lt;br /&gt;    {&lt;br /&gt;        db.Save();&lt;br /&gt;    }&lt;br /&gt;    catch (ValidationErrors propertyErrors)&lt;br /&gt;    {&lt;br /&gt;        ValidationDictionary.AddValidationErrors(propertyErrors);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;首先是以新增來說，會先做一次驗證（因為以Mvc來說，&lt;code&gt;ValidationDictionary&lt;/code&gt;實作會是一個&lt;code&gt;ModelStateDictionary&lt;/code&gt;的Wrapper。因此，第一層的Controller 驗證會在這裡面），如果過了，表示第一層的驗證過了。各自商業邏輯的部分就依照各自情況做調整。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在來，儲存不直接呼叫&lt;code&gt;db.SaveChange()&lt;/code&gt;，而是透過一個方法。這個方法會把db儲存的呼叫用try catch包住，而接住的Exception則是我們在&lt;code&gt;Repository&lt;/code&gt;層針對Repository儲存錯誤而做的處理。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1413036163953496"&gt;Controller層的修改&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;最後，在Controller這一層，首先需要幫忙把&lt;code&gt;ModelStateDictionary&lt;/code&gt;注入到Service裡面，然後驗證就直接呼叫方法並且判斷回傳的bool： &lt;/p&gt;&lt;pre class="brush: csharp; highlight:[6,7,15];"&gt;public class PostsController : Controller&lt;br /&gt;{       &lt;br /&gt;    public PostsController(IUnitOfWork inDb, IPostService inService)&lt;br /&gt;    {&lt;br /&gt;        service = inService;&lt;br /&gt;        service.InitialiseIValidationDictionary&lt;br /&gt;			(new ModelStateWrapper(this.ModelState));&lt;br /&gt;        db = inDb;&lt;br /&gt;    }&lt;br /&gt;	&lt;br /&gt;    [HttpPost]&lt;br /&gt;    [ValidateAntiForgeryToken]&lt;br /&gt;    public ActionResult Create(Create post)&lt;br /&gt;    {&lt;br /&gt;        if (service.CreateViewModelToDatabase(post))&lt;br /&gt;        {&lt;br /&gt;            return RedirectToAction&amp;lt;HomeController&amp;gt;(x =&amp;gt; x.Index())&lt;br /&gt;			.WithSuccess("修改成功");&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return View(post);&lt;br /&gt;    }&lt;br /&gt;	&lt;br /&gt;	...&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-warning"&gt;雖然&lt;code&gt;ModelStateDictionary&lt;/code&gt;也希望透過DI來注入，但是會造成死循環，因為Controller在等&lt;code&gt;ModelStateDictionary&lt;/code&gt;，而&lt;code&gt;ModelStateDictionary&lt;/code&gt; 又需要等Controller建立。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1413036163953675"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;希望透過這一篇，針對資料驗證的部份有得到統一的儲存錯誤訊息位置。這不僅讓前端顯示這些錯誤訊息的時候方便，同時3個層面的錯誤訊息都可以整合，這個對於整個Application來說，是很重要。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8427699814124704599/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-18-DataValidation-implement.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8427699814124704599'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8427699814124704599'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-18-DataValidation-implement.html' title='[iThome 第七屆鐵人賽 18] 資料驗證 - 實作篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-QuaggEqjgFM/VDk5qG0iv_I/AAAAAAAANg4/cG5vdDXWblk/s72-c/image_thumb%25255B2%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7662160041193601813</id><published>2014-10-09T22:48:00.001+08:00</published><updated>2014-11-30T09:49:09.015+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 17] 資料驗證 - 思路篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412865437559382" ;=""&gt;3個層面的驗證&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412865437574821" ;=""&gt;目前的問題在那裡？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412865437574512" ;=""&gt;解決思路&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412865437574414" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;在任意的Application裡面，都一定需要儲存資料。而這些資料的正確性是非常重要。舉例來說，以一篇部落格文章來說，這篇文章一定要有“標題”和“作者”，如果沒有這兩個資訊，這篇部落格文章更本就不算是文章。因此，確認進入資料庫的內容的資料是否正確（或者說符合領域裡面的規則），這就是資料正確性。 &lt;/p&gt;&lt;p&gt;在Mvc裡面，有一個非常好的基本資料驗證服務，也就是用DataAnnotation定下欄位基本規則，讓Mvc在Model Binding的時候就會做基本的資料驗證。 &lt;/p&gt;&lt;p&gt;但是那個只是單一的資料驗證，邏輯性的資料驗證呢？例如，需要和另外一個資料庫欄位做比對。這個光靠DataAnnotation是不夠的，只能夠在service層級來做這方面的資料驗證。 &lt;/p&gt;&lt;p&gt;在來，當資料要實際儲存的時候Entity Framework這邊也會有實際DB欄位的資訊，有時候會和DataAnnotation設定的不一樣，導致儲存的時候炸掉。 &lt;/p&gt;&lt;p&gt;上面提到3個層面，其實並沒有一個統一整合的東西把它們包在一起，導致在開發專案的時候，每一個人處理這三個層面的方式都不一樣。 &lt;/p&gt;&lt;p&gt;因此，接下來要看的是，框架如何把這些驗證的地方整合在一起。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412865437559382"&gt;3個層面的驗證&lt;/h1&gt;&lt;p&gt;雖然在開篇提到了關於3個層面的驗證，這裡用一張圖更好的解釋三個層面的驗證和不同之處： &lt;/p&gt;&lt;figure&gt; &lt;div class="mxgraph" style="overflow: hidden; height: 521px; width: 481px; position: relative"&gt;&lt;div style="overflow: hidden; height: 1px; width: 1px"&gt;5Vpdj9o4FP01lnYfpgoEmOSR8LF92EpVp9qPpyqTGBI1xGwSZqC/vsf2db6ZQgtMq0WAyI194xyfe3x9A7Nnm/0fmb+N3omQJ2xohXtmz9lw6Izu8S0NB20YupY2rLM41KZBZXiIv3Aymma7OOR5o2EhRFLE26YxEGnKg6JhW4mkeYmtvzbuK8ND4Cdd699xWER0D8NJZX/L43VkLjOYuPpMXhyMj5Cv/F1S3CkTzsnTG9/4orvaW/pwTP0PdEynt37aGNAXITYNQ8bzCim62ZhGRT4eRRbyrGFK4vRzHTV7gYnLhEBH+Wuzn/FETp6ZmLE1ssZjP5g8Wq678oM77Wd5avMSzoynNLgfdUmAPvnJjm7/Lz+JQ7+IRdqZikzs0pBLVwNme89RXPCHrR/Is88gK2zrzA9jDG4mEqGxspdLCy+cW8VJ0rDLF+x5kYnPvHZGtkcPPTCeFZy4f8rtV/OAAOJiw4vsIPmhm48m5JaCZ2B8PtfYSU2iGjHLIPNputel6wps/CC8T8Te7mD/tii2H/h/O54XHfA1TCaMcJNeHvlbeXKzB+zb6M0qEc9B5GfFm7zA9yc5ScdAb09UKlJ+DcRLOAnxSRfwgZnrOuImkC8KOPmsAd5BmYcQMDpUmNgeT8NplolnWILEz/M4kMZ9XPwDi/VmTEf/UljI3+95FmO4Si4k9YFedqg1l4eyfXmu2UENSo7kzFmAlPvZmh9ro1S3O1PfmorSmPEEuvDUHFXfBNE13osY4y2pYNvt4GsFVS52WcCpV13E2o7GLUejliONQseR4kt5499HoQHddo1DDzx7iiGCPxKw20wEPMfwzwtY25PRGmPBnSbxWq5xj6IosLZdI5INyibxGFH01PnTJ57319DOwcuhK7IiEmuR+smisnrV+iUD7wfCTDP1pTD7RihqGnWxPjnEvh+47qrTQXINoLZHOUSZof9ompdJ1sW4NTCc+Sa3rgLR6HUgUjPTxYgwuTNOXiXeiNQ1SGYCC5dIEqxZv77yqRl/eWm8nbSZ1LfCeu4X/jRNRdGfl/dl4sey6h6cvZnnXDYlPAKnWb/JBxGbsrI61obqdaxN9nBZrMddXu9yxSPrT7FGqndhrCd43TL9NgJZLtpUPngdtLsq8oFvRR4XQg36t7n3+/8tjbLtnhm5ndbQxX/CNMpk2i/nUUf2NDfIo5wOl5cxgIJpDkysZcxRLBtas4gHny+tImS/nYq0ONuX+t9ORU7YxhuJCA6o0amyXW+56gzIb103cU0lkypX913ITTGrjviIaHlRxIc9e4aFy6BSHn6MmTNm0zFbOMyzmXPPFhPm4u3KU96UTUkivqfK8lLd5KwKzArZKhXDTXp/Bck6aeunJvb1yjBlfmmY1a6enFqGMTXRUhRuV4UZnrBDOydv8Mvc+pNs2CTL2clER1Uoxb6GTBhSmI2zKY3V2GTS7UYyQQBeVia6yTRbjBjuHEoBdXAcNp0pdZgpy5i5SykQ2iJP3TN3ypxRn5S4bOoyFxY4mTMHQWTd4aMusGCOJ91NJ8xRguQtpSZJy0DKD7zAu/SLxug8ZwtcGBY1GgwL15Djs1QvXA8eHCVsUDg1rCkcojtGjF7oDosexCQBot4j9sCTtfzVoSEmW9qjYgMclTzlWIPidI0jKVx09FFgPZrLPX7/SiXAG8lXWKI4DDmS1BbPiHx1rpLpCE07LMdxg7TOHHBQO7ohU/28KIknFLyGw+YhYF0RDa8bax3J7WVJTBnxLyMtakd5A2kZ2qRgryItPTmfjOolc7VaICxtpQ0jJRuQCk/GaqUoHf2QCcyQOUvqDlfysbS992UU96gKemvZggNYBkof0FUJGdzAKBuPlJiUqqc0BH4q3x9VVVD3kU1LlSlvB+qDPpp5PVKC57Nqj5rwlTxsb103kAe1Tbu2PFAp49byMBx1HyGaVKTOwwkF8mUf2XZrcz+3OlzrSfrQas6KbdMe4TXUwe7+i6EWVwjKOXP1ei43Ktiey4UcsT/TsViP+3am8BBEfOMrJzrEIQNTKS5nh2sAqNVG9JoB2/u/i6sHaHsj0KVC+Yi28Yz/GntVw8NGhOosLcJt6Czt3RMKuxZaKoX2kCSemHNqRxhU5esXyvhaVLyGLLQ2l+awRgW47Enlzi8U4bD6q5XeVFZ/mLMXXwE=&lt;/div&gt;&lt;/div&gt;&lt;figcaption&gt;Mvc 3 個層面的資料驗證&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;基本上，3個層面驗證的東西都不同： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Controller - 般的基礎驗證，例如必填。&lt;br /&gt;&lt;li&gt;Service - 複雜的商業邏輯驗證&lt;br /&gt;&lt;li&gt;Reposit (DB) - 和最終DB Table Schema比對驗證 &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;h1 id="WizKMOutline_1412865437574821"&gt;目前的問題在那裡？&lt;/h1&gt;&lt;p&gt;現在最大問題在於3個層面的資料驗證沒有一個統一的處理方式。 &lt;/p&gt;&lt;p&gt;舉例來說，第一層，會由Mvc的Controller透過&lt;code&gt;ModeStateDictionary&lt;/code&gt;來記錄驗證結果。 &lt;/p&gt;&lt;p&gt;第二層，複雜的商業邏輯驗證。因為每一個domain都不一樣，因此這邊的邏輯依專案而不同，但是問題是如何把驗證結果傳遞到前端給使用者看？ &lt;/p&gt;&lt;p&gt;假設今天有多人在開發，開發者A或許自己定義Class來把錯誤訊息包起來並且傳遞給Controller去顯示，而開發者B則是用丟exception的方式傳到Controller。這個會造成維護的不方便。 &lt;/p&gt;&lt;p&gt;第三層，當資料和實際DB Schema比對（更準確的說是和Entity Framework所記錄的DB Table Schema），如果不一致，會直接丟出Exception。如果開發者沒有把這個Exception好好處理並且轉成使用者可以看得懂的內容，整個網站就炸掉了。 &lt;/p&gt;&lt;p&gt;因此，這些問題作答在於沒有統一的東西在傳遞這些訊息。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1412865437574512"&gt;解決思路&lt;/h1&gt;&lt;p&gt;上面提到了問題的所在，要解決這個問題，在框架裡面就需要有一個東西，能夠儲存三個層面的驗證資訊，並且統一由Controller來接住，並且顯示在前端。 &lt;/p&gt;&lt;p&gt;而Service層，將會作於Controller端的驗證資訊，和Repository層級的驗證資訊，整合驗證之後，回傳一個共通看得懂的東西給Controller到View裡面。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1412865437574414"&gt;結語&lt;/h1&gt;&lt;p&gt;在這一篇相信已經瞭解到沒有透過一個東西整合三層驗證的資訊是不行的，只有有了統一的處理邏輯，開發者才不用去思考這一塊的內容。 &lt;/p&gt;&lt;p&gt;這一篇是要解決問題的思路而已。因此，下一篇才會介紹如何實作這一篇的思路。 &lt;/p&gt;&lt;script type="text/javascript" src="https://www.draw.io/embed.js?s=flowchart"&gt;&lt;/script&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7662160041193601813/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-17-DataValidation-concept.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7662160041193601813'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7662160041193601813'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-17-DataValidation-concept.html' title='[iThome 第七屆鐵人賽 17] 資料驗證 - 思路篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-886233952618196536</id><published>2014-10-08T22:19:00.000+08:00</published><updated>2014-10-08T22:30:56.651+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 16] 處理檔案上傳 2 - 放到Service層</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412777833601649" ;=""&gt;功能概述&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412777833601541" ;=""&gt;功能實作&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412777833601770" ;=""&gt;在Service裡面新增ViewModel的部分&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412777833601876" ;=""&gt;Controller的變化&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412777833601138" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇，介紹了如何處理檔案上傳的部分。但是，裡面處理上傳檔案的邏輯是放在Mvc的Action裡面。 &lt;/p&gt; &lt;p&gt;這個有一些壞處，首先，和邏輯相關的不應該寫在Controller裡面，因為Controller的工作很簡單，就只是決定Model的資料，和顯示的View是哪一個。把處理這種邏輯放在Controller裡面破會了所謂的關注點分離（SoC）的概念。 &lt;/p&gt; &lt;p&gt;再來屬於SoC的衍生，因為如果邏輯寫在了Controller裡面，未來如果要替換邏輯或者需要做一些測試的時候，更本不好做。加上，如果別的地方也需要同樣邏輯的時候，更本沒有辦法通用。 &lt;/p&gt; &lt;p&gt;因此，這一篇將會介紹如何把邏輯抽到Service層裡面。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412777833601649"&gt;功能概述&lt;/h1&gt; &lt;p&gt;基本的邏輯在上一篇實作了在Controller裡面，現在要抽到Service裡面，尤其是通用型的Service（也就是GenericService&amp;lt;T&amp;gt;），就要以能夠動態的角度去思考如何處理這部分的邏輯，因此，定下一些規則。如果進來的ViewModel符合這些規則，就處理，要不然就不處理。 &lt;/p&gt; &lt;p&gt;檔案處理的邏輯如果在仔細思考一下，基本上就是： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;把&lt;code&gt;HttpPostedFileBase&lt;/code&gt;檔案儲存 (在有檔案的情況下）  &lt;li&gt;把儲存檔案的路徑放到要儲存到DB的欄位 &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;如果要把上面的邏輯自動化的話，就變成： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;找到這個ViewModel裡面是不是有&lt;code&gt;HttpPostedFileBase&lt;/code&gt; - 並且裡面有檔案  &lt;li&gt;把檔案儲存  &lt;li&gt;把路勁給要存到DB的欄位即可 - 要如何知道是哪一個欄位？ &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;關於第三點，就是這個框架處理要設定的規則，有符合規則就處理，要不然就不處理。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-success"&gt; &lt;h4&gt;規則&lt;/h4&gt; &lt;p&gt;&lt;code&gt;HttpPostedFileBase&lt;/code&gt;這個欄位的名字是實際存到DB的欄位名字加上&lt;code&gt;File&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;舉例來說，如果實際存到DB的欄位名字是：&lt;code&gt;CoverImg&lt;/code&gt;，那麼對應的&lt;code&gt;HttpPostedFileBase&lt;/code&gt;名字就是&lt;code&gt;CoverImgFile&lt;/code&gt; &lt;/p&gt;&lt;/div&gt; &lt;p&gt;有了這個規則，就可以把檔案上傳的部分移動到Service裡面。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412777833601541"&gt;功能實作&lt;/h1&gt; &lt;p&gt;接下來就看看如何實際實作功能。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1412777833601770"&gt;在Service裡面新增ViewModel的部分&lt;/h2&gt;&lt;pre class="brush: csharp; highlight: 9"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 依照某一個ViewModel的值，產生對應的Entity並且新增到資料庫&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;/// &amp;lt;param name="viewModel"&amp;gt;ViewModel的Reference&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;returns&amp;gt;是否儲存成功&amp;lt;/returns&amp;gt;&lt;br /&gt;public void CreateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel)&lt;br /&gt;{&lt;br /&gt;    ProcessHttpPostFile(viewModel, @"D:\");&lt;br /&gt;&lt;br /&gt;    var entity = AutoMapper.Mapper.Map&amp;lt;T&amp;gt;(viewModel);&lt;br /&gt;&lt;br /&gt;    db.Repository&amp;lt;T&amp;gt;().Create(viewModel);&lt;br /&gt;&lt;br /&gt;    db.SaveChange();&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;上面，highlight起來就是會處理檔案上傳的部分。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;這個方法基本上就是透過Reflection來找到&lt;code&gt;HttpPostedFileBase&lt;/code&gt;，並且找到對應的檔案。如果有，就會做處理： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 處理ViewModel裡面形態是HttpPostedFileBase的Property。&lt;br /&gt;/// 會把此property的檔案儲存到某個路徑下，並且把儲存的路勁寫在對應的Property裡面&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="viewModel"&amp;gt;要處理的ViewModel&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="basePath"&amp;gt;檔案要儲存位置的base&amp;lt;/param&amp;gt;&lt;br /&gt;private void ProcessHttpPostFile(object viewModel, string basePath)&lt;br /&gt;{&lt;br /&gt;    var properties = viewModel.GetType()&lt;br /&gt;			.GetProperties(BindingFlags.Instance | &lt;br /&gt;			BindingFlags.Public | BindingFlags.FlattenHierarchy);&lt;br /&gt;&lt;br /&gt;    foreach (var item in properties&lt;br /&gt;		.Where(x =&amp;gt; x.PropertyType == typeof(HttpPostedFileBase)))&lt;br /&gt;    {&lt;br /&gt;        var httpost = item.GetValue(viewModel) as HttpPostedFileBase;&lt;br /&gt;&lt;br /&gt;        if (httpost != null &lt;br /&gt;		&amp;amp;&amp;amp; string.IsNullOrEmpty(httpost.FileName) == false)&lt;br /&gt;        {&lt;br /&gt;            // 如果postFile的property名稱後面一定會加File。例如：&lt;br /&gt;			//CoverImgFile對應的string property名稱就是CoverImg。&lt;br /&gt;            // 因此看看是否有property的名稱是postFile的名稱減去4（File是4個字）&lt;br /&gt;            var fileNameProperty = properties&lt;br /&gt;				.Where(x =&amp;gt; x.Name == item.Name.Remove(item.Name.Count() - 4))&lt;br /&gt;				.FirstOrDefault();&lt;br /&gt;&lt;br /&gt;            if (fileNameProperty != null)&lt;br /&gt;            {&lt;br /&gt;                var savePath = Path.Combine(basePath, httpost.FileName);&lt;br /&gt;&lt;br /&gt;                if (Directory.Exists(Path.GetDirectoryName(savePath)) == false)&lt;br /&gt;                {&lt;br /&gt;                    Directory.CreateDirectory(Path.GetDirectoryName(savePath));&lt;br /&gt;                }&lt;br /&gt;&lt;br /&gt;                httpost.SaveAs(savePath);&lt;br /&gt;&lt;br /&gt;                fileNameProperty.SetValue(viewModel, httpost.FileName);&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412777833601876"&gt;Controller的變化&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;把處理的部分移到Service之後，在Controller裡面就變成原來的樣子： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(Create post)&lt;br /&gt;{&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        service.CreateViewModelToDatabase(post);&lt;br /&gt;        return RedirectToAction("Index");&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412777833601138"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過Service層，可以把一些通用的邏輯抽進去，避免掉Controller有太多邏輯，造成日後邏輯無法替換和重複使用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在接下來還會介紹更多Service還能夠包括的功能，使得這些底層的內容還需要每一次都處理。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/886233952618196536/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-16-FileProcess-InService.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/886233952618196536'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/886233952618196536'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-16-FileProcess-InService.html' title='[iThome 第七屆鐵人賽 16] 處理檔案上傳 2 - 放到Service層'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7855873618703384734</id><published>2014-10-07T22:28:00.000+08:00</published><updated>2014-10-07T22:31:52.606+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 15] 處理檔案上傳</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798396" ;=""&gt;整體功能概念&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798753" ;=""&gt;功能實作&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798979" ;=""&gt;欄位說明&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798396" ;=""&gt;View的說明&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798407" ;=""&gt;檔案上傳的處理&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412691943798780" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在網站裡面，通常都會需要讓使用者上傳檔案，好方便前臺或者別的顯示這個資訊的地方來下載這個對應的檔案。 &lt;/p&gt; &lt;p&gt;在Mvc裡面，有所謂的&lt;code&gt;HttpPostedFileBase&lt;/code&gt;可以方便我們接到前端input是file的檔案。這個檔案通常會被存到Server的某一個位置之後，路勁才會儲存到DB 裡面，下次顯示的時候顯示的是這個檔案的路徑。 &lt;/p&gt; &lt;p&gt;處理&lt;code&gt;HttpPostedFileBase&lt;/code&gt;的邏輯其實還滿常見，如果框架能夠把這一部份也處理掉的話，又可以減少我們煩惱這些細節的部份，提升開發效率。 &lt;/p&gt; &lt;p&gt;這一篇我們將來看一下如何做到。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412691943798396"&gt;整體功能概念&lt;/h1&gt; &lt;p&gt;我們的Entity欄位通常會是&lt;code&gt;string&lt;/code&gt;的形態，用來儲存這個上傳檔案的相對路徑。而檔案上傳方便做model binding是&lt;code&gt;HttpPosedFileBase&lt;/code&gt;這個形態，因此我們將會在ViewModel增加一個對應的property用來接使用者所選取的檔案。 &lt;/p&gt; &lt;p&gt;我們的邏輯處理規則是需要： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;&lt;code&gt;HttpPostedFileBase&lt;/code&gt;的檔案存到特定的位置。  &lt;li&gt;把儲存的檔案相對的路徑存入到正確的欄位裡面。 &lt;/li&gt;&lt;/ol&gt;  &lt;h1 id="WizKMOutline_1412691943798753"&gt;功能實作&lt;/h1&gt; &lt;p&gt;有了上面整體的概念之後，將會開始實作。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1412691943798979"&gt;欄位說明&lt;/h2&gt; &lt;p&gt;假設我們現在的&lt;code&gt;Post&lt;/code&gt;需要有一個欄位用來儲存這篇文章的代表圖，因此我們會多一個欄位叫做&lt;code&gt;CoverImg&lt;/code&gt;（在ViewModel），同樣對應到DB的Table欄位也是 &lt;code&gt;CoverImg&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;我們會在多一個欄位叫做&lt;code&gt;CoverImgFile&lt;/code&gt;在ViewModel，這個欄位的主要目的是對應到View裡面的&lt;code&gt;HttpPostedFileBase&lt;/code&gt; &lt;/p&gt; &lt;p&gt;因此目前&lt;code&gt;Post&lt;/code&gt;的定義會是（標亮是新增的兩個欄位）： &lt;/p&gt;&lt;pre class="brush: csharp; highlight:[8,9]"&gt;public partial class Create&lt;br /&gt;{&lt;br /&gt;    public int Id { get; set; }&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;    public string PostContent { get; set; }&lt;br /&gt;    public System.DateTime CreateDateTime { get; set; }&lt;br /&gt;    public Nullable&amp;lt;System.DateTime&amp;gt; LastModifyDateTime { get; set; }&lt;br /&gt;    public string CoverImg { get; set; }&lt;br /&gt;    public HttpPostedFileBase CoverImgFile { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412691943798396"&gt;View的說明&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;再來，對應的View會變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;@if(string.IsNullOrEmpty(Model.CoverImg) == false)&lt;br /&gt;{ &lt;br /&gt;    &amp;lt;img src="~/@Model.CoverImg" /&amp;gt;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;&amp;lt;input type="file" name="CoverImgFile" /&amp;gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;首先是如果檔案已經有上傳過（表示&lt;code&gt;CoverImg&lt;/code&gt;有值），就以圖片方式顯示。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;然後&lt;code&gt;CoverImgFile&lt;/code&gt;則是實際的檔案上傳。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412691943798407"&gt;檔案上傳的處理&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;在&lt;code&gt;Create&lt;/code&gt;的地方將會處理檔案上傳並且把路徑存到&lt;code&gt;CoverImg&lt;/code&gt;： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(Create post)&lt;br /&gt;{&lt;br /&gt;    if(post.CoverImgFile != null)&lt;br /&gt;    {&lt;br /&gt;        var fileName = DateTime.Now.ToString();&lt;br /&gt;&lt;br /&gt;        post.CoverImgFile.SaveAs(fileName);&lt;br /&gt;&lt;br /&gt;        post.CoverImg = fileName;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        service.CreateViewModelToDatabase(post);&lt;br /&gt;        return RedirectToAction("Index");&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊不管是否有驗證成功，都會把檔案儲存起來，避免Validation錯誤返回&lt;code&gt;Model&lt;/code&gt;的時候，之前選的檔案會不存在。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412691943798780"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;到這裡之後，相信對於如何處理檔案上傳和把檔案路徑放入對應的欄位已經瞭解。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;但是，相信使用上面來說不是很方便。首先，寫在Controller裡面這部份的邏輯就很不適合，再來，如果這個邏輯以後要修改或者需要通用基本上做不到。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，在下一篇，將會介紹如何透過Service層，把處理檔案上傳的邏輯抽出來，讓這部份的邏輯能夠共用。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7855873618703384734/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-15-FileProcess.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7855873618703384734'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7855873618703384734'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-15-FileProcess.html' title='[iThome 第七屆鐵人賽 15] 處理檔案上傳'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2726509402513752344</id><published>2014-10-06T21:45:00.001+08:00</published><updated>2014-10-06T21:55:29.813+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 14] 把目前的CRUD功能抽到Service層</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951345" ;=""&gt;IService&lt;t&gt;的定義&lt;/t&gt;&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951516" ;=""&gt;GenericService&lt;t&gt; - IService&lt;t&gt;的實作&lt;/t&gt;&lt;/t&gt;&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951680" ;=""&gt;定義專案相關的Service和實作&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951525" ;=""&gt;Controller裡面的修改&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951271" ;=""&gt;註冊到Autofac&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951137" ;=""&gt;Controller - CR的修改&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951177" ;=""&gt;Controller - UD的修改&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412602823951340" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了什麽是Service層，和爲什麽要使用Service層。在這一篇，將會把CRUD裡面的方法先抽到Service層裡面，因此Controller不在直接和Data Access Layer溝通，而是透過Service層來和Data Access Layer溝通。 &lt;/p&gt; &lt;p&gt;在定義Service功能的時候，將會使用泛型的方式讓程式碼能夠通用，然後各自在繼承通用型的方法來提供個別功能的客制。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412602823951345"&gt;IService&amp;lt;T&amp;gt;的定義&lt;/h1&gt; &lt;p&gt;在定義實作之前，先來定義好相對應的功能有什麽。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Service服務層內容的Interface&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;主要要儲存的Entity Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public interface IService&amp;lt;T&amp;gt;&lt;br /&gt;    where T : class&lt;br /&gt;{&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得符合條件的Entity並且轉成對應的ViewModel&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾邏輯&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="includes"&amp;gt;需要Include的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得轉換過的ViewModel List&amp;lt;/returns&amp;gt;&lt;br /&gt;    List&amp;lt;TViewModel&amp;gt; GetListToViewModel&amp;lt;TViewModel&amp;gt;(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate, &lt;br /&gt;        params Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;[] includes);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得某一個條件下面的某一筆Entity並且轉成對應的ViewModel&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾邏輯&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="includes"&amp;gt;需要Include的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得轉換過的ViewModel或者是null&amp;lt;/returns&amp;gt;&lt;br /&gt;    TViewModel GetSpecificDetailToViewModel&amp;lt;TViewModel&amp;gt;(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate, &lt;br /&gt;        params Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;[] includes);&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 依照某一個ViewModel的值，產生對應的Entity並且新增到資料庫&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="viewModel"&amp;gt;ViewModel的Reference&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否儲存成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    void CreateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 依照某一個ViewModel的值，更新對應的Entity&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="viewModel"&amp;gt;ViewModel的值&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾條件 - 要被更新的那一筆過濾調價&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否刪除成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    void UpdateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel, &lt;br /&gt;		Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 刪除某一筆Entity&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾出要被刪除的Entity條件&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否刪除成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    void Delete(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412602823951516"&gt;GenericService&amp;lt;T&amp;gt; - IService&amp;lt;T&amp;gt;的實作&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;這個部份將會實作IService裡面的服務。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 通用行的Service layer實作&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;主要的Entity形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public class GenericService&amp;lt;T&amp;gt; : IService&amp;lt;T&amp;gt;&lt;br /&gt;    where T : class&lt;br /&gt;{&lt;br /&gt;    protected IUnitOfWork db;&lt;br /&gt;&lt;br /&gt;      /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得符合條件的Entity並且轉成對應的ViewModel&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾邏輯&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="includes"&amp;gt;需要Include的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得轉換過的ViewModel List&amp;lt;/returns&amp;gt;&lt;br /&gt;    public virtual List&amp;lt;TViewModel&amp;gt; GetListToViewModel&amp;lt;TViewModel&amp;gt;(System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate, &lt;br /&gt;        params System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;[] includes)&lt;br /&gt;    {&lt;br /&gt;         var data = db.Repository&amp;lt;T&amp;gt;().Reads();&lt;br /&gt;&lt;br /&gt;        foreach (var item in includes)&lt;br /&gt;        {&lt;br /&gt;            data.Include(item);&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return AutoMapper.Mapper.Map&amp;lt;List&amp;lt;TViewModel&amp;gt;&amp;gt;(data.Where(wherePredicate));&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;      /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得某一個條件下面的某一筆Entity並且轉成對應的ViewModel&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾邏輯&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="includes"&amp;gt;需要Include的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得轉換過的ViewModel或者是null&amp;lt;/returns&amp;gt;&lt;br /&gt;    public virtual TViewModel GetSpecificDetailToViewModel&amp;lt;TViewModel&amp;gt;(System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate, &lt;br /&gt;        params System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;[] includes)&lt;br /&gt;    {&lt;br /&gt;         var data = db.Repository&amp;lt;T&amp;gt;().Reads();&lt;br /&gt;&lt;br /&gt;        foreach (var item in includes)&lt;br /&gt;        {&lt;br /&gt;            data.Include(item);&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return AutoMapper.Mapper.Map&amp;lt;TViewModel&amp;gt;(data.Where(wherePredicate).FirstOrDefault());&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;     /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 依照某一個ViewModel的值，更新對應的Entity&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="viewModel"&amp;gt;ViewModel的值&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾條件 - 要被更新的那一筆過濾調價&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否刪除成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    public virtual void UpdateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel, System.Linq.Expressions.Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate)&lt;br /&gt;    {&lt;br /&gt;        var entity = db.Repository&amp;lt;T&amp;gt;().Read(wherePredicate);&lt;br /&gt;&lt;br /&gt;        AutoMapper.Mapper.Map(viewModel, entity);&lt;br /&gt;&lt;br /&gt;        db.Repository&amp;lt;T&amp;gt;().Update(entity);&lt;br /&gt;&lt;br /&gt;        db.SaveChange();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 刪除某一筆Entity&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="wherePredicate"&amp;gt;過濾出要被刪除的Entity條件&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否刪除成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    public virtual void Delete(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; wherePredicate)&lt;br /&gt;    {&lt;br /&gt;        var data = db.Repository&amp;lt;T&amp;gt;().Read(wherePredicate);&lt;br /&gt;        db.Repository&amp;lt;T&amp;gt;().Delete(data);&lt;br /&gt;&lt;br /&gt;        db.SaveChange();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 依照某一個ViewModel的值，產生對應的Entity並且新增到資料庫&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TViewModel"&amp;gt;ViewModel的形態&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="viewModel"&amp;gt;ViewModel的Reference&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;是否儲存成功&amp;lt;/returns&amp;gt;&lt;br /&gt;    public void CreateViewModelToDatabase&amp;lt;TViewModel&amp;gt;(TViewModel viewModel)&lt;br /&gt;    {&lt;br /&gt;        var entity = AutoMapper.Mapper.Map&amp;lt;T&amp;gt;(viewModel);&lt;br /&gt;&lt;br /&gt;        db.Repository&amp;lt;T&amp;gt;().Create(viewModel);&lt;br /&gt;&lt;br /&gt;        db.SaveChange();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412602823951680"&gt;定義專案相關的Service和實作&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過這種方式，在之後需要擴充功能將會變的簡單。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public interface IPostService: IService&amp;lt;Post&amp;gt;&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public class PostService &lt;br /&gt;    : GenericService&amp;lt;Post&amp;gt;, IPostService&lt;br /&gt;{&lt;br /&gt;    public PostService(IUnitOfWork inDb)&lt;br /&gt;        : base(inDb)&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;在使用上，IService和GenericService可以作為框架的基礎方法。而個別專案則透過繼承和實作這個通用的服務來達到擴充或複寫以符合專案的需求。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412602823951525"&gt;Controller裡面的修改&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;Service做好了之後，第一件事情就是把它拿來用，因此會需要： &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412602823951271"&gt;註冊到Autofac&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;記得註冊服務到Autofac才有DI的功能： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;builder.RegisterType&amp;lt;PostService&amp;gt;().As&amp;lt;IPostService&amp;gt;();&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412602823951137"&gt;Controller - CR的修改&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;...&lt;br /&gt;private IPostService service;&lt;br /&gt;&lt;br /&gt;public PostsController(IPostService inService)&lt;br /&gt;{&lt;br /&gt;    service = inService;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// GET: Posts&lt;br /&gt;public ActionResult Index()&lt;br /&gt;{&lt;br /&gt;    //return View(db.Post.ToList());&lt;br /&gt;    return View(service.GetListToViewModel&amp;lt;Index&amp;gt;());&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// GET: Posts/Details/5&lt;br /&gt;public ActionResult Details(int? id)&lt;br /&gt;{&lt;br /&gt;    if (id == null)&lt;br /&gt;    {&lt;br /&gt;        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);&lt;br /&gt;    }&lt;br /&gt;    // Post post = db.Post.Find(id);&lt;br /&gt;    Detail post = service.GetSpecificDetailToViewModel&amp;amp;lt;Detail&amp;amp;gt;(x =&amp;amp;gt; x.Id == id);&lt;br /&gt;    if (post == null)&lt;br /&gt;    {&lt;br /&gt;        return HttpNotFound();&lt;br /&gt;    }&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// GET: Posts/Create&lt;br /&gt;public ActionResult Create()&lt;br /&gt;{&lt;br /&gt;    return View();&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// POST: Posts/Create&lt;br /&gt;// To protect from overposting attacks, please enable the specific properties you want to bind to, for &lt;br /&gt;// more details see http://go.microsoft.com/fwlink/?LinkId=317598.&lt;br /&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(Create post)&lt;br /&gt;{&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        service.CreateViewModelToDatabase(post);&lt;br /&gt;        return RedirectToAction(&amp;amp;quot;Index&amp;amp;quot;);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412602823951177"&gt;Controller - UD的修改&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;// GET: Posts/Edit/5&lt;br /&gt;public ActionResult Edit(int? id)&lt;br /&gt;{&lt;br /&gt;    if (id == null)&lt;br /&gt;    {&lt;br /&gt;        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);&lt;br /&gt;    }&lt;br /&gt;    Edit post = service.GetSpecificDetailToViewModel&amp;lt;Edit&amp;gt;(x =&amp;gt; x.Id == id);&lt;br /&gt;    if (post == null)&lt;br /&gt;    {&lt;br /&gt;        return HttpNotFound();&lt;br /&gt;    }&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// POST: Posts/Edit/5&lt;br /&gt;// To protect from overposting attacks, please enable the specific properties you want to bind to, for &lt;br /&gt;// more details see http://go.microsoft.com/fwlink/?LinkId=317598.&lt;br /&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Edit(Edit post)&lt;br /&gt;{&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        service.UpdateViewModelToDatabase(Edit, x =&amp;gt; x.Id == post.Id);&lt;br /&gt;       &lt;br /&gt;        return RedirectToAction("Index");&lt;br /&gt;    }&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// GET: Posts/Delete/5&lt;br /&gt;public ActionResult Delete(int? id)&lt;br /&gt;{&lt;br /&gt;    if (id == null)&lt;br /&gt;    {&lt;br /&gt;        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);&lt;br /&gt;    }&lt;br /&gt;    Detail post = service.GetSpecificDetailToViewModel&amp;lt;Detail&amp;gt;(x =&amp;gt; x.Id == id);&lt;br /&gt;    if (post == null)&lt;br /&gt;    {&lt;br /&gt;        return HttpNotFound();&lt;br /&gt;    }&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// POST: Posts/Delete/5&lt;br /&gt;[HttpPost, ActionName("Delete")]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult DeleteConfirmed(int id)&lt;br /&gt;{&lt;br /&gt;    service.Delete(x =&amp;gt; x.Id == id);&lt;br /&gt;&lt;br /&gt;    return RedirectToAction("Index");&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412602823951340"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;當Controller都和Service層溝通的時候，這裡面就多了一層的abstraction，意味著邏輯能夠重複使用，並且未來要替換邏輯也會變的更加容易。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;不過相信看到這邊，對於這個初步的Service肯定不會很滿意，畢竟只提供了最基本的功能。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在之後的篇章，將會慢慢的把這個Service補上更多功能。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在下一篇，將會先看有了Service層之後，對一些檔案上傳的處理有哪些幫助。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2726509402513752344/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html#comment-form' title='2 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2726509402513752344'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2726509402513752344'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html' title='[iThome 第七屆鐵人賽 14] 把目前的CRUD功能抽到Service層'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>2</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8827147089197093748</id><published>2014-10-05T20:51:00.000+08:00</published><updated>2014-10-05T20:51:00.549+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 13] Service層 - 概念篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412512808141470" ;=""&gt;什麽是Service層？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412512808142127" ;=""&gt;爲什麽需要Service層&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412512808142264" ;=""&gt;3 Layer Application在Mvc裡面的對應&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1412512808142463" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;在這一篇將會看所謂的Service層。爲什麽需要Service層？並且Service層包含了什麽東西，並且在使用上，會給我們帶來什麽便利。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412512808141470"&gt;什麽是Service層？&lt;/h1&gt;&lt;p&gt;這邊提到的層就是英語所謂的Layer。而Layer就是logical separation of set of functionality （邏輯性的切割一組功能）。舉例來說，和儲存有關的功能就屬於Data Access Layer。 &lt;/p&gt;&lt;p&gt;Layer的主要作用和所謂的SoC（Separation of Concern）是一樣的概念，每一個Layer有屬於自己的範圍。 &lt;/p&gt;&lt;p&gt;在一般任意的Application裡面，通常都有至少3個Layer。Presentation Layer、Service Layer和Data Access Layer。 &lt;/p&gt;&lt;p&gt;Presentation Layer屬於任何和畫面有關的部份。 &lt;/p&gt;&lt;p&gt;Service Layer 屬於比較偏商業邏輯層。 &lt;/p&gt;&lt;p&gt;Data Access Layer - 任何Application最終都需要儲存資料，而Data Access Layer就是儲存資料的層級。 &lt;/p&gt;&lt;p&gt;這三個Layer組起來就是常見所謂的3 Layer Application。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1412512808142127"&gt;爲什麽需要Service層&lt;/h1&gt;&lt;p&gt;在Mvc裡面有個3字口訣： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Model要&lt;em&gt;重&lt;/em&gt; ：表示處理邏輯都在這邊&lt;br /&gt;&lt;li&gt;Controller要&lt;em&gt;輕&lt;/em&gt;：Controller只負責組裝ViewModel的資料和選擇呈現的View&lt;br /&gt;&lt;li&gt;View要&lt;em&gt;笨&lt;/em&gt;：不要有過多的邏輯和運算，這邊只是要呈現資料的template &lt;/li&gt;&lt;br /&gt;&lt;/ol&gt;&lt;p&gt;這邊需要注意到的是Controller。 &lt;/p&gt;&lt;p&gt;由於預設的scaffolding產生出一個基本的CRUD的時候會在Controller裡面直接實例一個&lt;code&gt;DbContext&lt;/code&gt;，並且在Action裡面直接和&lt;code&gt;DbContext&lt;/code&gt;溝通，導致和容易就把程式邏輯寫在Action裡面。但是這個對於整個程式的彈性是不好。 &lt;/p&gt;&lt;p&gt;因為假設別的地方也需要用到一樣的邏輯去產生對應的ViewModel，寫在Controller裡面，就沒有辦法共用這個邏輯。 &lt;/p&gt;&lt;p&gt;而Service層才是適合做這件事情。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1412512808142264"&gt;3 Layer Application在Mvc裡面的對應 &lt;/h1&gt;&lt;p&gt;基本上來說，在Mvc和3 Layer Application的對應大概是： &lt;/p&gt;&lt;figure&gt; &lt;div class="mxgraph" style="overflow: hidden; height: 465px; width: 311px; position: relative"&gt;&lt;div style="overflow: hidden; height: 1px; width: 1px"&gt;3Vjfc+IsFP1reOxODDHGR7V292E70xln9scjJajMYnAI/upf34u5mETar9avbrt9ceRALnDO4XITQkeL7VfDlvNbnQtF4ijfEnpN4jhLevDrgF0FxGlUATMj8wrq1MBEPggE/bCVzEXZGmi1VlYu2yDXRSG4bWFTrdpTLNnMh6+BCWcqRH/K3M5xD3Fa49+EnM39NJ20X/WUdudj5GLKVspe7SHoc90L5mPhrrYRspFggB0C2FyyorWiB60XLcCIsqYKdytxWTjHvTa5MC1IyeJPkzY6BuWM1vCg+7fYjoRy6nll4vt+Gk/70263y7Mk5VdVnJtThx/4NKLAxf3fkMjomqkVbv8OuIDwzEpdQM93toNdH6ti9KrIhQvaIXS4mUsrJkvGXe8GfAvYWhgrwQoDJWeOfKsdOpVKjbTSFY80TYfxDax1ONWFRbN2shN2iUy4SQQejVoBODtCL4Q1O2eNo3OC56afVM1N7Usa4ZB505MeZCj07BC6phn+INMnsk4D1n9IsQGEjLukH5MMQkYj4MRopc6g/wIEUtomsBN3AwY7vScY9MS/KYGoXoPAiTBrCQx8WsfGFKd5H8ui2g3GA4pFkQ+M0RtoccXKUvKAJzqEQTdA6V6Hk1kTeeuiCTkzQkHCWrcz+FP7x0fvtIQ5a3N743pz+/TgQ5R6ZbjAp5r59YVAB9F8IMvMTNgg0F6Ow37OUwhv1YZCWD18hOSBbvG0eJreJXlgCdUg6ppZBsiAc1GWnzeF0N673nq4x0+aQrIjro9P/skp5DiQF+0vpBAslz9mCmnTkkShly+WQpIkTaeM34ONWBSJCKvs11sZCDG7XwBFX3pd3/6NPIqttM0+aLoueJUZliC69eEKXcAcFYYHwY0JjsWR5U9R5M2PRdJ9wc2nHosg0OVu1kBtb9ZXq/28oP9thH9ByaC0OVfJoNi6oJLhixcg/rqPBsulgusb33yb72K3a07GPdIfkCxx+DAi2TUZpyTrkSz8aAE5DcQZMiwDOGjlPh0E9cFC5rl7Jrji9m2M91yqPM8FvjQ4FiEsyKjHmtnUZ9hXZFNo1t9EKhHrT1t0/Ag=&lt;/div&gt;&lt;/div&gt;&lt;figcaption&gt;3層式架構和Mvc對應&lt;/figcaption&gt; &lt;/figure&gt; &lt;h1 id="WizKMOutline_1412512808142463"&gt;結語&lt;/h1&gt;&lt;p&gt;在這一篇瞭解到了透過增加Service層，我們能夠讓一些商業邏輯更容易的被共用，並且整個Application的SoC更加的清楚。 &lt;/p&gt;&lt;p&gt;在下一篇將會看到，如何建造Service層，並且Controller如何使用。 &lt;/p&gt;&lt;script type="text/javascript" src="https://www.draw.io/embed.js"&gt;&lt;/script&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/8827147089197093748/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-13-service-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8827147089197093748'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/8827147089197093748'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-13-service-intro.html' title='[iThome 第七屆鐵人賽 13] Service層 - 概念篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2328184661420665521</id><published>2014-10-04T20:01:00.000+08:00</published><updated>2014-11-30T09:49:08.989+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 12] BaseController的重要性</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412423976493870" ;=""&gt;爲什麽要自定自己的BaseController&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412423976493229" ;=""&gt;強型別的RedirectToAction&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412423976493643" ;=""&gt;取得和使用強型別的RedirectToAction&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412423976493410" ;=""&gt;BaseController讓強型別的RedirectToAction用起來和原來的版本一樣&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412423976493693" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在這一篇將會介紹爲什麽對框架來說有一個BaseController讓所有的Controller來繼承很重要，並且介紹一個簡單的強型別的&lt;code&gt;RedirectToAction&lt;/code&gt;讓所有繼承這個BaseController的可以來使用。 &lt;/p&gt; &lt;p&gt;透過這個強型別的RedirectToAction讓在寫Code的時候，不要犯下寫錯Action的名字，或者Action名字改了但是對應的RedirectToAction沒有改到的低級錯誤。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412423976493870"&gt;爲什麽要自定自己的BaseController&lt;/h1&gt; &lt;p&gt;所有的Controller都會繼承&lt;code&gt;System.Web.Mvc.Controller&lt;/code&gt;。繼承的概念在OO裡面很重要，因為可以讓一些所有Controller都通用的功能，透過繼承來傳下去。同時，一些特殊的Attribute如果放在Controller的層級，那麼所有的ActionResult都會有效果，因此針對我們的框架，就會定義一個框架的BaseController來讓所有的Controller繼承，以提供一些通用的方法。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412423976493229"&gt;強型別的RedirectToAction&lt;/h1&gt; &lt;p&gt;定義一個BaseController非常的簡單，只需要定一個class然後讓他繼承&lt;code&gt;System.Web.Mvc.Controller&lt;/code&gt;，之後我們實際要使用的Controller在繼承這個BaseController 就可以了。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Application 層級的BaseController&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class BaseController : Controller&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// 繼承BaseController&lt;br /&gt;public class HomeController : BaseController&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;爲了未來的擴充性，因此就算目前沒有任何共通的方法而讓BaseController留空都沒關係，因為有了這一層，在未來需要添加內容就會變的相對簡單。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;不過爲了不讓我們的BaseController什麽都沒有，我們來做一個很好用的功能，那就是加入強型別的RedirectToAction。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;那什麽是強型別的RedirectToAction？基本上Controller已經有一個&lt;code&gt;RedirectToAction&lt;/code&gt;的方法，不過這個方法和很多Mvc的helper方法一樣，接受一個string作為參數，而這個string就是所謂的“magic string”會幫我們對應到正確的Action。舉例來說，通常儲存成功都會做一個&lt;code&gt;RedirectToAction("Index")&lt;/code&gt;，表示回傳的內容將會是這個Controller的&lt;code&gt;Index&lt;/code&gt; ActionResult。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;問題來了，假設今天打的太快，把“Index”打成“Indx”（或者是把Action從“Index”改成了“Home”但是忘記改對應的RedirectToAction），因為它是string，在compile time完全看不出來打錯了。只有到Runtime才會發現有問題。那這個地方就有可能被漏掉並且造成系統炸掉，如果剛好在客戶面前發生，那麼整個開發團隊感覺就low掉了。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;&lt;a href="http://lh3.ggpht.com/-ux-DuxiwmsE/VC_h009Y8dI/AAAAAAAANgM/TyeLvTsLAbw/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-qfW17K9S59c/VC_h245N29I/AAAAAAAANgU/YIl7pCJ9KkA/image_thumb%25255B1%25255D.png?imgmax=800" width="362" height="224"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;少打一個字母，其實肉眼很不容易發現&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;而強型別的RedirectToAction就可以避免掉這個問題。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412423976493643"&gt;取得和使用強型別的RedirectToAction&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;有一個Nuget的package叫做：&lt;code&gt;Microsoft.AspNet.Mvc.Futures&lt;/code&gt;。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;可以透過&lt;code&gt;Package Mangement Console&lt;/code&gt;輸入：&lt;kbd&gt;Install-Package Microsoft.AspNet.Mvc.Futures&lt;/kbd&gt;來安裝。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;這個Package就有包含一個強型別的RedirectToAction，不過它屬於extension method，因此使用起來有些變扭： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 繼承BaseController&lt;br /&gt;public class HomeController : BaseController&lt;br /&gt;{&lt;br /&gt;    public ActionResult Index()&lt;br /&gt;    {&lt;br /&gt;        return View();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public ActionResult Create()&lt;br /&gt;    {&lt;br /&gt;		...&lt;br /&gt;        return this.RedirectToAction&amp;lt;HomeController&amp;gt;(x =&amp;gt; x.Index());&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個強型別的RedirectToAction是很好，可是用起來都需要加上&lt;code&gt;this&lt;/code&gt;實在和原始的RedirectToAction感覺不一樣，難道沒有辦法讓呼叫強型別的時候，不要透過&lt;code&gt;this&lt;/code&gt;？這時候我們的BaseController就能夠排上用場。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412423976493410"&gt;BaseController讓強型別的RedirectToAction用起來和原來的版本一樣&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;我們可在BaseController做一個Wrapper，把那個extension方法包起來，這樣呼叫起來感覺強型別的RedirectToAction就和原本的是一樣的呼叫方式： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Application 層級的BaseController&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class BaseController : Controller&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Redirects to action.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="TController"&amp;gt;The type of the controller.&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="action"&amp;gt;The action.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;br /&gt;    protected ActionResult RedirectToAction&amp;lt;TController&amp;gt;(Expression&amp;lt;Action&amp;lt;TController&amp;gt;&amp;gt; action)&lt;br /&gt;        where TController : Controller&lt;br /&gt;    {&lt;br /&gt;        return ControllerExtensions.RedirectToAction(this, action);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// 繼承BaseController&lt;br /&gt;public class HomeController : BaseController&lt;br /&gt;{&lt;br /&gt;    public ActionResult Index()&lt;br /&gt;    {&lt;br /&gt;        return View();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public ActionResult Create()&lt;br /&gt;    {&lt;br /&gt;	...&lt;br /&gt;        return RedirectToAction&amp;lt;HomeController&amp;gt;(x =&amp;gt; x.Index());&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-warning"&gt;這邊有一點需要注意，假設&lt;code&gt;Index&lt;/code&gt;需要傳入參數，這個強型別的方法是會有問題。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412423976493693"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;希望透過這個例子，能夠展示出有一個共通的Base是很好的一件事情，就算目前不需要擴充，但是只要所有的都繼承這個Base，以後要擴充就很方便。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;同時希望透過介紹強型別的RedirectToAction讓在寫Code的時候，避免掉低級錯誤，像是打錯字，或者改名字沒有改到對應的“Magic String” &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2328184661420665521/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-12-importantofbasecontroller.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2328184661420665521'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2328184661420665521'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-12-importantofbasecontroller.html' title='[iThome 第七屆鐵人賽 12] BaseController的重要性'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-qfW17K9S59c/VC_h245N29I/AAAAAAAANgU/YIl7pCJ9KkA/s72-c/image_thumb%25255B1%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3946649274158208007</id><published>2014-10-03T22:48:00.000+08:00</published><updated>2014-11-30T09:49:09.001+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 11] 傳遞資訊到前端的通用型服務</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113797" ;=""&gt;如何從後端傳遞訊息到前端&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113359" ;=""&gt;使用TempData的難處&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113280" ;=""&gt;AlertService功能概念&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113799" ;=""&gt;實作功能&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113817" ;=""&gt;AlertViewModel&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113495" ;=""&gt;AlertDecoratorActionResult和方便使用的4個Extension方法&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113777" ;=""&gt;View的部份&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113247" ;=""&gt;如何使用&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412347482113472" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;到目前為止，已經介紹了很多屬於基礎建設的部份。從核心的DI用Autofac開始，再到那裡都使用的到的Log服務。再來介紹了ViewModel和如何透過框架來讓對應變得更加簡單。最後介紹了透過Repository 和 Unit of work，使得實際的DAL層級能夠被abstraction出來。 &lt;/p&gt; &lt;p&gt;在這一篇，將會介紹比較偏向Controller層級的內容，也就是每一個application一定會使用到的：如何提供一種一致性的服務用於從Server傳遞訊息到客戶端？ &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412347482113797"&gt;如何從後端傳遞訊息到前端&lt;/h1&gt; &lt;p&gt;所謂傳遞訊息到前端的意思是，通常來說每當一個功能執行完成之後，一定會提供一些feedback給user。例如，新增一筆資料成功，系統可能會用一個&lt;code&gt;alert&lt;/code&gt;訊息來顯示“新增成功”。 &lt;/p&gt; &lt;p&gt;因為這個功能非常通用，因此Mvc裡面有一個特殊的儲存空間叫做&lt;code&gt;TempData&lt;/code&gt;。有別於&lt;code&gt;ViewData&lt;/code&gt;只能保存一次的request值到View裡面，&lt;code&gt;TempData&lt;/code&gt; 底層也是用&lt;code&gt;Session&lt;/code&gt;來儲存，但是有別於&lt;code&gt;Session&lt;/code&gt;在，當&lt;code&gt;TempData&lt;/code&gt;的值被&lt;em&gt;讀過&lt;/em&gt;，那一筆資料就會被清掉。 &lt;/p&gt; &lt;p&gt;因此，&lt;code&gt;TempData&lt;/code&gt;非常適合用來存這一種一次性的feedback訊息，顯示完之後就不需要了。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412347482113359"&gt;使用TempData的難處&lt;/h1&gt; &lt;p&gt;&lt;code&gt;TempData&lt;/code&gt;很適合存一次性資訊，但是實際在開發的時候不是那麼方便。在一個多人團隊開發的情況可能有以下幾個情況： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;&lt;em&gt;在沒有講好的情況下，每個人使用的&lt;code&gt;TempData&lt;/code&gt;Key不一樣&lt;/em&gt;：開發者A可能使用message作為key，但是開發者B可能使用messages。  &lt;li&gt;&lt;em&gt;要設定錯誤訊息的時候不方便&lt;/em&gt;：&lt;code&gt;Action&lt;/code&gt;裡面設定&lt;code&gt;TempData&lt;/code&gt;其實不是很好用。 &lt;/li&gt;&lt;/ol&gt; &lt;p&gt;因此這一次我們會建制一個&lt;code&gt;AlertService&lt;/code&gt;來提供一個好用的傳遞訊息的方式。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412347482113280"&gt;AlertService功能概念&lt;/h1&gt; &lt;p&gt;基本上我們會先建立一個用來封轉要顯示在前端的訊息ViewModel。這個ViewModel只有兩個Property，一個是&lt;code&gt;Message&lt;/code&gt;：代表要顯示的訊息，還有一個是 &lt;code&gt;AlertClass&lt;/code&gt;：也就是這個訊息要顯示的樣式。 &lt;/p&gt; &lt;p&gt;爲了能夠讓設定要傳遞的訊息更加簡單，將會建立一個&lt;code&gt;AlertDecoratorActionResult&lt;/code&gt;，這個特別的ActionResult只是讓設定訊息更加的方便。同時，爲了讓使用這個 ActionResult更加的方便，會在建立對應的4個Extension 方法，方便建立&lt;code&gt;AlertViewModel&lt;/code&gt;。 &lt;/p&gt; &lt;p&gt;最後，會建立屬於View的部份，並且使用bootstrap的&lt;code&gt;alert container&lt;/code&gt;來顯示不同層級的訊息。 &lt;/p&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-a4RIPV8yAR8/VC63G7JvNZI/AAAAAAAANf0/FvZqP3-EHyM/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-4Qrfm_YSg-o/VC63KG1t4II/AAAAAAAANf8/GJTBI7UBe24/image_thumb%25255B1%25255D.png?imgmax=800" width="455" height="202"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;將會實作的Class Diagram&lt;/figcaption&gt; &lt;/figure&gt; &lt;h1 id="WizKMOutline_1412347482113799"&gt;實作功能&lt;/h1&gt; &lt;p&gt;有了上面的介紹，應該有了基本要建造的功能內容，就來看看如何實作。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1412347482113817"&gt;AlertViewModel&lt;/h2&gt; &lt;p&gt;首先先定義ViewModel的樣子： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 用來代表一筆需要顯示的Alert資訊ViewModel&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class AlertViewModel&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存這個Alert資訊的Class - 用來區分呈現的顏色&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// Alert資訊的Class值&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string AlertClass { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Alert資訊的內容值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// Alert資訊的值&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string Message { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Initializes a new instance of the &amp;lt;see cref="AlertViewModel"/&amp;gt; class.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="alertClass"&amp;gt;Alert資訊的Class值&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;Alert資訊的內容&amp;lt;/param&amp;gt;&lt;br /&gt;    public AlertViewModel(string alertClass, string message)&lt;br /&gt;    {&lt;br /&gt;        AlertClass = alertClass;&lt;br /&gt;        Message = message;&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412347482113495"&gt;AlertDecoratorActionResult和方便使用的4個Extension方法&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;首先是AlertDecoratorActionResult： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 一個Decorator Pattern的ActionResult，讓增加Alert訊息變的方便&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class AlertDecoratorActionResult : ActionResult&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定實際的ActionResult&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// 實際的ActionResult值&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public ActionResult InnerResult { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定Alert的Class&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// Alert的Class&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string AlertClass { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得或設定Alert的訊息&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;value&amp;gt;&lt;br /&gt;    /// Alert的訊息&lt;br /&gt;    /// &amp;lt;/value&amp;gt;&lt;br /&gt;    public string Message { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    ///    Initializes a new instance of the &lt;br /&gt;    ///    &amp;lt;see cref="AlertDecoratorActionResult"/&amp;gt; class.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="inInnerResult"&amp;gt;The in inner result.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="inAlertClass"&amp;gt;The in alert class.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="inMessage"&amp;gt;The in message.&amp;lt;/param&amp;gt;&lt;br /&gt;    public AlertDecoratorActionResult(ActionResult inInnerResult, &lt;br /&gt;		string inAlertClass, string inMessage)&lt;br /&gt;    {&lt;br /&gt;        this.InnerResult = inInnerResult;&lt;br /&gt;        this.AlertClass = inAlertClass;&lt;br /&gt;        this.Message = inMessage;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Enables processing of the result of an action &lt;br /&gt;    ///    method by a custom type that inherits from the&lt;br /&gt;    ///    &amp;lt;see cref="T:System.Web.Mvc.ActionResult" /&amp;gt; class.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="context"&amp;gt;The context in &lt;br /&gt;    ///   which the result is executed. &lt;br /&gt;    ///   The context information includes the controller, &lt;br /&gt;    ///   HTTP content, request context, and route data.&amp;lt;/param&amp;gt;&lt;br /&gt;    public override void ExecuteResult(ControllerContext context)&lt;br /&gt;    {&lt;br /&gt;        context.Controller.TempData.AddAlert(this.AlertClass, this.Message);&lt;br /&gt;        this.InnerResult.ExecuteResult(context);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;code&gt;AlertDecoratorActionResult&lt;/code&gt;基本上是實作了Decorator Pattern，基本上就是把實際要顯示的ActionResult包了一層，然後注入要顯示的訊息到&lt;code&gt;TempData&lt;/code&gt;。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;在上面的&lt;code&gt;TempData.AddAlert()&lt;/code&gt;方法是客制的Extension方法，稍後會看到。 &lt;/div&gt;&lt;br /&gt;&lt;p&gt;實際使用的時候不是很便利，因此會使用4個Extension方法來擴充，加上兩個方便存和取TempData裡面的Alert： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Alert相關的Helper方法，方便呼叫使用&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public static class AlertExtension&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Alert存到TempData的Key值&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    private static readonly string Alerts = "_Alerts";&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得目前所擁有的Alert清單。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="tempData"&amp;gt;TempData&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;目前所還沒有顯示過的Alert清單&amp;lt;/returns&amp;gt;&lt;br /&gt;    public static List&amp;lt;AlertViewModel&amp;gt; GetAlerts(this TempDataDictionary tempData)&lt;br /&gt;    {&lt;br /&gt;        if (!tempData.ContainsKey(Alerts))&lt;br /&gt;        {&lt;br /&gt;            tempData[Alerts] = new List&amp;lt;AlertViewModel&amp;gt;();&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return (List&amp;lt;AlertViewModel&amp;gt;)tempData[Alerts];&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 增加一筆要顯示的Alert&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="tempData"&amp;gt;TempData&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="messageClass"&amp;gt;這筆Alert的Class值&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;這筆Alert的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    public static void AddAlert(this TempDataDictionary tempData,&lt;br /&gt;		 string messageClass, string message)&lt;br /&gt;    {&lt;br /&gt;        var alerts = tempData.GetAlerts();&lt;br /&gt;        alerts.Add(new AlertViewModel(messageClass, message));&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 返回的ActionResult加上訊息屬於success Class的Helper&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="result"&amp;gt;ActionResult&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;要顯示的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;有增加Alert訊息的ActionResult&amp;lt;/returns&amp;gt;&lt;br /&gt;    public static ActionResult WithSuccess(this ActionResult result, &lt;br /&gt;		string message)&lt;br /&gt;    {&lt;br /&gt;        return new AlertDecoratorActionResult(result, &lt;br /&gt;		"alert-success", message);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 返回的ActionResult加上訊息屬於info Class的Helper&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="result"&amp;gt;ActionResult&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;要顯示的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;有增加Alert訊息的ActionResult&amp;lt;/returns&amp;gt;&lt;br /&gt;    public static ActionResult WithInfo(this ActionResult result, &lt;br /&gt;		string message)&lt;br /&gt;    {&lt;br /&gt;        return new AlertDecoratorActionResult(result,&lt;br /&gt;		 "alert-info", message);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 返回的ActionResult加上訊息屬於warning Class的Helper&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="result"&amp;gt;ActionResult&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;要顯示的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;有增加Alert訊息的ActionResult&amp;lt;/returns&amp;gt;&lt;br /&gt;    public static ActionResult WithWarning(this ActionResult result,&lt;br /&gt;		 string message)&lt;br /&gt;    {&lt;br /&gt;        return new AlertDecoratorActionResult(result, &lt;br /&gt;		"alert-warning", message);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 返回的ActionResult加上訊息屬於error Class的Helper&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="result"&amp;gt;ActionResult&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;要顯示的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;有增加Alert訊息的ActionResult&amp;lt;/returns&amp;gt;&lt;br /&gt;    public static ActionResult WithError(this ActionResult result,&lt;br /&gt;		 string message)&lt;br /&gt;    {&lt;br /&gt;        return new AlertDecoratorActionResult(result, &lt;br /&gt;		"alert-danger", message);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;上面可以看到我們有定義一個key代表AlertViewModel在TempData的位置。同時提供了&lt;code&gt;AddAlert&lt;/code&gt;和&lt;code&gt;GetAlerts&lt;/code&gt;這兩個TempData的Extension，方便取得實際的Alert。最後Alert訊息是List的形態，讓我們可以擁有多筆Alert訊息。 &lt;/div&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412347482113777"&gt;View的部份&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;這邊會定義一個&lt;code&gt;PartialView&lt;/code&gt;叫做_Alert.cshtml，並且在&lt;code&gt;_Layout&lt;/code&gt;裡面render出來。 &lt;/p&gt;&lt;pre class="brush: javascript;"&gt;@using Core.Alerts&lt;br /&gt;&lt;br /&gt;@if (TempData.GetAlerts().Any())&lt;br /&gt;{&lt;br /&gt;    &amp;lt;script type="text/javascript"&amp;gt;&lt;br /&gt;		$(function() {&lt;br /&gt;		    alert('@String.Join("\\n", &lt;br /&gt;				TempData.GetAlerts().Select(x =&amp;gt; x.Message.ToString()))');&lt;br /&gt;		});&lt;br /&gt;    &amp;lt;/script&amp;gt;&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;在_Layout.cshtml快到body的地方： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;....&lt;br /&gt;&lt;br /&gt;    @Scripts.Render("~/bundles/jquery")&lt;br /&gt;    @Scripts.Render("~/bundles/bootstrap")&lt;br /&gt;    @Html.Partial("_Alert")&lt;br /&gt;    @RenderSection("scripts", required: false)&lt;br /&gt;&amp;lt;/body&amp;gt;&lt;br /&gt;.....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;這邊我沒有實作配合&lt;code&gt;AlertViewModel.AlertClass&lt;/code&gt;的值，搭配bootstrap，顯示有顏色的錯誤訊息，這個留個讀者去發揮。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412347482113247"&gt;如何使用&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;最後我們看一下會如何使用。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;using Core.Alerts; // 需要加入Extension方法的namespace&lt;br /&gt;&lt;br /&gt;.....&lt;br /&gt;&lt;br /&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(Create backgroundKnowledge)&lt;br /&gt;{&lt;br /&gt;   ...&lt;br /&gt;	// 新增成功，導回首頁&lt;br /&gt;    return RedirectToAction("Index").WithSuccess("新增成功");&lt;br /&gt;   &lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個時候，只要新增成功，會導回首頁，並且顯示“新增成功” &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412347482113472"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;希望透過這一篇，讓未來在需要傳遞訊息到前端的時候變的更加方便。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3946649274158208007/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-11-alertservice.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3946649274158208007'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3946649274158208007'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-11-alertservice.html' title='[iThome 第七屆鐵人賽 11] 傳遞資訊到前端的通用型服務'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-4Qrfm_YSg-o/VC63KG1t4II/AAAAAAAANf8/GJTBI7UBe24/s72-c/image_thumb%25255B1%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944</id><published>2014-10-02T21:52:00.000+08:00</published><updated>2014-11-30T09:44:16.194+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Entity Framework'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 10] 加上 Unit of Work，抽離Entity Framework的依賴就完美了</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412257831376113" ;=""&gt;Repository Pattern的問題是什麽&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412257831376416" ;=""&gt;什麽是Unit of Work&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412257831376151" ;=""&gt;Unit of Work的interface定義&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412257831377407" ;=""&gt;Unit of Work的EF 實作&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412257831377186" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了Repository Pattern，我們能夠抽離實際在做儲存的動作，讓我們在替換實際儲存動作更加容易。 &lt;/p&gt; &lt;p&gt;但是光靠一個Repository Pattern其實還是有些缺陷，因此，通常來說會實作Unit of Work pattern搭配Repository pattern達到一個比較完美的狀態。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412257831376113"&gt;Repository Pattern的問題是什麽&lt;/h1&gt; &lt;p&gt;Repository Pattern代表一個儲存，以DB的世界來說，Repository 其實代表的是一個Table。在比較不複雜的程式來說，Repository層級可能就够了，但是如果要到一個複雜一點的程式，Repository pattern就有點相形見拙。 &lt;/p&gt; &lt;p&gt;Repository Pattern最大的問題在於，當需要和一個以上的Table溝通的時候，DB的那種Atomic operation就沒有了。因為，Repository是針對Table，所以假設需要同時儲存到兩個Table，可以使用兩個Repository來做。問題在於，這兩個Repository彼此不知道對方，表示，假設Repository 1 儲存完成了，但是Repository 2 儲存失敗了，以完整的Atomic operation來說，只要一個失敗，整個operation應該算是失敗了，但是，因為Repository 之間是&lt;em&gt;沒有&lt;/em&gt;聯繫的，因此資料會處於一種dirty state，就是一個進去了，但是一個失敗了。 &lt;/p&gt; &lt;p&gt;要解決這個問題，我們就需有一個東西，來管理Repository彼此之間的情況，好讓它可以再一個成功另外一個失敗的情況下，整個roll back處理，而Unit of Work正是一個這樣的Pattern。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412257831376416"&gt;什麽是Unit of Work&lt;/h1&gt; &lt;p&gt;基本上我們可以把一次的operation想做是一個unit of work。這個operation裡面可能有很多動作，或許需要更新3個table的資料，或許要新增3個table的資料。 &lt;/p&gt; &lt;p&gt;這一個operation肯定是所有的動作都完成了，才算是整個operation結束。以DB的角度來想，就是像Transaction一樣的概念。 &lt;/p&gt; &lt;p&gt;而Unit of Work這個pattern就是會對這個operation的每一個動作，做一個記錄。直到當被告知完成的時候，它才會真的去做處理，並且只有兩種情況回報：成功，或者失敗。 &lt;/p&gt; &lt;p&gt;以DB的世界來說，Unit of Work代表一個DB，而Repository代表一個Table。 &lt;/p&gt; &lt;p&gt;Entity Framework的&lt;code&gt;DbContext&lt;/code&gt;本身就有做Unit of Work。因此我們才能夠做一些CRUD，然後在一次呼叫&lt;code&gt;SaveChange()&lt;/code&gt;，而也是這個時候&lt;code&gt;DbContext&lt;/code&gt;才會真的把他有記錄的內容一次對DB做，並且返回成功或失敗。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt;如果對於Unit of Work有興趣，可以看一下這個Code Project的文章： &lt;a href="http://www.codeproject.com/Articles/581487/Unit-of-Work-Design-Pattern"&gt;Unit of Work Design Pattern&lt;/a&gt; &lt;/div&gt; &lt;h1 id="WizKMOutline_1412257831376151"&gt;Unit of Work的interface定義&lt;/h1&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 實作Unit Of Work的interface。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public interface IUnitOfWork : IDisposable&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存所有異動。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    void Save();&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得某一個Entity的Repository。&lt;br /&gt;    /// 如果沒有取過，會initialise一個&lt;br /&gt;    /// 如果有就取得之前initialise的那個。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="T"&amp;gt;此Context裡面的Entity Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;Entity的Repository&amp;lt;/returns&amp;gt;&lt;br /&gt;    IRepository&amp;lt;T&amp;gt; Repository&amp;lt;T&amp;gt;() where T : class;&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;基本上我們這邊需要實作的方法很簡單，一個是如何取得我們的&lt;code&gt;Repository&lt;/code&gt;。再來一個就是把所有透過&lt;code&gt;Repository&lt;/code&gt;的動作，透過&lt;code&gt;save&lt;/code&gt;存入到實體的位置。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412257831377407"&gt;Unit of Work的EF 實作&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;因為EF的&lt;code&gt;DbContext&lt;/code&gt;本身就有Unit of Work，因此我們實作起來非常簡單。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 實作Entity Framework Unit Of Work的class&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class EFUnitOfWork : IUnitOfWork&lt;br /&gt;{&lt;br /&gt;    private readonly DbContext _context;&lt;br /&gt;&lt;br /&gt;    private bool _disposed;&lt;br /&gt;    private Hashtable _repositories;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 設定此Unit of work(UOF)的Context。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="context"&amp;gt;設定UOF的context&amp;lt;/param&amp;gt;&lt;br /&gt;    public EFUnitOfWork(DbContext context)&lt;br /&gt;    {&lt;br /&gt;        _context = context;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存所有異動。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    public void Save()&lt;br /&gt;    {&lt;br /&gt;        _context.SaveChanges();       &lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 清除此Class的資源。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    public void Dispose()&lt;br /&gt;    {&lt;br /&gt;        Dispose(true);&lt;br /&gt;        GC.SuppressFinalize(this);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 清除此Class的資源。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="disposing"&amp;gt;是否在清理中？&amp;lt;/param&amp;gt;&lt;br /&gt;    protected virtual void Dispose(bool disposing)&lt;br /&gt;    {&lt;br /&gt;        if (!_disposed)&lt;br /&gt;        {&lt;br /&gt;            if (disposing)&lt;br /&gt;            {&lt;br /&gt;                _context.Dispose();&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        _disposed = true;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得某一個Entity的Repository。&lt;br /&gt;    /// 如果沒有取過，會initialise一個&lt;br /&gt;    /// 如果有就取得之前initialise的那個。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;typeparam name="T"&amp;gt;此Context裡面的Entity Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;Entity的Repository&amp;lt;/returns&amp;gt;&lt;br /&gt;    public IRepository&amp;lt;T&amp;gt; Repository&amp;lt;T&amp;gt;() where T : class&lt;br /&gt;    {&lt;br /&gt;        if (_repositories == null)&lt;br /&gt;        {&lt;br /&gt;            _repositories = new Hashtable();&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        var type = typeof(T).Name;&lt;br /&gt;&lt;br /&gt;        if (!_repositories.ContainsKey(type))&lt;br /&gt;        {&lt;br /&gt;            var repositoryType = typeof(EFGenericRepository&amp;lt;&amp;gt;);&lt;br /&gt;&lt;br /&gt;            var repositoryInstance =&lt;br /&gt;                Activator.CreateInstance(repositoryType&lt;br /&gt;                        .MakeGenericType(typeof(T)), _context);&lt;br /&gt;&lt;br /&gt;            _repositories.Add(type, repositoryInstance);&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        return (IRepository&amp;lt;T&amp;gt;)_repositories[type];&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊沒有什麼太過於特別的東西，這個實作需要&lt;code&gt;DbContext&lt;/code&gt;，而這個&lt;code&gt;DbContext&lt;/code&gt;會透過Reflection注入到Repository裡面，因此所有的異動在 &lt;code&gt;DbContext&lt;/code&gt;都有記錄，因此，我們做&lt;code&gt;Save&lt;/code&gt;的時候，是一個Atomic的transaction。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-warning"&gt;我這個版本的Unit of work屬於我比較早期就開始使用，因此這邊Repository的取得就沒有使用DI。當然，用不用DI見仁見智。 &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412257831377186"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;到了這邊，我們的Unit of Work和Repository就介紹完了。有了這兩個pattern的合作，DAL層的實作就可以完全達到抽象化，避免被綁死在某一個儲存技術。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在下一篇，我們來看一個比較簡單，但是是每一種Application都用的到的功能，也就是所謂的顯示給客戶端的功能，要如何打造一個容易傳遞資訊給顯示端，並且要修改顯示樣式的時候還很簡單。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;留待下回分解。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1958344686462714944/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html#comment-form' title='17 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' title='[iThome 第七屆鐵人賽 10] 加上 Unit of Work，抽離Entity Framework的依賴就完美了'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>17</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1238452047715196359</id><published>2014-10-01T22:53:00.000+08:00</published><updated>2014-11-30T09:44:16.191+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Entity Framework'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 09] 用Repository Pattern抽離對Entity Framework的依賴</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876698" ;=""&gt;Data Acce Layer (DAL)&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876190" ;=""&gt;用Entity Framework做DAL的問題&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876581" ;=""&gt;Repository Pattern&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876470" ;=""&gt;定義Repository的interface&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876863" ;=""&gt;Entity Framework的Repository interface實作&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876954" ;=""&gt;使用Entity Framework的Repository&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876119" ;=""&gt;注入的部分&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876627" ;=""&gt;Create和Read(Index)用法比對&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876991" ;=""&gt;Update和Delete用法比對&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876583" ;=""&gt;模擬要做單元測試，把Repository實作抽換&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412174793876351" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完了如何讓ViewModel和Entity之間的轉換透過AutoMapper變的更簡單，然後透過框架讓設定ViewModel和Entity之間的對應關係變的容易。 &lt;/p&gt; &lt;p&gt;在這一篇，將會看Data Access Layer （DAL）的部份，也就是儲存資料層的部份。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412174793876698"&gt;Data Acce Layer (DAL)&lt;/h1&gt; &lt;p&gt;不管任何大小的軟體，通常都會需要儲存資料。而這個儲存資料最常見的就是儲存到資料庫裡面。以Asp .Net Mvc來說，最常見的就是透過Entity Framework這個ORM的技術來儲存到實體的資料庫，例如MS Sql，Oracle等。 &lt;/p&gt; &lt;p&gt;而如果以Entity Framework來講，它所在的角色就屬於DAL層。 &lt;/p&gt; &lt;p&gt;以一般比較常見的三層是架構，大概就會如下圖： &lt;/p&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-2nAYDvLr-FI/VCwVG1kV_oI/AAAAAAAANfI/zKOFFBmXk4A/s1600-h/3%252520Layer%252520Architecture%25255B6%25255D.jpg"&gt;&lt;img title="3 Layer Architecture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="3 Layer Architecture" src="http://lh6.ggpht.com/-KjVfM88A3xg/VCwVK3fW_uI/AAAAAAAANfQ/tuI_pNLoQ2E/3%252520Layer%252520Architecture_thumb%25255B4%25255D.jpg?imgmax=800" width="414" height="274"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;一般的三層式架構 - 裡面白色的表示Mvc裡面比和3層式架構較相近的對應&lt;/figcaption&gt; &lt;/figure&gt; &lt;h1 id="WizKMOutline_1412174793876190"&gt;用Entity Framework做DAL的問題&lt;/h1&gt; &lt;p&gt;其實這個問題不只有使用Entity Framework會，任何的DAL實作都有這個問題。 &lt;/p&gt; &lt;p&gt;舉個例子來說，假設今天我們用的是Entity Framework作為DAL層，如果開發到一半，對方突然要求不要使用Entity Framework，而是要改成傳統的ADO .Net作為DAL怎麼辦？ &lt;/p&gt; &lt;p&gt;或者說如果要做單元測試（Unit Testing），肯定不希望在跑的時候還是連資料庫，而是希望連一些假資料，這時候怎麼辦？ &lt;/p&gt; &lt;p&gt;解決方法其實很簡單，就是把實際的DAL在抽一層出來，就有了所謂的Repository Pattern。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1412174793876581"&gt;Repository Pattern&lt;/h2&gt; &lt;p&gt;一般來說，在寫Mvc裡面最長看到的Pattern就是Repository Pattern。 &lt;/p&gt; &lt;p&gt;這個Pattern概念非常簡單，Repository其實有儲存庫的意思，所以這個Pattern的意思是，把實際的DAL層透過所謂的Repository封裝之後，從外面的角度來說是和Repository 溝通來取得資料，至於Repository的資料來源是那裡，就不管了。 &lt;/p&gt; &lt;p&gt;文字敘述可能有些抽象，我們來看一張圖： &lt;/p&gt; &lt;p&gt;&lt;a href="http://lh6.ggpht.com/-CJ34Voz5HJI/VCwVN1vqeDI/AAAAAAAANfY/VPxUveJPQwI/s1600-h/image%25255B10%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-k7FPtuTa9WI/VCwVU5lXEcI/AAAAAAAANfg/BMnF1LTecUw/image_thumb%25255B6%25255D.png?imgmax=800" width="387" height="379"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;Repository的好處：圖片來源： &lt;a href="http://www.asp.net/mvc/tutorials/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application"&gt;Implementing the Repository and Unit of Work Patterns in an ASP.NET MVC Application (9 of 10)&lt;/a&gt;&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;可以看到，左邊的圖是一般直接用Entity Framework，而右邊使用了Repository Pattern + Unit of Work（下一篇介紹），因此可以再真實的環境用Entity Framework連資料庫，然後在單元測試的時候，連假資料。 &lt;/p&gt; &lt;p&gt;這樣就可以把實際的資料來源抽象化，提供更大的彈性。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412174793876470"&gt;定義Repository的interface&lt;/h1&gt; &lt;p&gt;Repository有很多種實作方法，共通的來說，1個Repository代表一個&lt;em&gt;DB 裡面的 Table&lt;/em&gt;。通常的做法有兩種，一種是每一個Table就一個interface，另外一種是以Generic的方式，寫一種通用型的Repository。 &lt;/p&gt; &lt;p&gt;我這邊會介紹的是通用型的Repository。 &lt;/p&gt; &lt;p&gt;首先，一般的DB 動作有所謂的CRUD，因此我們的interface就至少會包含這幾種動作。同時，我們還會有一個SaveChanges的方法，代表把目前有記錄的動作執行。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 代表一個Repository的interface。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;任意model的class&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public interface IRepository&amp;lt;T&amp;gt;&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 新增一筆資料。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要新增到的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    void Create(T entity);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得第一筆符合條件的內容。如果符合條件有多筆，也只取得第一筆。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="predicate"&amp;gt;要取得的Where條件。&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得第一筆符合條件的內容。&amp;lt;/returns&amp;gt;&lt;br /&gt;    T Read(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; predicate);&lt;br /&gt;    &lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得Entity全部筆數的IQueryable。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;Entity全部筆數的IQueryable。&amp;lt;/returns&amp;gt;&lt;br /&gt;    IQueryable&amp;lt;T&amp;gt; Reads();&lt;br /&gt;    &lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 更新一筆資料的內容。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要更新的內容&amp;lt;/param&amp;gt;&lt;br /&gt;    void Update(T entity);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 刪除一筆資料內容。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要被刪除的Entity。&amp;lt;/param&amp;gt;&lt;br /&gt;    void Delete(T entity);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存異動。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    void SaveChanges();&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;定義好了之後，我們就來看實作。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412174793876863"&gt;Entity Framework的Repository interface實作&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;再來我們就定義一個EF版本的Repository實作： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 實作Entity Framework Generic Repository 的 Class。&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="TEntity"&amp;gt;EF Model 裡面的Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public class EFGenericRepository&amp;lt;TEntity&amp;gt; : IRepository&amp;lt;TEntity&amp;gt;&lt;br /&gt;    where TEntity : class&lt;br /&gt;{&lt;br /&gt;    private DbContext Context { get; set; }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 建構EF一個Entity的Repository，需傳入此Entity的Context。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="inContext"&amp;gt;Entity所在的Context&amp;lt;/param&amp;gt;&lt;br /&gt;    public EFGenericRepository(DbContext inContext)&lt;br /&gt;    {&lt;br /&gt;        Context = inContext;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 新增一筆資料到資料庫。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要新增到資料的庫的Entity&amp;lt;/param&amp;gt;&lt;br /&gt;    public void Create(TEntity entity)&lt;br /&gt;    {&lt;br /&gt;        Context.Set&amp;lt;TEntity&amp;gt;().Add(entity);&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得第一筆符合條件的內容。如果符合條件有多筆，也只取得第一筆。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="predicate"&amp;gt;要取得的Where條件。&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;取得第一筆符合條件的內容。&amp;lt;/returns&amp;gt;&lt;br /&gt;    public TEntity Read(Expression&amp;lt;Func&amp;lt;TEntity, bool&amp;gt;&amp;gt; predicate)&lt;br /&gt;    {&lt;br /&gt;        return Context.Set&amp;lt;TEntity&amp;gt;().Where(predicate).FirstOrDefault();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 取得Entity全部筆數的IQueryable。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;returns&amp;gt;Entity全部筆數的IQueryable。&amp;lt;/returns&amp;gt;&lt;br /&gt;    public IQueryable&amp;lt;TEntity&amp;gt; Reads()&lt;br /&gt;    {&lt;br /&gt;        return Context.Set&amp;lt;TEntity&amp;gt;().AsQueryable();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 更新一筆Entity內容。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要更新的內容&amp;lt;/param&amp;gt;&lt;br /&gt;    public void Update(TEntity entity)&lt;br /&gt;    {&lt;br /&gt;        Context.Entry&amp;lt;TEntity&amp;gt;(entity).State = EntityState.Modified;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 更新一筆Entity的內容。只更新有指定的Property。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要更新的內容。&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="updateProperties"&amp;gt;需要更新的欄位。&amp;lt;/param&amp;gt;&lt;br /&gt;    public void Update(TEntity entity, Expression&amp;lt;Func&amp;lt;TEntity, object&amp;gt;&amp;gt;[] updateProperties)&lt;br /&gt;    {&lt;br /&gt;        Context.Configuration.ValidateOnSaveEnabled = false;&lt;br /&gt;&lt;br /&gt;        Context.Entry&amp;lt;TEntity&amp;gt;(entity).State = EntityState.Unchanged;&lt;br /&gt;&lt;br /&gt;        if (updateProperties != null)&lt;br /&gt;        {&lt;br /&gt;            foreach (var property in updateProperties)&lt;br /&gt;            {&lt;br /&gt;                Context.Entry&amp;lt;TEntity&amp;gt;(entity).Property(property).IsModified = true;&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 刪除一筆資料內容。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="entity"&amp;gt;要被刪除的Entity。&amp;lt;/param&amp;gt;&lt;br /&gt;    public void Delete(TEntity entity)&lt;br /&gt;    {&lt;br /&gt;        Context.Entry&amp;lt;TEntity&amp;gt;(entity).State = EntityState.Deleted;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 儲存異動。&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    public void SaveChanges()&lt;br /&gt;    {&lt;br /&gt;        Context.SaveChanges();&lt;br /&gt;&lt;br /&gt;        // 因為Update 單一model需要先關掉validation，因此重新打開&lt;br /&gt;        if (Context.Configuration.ValidateOnSaveEnabled == false)&lt;br /&gt;        {&lt;br /&gt;            Context.Configuration.ValidateOnSaveEnabled = true;&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412174793876954"&gt;使用Entity Framework的Repository&lt;/h2&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;基本上，我們也是一樣可以用Autofac做注入，不過因為最終我們會用到Unit of Work，所以這邊我就先不注入，純粹展示使用方法。 &lt;/div&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;下面範例基本上會用&lt;em&gt;註解&lt;/em&gt;顯示之前用Entity Framework Context的用法（db是代表context），可以做一個用Repository和用原生EF Context的比較。其實用起來差不多。 &lt;/div&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1412174793876119"&gt;注入的部分&lt;/h3&gt;&lt;br /&gt;&lt;p&gt;首先看一下我們如何注入&lt;code&gt;Repository&lt;/code&gt;進來： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class PostsController : Controller&lt;br /&gt;{&lt;br /&gt;	// 預設Scaffolding出來的Entity Context&lt;br /&gt;    // private BlogEntities db = new BlogEntities();&lt;br /&gt;&lt;br /&gt;    private IRepository&amp;lt;Post&amp;gt; repo;&lt;br /&gt;&lt;br /&gt;    public PostsController()&lt;br /&gt;        : this(new EFGenericRepository&amp;lt;Post&amp;gt;(new BlogEntities()))&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public PostsController(IRepository&amp;lt;Post&amp;gt; inRepo)&lt;br /&gt;    {&lt;br /&gt;        repo = inRepo;&lt;br /&gt;    }&lt;br /&gt;	....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1412174793876627"&gt;Create和Read(Index)用法比對&lt;/h3&gt;&lt;pre class="brush: csharp;"&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(Post post)&lt;br /&gt;{&lt;br /&gt;...    &lt;br /&gt;    // db.Post.Add(post);&lt;br /&gt;    // db.SaveChanges();&lt;br /&gt;    repo.Create(post);&lt;br /&gt;    repo.SaveChanges();&lt;br /&gt;    return RedirectToAction("Index");&lt;br /&gt;....&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public ActionResult Index()&lt;br /&gt;{&lt;br /&gt;    //return View(db.Post.ToList());&lt;br /&gt;    return View(repo.Reads().ToList());&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public ActionResult Details(int? id)&lt;br /&gt;{&lt;br /&gt;	...&lt;br /&gt;    // Post post = db.Post.Find(id);&lt;br /&gt;    Post post = repo.Read(x =&amp;amp;gt; x.Id == id);&lt;br /&gt;	...&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1412174793876991"&gt;Update和Delete用法比對&lt;/h3&gt;&lt;pre class="brush: csharp;"&gt;...&lt;br /&gt;public ActionResult Edit(EditViewModel post)&lt;br /&gt;{&lt;br /&gt;	...    &lt;br /&gt;	// db.Entry(postEntity).State = EntityState.Modified;&lt;br /&gt;	// db.SaveChanges();&lt;br /&gt;	repo.Update(postEntity);&lt;br /&gt;	repo.SaveChanges();&lt;br /&gt;	...&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public ActionResult DeleteConfirmed(int id)&lt;br /&gt;{&lt;br /&gt;	...&lt;br /&gt;	&lt;br /&gt;    //db.Post.Remove(post);&lt;br /&gt;    //db.SaveChanges();&lt;br /&gt;    repo.Delete(post);&lt;br /&gt;    repo.SaveChanges();&lt;br /&gt;	&lt;br /&gt;	...  &lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;看過這幾個常見的比對，應該發現和之前(直接使用EF的Context)用法差不多，但是對未來的彈性大幅度提到，下面將舉一個簡單的例子。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412174793876583"&gt;模擬要做單元測試，把Repository實作抽換&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;因為我們的Controller會要的是&lt;code&gt;IRepository&lt;/code&gt;，因此當要做單元測試的時候，我們可以給另外一個實作，例如： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class FakeRepository&amp;lt;Post&amp;gt; &lt;br /&gt;        : IRepository&amp;lt;Post&amp;gt;&lt;br /&gt;        &lt;br /&gt;{&lt;br /&gt;    private List&amp;lt;Post&amp;gt; data;&lt;br /&gt;&lt;br /&gt;    &lt;br /&gt;    public FakeRepository()&lt;br /&gt;    {&lt;br /&gt;        data = new List&amp;lt;Post&amp;gt;();&lt;br /&gt;&lt;br /&gt;        data.Add(new Post()&lt;br /&gt;        {&lt;br /&gt;            Id = 1,&lt;br /&gt;            CreateDateTime = DateTime.Now,&lt;br /&gt;            LastModifyDateTime = DateTime.Now.AddDays(-10),&lt;br /&gt;            PostContent = "abc",&lt;br /&gt;            Title = "123"&lt;br /&gt;        });&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public IQueryable&amp;lt;Post&amp;gt; Reads()&lt;br /&gt;    {&lt;br /&gt;        return data.AsQueryable();&lt;br /&gt;    }&lt;br /&gt;	&lt;br /&gt;	// ...其他方法&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;那做單元測試就簡單並且減少時間（不需要和DB溝通），因為資料是我們灌好的假資料，可以掌控內容。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412174793876351"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;希望透過這一篇，對於爲什麽和如何使用Repository Pattern會有些概念，不過Repository本身還是有些問題。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;一個DB肯定不止一個Table，而Repository只代表了一個Table，那如果我同時要用2個Table以上怎麼辦？這個時候Unit of work就進來了。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;Unit of work就留到下一篇在講了。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/1238452047715196359/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-09-RepositoryPattern.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1238452047715196359'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/1238452047715196359'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-09-RepositoryPattern.html' title='[iThome 第七屆鐵人賽 09] 用Repository Pattern抽離對Entity Framework的依賴'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh6.ggpht.com/-KjVfM88A3xg/VCwVK3fW_uI/AAAAAAAANfQ/tuI_pNLoQ2E/s72-c/3%252520Layer%252520Architecture_thumb%25255B4%25255D.jpg?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6184144553651721180</id><published>2014-09-30T22:26:00.000+08:00</published><updated>2014-10-02T22:09:22.026+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 08] 框架簡化建立AutoMapper對應的設定</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180326" ;=""&gt;框架思路&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180640" ;=""&gt;Interface的定義&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180562" ;=""&gt;使用兩個interface的差異&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180610" ;=""&gt;使用IMapFrom&lt;t&gt;&lt;/t&gt;&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180358" ;=""&gt;使用IHaveCustomMapping&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180139" ;=""&gt;在系統啟動的時候註冊AutoMapper對應&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180965" ;=""&gt;Task Module&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412086842180226" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇我們介紹了AutoMapper的設定和用法，使用起來肯定比自己手動做左邊倒到右邊還要簡單。 &lt;/p&gt; &lt;p&gt;不過AutoMapper也不是沒有它自己的問題，最麻煩的地方在於設定Entity和Class之間的對應。這一篇要探討的就是，如何透過框架來減少這方面的設定。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412086842180326"&gt;框架思路&lt;/h1&gt; &lt;p&gt;我們先來思考一下我們會如何達到簡化設定對應邏輯，然後在開始開發。 &lt;/p&gt; &lt;p&gt;首先，其實AutoMapper本身有所謂的Profile，可以透過Profile來設定Entity和ViewModel之間的對應。不過我個人比較傾向於Entity和ViewModel的對應邏輯是能夠簡單看到並且是在一起，換句話說，如果能夠在ViewModel定義好和Entity的對應關係不是很好，因為只要一找到ViewModel，馬上就知道它和Entity的關係。 &lt;/p&gt; &lt;p&gt;有了這個概念，我們就可以來看一下我們如何透過Interface來達到這個效果。 &lt;/p&gt; &lt;h1 id="WizKMOutline_1412086842180640"&gt;Interface的定義&lt;/h1&gt; &lt;p&gt;我們要提供兩種定義的方式： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;&lt;code&gt;IMapFrom&amp;lt;T&amp;gt;&lt;/code&gt; - T表示這個ViewModel對應的Entity  &lt;li&gt;&lt;code&gt;IHaveCustomMapping&lt;/code&gt; - 表示這個ViewModel要自己對應Entity和設定自己的邏輯 &lt;/li&gt;&lt;/ol&gt; &lt;p&gt;因此看起來會是： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh4.ggpht.com/-9aOpUQWtjxQ/VCq9hSSUVVI/AAAAAAAANek/n9ryaMyFBqg/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-zk7UACRrbeQ/VCq9jahMSTI/AAAAAAAANes/l7s5hxah5aU/image_thumb%25255B1%25255D.png?imgmax=800" width="384" height="187"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;interface的Class diagram&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;然後實際的C#程式碼是： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 設定ViewModel要對應的Model。&lt;br /&gt;/// 這個用預設的Convention來對應&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;typeparam name="T"&amp;gt;要被對應到的Type&amp;lt;/typeparam&amp;gt;&lt;br /&gt;public interface IMapFrom&amp;lt;T&amp;gt;&lt;br /&gt;{&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 設定ViewModel要對應的Model&lt;br /&gt;/// 如果需要客制AutoMapper的邏輯，讓ViewModel實作此Interface&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public interface IHaveCustomMapping&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 設定自定義的Mapping邏輯&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="configuration"&amp;gt;Automapper的Config物件&amp;lt;/param&amp;gt;&lt;br /&gt;    void CreateMappings(IConfiguration configuration);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412086842180562"&gt;使用兩個interface的差異&lt;/h1&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412086842180610"&gt;使用IMapFrom&amp;lt;T&amp;gt;&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;我們先看一下上一篇我們&lt;code&gt;IndexViewModel&lt;/code&gt;本來的用法： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;Mapper.CreateMap&amp;lt;Post, IndexViewModel&amp;gt;();&lt;br /&gt;var projectIQueryable = (db.Post.Project().To&amp;lt;IndexViewModel&amp;gt;()).ToList();&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;如果改用成我們的interface，會變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// ViewModel加上interface&lt;br /&gt;public class IndexViewModel : IMapFrom&amp;lt;Post&amp;gt;&lt;br /&gt;&lt;br /&gt;....&lt;br /&gt;// 在實際呼叫的時候，會和之前一樣，只是不需要呼叫CreatMap&lt;br /&gt;&lt;br /&gt;var projectIQueryable = (db.Post.Project().To&amp;lt;IndexViewModel&amp;gt;()).ToList();&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412086842180358"&gt;使用IHaveCustomMapping&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;這個是假設有特殊的對應邏輯才在呼叫，使用上會是： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class IndexViewModel : IHaveCustomMapping&lt;br /&gt;{&lt;br /&gt;	// properties&lt;br /&gt;&lt;br /&gt;    public void CreateMappings(IConfiguration configuration)&lt;br /&gt;    {&lt;br /&gt;        configuration.CreateMap&amp;lt;Post, IndexViewModel&amp;gt;();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;可以看到，AutoMapper的&lt;code&gt;IConfiguration&lt;/code&gt;會被傳進來，這時候就可以手動設定對應邏輯。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;到這邊為止，我們interface的定義和使用就完成了，不過接下來我們還需要讓這兩個interface實際有作用，要不然是沒有效果。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412086842180139"&gt;在系統啟動的時候註冊AutoMapper對應&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;當我們用了interface把這些ViewModel的對應都定義好了之後，我們希望在系統啟動了之後，讀出所有設定過這兩種interface的ViewModel，並且作出對應的AutoMapper設定。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們首先寫好使用這兩個interface的邏輯： &lt;/p&gt;&lt;br /&gt;&lt;p&gt;顯示取得所有實作這兩個interface的type： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 註冊有設定AutoMapper的viewmodel&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class AutoMapperConfig : IRunAtStartup&lt;br /&gt;{&lt;br /&gt;	/// &amp;lt;summary&amp;gt;&lt;br /&gt;	/// 要執行的邏輯&lt;br /&gt;	/// &amp;lt;/summary&amp;gt;&lt;br /&gt;	public void Execute()&lt;br /&gt;	{&lt;br /&gt;		var typeOfIHaveCustomMapping = typeof(IHaveCustomMapping);&lt;br /&gt;		var typeOfIMapFrom = typeof(IMapFrom&amp;lt;&amp;gt;);&lt;br /&gt;	&lt;br /&gt;		// Type 符合 IHaveCustomMapping 和 IMapFrom 的 predicate方法&lt;br /&gt;		// 這個predicate 的條件和下面個別mapping的第一個條件是一致的。&lt;br /&gt;		Func&amp;lt;Type, bool&amp;gt; predicate = (t =&amp;gt; typeOfIHaveCustomMapping.IsAssignableFrom(t) // 找到符合IHaveCustomMapping&lt;br /&gt;					|| t.GetInterfaces().Where(i =&amp;gt; i.IsGenericType &amp;amp;&amp;amp; i.GetGenericTypeDefinition() == typeOfIMapFrom).Any()); // 找到符合IMapFrom&amp;lt;&amp;gt;&lt;br /&gt;	&lt;br /&gt;		var types = AssemblyTypes.GetAssemblyFromDirectory(assembly =&amp;gt; assembly.GetExportedTypes().Where(predicate).Any())     // 選擇要讀進來的Assembly - 只有符合IHaveCustomMapping 和 IMapFrom才讀&lt;br /&gt;			// 把讀進來的Assembly取出裡面符合兩個interface的Type&lt;br /&gt;				.SelectMany(x =&amp;gt; x.GetExportedTypes()&lt;br /&gt;				.Where(predicate)).ToList();&lt;br /&gt;	&lt;br /&gt;		LoadStandardMappings(types);&lt;br /&gt;	&lt;br /&gt;		LoadCustomMappings(types);&lt;br /&gt;	}&lt;br /&gt;	&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;在來針對兩個不同的interface呼叫不同的mapping邏輯： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 註冊如果使用是自定義邏輯的Mapping&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="types"&amp;gt;可能符合的Type&amp;lt;/param&amp;gt;&lt;br /&gt;private static void LoadCustomMappings(IEnumerable&amp;lt;Type&amp;gt; types)&lt;br /&gt;{&lt;br /&gt;	var maps = (from t in types&lt;br /&gt;				from i in t.GetInterfaces()&lt;br /&gt;				where typeof(IHaveCustomMapping).IsAssignableFrom(t) &amp;amp;&amp;amp;&lt;br /&gt;					!t.IsAbstract &amp;amp;&amp;amp;&lt;br /&gt;					!t.IsInterface&lt;br /&gt;				select (IHaveCustomMapping)Activator.CreateInstance(t)).ToArray();&lt;br /&gt;&lt;br /&gt;	foreach (var map in maps)&lt;br /&gt;	{&lt;br /&gt;		map.CreateMappings(AutoMapper.Mapper.Configuration);&lt;br /&gt;	}&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Loads the standard mappings.&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="types"&amp;gt;The types.&amp;lt;/param&amp;gt;&lt;br /&gt;private static void LoadStandardMappings(IEnumerable&amp;lt;Type&amp;gt; types)&lt;br /&gt;{&lt;br /&gt;	var maps = (from t in types&lt;br /&gt;				from i in t.GetInterfaces()&lt;br /&gt;				where i.IsGenericType &amp;amp;&amp;amp; i.GetGenericTypeDefinition() == typeof(IMapFrom&amp;lt;&amp;gt;) &amp;amp;&amp;amp;&lt;br /&gt;					!t.IsAbstract &amp;amp;&amp;amp;&lt;br /&gt;					!t.IsInterface&lt;br /&gt;				select new&lt;br /&gt;				{&lt;br /&gt;					Source = i.GetGenericArguments()[0],&lt;br /&gt;					Destination = t&lt;br /&gt;				}).ToArray();&lt;br /&gt;&lt;br /&gt;	foreach (var map in maps)&lt;br /&gt;	{&lt;br /&gt;		AutoMapper.Mapper.CreateMap(map.Source, map.Destination);&lt;br /&gt;	}&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412086842180965"&gt;Task Module&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;在上面的部分，如果注意看的話，&lt;code&gt;AutoMapperConfig : IRunAtStartup&lt;/code&gt;。而&lt;code&gt;IRunAtStartup&lt;/code&gt;其實屬於我們框架的Task系統。以&lt;code&gt;IRunAtStartUp&lt;/code&gt; 來說，表示實作這個interface的Class將會在系統啟動的時候執行。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此我們先設定這個Task的Autofac Module： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt; /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Autofac用來註冊Task相關的服務&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class TaskModule : Autofac.Module&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Override to add registrations to the container.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="builder"&amp;gt;The builder through which components can be&lt;br /&gt;    /// registered.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;remarks&amp;gt;&lt;br /&gt;    /// Note that the ContainerBuilder parameter is unique to this module.&lt;br /&gt;    /// &amp;lt;/remarks&amp;gt;&lt;br /&gt;    protected override void Load(Autofac.ContainerBuilder builder)&lt;br /&gt;    {&lt;br /&gt;        var assemblies = Assembly.GetExecutingAssembly();           &lt;br /&gt;        builder.RegisterAssemblyTypes(assemblies).As&amp;lt;IRunAtStartup&amp;gt;();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;然後在Global.asax的地方註冊這個Module： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// global.asax Application_Start&lt;br /&gt;...&lt;br /&gt;Builder.RegisterModule&amp;lt;TaskModule&amp;gt;();&lt;br /&gt;..&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;最後，因為這個&lt;code&gt;IRunAtStartup&lt;/code&gt;屬於系統啟動的時候執行，因此在同樣&lt;code&gt;global.asax&lt;/code&gt;裡面的&lt;code&gt;Application_Start&lt;/code&gt;，我們就會： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// global.asax Application_Start&lt;br /&gt;...&lt;br /&gt;&lt;br /&gt;var container = builder.Build();&lt;br /&gt;&lt;br /&gt;DependencyResolver.SetResolver(new AutofacDependencyResolver(container));&lt;br /&gt;&lt;br /&gt;// 執行IRunAtStartUp的實作物件&lt;br /&gt;using (var scope = container.BeginLifetimeScope())&lt;br /&gt;{&lt;br /&gt;    var runAtStartUpTasks = scope.Resolve&amp;lt;IEnumerable&amp;lt;IRunAtStartup&amp;gt;&amp;gt;();&lt;br /&gt;&lt;br /&gt;    foreach (var item in runAtStartUpTasks)&lt;br /&gt;    {&lt;br /&gt;        item.Execute();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;這樣我們有設定的那兩種interface Mapping的AutoMapper定義就會有效果了。 &lt;br /&gt;&lt;h1 id="WizKMOutline_1412086842180226"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;在這一篇我們把AutoMapper的對應設定邏輯利用2種interface把它抽到了和ViewModel一起定義。這樣的好處是我們只要看到ViewModel，就會知道他和那些Entity有對應關係。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;希望透過這一篇，讓在使用AutoMapper的時候能夠更簡單，並且更容易使用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在下一篇，我們來看如何透過Unit of Work和Repository Pattern把DB的溝通抽出來。 &lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/6184144553651721180/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-08-AutoMapperConfigEasier.html#comment-form' title='1 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6184144553651721180'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/6184144553651721180'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-08-AutoMapperConfigEasier.html' title='[iThome 第七屆鐵人賽 08] 框架簡化建立AutoMapper對應的設定'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-zk7UACRrbeQ/VCq9jahMSTI/AAAAAAAANes/l7s5hxah5aU/s72-c/image_thumb%25255B1%25255D.png?imgmax=800' height='72' width='72'/><thr:total>1</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5202155767227955111</id><published>2014-09-29T23:05:00.000+08:00</published><updated>2014-09-29T23:14:32.084+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 07] AutoMapper 介紹 - 簡單化Entity和ViewModel之間的轉換</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536252" ;=""&gt;AutoMapper介紹&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536745" ;=""&gt;測試情景&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536681" ;=""&gt;Index頁面的ViewModel&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536920" ;=""&gt;沒有AutoMapper的做法&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536913" ;=""&gt;用上AutoMapper&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536951" ;=""&gt;需求變更&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536164" ;=""&gt;Queryable Extension - 減少Sql Select的欄位&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536224" ;=""&gt;Edit頁面的ViewModel&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1412002434536901" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇介紹完ViewModel的好處之後，留下的問題是，ViewModel雖然有帶來好處，但是ViewModel和實際Entity之間的對應其實是很麻煩的一件事情，那麼我們如何能夠簡化對應的邏輯呢？ &lt;/p&gt; &lt;p&gt;這時候就是AutoMapper這個套件入場的時候。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1412002434536252"&gt;AutoMapper介紹&lt;/h1&gt; &lt;div class="bs-callout bs-callout-default"&gt; &lt;h4 kmcontenthide="1"&gt;AutoMapper&lt;a href="http://lh3.ggpht.com/-5myKMDkYN1k/VCl3R_v-ukI/AAAAAAAANd8/8c5fYLeWXjg/s1600-h/image%25255B12%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-WW7JmI4qje8/VCl3S-DiYXI/AAAAAAAANeE/DPR6CwLnV30/image_thumb%25255B9%25255D.png?imgmax=800" width="197" height="45"&gt;&lt;/a&gt;&lt;/h4&gt; &lt;ul&gt; &lt;li&gt;套件Github首頁：&lt;a href="https://github.com/AutoMapper/AutoMapper"&gt;https://github.com/AutoMapper/AutoMapper&lt;/a&gt;  &lt;li&gt;Wiki頁：&lt;a href="https://github.com/AutoMapper/AutoMapper/wiki"&gt;https://github.com/AutoMapper/AutoMapper/wiki&lt;/a&gt;  &lt;li&gt;Nuget 安裝指令：&lt;kbd&gt;Install-Package AutoMapper&lt;/kbd&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;AutoMapper的目的就是要解決無聊的左邊資料倒到右邊。我們舉一個例子，如果是在早期的Asp .Net Webform，當一個Form進來的時候，我們常常會需要： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// psuedo 程式碼&lt;br /&gt;&lt;br /&gt;string name = Request.Form["name"];&lt;br /&gt;string age = Request.Form["age"];&lt;br /&gt;.....&lt;br /&gt;&lt;/pre&gt;這些其實很無聊但是又不得不做。在Mvc裡面Model Binding解決了這個問題。 &lt;br /&gt;&lt;p&gt;但是如果用ViewModel，還是有這個問題，因此就有人開發了AutoMapper。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;AutoMapper簡單來說，使用步奏就是： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;定義好兩個Class之間轉換的邏輯 &lt;br /&gt;&lt;li&gt;把object透過AutoMapper轉換成為另外一個形態的object &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412002434536745"&gt;測試情景&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;在介紹AutoMapper之前，我們先設定好我們的測試情景。假設我們有一個DB，裡面一個Table叫做Post，代表著一個部落格網站裡面所擁有的文章。Entity可能如下： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public partial class Post&lt;br /&gt;{&lt;br /&gt;    public int Id { get; set; }&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;    public string PostContent { get; set; }&lt;br /&gt;    public System.DateTime CreateDateTime { get; set; }&lt;br /&gt;    public Nullable&amp;lt;System.DateTime&amp;gt; LastModifyDateTime { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;那用這個Entity，透過Mvc的Scaffolding，我們建立出基本的CRUD頁面。那Scaffolding出來的CRUD，Entity會是預設的ViewModel。透過上一篇我們知道使用Entity做ViewModel的壞處是什麼，因此我們會開始針對CRUD建立對應的ViewModel。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412002434536681"&gt;Index頁面的ViewModel&lt;/h1&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412002434536920"&gt;沒有AutoMapper的做法&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;假設我說，我們的Index頁面不要顯示&lt;code&gt;CreateDateTime&lt;/code&gt;和&lt;code&gt;LastModifyDateTime&lt;/code&gt;。我們當然可以只改View的HtmlHelper，不要顯示這兩個Property，不過等一下我們就知道為什麼用ViewModel更好。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，我建立了一個如下的ViewModel： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class IndexViewModel&lt;br /&gt;{&lt;br /&gt;    public int Id { get; set; }&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;    public string PostContent { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;在沒有時候AutoMapper的情況下，我們會需要做： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;List&amp;lt;IndexViewModel&amp;gt; viewModel = new List&amp;lt;IndexViewModel&amp;gt;();&lt;br /&gt;&lt;br /&gt;foreach (var item in db.Post.ToList())&lt;br /&gt;{&lt;br /&gt;    viewModel.Add(new IndexViewModel()&lt;br /&gt;    {&lt;br /&gt;        Id = item.Id,&lt;br /&gt;        PostContent = item.PostContent,&lt;br /&gt;        Title = item.Title&lt;br /&gt;    });&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;想想，我們才3個property而已就佔了這麼多行數的程式碼，如果有20個property不就很恐怖。而且，明明兩邊的Property都一樣，他不能夠自己對應嗎？ &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412002434536913"&gt;用上AutoMapper&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;如果用上AutoMapper，程式碼變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 定義Post是來源的Class而IndexViewModel是最後結果&lt;br /&gt;Mapper.CreateMap&amp;lt;Post, IndexViewModel&amp;gt;();&lt;br /&gt;&lt;br /&gt;// 把List&amp;lt;Post&amp;gt;轉成List&amp;lt;IndexViewModel&amp;gt;&lt;br /&gt;var viewModel2 = Mapper.Map&amp;lt;List&amp;lt;IndexViewModel&amp;gt;&amp;gt;(db.Post.ToList());&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;用了AutoMapper總共有2個好處： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;&lt;em&gt;程式碼變少了:&lt;/em&gt;本來要11行，現在只要2行 &lt;br /&gt;&lt;li&gt;&lt;em&gt;程式碼的可讀性提高：&lt;/em&gt;本來還會跑迴圈，如果property參數多了，看起來不是那麼直覺。但是用AutoMapper，非常直覺知道是在轉換Model形態 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;p&gt;可能你會在想，為什麼我們什麼都沒有設定，AutoMapper就知道對應欄位是什麼？其實因為AutoMapper會自動把一樣的Property名字作為一對，以我們的例子，Property都一樣，因此我不需要做額外設定。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412002434536951"&gt;需求變更&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;假設，今天我們Index頁面的需求變了，變成在Index頁面的每一筆Post需要顯示&lt;em&gt;最後一次修改時間距離建立時間過了幾天，如果沒有最後一次修改時間，就用今天日期&lt;/em&gt;，這個時候，我們就需要手動設定Property的值要如何產生。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;首先我們在&lt;code&gt;IndexViewModel&lt;/code&gt;增加一個Property： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public double HowManyDayPass { get; set; }&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;然後AutoMapper的轉換邏輯改一下： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;...&lt;br /&gt;Mapper.CreateMap&amp;lt;Post, IndexViewModel&amp;gt;()&lt;br /&gt;    .ForMember(member =&amp;gt; member.HowManyDayPass, &lt;br /&gt;    opt =&amp;gt; opt.MapFrom(x =&amp;gt; x.LastModifyDateTime == null ? &lt;br /&gt;        (DateTime.Now - x.CreateDateTime).TotalDays : &lt;br /&gt;        (x.LastModifyDateTime.Value - x.CreateDateTime).TotalDays));&lt;br /&gt;....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;應該很好懂，設定member.HowManyDayPass這個property的值要從：如果沒有&lt;code&gt;最後修改時間&lt;/code&gt;，就用&lt;code&gt;今天日期&lt;/code&gt;減掉&lt;code&gt;建立日期&lt;/code&gt;。不然就用 &lt;code&gt;最後修改時間&lt;/code&gt;減掉&lt;code&gt;建立時間&lt;/code&gt;。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1412002434536164"&gt;Queryable Extension - 減少Sql Select的欄位&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;AutoMapper其實有提供一個&lt;code&gt;IQueryable&lt;/code&gt;的Extension方法，讓我們EF在對DB下Sql的時候，只下我們需要的部分。我們直接看例子： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;//需要先加Using&lt;br /&gt;using AutoMapper.QueryableExtensions;&lt;br /&gt;...&lt;br /&gt;&lt;br /&gt;var projectIQueryable = (db.Post.Project().To&amp;lt;IndexViewModel&amp;gt;()).ToList(); // AutoMapper QuerableExtension&lt;br /&gt;&lt;br /&gt;var normalIQuerable = db.Post.AsQueryable().ToList();&lt;br /&gt;&lt;br /&gt;...&lt;br /&gt;&lt;/pre&gt;&lt;figure&gt;&lt;a href="http://lh5.ggpht.com/-AnDxuA0OOB4/VCl3UG-DEdI/AAAAAAAANeM/XX1DGQZFDVY/s1600-h/image%25255B17%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-9g3TcBcBJMo/VCl3VbpY0qI/AAAAAAAANeU/C3xIfoZcL4w/image_thumb%25255B12%25255D.png?imgmax=800" width="539" height="170"&gt;&lt;/a&gt;&lt;br&gt; &lt;figcaption&gt;用了AutoMapper產生的Sql(左邊)和沒用的產生Sql(右邊) &lt;/figcaption&gt;&lt;/figure&gt;&lt;br /&gt;&lt;p&gt;有這樣的效果是因為EF用了LazyLoading。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412002434536224"&gt;Edit頁面的ViewModel&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;這邊我快速介紹一下修改頁面的ViewModel。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;以我們的例子，只允許修改&lt;code&gt;Title&lt;/code&gt;和&lt;code&gt;PostContent&lt;/code&gt;而已，同時，&lt;code&gt;LastModifyDateTime&lt;/code&gt;應該要自動使用系統時間。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;這個時候我們的EditViewModel就會是： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class EditViewModel&lt;br /&gt;{&lt;br /&gt;    public int Id { get; set; }&lt;br /&gt;    public string Title { get; set; }&lt;br /&gt;    public string PostContent { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;AutoMapper的設定： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Edit(EditViewModel post)&lt;br /&gt;{&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;        // 建立Mapping邏輯，並且LastModifyDateTime使用系統時間&lt;br /&gt;        Mapper.CreateMap&amp;lt;EditViewModel, Post&amp;gt;().&lt;br /&gt;            ForMember(member =&amp;gt; member.LastModifyDateTime, &lt;br /&gt;            opt =&amp;gt; opt.UseValue(DateTime.Now));&lt;br /&gt;&lt;br /&gt;        Post postEntity = db.Post.Find(post.Id);&lt;br /&gt;&lt;br /&gt;        // 只更新ViewModel的部分到Entity&lt;br /&gt;        Mapper.Map(post, postEntity);&lt;br /&gt;            &lt;br /&gt;        db.Entry(postEntity).State = EntityState.Modified;&lt;br /&gt;        db.SaveChanges();&lt;br /&gt;        return RedirectToAction("Index");&lt;br /&gt;    }&lt;br /&gt;    return View(post);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1412002434536901"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;到目前為止我們介紹了AutoMapper的基本概念，和基本的使用。相信在整體使用上面來說，比自己手動轉換來的方便。但是，假設以我們目前介紹的方式去做，AutoMapper還是有點不好用。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;其實最主要的問題是在：&lt;em&gt;設定對應邏輯的地方&lt;/em&gt;。雖然說AutoMapper簡化了很多設定，可是還是要設定啊，這些設定到底要放在那裡？想象一下，假設我們每一個View有個 ViewModel，一個功能至少有CRUD，很快我們就有一堆ViewModel，這些設定就變的不好維護。雖然說AutoMapper簡化了很多設定，可是還是要設定啊，這些設定到底要放在那裡？想象一下，假設我們每一個View有個 ViewModel，一個功能至少有CRUD (4個ViewModel)，很快我們就有一堆ViewModel，這些設定就變的不好維護 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此在下一篇，我們會建立一些功能，讓我們的在開發上面使用起來更方便和好維護。 &lt;/p&gt;  </content><link rel='related' href='http://alantsai2007.blogspot.tw/2014/09/BuildYourOwnApplicationFrameworkOnMvc-07-AutoMapper-Intro.html' title='[iThome 第七屆鐵人賽 07] AutoMapper 介紹 - 簡單化Entity和ViewModel之間的轉換'/><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/5202155767227955111/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/ithome-07-automapper-entityviewmodel.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5202155767227955111'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/5202155767227955111'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/ithome-07-automapper-entityviewmodel.html' title='[iThome 第七屆鐵人賽 07] AutoMapper 介紹 - 簡單化Entity和ViewModel之間的轉換'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh3.ggpht.com/-WW7JmI4qje8/VCl3S-DiYXI/AAAAAAAANeE/DPR6CwLnV30/s72-c/image_thumb%25255B9%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7837491297504557019</id><published>2014-09-28T22:13:00.000+08:00</published><updated>2014-11-30T09:49:09.026+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 06] ViewModel的重要性</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411913305459916" ;=""&gt;強型別的View（Strong Type View）&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411913305469655" ;=""&gt;用Entity作為ViewModel的壞處是什麼&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411913305470496" ;=""&gt;Model Binding 有風險&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411913305470506" ;=""&gt;如果顯示的值是復合形的值&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411913305470555" ;=""&gt;ViewModel的定義&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411913305470600" ;=""&gt;使用ViewModel如何解決上述的問題&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411913305470248" ;=""&gt;Model Binding風險問題&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411913305470780" ;=""&gt;解決複合型資料問題&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411913305470289" ;=""&gt;ViewModel的問題&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411913305470393" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;在這一篇我們將來看一下在寫Mvc裡面最重要的一個概念，也就是強型別的View（Strong Type View）和ViewModel。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1411913305459916"&gt;強型別的View（Strong Type View）&lt;/h1&gt;&lt;p&gt;Mvc裡面的View使用的是Razor語法，而每一個View能夠定義傳進來的Model形態是什麼。透過這種方式，在寫View的時候不止能夠在Compile time的時候知道對於傳進來的Model使用上面有沒有正確，配上HtmlHelper，還能夠建立能夠和Model binding成功的對應html input。 &lt;/p&gt;&lt;p&gt;強型別的View好處多多，但是問題在於這個型別應該要用什麼？如果用預設的Mvc做Scaffolding的話，預設用的是Entity Framework裡面的&lt;code&gt;DbSet&lt;/code&gt;Entity作為Model，就是實際Table 對應的Entity作為強型別View的Model。 &lt;/p&gt;&lt;p&gt;使用Entity Framework的Entity作為ViewModel好還是不好有點看個人的習慣，不過我個人覺的是不好。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411913305469655"&gt;用Entity作為ViewModel的壞處是什麼&lt;/h1&gt;&lt;p&gt;基本上有以下幾個問題： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;Model Binding的時候有風險 - 這個其實在新版本的Scaffolding有提醒（舊版本沒有），但是如果沒有注意的話可能還是會有問題  &lt;li&gt;如果有些值是多個DB Table組成，用純Entity就沒有辦法做到 &lt;/li&gt;&lt;/ol&gt;&lt;h2 id="WizKMOutline_1411913305470496"&gt;Model Binding 有風險&lt;/h2&gt;&lt;p&gt;我們先來看一下預設Scaffolding Create Post Action的片段： &lt;/p&gt;&lt;figure&gt;&lt;a href="http://lh3.ggpht.com/-P-5vBr2OAwk/VCgXGV0xiHI/AAAAAAAANdA/JKpmVTMY8vw/s1600-h/image%25255B5%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-3tgVe5gCHyk/VCgXINPxY8I/AAAAAAAANdI/db00Ocj4UDo/image_thumb%25255B3%25255D.png?imgmax=800" width="422" height="177"&gt;&lt;/a&gt;&lt;br&gt;&lt;figcaption&gt;預設Scaffolding出來的Create Post action片段&lt;/figcaption&gt; &lt;/figure&gt; &lt;p&gt;我們可以看到英文的註解，和&lt;code&gt;[Bind(Include = "Id,DisplayName,Url")]&lt;/code&gt;看到，其實它是在限制那些Property應該要做Model Binding。因此，以這個例子，Id、 DisplayName和Url將會做ModelBinding。 &lt;/p&gt;&lt;p&gt;假設今天我們不希望Id是由使用者輸入，而是系統產生，因此我們會把畫面上面產生輸入Id的HtmlHelper拿掉。假設，使用者是透過我們的form表單post資訊回來，這個不會有問題。 &lt;/p&gt;&lt;p&gt;但是，如果有人在Form post之前，增加一個欄位並且測出有Id這個欄位，那麼他post過來帶上Id這個欄位的是時候，&lt;em&gt;我們存到DB值就錯了&lt;/em&gt;。 &lt;/p&gt;&lt;p&gt;這個問題在於，假設今天我要刪除某一個Property是由使用者輸入，會需要： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;刪掉產生這個Property的HtmlHelper  &lt;li&gt;把&lt;code&gt;[Binding]&lt;/code&gt;的欄位刪掉那個Property &lt;/li&gt;&lt;/ol&gt;上面關於第一點，如果忘記還好發現，因為忘記刪掉，畫面會看到欄位。但是，第二個就不好發現了。因為只要不是惡意嘗試，更本不會注意到。   &lt;p&gt;ViewModel就可以解決這個問題。同時，用ViewModel還符合OO裡面的封裝（Encapsulation）概念，只開放要使用的欄位。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1411913305470506"&gt;如果顯示的值是復合形的值&lt;/h2&gt;&lt;p&gt;這個意思是，假設我們要顯示的值是不同地方組合出來的，要用Entity做ViewModel顯然不適合，因為Entity是Entity Framework對應到DB Table，因此不能夠隨意變動裡面的Property。 &lt;/p&gt;&lt;p&gt;我們用個簡單的例子，假設我需要顯示一個值是&lt;code&gt;DisplayName&lt;/code&gt;和&lt;code&gt;Url&lt;/code&gt;兩個欄位的值，如果使用是Entity做ViewModel，我們只能夠在View裡面手動把兩個 Property做concatenate顯示。如果這個View多處需要顯示這個值，或是不同的View都需要顯示這個值，用concatenate的方式做顯示有個問題，如果有天要替換兩個結合的Property，只能用搜索替換的方式來修改，很容易改錯，如果使用ViewModel就能夠解決這個問題。 &lt;/p&gt;&lt;p&gt;只要在ViewModel定義一個Property，這個Property是兩個Property concatenate的結果，顯示在View的時候，就用那個Property。之後如果要改值，只需要改Property，所有的 View顯示的就會一起改變。 &lt;/p&gt;&lt;p&gt;講了這們多，我們就看一下ViewModel到底是什麼。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411913305470555"&gt;ViewModel的定義&lt;/h1&gt;&lt;div class="bs-callout bs-callout-info"&gt;其實ViewModel的定義有些細節上面會不同，因此我下面介紹的屬於我個人覺得比較適合ViewModel的定義。個人在使用上符合自己習慣即可。 &lt;/div&gt;&lt;p&gt;首先，ViewModel就像它的名字一樣，用於顯示View的Model &lt;/p&gt;&lt;p&gt;而我這邊的ViewModel定義是： &lt;/p&gt;&lt;ol&gt;&lt;li&gt;ViewModel只是簡單的POCO Class - 就像Entity Framework裡面的Entity一樣，只有Property  &lt;li&gt;ViewModel不定義邏輯 - 有些會把取得資料的邏輯或者一些商業邏輯寫在ViewModel。但是，我認為ViewModel應該越純粹越好，它只是資料的載體，方便我們把資料傳到 View而已，那些商業邏輯是屬於service layer或者Business layer  &lt;li&gt;每一個View有自己的ViewModel - 每一個View應該要有自己對應的ViewModel &lt;/li&gt;&lt;/ol&gt;&lt;h1 id="WizKMOutline_1411913305470600"&gt;使用ViewModel如何解決上述的問題&lt;/h1&gt;&lt;h2 id="WizKMOutline_1411913305470248"&gt;Model Binding風險問題&lt;/h2&gt;&lt;p&gt;我們可以用ViewModel來解決Model Binding的問題： &lt;/p&gt;&lt;pre class="brush: csharp; highlight:[13,14,15,16,17,18]"&gt;public class LinkCreateViewModel&lt;br /&gt;{&lt;br /&gt;    public string DisplayName { get; set; }&lt;br /&gt;    public string Url { get; set; }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;[HttpPost]&lt;br /&gt;[ValidateAntiForgeryToken]&lt;br /&gt;public ActionResult Create(LinkCreateViewModel link)&lt;br /&gt;{&lt;br /&gt;    if (ModelState.IsValid)&lt;br /&gt;    {&lt;br /&gt;  // 只設定需要的欄位 &lt;br /&gt;        Link enity = new Link()&lt;br /&gt;        {&lt;br /&gt;            DisplayName = link.DisplayName,&lt;br /&gt;            Url = link.Url&lt;br /&gt;        };&lt;br /&gt;&lt;br /&gt;        db.Links.Add(enity);&lt;br /&gt;        db.SaveChanges();&lt;br /&gt;        return RedirectToAction("Index");&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    return View(link);&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這邊可以看到，透過ViewModel，我們只傳入實際讓使用者輸入的Property。假設那一天要減少一個Property，而轉換成為Entity的部分忘記改，在Compile的時候就會知道，這樣也可以減少bug的出現。假設還是用&lt;code&gt;[Bind]&lt;/code&gt;的方式，那麼減少欄位忘記改在compile是不會報錯，因為&lt;code&gt;[Bind]&lt;/code&gt;用的是string。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411913305470780"&gt;解決複合型資料問題&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;其實會和上面概念一樣，取得某一筆Entity資料之後，把它轉換成為ViewModel並且設定ViewModel Property顯示的值。然後，傳到View裡面。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411913305470289"&gt;ViewModel的問題&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;看完ViewModel的好處，我們也需要看一下它的問題。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;最主要問題在於，Entity和ViewModel之間的轉換。以上面的例子，這個轉換的邏輯不好通用。假設，今天我別的地方也需要把&lt;code&gt;LinkCreateViewModel&lt;/code&gt;和&lt;code&gt;Link&lt;/code&gt; 做轉換，我要怎麼共用這個轉換的邏輯？就算寫成通用方法，想想如果每一個ViewModel都寫一次，不是很浪費時間嗎？ &lt;/p&gt;&lt;br /&gt;&lt;p&gt;針對這個問題，我們下一篇將介紹一個常用的套件，AutoMapper來解決。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411913305470393"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過這一篇我們了解到ViewModel的好處並且為什麼使用ViewModel。同時我們也注意到了ViewModel使用上面的不便利性。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;下一篇將會介紹AutoMapper，看看AutoMapper是如何解決這個問題。 &lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7837491297504557019/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-06-ViewModelIntro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7837491297504557019'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7837491297504557019'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-06-ViewModelIntro.html' title='[iThome 第七屆鐵人賽 06] ViewModel的重要性'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh6.ggpht.com/-3tgVe5gCHyk/VCgXINPxY8I/AAAAAAAANdI/db00Ocj4UDo/s72-c/image_thumb%25255B3%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4046521654443336552</id><published>2014-09-28T00:51:00.000+08:00</published><updated>2014-09-30T22:40:10.889+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 05] 打造第一個通用服務 - Log</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356434" ;=""&gt;建立的流程&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356701" ;=""&gt;定義Log擁有的Service&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356758" ;=""&gt;定義ILog的實作&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356839" ;=""&gt;設定一些注入用的參數&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356257" ;=""&gt;定義interface的實作&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356346" ;=""&gt;在ContainerBuilder註冊&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411835209356631" ;=""&gt;建立NlogModule&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411835209385846" ;=""&gt;註冊Autofac.Module&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411835209385380" ;=""&gt;結語&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;到目前為止，應該對於Autofac的使用有了基本的了解。在上一篇用了一個簡單的Log服務來說明Autofac如何和Mvc結合。 &lt;/p&gt; &lt;p&gt;Log屬於任何一個系統必須有的服務，因此在這一篇，我們打造真的Log服務。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1411835209356434"&gt;建立的流程&lt;/h1&gt; &lt;p&gt;基本上會和我們在上一篇打造那個服務一樣，我們會： &lt;/p&gt;&lt;figure&gt; &lt;div class="mxgraph" style="overflow: hidden; height: 271px; width: 261px; position: relative"&gt; &lt;div style="overflow: hidden; height: 1px; width: 1px"&gt;1VZPk6I+EP00OY4lf1Q8AuL+Lnvy8DtHaCA1gVAhKM6nn442IuPurFM7tVNzschL0+l+73WQeXHV/9C8KX+qDCRz51nPvA1z3cBf4a8FThfAXc8vQKFFdoGcEdiJFyBwCOtEBu0k0CgljWimYKrqGlIzwXIlp0c0vBjSj8Au5fIe/V9kpqQe3OWI/weiKIdjnOX6stOa05Ajg5x30jydIdyz2xUfclFX/ZzY8CnBiQCPAhpeT0p6UaqaABrakStqV1BdlGOvdAZ6AklRP9/y5iUonVYKX7RPVR+DtPIN0viZk+2xy0W6z/21s3q65Nk+Gn4lVENNxf1tSqL0wGVH7bNkwaKIRSFLViyMWBCJ2oDOeQrMSuf1nHkRS3wWbdg6tlGBi+FhZxQG2fU6ZIG/A30Q9p03irZGq+erIZC0qC15YzervrCmn+VSHdOSazNrtEqhRYqjXNWG7Oz4VDNoAzQYjzAzSoTTBaoCo0/WPOSdBYlKk+VRyuPoXHdB9ipvXDtgnIxQXDOPMuADKfGgKt4vVQm3LFxeiR9VGRiPJUeuPqJRrKpG1Zayb6qS489niy8UamjyRqi3TEKdhVqrI65SK5BILZkGiRvgGiUYsK2wh2/w/orwRVoRb5Dd3bd/IhIrUZ1Gj7w7/XhwAb/Lc/bivSAaJDfiMC3oU7klXSdDgL71WRjE6DMuatBRJ6S9lZMAUXtt4ZgESxaE39XQ7hcbmr7NHzb0lKh/Yl66JN8175nKzzcvLsfP/Hnv5u+al7wC&lt;/div&gt;&lt;/div&gt;&lt;figcaption&gt;建立Service和Component的流程&lt;/figcaption&gt; &lt;/figure&gt; &lt;ol&gt; &lt;li&gt;定義Log所會擁有的Service（interface）  &lt;li&gt;實作一個我們框架會用的Log Component  &lt;li&gt;註冊到ContainerBuilder &lt;/li&gt;&lt;/ol&gt; &lt;h1 id="WizKMOutline_1411835209356701"&gt;定義Log擁有的Service&lt;/h1&gt; &lt;p&gt;基本上，一般的log都有一些log層級，可以讓我們寫log的時候區分那些屬於錯誤（Error），和那些是偵錯（Debug）時候看的。因此，有以下幾個層級： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;Trace  &lt;li&gt;Debug  &lt;li&gt;Info  &lt;li&gt;Warn  &lt;li&gt;Error  &lt;li&gt;Fatal &lt;/li&gt;&lt;/ol&gt;  &lt;p&gt;層級定義完成之後，我們要決定每一個層級要有那些寫log的方法： &lt;/p&gt; &lt;ol&gt; &lt;li&gt;(string message) - 只是把message輸出  &lt;li&gt;(object outpuObject) - 把物件資訊印出來  &lt;li&gt;(string message, params object[] args) - message是訊息，可以用string format一樣的placeholder，而args是placeholder的值  &lt;li&gt;(string message, object outputObject) - 要輸出的訊息和把物件資訊印出來 &lt;/li&gt;&lt;/ol&gt;  &lt;div class="bs-callout bs-callout-info"&gt;當然，上面這些定義是符合我自己使用，而每一個情況不一樣，因此各位應該客制屬於自己需要的方法。 &lt;/div&gt; &lt;p&gt;最後，由於有6個log層級和每一個層級都有4個方法，總共有24個需要定義，這邊我只定義某一個層級的4個方法，剩下都會一樣： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Log功能的interface&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public interface ILog&lt;br /&gt;{&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Traces 訊息&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    void Trace(string message);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Traces 把某個物件內容dump出來&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="outputObject"&amp;gt;要dump的物件&amp;lt;/param&amp;gt;&lt;br /&gt;    void Trace(object outputObject);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Traces 訊息加上format的參數&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="args"&amp;gt;format的參數&amp;lt;/param&amp;gt;&lt;br /&gt;    void Trace(string message, params object[] args);&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Traces 把某個物件內容dump出來，並且在dump內容加上一段訊息&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="message"&amp;gt;加上的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="outputObject"&amp;gt;要dump的物件&amp;lt;/param&amp;gt;&lt;br /&gt;    void Trace(string message, object outputObject);&lt;br /&gt;&lt;br /&gt;// 。。。。 其他log層級的方法定義&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411835209356758"&gt;定義ILog的實作&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;有了Service定義好了之後，我們就要來決定我們要如何實作ILog。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;第一件事情是決定自己要使用的Log Framework。比較出名的有NLog和Log4Net。我這邊會選擇使用NLog。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;br /&gt;&lt;h4 kmcontenthide="1"&gt;NLog&lt;/h4&gt;&lt;br /&gt;&lt;ul&gt;&lt;br /&gt;&lt;li&gt;官網：&lt;a href="http://nlog-project.org/"&gt;http://nlog-project.org/&lt;/a&gt; &lt;br /&gt;&lt;li&gt;Wiki：&lt;a href="https://github.com/nlog/nlog/wiki"&gt;https://github.com/nlog/nlog/wiki&lt;/a&gt; &lt;br /&gt;&lt;li&gt;文件：&lt;a href="http://nlog-project.org/documentation"&gt;http://nlog-project.org/documentation&lt;/a&gt; &lt;br /&gt;&lt;li&gt;Nuget 指令：&lt;kbd&gt;Install-Package NLog&lt;/kbd&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411835209356839"&gt;設定一些注入用的參數&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;有用過Log Framework就會知道，通常我們會想要知道，是哪一個Class寫出了某一筆的log，因此在建立Log的class的時候能夠傳入要用這個log的Class 名稱。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們也希望我們的Log Framework有這個功能，因此我們需要先定義出來，好讓Autofac能夠幫忙注入Class名稱。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// 使用Nlog作為ILog的實作&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class NlogLogger : ILog&lt;br /&gt;{&lt;br /&gt;    // NLog 物件&lt;br /&gt;    private Logger logger;&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Initializes a new instance of the &amp;lt;see cref="NlogLogger"/&amp;gt; class.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    public NlogLogger()&lt;br /&gt;    {&lt;br /&gt;        logger = NLog.LogManager.GetCurrentClassLogger();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Initializes a new instance of the &amp;lt;see cref="NlogLogger"/&amp;gt; class.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="name"&amp;gt;目前要使用Log的Class名字&amp;lt;/param&amp;gt;&lt;br /&gt;    public NlogLogger(string name)&lt;br /&gt;    {&lt;br /&gt;        logger = NLog.LogManager.GetLogger(name);&lt;br /&gt;    }&lt;br /&gt;	&lt;br /&gt;// ..其他實作&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;我們透過的方式會是用Constructor來傳遞我們class的名稱。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411835209356257"&gt;定義interface的實作&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;再來我們要實際實作interface定義的24個方法。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;有兩個部分需要特別處理： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;怎麼把物件資訊dump出來 &lt;br /&gt;&lt;li&gt;log framework通常都能夠判斷某個層級是否需要開放輸出 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;針對第一個，我將會使用&lt;code&gt;Json.Net&lt;/code&gt;來把物件資訊dump出來。這個有好有懷，好處是不用寫複雜的邏輯來把物件印出來，而且顯示的樣式是熟悉的Json格式。而壞處是我們多了一個json .Net的 dependency。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-default"&gt;&lt;br /&gt;&lt;h4 id="WizKMOutline_1411835206340504" kmcontenthide="1"&gt;Json .Net&lt;/h4&gt;&lt;br /&gt;&lt;p&gt;屬於必裝型的套件。主要工作室Class &amp;lt;=&amp;gt; Json之間互相的轉換。效能上面比內建的快（根據他們自己的評測） &lt;/p&gt;&lt;br /&gt;&lt;ul&gt;&lt;br /&gt;&lt;li&gt;官網：&lt;a href="https://json.codeplex.com/"&gt;https://json.codeplex.com/&lt;/a&gt; &lt;br /&gt;&lt;li&gt;文件：&lt;a href="http://james.newtonking.com/json/help/index.html"&gt;http://james.newtonking.com/json/help/index.html&lt;/a&gt; &lt;br /&gt;&lt;li&gt;Nuget指令：&lt;kbd&gt;Install-Package Newtonsoft.Json&lt;/kbd&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;br /&gt;&lt;p&gt;針對第二個，我們每個層級的四個方法都用統一的一個方法做輸出，這樣就會做判斷需不需要實際呼叫： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 還是在NlogLogger.cs 裡面&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Traces 訊息&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="message"&amp;gt;訊息&amp;lt;/param&amp;gt;&lt;br /&gt;public void Trace(string message)&lt;br /&gt;{&lt;br /&gt;    if (logger.IsTraceEnabled)&lt;br /&gt;    {&lt;br /&gt;        logger.Trace(message);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;  /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Traces 訊息加上format的參數&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="message"&amp;gt;訊息&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="args"&amp;gt;format的參數&amp;lt;/param&amp;gt;&lt;br /&gt;public void Trace(string message, params object[] args)&lt;br /&gt;{&lt;br /&gt;    Trace(string.Format(message, args));&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;  /// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Traces 把某個物件內容dump出來&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="outputObject"&amp;gt;要dump的物件&amp;lt;/param&amp;gt;&lt;br /&gt;public void Trace(object outputObject)&lt;br /&gt;{&lt;br /&gt;    Trace(JsonConvert.SerializeObject(outputObject, Formatting.Indented));&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Traces 把某個物件內容dump出來，並且在dump內容加上一段訊息&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="message"&amp;gt;加上的訊息&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="outputObject"&amp;gt;要dump的物件&amp;lt;/param&amp;gt;&lt;br /&gt;public void Trace(string message, object outputObject)&lt;br /&gt;{&lt;br /&gt;    Trace(message + Environment.NewLine +&lt;br /&gt;	 	JsonConvert.SerializeObject(outputObject, Formatting.Indented));&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// ..其他層級實作如上&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;上面顯示了Trace層級的方法實際定義，其他幾個層級的實作會一樣。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411835209356346"&gt;在ContainerBuilder註冊&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;在這邊有一點是之前沒有講過的，我們的NlogLogger裡面是沒有無參數的建構子。而我們接受的參數只是一個string的參數叫做name。那麼，照著我們目前所了解的註冊裡面，是沒有辦法解決這個問題。不過，Autofac當然有想到這種情況，因此我們這邊乘著這個機會介紹一下。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們先了解一下，&lt;code&gt;string name&lt;/code&gt;的參數是要傳入什麼？ &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們之前講過，log framework都有一個參數是記錄寫這個log的class 名稱。因此我們這個參數代表就是這個要用NlogLogger的class 名稱。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;那要如何注入這個class名稱呢？在Autofac裡面有Module可以讓我們設定特殊的註冊邏輯。同時，在Module裡面有提供event讓我們可以再Autofac實例化component的時候，做一些事情。因此我們可以透過這個方法來注入我們class的名稱。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;br /&gt;&lt;p&gt;Module相關文件： &lt;a href="http://autofac.readthedocs.org/en/latest/configuration/modules.html"&gt;http://autofac.readthedocs.org/en/latest/configuration/modules.html&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411835209356631"&gt;建立NlogModule&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;建立一個Autofac的Module需要建立一個Class繼承&lt;code&gt;Autofac.Module&lt;/code&gt;。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們這邊會複寫兩個method： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;&lt;code&gt;Load&lt;/code&gt; - Module註冊第一個會執行的方法。這邊可以設定我們的NlogLogger將會作為ILog service的Component。 &lt;br /&gt;&lt;li&gt;&lt;code&gt;AttachToComponentRegistration&lt;/code&gt;這邊就是讓我們可以註冊一些在建立時候的事件 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;br /&gt;&lt;p&gt;這一段的程式碼是參考網路上面的資料，因此有些註解是英文。 &lt;/p&gt;&lt;/div&gt;&lt;pre class="brush: csharp;"&gt;// NLogModule.cs&lt;br /&gt; &lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Dependency Injection Module 用來註冊ILog將會使用NLog&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;public class NLogModule : Autofac.Module&lt;br /&gt;{&lt;br /&gt;	/// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// Override to add registrations to the container.&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="builder"&amp;gt;The builder through which components can be&lt;br /&gt;    /// registered.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;remarks&amp;gt;&lt;br /&gt;    /// Note that the ContainerBuilder parameter is unique to this module.&lt;br /&gt;    /// &amp;lt;/remarks&amp;gt;&lt;br /&gt;    protected override void Load(ContainerBuilder builder)&lt;br /&gt;    {&lt;br /&gt;        builder.RegisterType&amp;lt;NlogLogger&amp;gt;()&lt;br /&gt;          .As&amp;lt;ILog&amp;gt;();&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    /// &amp;lt;summary&amp;gt;&lt;br /&gt;    /// 增加透過用Constructor或者Property的方式注入&lt;br /&gt;    ///		&amp;lt;see cref="MvcInfrastructure.Common.Log.NlogLogger"/&amp;gt;&lt;br /&gt;    ///		為&amp;lt;see cref="MvcInfrastructure.Common.Log.ILog"/&amp;gt;的實作&lt;br /&gt;    /// &amp;lt;/summary&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="componentRegistry"&amp;gt;The component registry.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;param name="registration"&amp;gt;The registration to attach functionality to.&amp;lt;/param&amp;gt;&lt;br /&gt;    /// &amp;lt;remarks&amp;gt;&lt;br /&gt;    /// This method will be called for all existing &amp;lt;i&amp;gt;and future&amp;lt;/i&amp;gt; component&lt;br /&gt;    /// registrations - ordering is not important.&lt;br /&gt;    /// &amp;lt;/remarks&amp;gt;&lt;br /&gt;    protected override void AttachToComponentRegistration(IComponentRegistry componentRegistry, &lt;br /&gt;			IComponentRegistration registration)&lt;br /&gt;    {&lt;br /&gt;        // Handle constructor parameters. 處理Constructor注入&lt;br /&gt;        registration.Preparing += OnComponentPreparing;&lt;br /&gt;        &lt;br /&gt;        // Handle properties. 處理Property注入&lt;br /&gt;        registration.Activated += (sender, e) =&amp;gt; &lt;br /&gt;			InjectLoggerProperties(e.Instance);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;從上面可以看到，在&lt;code&gt;AttachToComponentRegistration&lt;/code&gt;我們註冊了兩個事件，一個是用來處理Constructor的時候注入參數，另外一個是用Property的方式注入。 &lt;/p&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;br /&gt;&lt;p&gt;我們實作的版本是沒有允許用Property的方式注入，不過保留這個方法僅供參考。 &lt;/p&gt;&lt;/div&gt;&lt;br /&gt;&lt;p&gt;接下來我們看一下，Constructor注入的方法是如何寫的： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;//NLogModule.cs&lt;br /&gt;&lt;br /&gt;// ....&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Called when [component preparing]. 用來增加Constructor方式注入&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="sender"&amp;gt;The sender.&amp;lt;/param&amp;gt;&lt;br /&gt;/// &amp;lt;param name="e"&amp;gt;The &amp;lt;see cref="PreparingEventArgs"/&amp;gt; instance containing the event data.&amp;lt;/param&amp;gt;&lt;br /&gt;private static void OnComponentPreparing(object sender, PreparingEventArgs e)&lt;br /&gt;{&lt;br /&gt;    var t = e.Component.Activator.LimitType;&lt;br /&gt;    e.Parameters = e.Parameters.Union(&lt;br /&gt;        new[]&lt;br /&gt;        {&lt;br /&gt;            new ResolvedParameter((p, i) =&amp;gt; p.ParameterType == typeof(ILog),&lt;br /&gt;                (p, i) =&amp;gt; i.Resolve&amp;lt;ILog&amp;gt;(new NamedParameter("name", t.FullName)))&lt;br /&gt;        });&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// .....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;最後，看一下如果用Property Inject的話是如何實現 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;//NLogModule.cs&lt;br /&gt;&lt;br /&gt;// ....&lt;br /&gt;&lt;br /&gt;/// &amp;lt;summary&amp;gt;&lt;br /&gt;/// Property注入的邏輯&lt;br /&gt;/// &amp;lt;/summary&amp;gt;&lt;br /&gt;/// &amp;lt;param name="instance"&amp;gt;目前被實例化的Class Instance&amp;lt;/param&amp;gt;&lt;br /&gt;private static void InjectLoggerProperties(object instance)&lt;br /&gt;{&lt;br /&gt;    var instanceType = instance.GetType();&lt;br /&gt;&lt;br /&gt;    // Get all the injectable properties to set.&lt;br /&gt;    // If you wanted to ensure the properties were only UNSET properties,&lt;br /&gt;    // here's where you'd do it.&lt;br /&gt;    var properties = instanceType&lt;br /&gt;      .GetProperties(BindingFlags.Public | BindingFlags.Instance)&lt;br /&gt;      .Where(p =&amp;gt; p.PropertyType == typeof(ILog) &amp;amp;&amp;amp; p.CanWrite &amp;amp;&amp;amp; p.GetIndexParameters().Length == 0);&lt;br /&gt;&lt;br /&gt;    // Set the properties located.&lt;br /&gt;    foreach (var propToSet in properties)&lt;br /&gt;    {&lt;br /&gt;        propToSet.SetValue(instance, new NlogLogger(instanceType.FullName), null);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;// .....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;到這邊，我們的Autofac.Module就建立好了。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411835209385846"&gt;註冊Autofac.Module&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;之前註冊的時候也沒有提到如何註冊Autofac.Module，這一次一起介紹。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;其他註冊的部分我們就不看了，就只看註冊Module的部分： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;//Global.asax&lt;br /&gt;&lt;br /&gt;// ....&lt;br /&gt;&lt;br /&gt;Builder.RegisterModule&amp;lt;NLogModule&amp;gt;();&lt;br /&gt;&lt;br /&gt;// .....&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這樣註冊就完成了，至於使用，就和上一篇介紹那樣，在要用到ILog的Controller裡面，把Constructor有個參數接受ILog形態的參數即可。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411835209385380"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;透過這一篇，我們就知道了如何建立一個Log的功能，並且如何作為我們第一個框架的服務。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;在下一篇開始，將會介紹再用Mvc開發的時候，最常用到的ViewModel概念和為什麼要使用ViewModel。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;有關於程式碼的部分，稍後會補上整個專案，以供參考。 &lt;/p&gt;&lt;script type="text/javascript" src="https://www.draw.io/embed.js?s=flowchart"&gt;&lt;/script&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/4046521654443336552/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html#comment-form' title='3 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4046521654443336552'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/4046521654443336552'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html' title='[iThome 第七屆鐵人賽 05] 打造第一個通用服務 - Log'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>3</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7817107804296020734</id><published>2014-09-26T23:15:00.000+08:00</published><updated>2014-11-30T09:49:09.022+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='Autofac'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 04] Autofac和Asp .Net Mvc結合</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154683600" ;=""&gt;Mvc能夠用DI Container帶來的好處&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693482" ;=""&gt;Asp .Net Mvc如何在建構Controller的時候，讓DI container介入&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693637" ;=""&gt;Autofac Asp.net Mvc Integration&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693745" ;=""&gt;Demo&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693745" ;=""&gt;先定義Log服務的Interface和一支實作&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693770" ;=""&gt;在Controller裡面，允許透過建構子注入ILog&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693781" ;=""&gt;設定DI Container和Mvc結合&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693370" ;=""&gt;取得Request裡面的QueryString並且輸出去到檔案&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693225" ;=""&gt;結語&lt;/a&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411744154693286" ;=""&gt;Reference&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇我們介紹了Autofac的基本概念，還有它裡面比較常用的專有名詞，詳細對於Autofac有了一些了解。 &lt;/p&gt; &lt;p&gt;在這一篇，我將會介紹如何讓我們在Asp .Net Mvc裡面，簡單的使用Autofac作為我們的DI Container。 &lt;/p&gt; &lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1411744154683600"&gt;Mvc能夠用DI Container帶來的好處&lt;/h1&gt; &lt;p&gt;在介紹Autofac如何提供簡單和Mvc結合之前，我們先來看一下Mvc有了DI Container的好處。 &lt;/p&gt; &lt;p&gt;通常來說在我們的Controller裡面至少都會depend別的library。有可能是Data Access Layer(DAL)或者是Business Logic Layer。我們以預設的Mvc Scaffolding搭配Entity Framework來看，可能會有類似如下的程式碼： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class LinksController : Controller&lt;br /&gt;{&lt;br /&gt;	private ApplicationDbContext db = new ApplicationDbContext();&lt;br /&gt;&lt;br /&gt;	// GET: Links&lt;br /&gt;	public ActionResult Index()&lt;br /&gt;	{&lt;br /&gt;		return View(db.Links.ToList());&lt;br /&gt;	}&lt;br /&gt;	&lt;br /&gt;	....&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這個有一個問題，那個&lt;code&gt;ApplicationDbContext&lt;/code&gt;等於是被寫死在裡面了，假設今天我要做單元測試，每一個測試都實際對DB執行其實是很沒有效率。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;因此，有一種做法是我們把&lt;code&gt;db&lt;/code&gt;這個參數實際的實例寫在建構子裡面，然後透過Controller在被建立的時候注入我們要的服務，這樣，如果在做單元測試的時候可以丟進去 mock出來的&lt;code&gt;db&lt;/code&gt;，在實際運行的時候，DI Container又會真的注入真的&lt;code&gt;db&lt;/code&gt;進去。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// psuedo 範例程式&lt;br /&gt;public class LinksController : Controller&lt;br /&gt;{&lt;br /&gt;    private ApplicationDbContext db;&lt;br /&gt;&lt;br /&gt;    public LinksController(ApplicationDbContext inDb)&lt;br /&gt;    {&lt;br /&gt;        db = inDb;&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public class UnitTest&lt;br /&gt;{&lt;br /&gt;    LinksController c = new LinksController(new FakeDbContext());&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;上面，是一個範例程式碼，表示在單元測試的時候可以替換db。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;不過如果這樣直接執行，也會出錯，因為預設的Mvc是只會實例化預設建構子（沒有參數的建構子），而以我們上面的例子來說，我們沒有預設建構子，因此，Mvc無法實例Controller 就會出錯。 &lt;a href="http://lh5.ggpht.com/-x3lMb3DEL1w/VCWIvhEhmZI/AAAAAAAANa0/M0ol1unb8Lo/s1600-h/image%25255B22%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-B4nxBIjru6E/VCWIxb1jLfI/AAAAAAAANa8/zOqp-3QF8-8/image_thumb%25255B10%25255D.png?imgmax=800" width="539" height="109"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;沒有預設建構子的錯誤&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;這個時候就要靠我們的DI Container了。Mvc只能夠實例化預設建構子是因為它不知道每一個參數是對應到什麼class，因此沒有辦法做下去。但是DI Container會有我們註冊的 Service和Component，因此DI Container知道如何實例化那些對應的建構子參數，達到幫我們注入正確的Component進去。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411744154693482"&gt;Asp .Net Mvc如何在建構Controller的時候，讓DI container介入&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;Mvc開發之間，就有考慮到這個問題，因此有一個靜態方法：&lt;code&gt;DependencyResolver.SetResolver(IDependencyResolver)&lt;/code&gt;可以讓我們告訴Mvc，當需要建立Controller的時候，不要用你自己的來建立，用註冊進去的&lt;code&gt;IDependencyResolver&lt;/code&gt;物件來做建立的動作。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;到這裡就需要來提一下Autofac的Mvc 5 Integration套件，基本上概念非常簡單這個部分的套件幫助我們是做好了&lt;code&gt;IDependencyResolver&lt;/code&gt;，並且讓我們能夠為Mvc不同的功能提供注入的服務。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411744154693637"&gt;Autofac Asp.net Mvc Integration&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;首先，需要先去nuget下載安裝，這個Integration的nuget指令如下： &lt;/p&gt;&lt;kbd&gt;Install-Package Autofac.Mvc5&lt;/kbd&gt; &lt;br /&gt;&lt;p&gt;這個integration提供了幾個helper方便我們整合Autofac和Mvc： &lt;/p&gt;&lt;br /&gt;&lt;ol&gt;&lt;br /&gt;&lt;li&gt;第一個當然是&lt;code&gt;IDependencyResolver&lt;/code&gt;的實作，方便使用Autofac作為Mvc的DI &lt;br /&gt;&lt;li&gt;&lt;code&gt;ContainerBuilder&lt;/code&gt;有多一個&lt;code&gt;RegisterControllers&lt;/code&gt;的擴充方法，只要把Controller所在的Assembly給他， 它就會幫我們把所有Controller都註冊成為Component &lt;br /&gt;&lt;li&gt;之前講註冊Service的時候，沒有提到Component的Lifetime Scope(這方面比較細部因此不會介紹，有興趣可以看文件)，在裝了這個Integration， 會多一個Lifetime Scope是&lt;code&gt;InstancePerHttpRequest&lt;/code&gt;，表示每一次Request都是新的物件 &lt;br /&gt;&lt;li&gt;有提供能夠動態注入ModelBinder到Mvc &lt;br /&gt;&lt;li&gt;提供一個Autofac的Module方便注入Http相關 - 因此要取得像Session、Request等變的簡單 &lt;br /&gt;&lt;li&gt;提供注入Property到View和ActionFilter裡面 &lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;&lt;div class="bs-callout bs-callout-info"&gt;更多詳細的介紹，請參考文件：&lt;a href="https://github.com/autofac/Autofac/wiki/Mvc-Integration#integrating-with-aspnet-mvc-40"&gt;Mvc Integration&lt;/a&gt; &lt;/div&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411744154693745"&gt;Demo&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;這邊我用一個簡單的例子來介紹有了DI的強大。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;我們假設要做一個很陽春的Log功能，他會把進來的Request QueryString記錄下來。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411744154693745"&gt;先定義Log服務的Interface和一支實作&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;public interface ILog&lt;br /&gt;{&lt;br /&gt;    void Write(string message);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;public class TextWriterLog : ILog&lt;br /&gt;{&lt;br /&gt;    public void Write(string message)&lt;br /&gt;    {&lt;br /&gt;        File.AppendAllText(@"R:\logFile.txt", message);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;上面沒有太特別的地方，一個interface，和一個寫到檔案的實作。 &lt;/p&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411744154693770"&gt;在Controller裡面，允許透過建構子注入ILog&lt;/h2&gt;&lt;pre class="brush: csharp;"&gt;public class HomeController : Controller&lt;br /&gt;{&lt;br /&gt;    ILog logger;&lt;br /&gt;&lt;br /&gt;    public HomeController(ILog inLogger)&lt;br /&gt;    {&lt;br /&gt;        logger = inLogger;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    // GET: Home&lt;br /&gt;    public ActionResult Index()&lt;br /&gt;    {&lt;br /&gt;        logger.Write("進入 Home/Index");&lt;br /&gt;        return View();&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h3 id="WizKMOutline_1411744154693781"&gt;設定DI Container和Mvc結合&lt;/h3&gt;&lt;br /&gt;&lt;p&gt;到了這邊，我們就需要去設定DI Container和要註冊的物件 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 在global.asax.cs&lt;br /&gt;protected void Application_Start()&lt;br /&gt;{&lt;br /&gt;    var builder = new ContainerBuilder();&lt;br /&gt;&lt;br /&gt;    // 註冊所有的Controller作為Service&lt;br /&gt;    builder.RegisterControllers(typeof(HomeController).Assembly);&lt;br /&gt;&lt;br /&gt;    // 註冊TextWriterLog作為ILog的Service&lt;br /&gt;    builder.RegisterType&amp;lt;TextWriterLog&amp;gt;().As&amp;lt;Ilog&amp;gt;();&lt;br /&gt;&lt;br /&gt;    // 建立 DI Container&lt;br /&gt;    var container = builder.Build();&lt;br /&gt;&lt;br /&gt;    // 用DI Container作為建立Controller時候的DI Resolver。&lt;br /&gt;    DependencyResolver.SetResolver(new AutofacDependencyResolver(container));&lt;br /&gt;	&lt;br /&gt;// 其他Mvc設定&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;這時候把我們的程式run起來，之後就會發現多了一個檔案： &lt;a href="http://lh6.ggpht.com/-lbBnglzEGHo/VCWIyTOnh6I/AAAAAAAANbE/Lt8EaN8PTok/s1600-h/image%25255B25%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-r6tSSHaCwtY/VCWIziuMXjI/AAAAAAAANbM/w23rWiYPz3o/image_thumb%25255B11%25255D.png?imgmax=800" width="396" height="120"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;TextWriterLog輸出的結果內容&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;h2 id="WizKMOutline_1411744154693370"&gt;取得Request裡面的QueryString並且輸出去到檔案&lt;/h2&gt;&lt;br /&gt;&lt;p&gt;一開是說會把QueryString的東西也輸出來，這還需要一點設定。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;首先在&lt;code&gt;global.asax.cs做點增加：&lt;/code&gt; &lt;/p&gt;&lt;pre class="brush: csharp; highlight: [6, 7]"&gt;// .. 其他內容&lt;br /&gt;&lt;br /&gt;// 註冊TextWriterLog作為ILog的Service&lt;br /&gt;builder.RegisterType&amp;lt;TextWriterLog&amp;gt;().As&amp;lt;Ilog&amp;gt;();&lt;br /&gt;&lt;br /&gt;// 註冊Http 相關內容&lt;br /&gt;builder.RegisterModule(new AutofacWebTypesModule());&lt;br /&gt;&lt;br /&gt;// 建立 DI Container&lt;br /&gt;var container = builder.Build();&lt;br /&gt;&lt;br /&gt;// .. 其他內容&lt;br /&gt;&lt;/ilog&gt;&lt;/textwriterlog&gt;&lt;/pre&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;再來，修改我們的&lt;code&gt;TextWriterLog&lt;/code&gt; &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;public class TextWriterLog : ILog&lt;br /&gt;{&lt;br /&gt;    HttpRequestBase request;&lt;br /&gt;	&lt;br /&gt;	// 注入Request&lt;br /&gt;    public TextWriterLog(HttpRequestBase inRequest)&lt;br /&gt;    {&lt;br /&gt;        request = inRequest;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    public void Write(string message)&lt;br /&gt;    {&lt;br /&gt;        var queryString = string.Empty;&lt;br /&gt;&lt;br /&gt;        foreach (var item in request.QueryString.AllKeys)&lt;br /&gt;        {&lt;br /&gt;            queryString = queryString + item + "=" + &lt;br /&gt;				request.QueryString[item] + "&amp;amp;";&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        var result = string.Format("訊息：{0}{1} QueryString：{2}{3}", &lt;br /&gt;			message, Environment.NewLine, queryString, Environment.NewLine);&lt;br /&gt;&lt;br /&gt;        File.AppendAllText(@"R:\logFile.txt", result);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;最後我們帶上Querystring瀏覽：&lt;/p&gt;&lt;br /&gt;&lt;p&gt;&amp;nbsp;&lt;a href="http://lh4.ggpht.com/-h9TKEsuNNnI/VCWI00mvDiI/AAAAAAAANbU/6Bx0Hw8lDN8/s1600-h/image%25255B29%25255D.png"&gt;&lt;img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-LlZTQ_LDWqk/VCWI2WCHbaI/AAAAAAAANbc/KCXMUxrqhlU/image_thumb%25255B13%25255D.png?imgmax=800" width="311" height="171"&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure&gt; &lt;figcaption&gt;最後輸出結果的截圖&lt;/figcaption&gt; &lt;/figure&gt;&lt;br /&gt;&lt;p&gt;這邊結果有兩次，第一次是執行起來沒有Querystring，第二次則是有帶上QueryString。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411744154693225"&gt;結語&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;希望透過這一篇對於Autofac和Mvc的整合有些了解。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;也希望透過簡單的範例，能夠看到有DI的強大，畢竟我們不需要做什麼，我們只是說我需要一個Request，在方法裡面就會有Request的Instance。 &lt;/p&gt;&lt;br /&gt;&lt;p&gt;下一篇我們講開始打造我們的框架，首先從建立我們自己的Log服務開始。 &lt;/p&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411744154693286"&gt;Reference&lt;/h1&gt;&lt;br /&gt;&lt;p&gt;如果想要知道更多關於 Autofac Mvc Integration其他用法，請參考文件： &lt;a href="https://github.com/autofac/Autofac/wiki/Mvc-Integration#integrating-with-aspnet-mvc-40"&gt;Mvc Integration&lt;/a&gt;&lt;/p&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7817107804296020734/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-04-AutofacMvcIntegration.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7817107804296020734'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7817107804296020734'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-04-AutofacMvcIntegration.html' title='[iThome 第七屆鐵人賽 04] Autofac和Asp .Net Mvc結合'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh6.ggpht.com/-B4nxBIjru6E/VCWIxb1jLfI/AAAAAAAANa8/zOqp-3QF8-8/s72-c/image_thumb%25255B10%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7719748122929788205</id><published>2014-09-25T22:48:00.001+08:00</published><updated>2014-11-30T09:49:09.019+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='Autofac'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 03] Autofac基本介紹</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt; &lt;ul style="margin: 0px 0px 0px 20px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069470" ;=""&gt;DI Container的選擇&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069634" ;=""&gt;Autofac介紹&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069586" ;=""&gt;Autofac 基本概念介紹&lt;/a&gt;  &lt;ul style="margin: 0px 0px 0px 30px"&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069513" ;=""&gt;第一步，建立ContainerBuilder&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069240" ;=""&gt;第二步，註冊服務&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069449" ;=""&gt;第三步，建立Container&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069891" ;=""&gt;最後一步，取得我們要的Component&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069771" ;=""&gt;Autofac 使用範例&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069284" ;=""&gt;結語&lt;/a&gt;  &lt;li&gt;&lt;a href="#WizKMOutline_1411655187069121" ;=""&gt;Reference&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;p&gt;在上一篇：&lt;a href="http://alantsai2007.blogspot.com/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html"&gt;IoC基本概念介紹&lt;/a&gt;介紹了IoC和DI的概念。在最後提到了，如果沒有一個東西幫我們管理DI，那麼其實整個的彈性設計還是無法彈性起來。 &lt;/p&gt; &lt;p&gt;因此在這一篇，我們就來看一下其中一個比較常用的DI Container：Autofac。 &lt;/p&gt;  &lt;a name='more'&gt;&lt;/a&gt;&lt;h1 id="WizKMOutline_1411655187069470"&gt;DI Container的選擇&lt;/h1&gt; &lt;p&gt;其實有很多種DI Container，它們的運作邏輯都差不多，因此假設不希望在自己的專案裡面使用Autofac，完全可以換一個用的習慣的DI Container。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;之前在第一篇提到的&lt;a href="https://github.com/MattHoneycutt/Fail-Tracker"&gt;Fail-Tracker(Github)&lt;/a&gt;，它裏面使用的就是Structuremap這個DI Container。 &lt;/p&gt;&lt;/div&gt; &lt;div class="bs-callout bs-callout-primary"&gt; &lt;p&gt;如果還沒有選好要用的DI Container，又想要貨比三家，可以參考這篇部落格 &lt;a href="http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison"&gt;IoC Container Benchmark - Performance comparison&lt;/a&gt; 看看針對比較常見的.Net DI Container做效能和功能的比較。 &lt;/p&gt;&lt;/div&gt; &lt;h1 id="WizKMOutline_1411655187069634"&gt;Autofac介紹&lt;/h1&gt; &lt;div class="bs-callout bs-callout-default"&gt; &lt;h4&gt;&lt;a href="http://lh4.ggpht.com/-PpffZ-vrNRQ/VCQoaXkyRiI/AAAAAAAANZU/BdadqIdcVGQ/s1600-h/image%25255B3%25255D.png"&gt;&lt;img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-o3TN9x5Sjd8/VCQods51RII/AAAAAAAANZc/dz3KjL-FWto/image_thumb%25255B1%25255D.png?imgmax=800" width="50" height="45"&gt;&lt;/a&gt;Autofac&lt;/h4&gt; &lt;ul&gt; &lt;li&gt;官網：&lt;a href="http://autofac.org/"&gt;http://autofac.org/&lt;/a&gt;  &lt;li&gt;文件：&lt;a href="http://autofac.readthedocs.org/en/latest/"&gt;http://autofac.readthedocs.org/en/latest/&lt;/a&gt;  &lt;li&gt;Nuget上面和它有關的package：&lt;a href="https://www.nuget.org/packages?q=Author%3A%22Autofac+Contributors%22+Owner%3A%22alexmg%22+Autofac*"&gt;Nuget網頁搜索&lt;/a&gt;  &lt;li&gt;Autofac nuget 安裝指令：&lt;kbd&gt;Install-Package Autofac&lt;/kbd&gt;  &lt;li&gt;Autofac 和asp .net mvc 5 整合的nuget 安裝指令：&lt;kbd&gt;Install-Package Autofac.Mvc5&lt;/kbd&gt;  &lt;li&gt;其他備註：Autofac不止適合用在Mvc裡面，基本上所有類型的.Net他都有對應的整合Helper（就像上面那個就是針對mvc 5的整合helper）。 &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt; &lt;h1 id="WizKMOutline_1411655187069586"&gt;Autofac 基本概念介紹&lt;/h1&gt; &lt;p&gt;基本上來說使用Autofac的流程就是： &lt;/p&gt;&lt;figure&gt;&lt;figcaption&gt;&lt;a href="http://lh4.ggpht.com/-Dp6v99pFgf4/VCQogNlP2vI/AAAAAAAANZk/dmXhkmTnnjM/s1600-h/Autofac%252520Basic%252520Flow%25255B10%25255D.png"&gt;&lt;img title="Autofac Basic Flow" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Autofac Basic Flow" src="http://lh4.ggpht.com/-75CrYSvKPxg/VCQolX7Ol3I/AAAAAAAANZs/wBANx-ee6yg/Autofac%252520Basic%252520Flow_thumb%25255B6%25255D.png?imgmax=800" width="158" height="244"&gt;&lt;/a&gt;Autofac最基本使用流程圖&lt;/figcaption&gt; &lt;/figure&gt; &lt;h2 id="WizKMOutline_1411655187069513"&gt;第一步，建立ContainerBuilder&lt;/h2&gt; &lt;p&gt;在第一步就是建立一個ContainerBuilder的物件。要建立DI Container，你當然需要告訴他什麽東西配對什麽，因此，這個物件會記錄你註冊進去的Service（服務）和Component（元件）- 等一下在有比較詳細介紹這兩個的意思，最後都註冊完了，就建立出一個DI Container。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1411655187069240"&gt;第二步，註冊服務&lt;/h2&gt; &lt;p&gt;第二步就是註冊服務。在Autofac裡面基本上最長看到的應該就是Service和Component： &lt;/p&gt; &lt;ul&gt; &lt;li&gt;&lt;em&gt;Component&lt;/em&gt;：要註冊到Container的類別。Component基本上就是你和DI Container要東西的時候，他會new給你的類別  &lt;li&gt;&lt;em&gt;Service&lt;/em&gt;：Service就是Component會提供的服務。基本上會是interface（當然，不一定是要interface）。 &lt;/li&gt;&lt;/ul&gt;因此，簡單來看，Service是interface，Component就是interface的實作。因此，在註冊到ContainerBuilder的時候，要告訴他，什麽service（interface），對應到什麽 component（interface實作的class）。  &lt;p&gt;在註冊服務這一邊，Autofac有提供所謂的module，也就是比較複雜或可重複使用的服務註冊可以把它包成一個module，這樣以後註冊起來很方便（Autofac和Mvc的結合也是用了 Module，方便註冊Mvc相關） &lt;/p&gt; &lt;p&gt;在註冊服務這一方面，Autofac提供了很多種的註冊方式，可以由寫C#來註冊，也可以由讀xml來設定註冊，因此非常彈性。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-info"&gt; &lt;p&gt;在註冊這一塊其實很多細節，詳細可以參考：&lt;a href="http://autofac.readthedocs.org/en/latest/register/index.html"&gt;Registering Component&lt;/a&gt; &lt;/p&gt;&lt;/div&gt; &lt;h2 id="WizKMOutline_1411655187069449"&gt;第三步，建立Container&lt;/h2&gt; &lt;p&gt;第三步就是當我們把要用的service和component都註冊完成了之後，就會呼叫ContainerBuilder.Build()。這個的東西就是我們的DI Container。 &lt;/p&gt; &lt;h2 id="WizKMOutline_1411655187069891"&gt;最後一步，取得我們要的Component&lt;/h2&gt; &lt;p&gt;最後，有了Container，我們就可以透過Container，來取得我們需要的component。 &lt;/p&gt; &lt;p&gt;這個在文件裡面稱之為&lt;em&gt;Resolving&lt;/em&gt;，相關的使用方法可以參考文件的&lt;a href="http://autofac.readthedocs.org/en/latest/resolve/index.html"&gt;Resolving Service&lt;/a&gt;。 &lt;/p&gt; &lt;div class="bs-callout bs-callout-warning"&gt; &lt;p&gt;Resolving我不會提太多，因為基本上多我們來說是無縫的和Mvc整合，我們不需要自己手動Resolve。因此，之後有需要請參考文件。 &lt;/p&gt;&lt;/div&gt; &lt;h1 id="WizKMOutline_1411655187069771"&gt;Autofac 使用範例&lt;/h1&gt; &lt;p&gt;下面的範例是我從官網抄下來，裡面的注解介紹了每一個部份： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 第一步，建立ContainerBuilder&lt;br /&gt;var builder = new ContainerBuilder();&lt;br /&gt;&lt;br /&gt;// 開始 第二步，註冊service&lt;br /&gt;&lt;br /&gt;// 註冊ConsoleLogger這個class為ILogger Service的Component&lt;br /&gt;builder.RegisterType&amp;lt;ConsoleLogger&amp;gt;.As&amp;lt;ILogger&amp;gt;();&lt;br /&gt;&lt;br /&gt;// 如果寫法是：builder.RegisterType&amp;lt;ConsoleLogger&amp;gt;(); &lt;br /&gt;// 那麼就是ConsoleLogger這個class為ConsoleLogger Service的Component&lt;br /&gt;&lt;br /&gt;// 註冊自己實例化出來的物件&lt;br /&gt;// 上面是只註冊class type（因此，用到的時候是autofac幫你new出來），這邊是直接用這個object&lt;br /&gt;var output = new StringWriter();&lt;br /&gt;builder.RegisterInstance(output).As&amp;lt;TextWriter&amp;gt;();&lt;br /&gt;&lt;br /&gt;// 用lambda 註冊會更有彈性，因為傳進來的c是container的instance，因此可以用c來做一些複雜的東西。&lt;br /&gt;builder.Register(c =&amp;gt; new ConfigReader("mysection")).As&amp;lt;IConfigReader&amp;gt;();&lt;br /&gt;&lt;br /&gt;// 假設不想要一個一個註冊，可以用scan的方式。&lt;br /&gt;// 下面scan一個assembly所有的type，當那個type的名字最後結尾是Repository的時候，&lt;br /&gt;// 把它註冊的service設為這個class的interface&lt;br /&gt;builder.RegisterAssemblyTypes(myAssembly)&lt;br /&gt; .Where(t =&amp;gt; t.Name.EndsWith("Repository"))&lt;br /&gt; .AsImplementedInterfaces();&lt;br /&gt;&lt;br /&gt;//結束 第二步&lt;br /&gt;&lt;br /&gt;// 第三步，註冊都完成了，建立自己的container&lt;br /&gt;var container = builder.Build();&lt;br /&gt;&lt;br /&gt;// 第四部，從container取得對應的component。&lt;br /&gt;// 這邊用using包起來，因為出了這個scope，一切Resolve出來的都會被釋放掉。&lt;br /&gt;// 這部份在我們整個系列碰到並不多，因為不建議自己每一個這樣取出來，&lt;br /&gt;// 而是用深度整合的方式來讓一切像自動發生。&lt;br /&gt;// 詳細之後就會比較清楚&lt;br /&gt;using(var scope = container.BeginLifetimeScope())&lt;br /&gt;{&lt;br /&gt;  var reader = container.Resolve&amp;lt;IConfigReader&amp;gt;();&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h1 id="WizKMOutline_1411655187069284"&gt;結語&lt;/h1&gt;&lt;p&gt;如果從來沒有使用過DI Container，看到這邊可能還是覺得很抽象，不確定怎麼用。不用擔心，之後我們在開發框架的時候會使用到，到時候在回來比照前面這些內容，相信因該會給一個不錯的起始點。 &lt;/p&gt;&lt;p&gt;Autofac其實細部有很多內容，我這邊只碰到了最基礎的部份，希望透過這一篇能夠打開DI Container和Autofac的一些學習曲綫，給予一個好的起始點，之後要查找問題能夠更容易一些。 &lt;/p&gt;&lt;p&gt;本來這一篇會介紹到Autofac如何和Asp .net Mvc整合，但在寫下去怕太長，因此Mvc的部份就留到下一次在講。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411655187069121"&gt;Reference&lt;/h1&gt;&lt;p&gt;再次總結一下相關資源： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;第一個一定要再次介紹官網，因為裡面的文件很詳細（只不過它是英文）&lt;a href="http://autofac.org/"&gt;官網&lt;/a&gt; 、&lt;a href="http://autofac.readthedocs.org/en/latest/"&gt;文件&lt;/a&gt; &lt;br /&gt;&lt;li&gt;黑大曾經有寫過一些Autofac相關：&lt;a href="http://blog.darkthread.net/post-2011-06-07-autofac-notes-1.aspx"&gt;Autofac筆記 1&lt;/a&gt;、 &lt;a href="http://blog.darkthread.net/blogs/darkthreadtw/archive/tags/Autofac/default.aspx"&gt;其他Autofac相關&lt;/a&gt; &lt;li&gt;DI Container 的比較和評測：&lt;a href="http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison"&gt;IoC Container Benchmark - Performance comparison&lt;/a&gt;&amp;nbsp; &lt;/li&gt;&lt;/ul&gt;  </content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/7719748122929788205/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-03-Autofac-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7719748122929788205'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/7719748122929788205'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-03-Autofac-intro.html' title='[iThome 第七屆鐵人賽 03] Autofac基本介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='http://lh4.ggpht.com/-o3TN9x5Sjd8/VCQods51RII/AAAAAAAANZc/dz3KjL-FWto/s72-c/image_thumb%25255B1%25255D.png?imgmax=800' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3610367127925014904</id><published>2014-09-24T22:39:00.000+08:00</published><updated>2014-11-30T09:49:08.996+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='Asp .Net Mvc'/><category scheme='http://www.blogger.com/atom/ns#' term='Autofac'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 02] IoC基本概念介紹</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065409" ;=""&gt;什麽是IoC？&lt;/a&gt; &lt;ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065133" ;=""&gt;傳統New Class的方法&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065715" ;=""&gt;從硬體學到的概念：Interface&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065776" ;=""&gt;回來看IoC的概念&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065537" ;=""&gt;DI是什麽？&lt;/a&gt; &lt;ul style="margin: 0px 0px 0px 30px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065467" ;=""&gt;Constructor injection&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065293" ;=""&gt;Property injection&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065106" ;=""&gt;DI Container&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065133" ;=""&gt;結語&lt;/a&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411569108065440" ;=""&gt;Reference&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;在實際開始進入Asp .net Mvc之前，我們需要先來看一下一個很重要的概念，那就是IoC。 &lt;/p&gt;&lt;p&gt;可以說IoC是框架的核心，基本上只要具備一定規模的框架，通常都會使用IoC和DI的搭配，因此我們需要先瞭解它的概念才能夠實際開始我們的框架開發。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt; &lt;h1 id="WizKMOutline_1411569108065409"&gt;什麽是IoC？&lt;/h1&gt;&lt;div class="bs-callout bs-callout-info"&gt;IoC是Inversion Of Control（控制翻轉）的縮寫。 &lt;/div&gt;&lt;p&gt;在介紹IoC之前，我們先來一段歷史回顧，看看彈性的程式是如何演進。 &lt;/p&gt;&lt;h2 id="WizKMOutline_1411569108065133"&gt;傳統New Class的方法&lt;/h2&gt;&lt;p&gt;我們寫了一支方法，而這一支方法（Write(string text)）的功能非常簡單，就是把傳入的參數輸出到console： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;class Program&lt;br /&gt;{&lt;br /&gt;    static void Main(string[] args)&lt;br /&gt;    {&lt;br /&gt;        ConsoleOutput output = new ConsoleOutput();&lt;br /&gt;        output.Write("Hello World");&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;class ConsoleOutput&lt;br /&gt;{&lt;br /&gt;    public void Write(string text)&lt;br /&gt;    {&lt;br /&gt;        Console.WriteLine(text);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;開發出來了，一切都很美好，但是有一天有個使用者和你反應：「這個輸出能不能輸出到Text檔案裡面啊？」 &lt;/p&gt;&lt;p&gt;身為一個厲害的工程師，這個當然沒有問題，馬上幫他寫出另外一個版本是輸出到Text檔案： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;class Program&lt;br /&gt;{&lt;br /&gt;    static void Main(string[] args)&lt;br /&gt;    {&lt;br /&gt;        // ConsoleOutput output = new ConsoleOutput();&lt;br /&gt;        TextOutput output = new TextOutput();&lt;br /&gt;        output.Write("Hello World");&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;class TextOutput&lt;br /&gt;{&lt;br /&gt;    public void Write(string text)&lt;br /&gt;    {&lt;br /&gt;        File.WriteAllText("Filex.txt", text);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;// ConsoleOutput 和之前一樣..&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;到目前為止，其實已經暴露出好的Design需要避免的問題： &lt;/p&gt;&lt;div class="bs-callout bs-callout-warning"&gt;&lt;h4&gt;loose coupling原則&lt;/h4&gt;&lt;p&gt;主要的程式非常依賴（Depend）實際的class，這導致了： &lt;/p&gt;&lt;p&gt;當輸出到不同目的地的時候，開發者需要重新編譯整個程式碼，甚至連呼叫的地方都需要重新修改，當程式碼和邏輯不複雜的時候問題不大，但是當程式變大的時候 這其實是很麻煩的一件事情。這違反了OO裡面常說的loose coupling的原則。 &lt;/p&gt;&lt;/div&gt;&lt;h2 id="WizKMOutline_1411569108065715"&gt;從硬體學到的概念：Interface&lt;/h2&gt;&lt;p&gt;爲了避免掉這一種直接的依賴關係，我們像硬體界學了一個概念，也就是Interface（介面）。 &lt;/p&gt;&lt;p&gt;我們可以想像，世界上面那麼多的廠商都在做HD，我們怎麼能夠保證廠商 A和廠商 B的HD都能夠在我電腦上面使用呢？靠的就是每一家廠商的HD都會依照開出來的Interface（介面）去做產品。因此，只要你的電腦有SATA（interface），就可以讀的到SATA的HD。 &lt;/p&gt;&lt;p&gt;同樣道理用在軟體上面，我管你是如何實作（管你是哪家生產的廠商），只要最後你的結果是有Write（HD能夠和SATA接上）的Class就好。這樣我們就可以彈性話的切換我們想要的實作。 &lt;/p&gt;&lt;p&gt;因此，我們的程式碼變成： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;interface IWriter&lt;br /&gt;{&lt;br /&gt;    void Write(string text);&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;class TextOutput : IWriter&lt;br /&gt;{&lt;br /&gt;    public void Write(string text)&lt;br /&gt;    {&lt;br /&gt;        File.WriteAllText("Filex.txt", text);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;class ConsoleOutput : IWriter&lt;br /&gt;{&lt;br /&gt;    public void Write(string text)&lt;br /&gt;    {&lt;br /&gt;        Console.WriteLine(text);&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;因為我們現在完全把&lt;em&gt;實作&lt;/em&gt;和&lt;em&gt;功能&lt;/em&gt;拆出來了，我們可以動態的讓使用者選擇輸出方式： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;static void Main(string[] args)&lt;br /&gt;{&lt;br /&gt;    IWriter output;&lt;br /&gt; &lt;br /&gt;    // 使用者選擇要用檔案輸出還是Console輸出&lt;br /&gt;    if (args.Count() &gt; 0 &amp;&amp; args[0] == "text")&lt;br /&gt;    {&lt;br /&gt;        output = new TextOutput();&lt;br /&gt;    }&lt;br /&gt;    else&lt;br /&gt;    {&lt;br /&gt;        output = new ConsoleOutput();&lt;br /&gt;    }&lt;br /&gt; &lt;br /&gt;    output.Write("Hello World");&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;h2 id="WizKMOutline_1411569108065776"&gt;回來看IoC的概念&lt;/h2&gt;&lt;p&gt;看完了傳統的、沒有彈性的寫法和用了Interface的寫法對比，應該會感覺到其實這兩個流程是不太一樣： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;傳統、沒有彈性的寫法在&lt;em&gt;定義（Declare）&lt;/em&gt;參數的瞬間就&lt;em&gt;已經決定了&lt;/em&gt;這個參數的具體使用方式。因此和一般的程式flow是一樣的，&lt;em&gt;重上到下&lt;/em&gt;  &lt;li&gt;使用interface的寫法，是在&lt;em&gt;實例（也就是new()）&lt;/em&gt;的時候才決定具體的使用方法。因此它的flow是到要用的時候才會new，所以是&lt;em&gt;依照&lt;/em&gt; 後面要什麽來控制的。 &lt;/li&gt;    &lt;/ul&gt;&lt;p&gt;這時候我們在想想IoC的意思是控制翻轉，就能夠大概瞭解意思了。傳統的方法屬於&lt;em&gt;重上到下&lt;/em&gt;，而interface則是由new()他的類別來決定實作，因此控制的流程翻轉了。（不再是重上到下了） &lt;/p&gt;&lt;div class="bs-callout bs-callout-info"&gt;&lt;p&gt;因此，IoC在框架裡面非常重要，因為透過interface把功能抽離，我們的框架才能夠使用IoC的方式來決定什麽的實作（也就是實際的方法）是我們框架要的。 &lt;/p&gt;&lt;/div&gt;&lt;h1 id="WizKMOutline_1411569108065537"&gt;DI是什麽？&lt;/h1&gt;&lt;p&gt;我們從上面IoC看到了，利用interface的方式，可以再使用的時候在決定要使用的實作是那一個。這時候，我們下一個問題是，那決定實作的時刻是如何使用的呢？ &lt;/p&gt;&lt;p&gt;這個時候我們又有一個新的名詞，就是Dependency Injection（相依性注入）。 &lt;/p&gt;&lt;p&gt;基本上，這邊會介紹的DI只有透過你Constructor和Property的這兩種方式。為了這兩種方法的介紹，我們把程式碼在包一層（之前是直接寫在Main裡面），所以假設我們有一個library class，他依賴一個IWriter的物件。 &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 此class 會用到IWriter&lt;br /&gt;public class LibraryWrapper&lt;br /&gt;{&lt;br /&gt;    // ....&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;h2 id="WizKMOutline_1411569108065467"&gt;Constructor injection&lt;/h2&gt;&lt;p&gt;這個的意思是透過建構子來注入依賴的物件： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 此class 會用到IWriter&lt;br /&gt;public class LibraryWrapper&lt;br /&gt;{&lt;br /&gt;    private IWriter _writer;&lt;br /&gt;    // 透過建構子注入相依的物件&lt;br /&gt;    public LibraryWrapper(IWriter inWriter)&lt;br /&gt;    {&lt;br /&gt;        _writer = inWriter;&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;.....&lt;br /&gt;// 使用上就是&lt;br /&gt; &lt;br /&gt;LibraryWrapper output;&lt;br /&gt; &lt;br /&gt;// 使用者選擇要用檔案輸出還是Console輸出&lt;br /&gt;if (args.Count() &gt; 0 &amp;&amp; args[0] == "text")&lt;br /&gt;{&lt;br /&gt;    output = new LibraryWrapper (new TextOutput());&lt;br /&gt;}&lt;br /&gt;else&lt;br /&gt;{&lt;br /&gt;    output = new LibraryWrapper (new ConsoleOutput());&lt;br /&gt;}&lt;br /&gt;...&lt;br /&gt;&lt;/pre&gt;&lt;h2 id="WizKMOutline_1411569108065293"&gt;Property injection&lt;/h2&gt;&lt;p&gt;相較於建構子的時候注入，這種類型是透過property來注入： &lt;/p&gt;&lt;pre class="brush: csharp;"&gt;// 此class 會用到IWriter&lt;br /&gt;public class LibraryWrapper&lt;br /&gt;{&lt;br /&gt;    public IWriter Writer { get; set; }&lt;br /&gt;}&lt;br /&gt; &lt;br /&gt;.....&lt;br /&gt;// 使用上就是&lt;br /&gt; &lt;br /&gt;LibraryWrapper output;&lt;br /&gt; &lt;br /&gt;// 使用者選擇要用檔案輸出還是Console輸出&lt;br /&gt;if (args.Count() &gt; 0 &amp;&amp; args[0] == "text")&lt;br /&gt;{&lt;br /&gt;    output = new LibraryWrapper ();&lt;br /&gt;    output.Writer = new TextOutput();&lt;br /&gt;}&lt;br /&gt;else&lt;br /&gt;{&lt;br /&gt;    output = new LibraryWrapper ();&lt;br /&gt;    output.Writer = new ConsoleOutput();&lt;br /&gt;}&lt;br /&gt;...&lt;br /&gt;&lt;/pre&gt;&lt;h1 id="WizKMOutline_1411569108065106"&gt;DI Container&lt;/h1&gt;&lt;p&gt;到目前為止，我們介紹了透過interface來讓我們可以做到IoC達到框架來選擇實際的實作是那一個。再來，我們介紹了所謂的DI來決定interface的實作是什麽時候決定。最後這一部份我們要介紹所謂的DI Container。 &lt;/p&gt;&lt;p&gt;雖然DI我們可以用手動的方式達到，但是其實還是&lt;em&gt;不彈性&lt;/em&gt;。舉例來說，當我要切換實作的時候，還是需要改code並且重新編譯。因此本質上還是沒有彈性的效果。 &lt;/p&gt;&lt;p&gt;再來，假設我有一些實作希望是以全域的方式注入。換句話說，就是所有的這個interface的實作，都用同一個instance的話，靠我們手動是沒有辦法簡單做到的。 &lt;/p&gt;&lt;p&gt;因此有了所謂DI Container。DI Container會記錄我們所有的interface和實作的對應（可以用xml方式設定，因此不需要重新compile程式就可以改interface的對應實作），並且管理這些實作的instance scope（例如，剛剛提到的，某些實作要以單一全域的方式存在）。 &lt;/p&gt;&lt;p&gt;有了DI Container，我們才能真的做到彈性。 &lt;/p&gt;&lt;p&gt;DI Container有很多，比較常見的有： &lt;/p&gt;&lt;ul&gt;&lt;li&gt;Autofac  &lt;li&gt;Unity  &lt;li&gt;Ninject  &lt;li&gt;Structuremap  &lt;li&gt;Spring（Java派比較常用）  &lt;li&gt;等等... &lt;/li&gt;    &lt;/ul&gt;這些Container各有優勢，不過本質上都是一樣的作用。   &lt;h1 id="WizKMOutline_1411569108065133"&gt;結語&lt;/h1&gt;&lt;p&gt;透過這一篇，我希望大家對於Ioc和DI有了一些基本的概念，在下一篇我會介紹Autofac這個DI Container，並且如何開始和我們的Mvc框架整合。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411569108065440"&gt;Reference&lt;/h1&gt;&lt;ul&gt;&lt;li&gt;Martin Fowler有寫過一篇專門介紹IoC的，很值得一看：&lt;a href="http://www.martinfowler.com/articles/injection.html"&gt;原文&lt;/a&gt;、 &lt;a href="http://www.cnblogs.com/yilin/archive/2008/06/26/1230380.html"&gt;簡體中文翻譯版&lt;/a&gt; &lt;/li&gt;&lt;/ul&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/3610367127925014904/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html#comment-form' title='2 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3610367127925014904'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/3610367127925014904'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html' title='[iThome 第七屆鐵人賽 02] IoC基本概念介紹'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>2</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2923252187346622344</id><published>2014-09-23T21:26:00.000+08:00</published><updated>2014-09-23T21:26:00.946+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='「iThome 第七屆鐵人賽」'/><title type='text'>[iThome 第七屆鐵人賽 01] 開篇</title><content type='html'>&lt;a id="KMContentPageTopID" name="KMContentPageTopID"&gt;&lt;/a&gt; &lt;div id="divKMOutline" style="border-top-style: groove; border-bottom-style: groove; border-right-style: none; margin: 10px 0px; border-left-style: none"&gt;&lt;ul style="margin: 0px 0px 0px 20px"&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411403456163972" ;=""&gt;爲什麽要寫這個主題？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411403456163913" ;=""&gt;什麽是框架（Framework）？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411403456163647" ;=""&gt;Asp .Net Mvc 問題在那裡？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411403456163515" ;=""&gt;適合什麽樣的人看？&lt;/a&gt;&lt;br /&gt;&lt;li&gt;&lt;a href="#WizKMOutline_1411403456163657" ;=""&gt;其他注意事項&lt;/a&gt;&lt;/li&gt;&lt;br /&gt;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;一眨眼一年就過去了，去年參加鐵人賽的心情彷如昨日。 &lt;/p&gt;&lt;p&gt;經過一年的時間，終於又回來專注於開發我比較習慣的環境，也就是Asp .Net Mvc。 &lt;/p&gt;&lt;p&gt;因此相較於去年的主題“C# Web 開發 跳到 Java Web開發”，今年的主題“以Asp .Net MVC 5 為基礎，建立自己的程式開發框架”難度比去年高，同時也是一直以來我想要做的事情。 &lt;/p&gt;&lt;p&gt;希望今年也能夠帶給大家一些幫助。 &lt;/p&gt;&lt;a name='more'&gt;&lt;/a&gt;&lt;h1 id="WizKMOutline_1411403456163972"&gt;爲什麽要寫這個主題？&lt;/h1&gt;&lt;p&gt;在用Asp .net Mvc開發不同的專案過程當中，我漸漸的發現，其實有些東西寫起來真的很枯燥（因為都是一樣的東西），並且是很容易被漏掉。尤其是當和別的開發者在共同開發的時候， 雙方的認知不同，寫出來的東西就會有差異。 &lt;/p&gt;&lt;p&gt;舉例來說，當Server接受到 Client的Request，做了一些處理，處理完了，要返回View並且顯示一些回饋訊息給使用著的時候，如果沒有一個共通的方法，每一個人的寫法都會不一樣。 &lt;/p&gt;&lt;p&gt;開發者A或許會用ViewBag作為訊息的載體，而開發者B則會用TempData。而在顯示方面2個人也許也會不一樣，開發者A或許用簡單的alert而開發者B或許會用其他第三方插件。 &lt;/p&gt;&lt;p&gt;或許定義一個開發文件的話可以減少上面提到的問題，但是在實務上面，很難同時讓文件和開發習慣同步。換句話說，在專案啟動的時候或許大家還能夠遵守，但是 漸漸的，就沒有人去看開發文件或者更新開發文件的內容以符合目前的開發習慣。 &lt;/p&gt;&lt;p&gt;那麼怎麼解決這個問題呢（或者減少這種問題）？如何讓開發團隊（或者就算開發著只有自己）能夠不在關注於那些很繁瑣但是又重要的細節的情況下， 又不會漏掉這些必做的小細節呢？答案就是&lt;em&gt;建立一個適合團隊（或者自己）的開發框架（Framework）&lt;/em&gt; &lt;/p&gt;&lt;h1 id="WizKMOutline_1411403456163913"&gt;什麽是框架（Framework）？&lt;/h1&gt;&lt;div class="bs-callout bs-callout-info"&gt;這個問題其實我自己沒有太深入的去研究過，因此只能夠屬於我自己的想法，如果有誤，歡迎指正。 &lt;/div&gt;&lt;p&gt;當我們把一些常用的功能抽出來，它就變成了一個library或者通用行的Utility Method。例如，一個發送email的library，或者一個用來寫log的library。 &lt;/p&gt;&lt;p&gt;當我們把這些library組裝起來，讓他們能夠各司其職又能夠無縫使用，並且想要客制的時候就能夠客制，這就是框架。 &lt;/p&gt;&lt;p&gt;換句話說，以樂高的角度來看，library就是每一塊的積木，堆疊出來就是框架。那和樂高一樣，最後疊出來的東西是最符合你的需求和環境使用。 &lt;/p&gt;&lt;p&gt;框架還有一個很重要的特性就是Mvc常說的：&lt;em&gt;Convention Over Configuration （習慣取代設定）&lt;/em&gt; &lt;/p&gt;&lt;p&gt;最典型的就是Mvc裡面的&lt;code&gt;Return View()&lt;/code&gt;。在不給任何view name的情況下，會使用和Action名字一樣。但是，如果你要自己選則View，也可以。 &lt;/p&gt;&lt;p&gt;因此，簡單來說，打造一個框架，讓大家有一致的習慣來寫程式，減少互相的不同。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411403456163647"&gt;Asp .Net Mvc 問題在那裡？&lt;/h1&gt;&lt;p&gt;其實Mvc真的是一個很容易開發的框架，但是因為它的設計理念是給任意類型的網站使用，因此他只有做到最少的部份。 &lt;/p&gt;&lt;p&gt;因此像一些常用的東西，例如logging他就不會做在裡面（也不需要做在裡面），而是讓我們自由發揮。通常這些通用行的東西每一個專案都差不多，每一次都要重複copy and paste其實是很浪費時間而且整體使用上面又不是很方便。因此，以Mvc為基準在往上蓋一層我們自己常用的東西，那麼我們開發速度就會快很多。 &lt;/p&gt;&lt;h1 id="WizKMOutline_1411403456163515"&gt;適合什麽樣的人看？&lt;/h1&gt;&lt;p&gt;這系列只要對於Mvc開發有興趣的都可以看看。但是不會介紹Mvc的基礎（會介紹一些提到的其他概念的基礎，例如IoC），因此至少對於Mvc要有基本的認識。 下面是一個我之前做過介紹Mvc的Slide，如果裡面內容都大概了解，那麼這系列的內容看起來不會有問題。 &lt;/p&gt;&lt;div&gt;&lt;iframe src="//www.slideshare.net/slideshow/embed_code/37067074" width="597" height="486" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen&gt; &lt;/iframe&gt; &lt;div style="margin-bottom:5px"&gt;&lt;strong&gt; &lt;a href="https://www.slideshare.net/alantsai2007/aspnet-mvc-37067074" title="Asp.net mvc 概觀介紹" target="_blank"&gt;Asp.net mvc 概觀介紹&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href="http://www.slideshare.net/alantsai2007" target="_blank"&gt;Alan Tsai&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/div&gt;&lt;h1 id="WizKMOutline_1411403456163657"&gt;其他注意事項&lt;/h1&gt;&lt;p&gt;這系列其實很多部份都是可以獨立拆出來使用，適合我的框架不一定適合你。因此，應該要針對你們的習慣來微調甚至是完全翻掉我所介紹的內容。 &lt;/p&gt;&lt;p&gt;正常情況下，屬於框架部份應該要拆出來成為別的Library Project，但是爲了簡單Demo，這裡面的範例就不會在拆project，但是在實務上要，這樣才能夠通用於不同案子。 &lt;/p&gt;&lt;p&gt;我的程式碼大部份都是出自於網路，很少是（但是還是有）我完全從無到要自己想出來的內容。我頂多是把蒐集到的東西整合， 或者使用別人的Idea在重寫適合我情況的程式碼。因此，假設我還找得到的話，我會儘量放上原始的reference作為參考。 &lt;/p&gt;&lt;p&gt;我這個框架參考了很多Matt Honeycutt的&lt;a href="https://github.com/MattHoneycutt/Fail-Tracker"&gt;Fail-Tracker(Github)&lt;/a&gt; 專案，他有在一個研討會講過 &lt;a href="https://www.youtube.com/watch?v=fTGCKsCL4wg"&gt;Build Your Own Application Framework with ASP.NET MVC 3 (Youtube)&lt;/a&gt;， 有興趣的可以看看他的source code和演講。 &lt;/p&gt;&lt;p&gt;最後，希望大家有任何指教都不要客氣，並且讀完都有收穫。&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='http://blog.alantsai.net/feeds/2923252187346622344/comments/default' title='張貼留言'/><link rel='replies' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-01-intro.html#comment-form' title='0 個意見'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2923252187346622344'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/posts/default/2923252187346622344'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-01-intro.html' title='[iThome 第七屆鐵人賽 01] 開篇'/><author><name>Alan Tsai</name><uri>https://plus.google.com/100603753670492098693</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-5039193888290858189</id><published>2015-01-21T17:38:43.310+08:00</published><updated>2015-01-21T17:38:43.310+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>想說投影片內容也太眼熟了吧
結果發現我之前有google到耶~而且還有加入我的最愛清單喔~
完全沒注...</title><content type='html'>想說投影片內容也太眼熟了吧&lt;br /&gt;結果發現我之前有google到耶~而且還有加入我的最愛清單喔~&lt;br /&gt;完全沒注意過作者的名字&lt;br /&gt;沒想到你就是本人XD&lt;br /&gt;寫得好啊~~~</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1649429406173317211/comments/default/5039193888290858189'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1649429406173317211/comments/default/5039193888290858189'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/12/entity-framework-database.html?showComment=1421833123310#c5039193888290858189' title=''/><author><name>Vita Wang</name><uri>https://www.blogger.com/profile/00245700888306746430</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/12/entity-framework-database.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1649429406173317211' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1649429406173317211' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-442528419'/><gd:extendedProperty name='blogger.displayTime' value='2015年1月21日 下午5:38'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3215179508368261791</id><published>2016-08-14T15:11:24.813+08:00</published><updated>2016-08-14T15:11:24.813+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>CreateViewModelToDatabase 吃的是 var entity = AutoMap...</title><content type='html'>CreateViewModelToDatabase 吃的是 var entity = AutoMapper.Mapper.Map(viewModel);&lt;br /&gt; &lt;br /&gt;        db.Repository().Create(entity );&lt;br /&gt;&lt;br /&gt;不是ViewModel</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/2726509402513752344/comments/default/3215179508368261791'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/2726509402513752344/comments/default/3215179508368261791'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html?showComment=1471158684813#c3215179508368261791' title=''/><author><name>承翰楊</name><uri>https://www.blogger.com/profile/01204999900519853520</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-2726509402513752344' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/2726509402513752344' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1771755827'/><gd:extendedProperty name='blogger.displayTime' value='2016年8月14日 下午3:11'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-7770537618231000755</id><published>2016-08-17T01:43:13.203+08:00</published><updated>2016-08-17T01:43:13.203+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>谢谢，很有帮助。</title><content type='html'>谢谢，很有帮助。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/7770537618231000755'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/7770537618231000755'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1471369393203#c7770537618231000755' title=''/><author><name>陈卓</name><uri>https://www.blogger.com/profile/02734274018331922520</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-3QCi5lCp4WI/AAAAAAAAAAI/AAAAAAAAAGU/HImgMUiQOew/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-989986940'/><gd:extendedProperty name='blogger.displayTime' value='2016年8月17日 上午1:43'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8498461087402475914</id><published>2016-08-26T12:56:32.794+08:00</published><updated>2016-08-26T12:56:32.794+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>如果有什麼不清楚的地方，歡迎問我哦</title><content type='html'>如果有什麼不清楚的地方，歡迎問我哦</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8498461087402475914'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8498461087402475914'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1472187392794#c8498461087402475914' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/7770537618231000755'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2016年8月26日 下午12:56'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2851377704433114263</id><published>2016-08-26T13:01:35.801+08:00</published><updated>2016-08-26T13:01:35.801+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>實際儲存到db的一定會是entity，因為這邊使用的是entityframework 作為儲存層

...</title><content type='html'>實際儲存到db的一定會是entity，因為這邊使用的是entityframework 作為儲存層&lt;br /&gt;&lt;br /&gt;但是這個方法其實接的參數是ViewModel然後透過autommaper轉成Entity&lt;br /&gt;&lt;br /&gt;假設今天底層不想使用 entity framework，我外層不需要調整 - 因為外層傳入的是view model</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/2726509402513752344/comments/default/2851377704433114263'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/2726509402513752344/comments/default/2851377704433114263'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html?showComment=1472187695801#c2851377704433114263' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/2726509402513752344/comments/default/3215179508368261791'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-14-service-basicCRUD.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-2726509402513752344' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/2726509402513752344' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2016年8月26日 下午1:01'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3141902328201925658</id><published>2016-08-26T13:08:21.519+08:00</published><updated>2016-08-26T13:08:21.519+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>雖然說過了一年多才發現你的留言實在是Orz - 沒想到我的部落格會有人留言

有空多來逛逛 - 說不...</title><content type='html'>雖然說過了一年多才發現你的留言實在是Orz - 沒想到我的部落格會有人留言&lt;br /&gt;&lt;br /&gt;有空多來逛逛 - 說不定會看到一些有用的內容 - 雖然說目前也沒很多內容，更新也不穩定OTZ&lt;br /&gt;&lt;br /&gt;謝謝啦</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1649429406173317211/comments/default/3141902328201925658'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1649429406173317211/comments/default/3141902328201925658'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/12/entity-framework-database.html?showComment=1472188101519#c3141902328201925658' title=''/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/12/entity-framework-database.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1649429406173317211' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1649429406173317211' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2016年8月26日 下午1:08'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8180024957747210978</id><published>2016-11-12T23:17:02.517+08:00</published><updated>2016-11-12T23:17:02.517+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>您好~
請問這系列的文章有程式碼可以參考嗎?</title><content type='html'>您好~&lt;br /&gt;請問這系列的文章有程式碼可以參考嗎?</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/8180024957747210978'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/8180024957747210978'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html?showComment=1478963822517#c8180024957747210978' title=''/><author><name>kevin</name><uri>https://www.blogger.com/profile/04076999792473512254</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-4046521654443336552' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/4046521654443336552' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-518175010'/><gd:extendedProperty name='blogger.displayTime' value='2016年11月12日 下午11:17'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-11002508213666827</id><published>2016-11-13T08:04:16.915+08:00</published><updated>2016-11-13T08:04:16.915+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>您好，因為時間的關係，這個系列我一直沒有時間做一個整理
不過，我有個同事有整理一套 - 您可以參考看...</title><content type='html'>您好，因為時間的關係，這個系列我一直沒有時間做一個整理&lt;br /&gt;不過，我有個同事有整理一套 - 您可以參考看看&lt;br /&gt;&lt;br /&gt;https://github.com/matsurigoto/mvc-base-project&lt;br /&gt;&lt;br /&gt;如果有任何問題，也歡迎交流</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/11002508213666827'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/11002508213666827'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html?showComment=1478995456915#c11002508213666827' title=''/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-4046521654443336552' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/4046521654443336552' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2016年11月13日 上午8:04'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1901214675524216161</id><published>2016-11-14T22:34:24.893+08:00</published><updated>2016-11-14T22:34:24.893+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>感謝Alan的分享，有問題再跟你請教~^^</title><content type='html'>感謝Alan的分享，有問題再跟你請教~^^</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/1901214675524216161'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/1901214675524216161'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html?showComment=1479134064893#c1901214675524216161' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/4046521654443336552/comments/default/11002508213666827'/><author><name>kevin</name><uri>https://www.blogger.com/profile/04076999792473512254</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-05-LogLibrary.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-4046521654443336552' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/4046521654443336552' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-518175010'/><gd:extendedProperty name='blogger.displayTime' value='2016年11月14日 下午10:34'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3722749374698905781</id><published>2016-12-21T23:36:05.941+08:00</published><updated>2016-12-21T23:36:05.941+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>想跟您請教一下  EFUnitOfWork 裡面的「public void Dispose()」什麼...</title><content type='html'>想跟您請教一下  EFUnitOfWork 裡面的「public void Dispose()」什麼時候才會被觸發!!&lt;br /&gt;我知道 Controller 有 override Dispose 就能 自動觸發，但在 EFUnitOfWork 什麼時候才會被觸發??&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3722749374698905781'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3722749374698905781'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1482334565941#c3722749374698905781' title=''/><author><name>人生七劃</name><uri>https://www.blogger.com/profile/08347168078759372212</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//3.bp.blogspot.com/-eCyeeLbL4dU/VdbRZFlyWgI/AAAAAAAABU4/O5eYi6V7zjw/s32/cover.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-701701674'/><gd:extendedProperty name='blogger.displayTime' value='2016年12月21日 下午11:36'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3627208701653730503</id><published>2016-12-22T18:48:12.482+08:00</published><updated>2016-12-22T18:48:12.482+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>對於您的問題，答案是，沒有人呼叫，就永遠不會被呼叫

Dispose這個方法在.net 裡面屬於 手...</title><content type='html'>對於您的問題，答案是，沒有人呼叫，就永遠不會被呼叫&lt;br /&gt;&lt;br /&gt;Dispose這個方法在.net 裡面屬於 手動呼叫 （Explicit）的資源清理方法 - 換句話說，如果沒有人呼叫的話，.Net Runtime是不會執行的 - 所以，都建議用 using方式來new，會自動清理。&lt;br /&gt;&lt;br /&gt;有另外一種會被.net runtime自動呼叫(Implicit)的資源清理方式，就是所謂的Finalizer（以前稱為Destructor） - 不過這種主要用來設定清理 unmange 的程式代碼&lt;br /&gt;&lt;br /&gt;原則上，如果你是手動呼叫 EFUnitOfWork，那麼呼叫方式都是建議 類似 using(var uow = new EFUnitOfWork()) - 如果有用DI呼叫，看是什麼，想Autofac會自動呼叫Dispose&lt;br /&gt;&lt;br /&gt;SO上面有很多相關問題的討論，可以參考&lt;br /&gt;&lt;br /&gt;http://stackoverflow.com/questions/2871888/dispose-when-is-it-called&lt;br /&gt;http://stackoverflow.com/questions/732864/finalize-vs-dispose&lt;br /&gt;&lt;br /&gt;希望有回答到你的問題&lt;br /&gt;&lt;br /&gt;謝謝</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3627208701653730503'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3627208701653730503'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1482403692482#c3627208701653730503' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3722749374698905781'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2016年12月22日 下午6:48'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3564829627744114202</id><published>2017-04-03T22:17:51.737+08:00</published><updated>2017-04-03T22:17:51.737+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>離線 12.7GB？ 家用小水管 5M ADSL 要抓多久啊？
這線上安裝可以暫停裝一半關機明天再繼...</title><content type='html'>離線 12.7GB？ 家用小水管 5M ADSL 要抓多久啊？&lt;br /&gt;這線上安裝可以暫停裝一半關機明天再繼續安裝嗎？&lt;br /&gt;VS 2017 該不會是有史以來最失敗的版本？沒有提供 ISO 檔給公司海量人員安裝？還要自己手動整合離線版？</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/3564829627744114202'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/3564829627744114202'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1491229071737#c3564829627744114202' title=''/><author><name>大記事記大翅</name><uri>https://www.blogger.com/profile/10180569531349859923</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-525343048'/><gd:extendedProperty name='blogger.displayTime' value='2017年4月3日 下午10:17'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8917035959880499673</id><published>2017-04-04T16:41:58.142+08:00</published><updated>2017-04-04T16:41:58.142+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>我不太清楚會需要下載多久 - 基本上我就是開著讓他下然後就沒有理他
如果沒有辦法一直開著下也沒關係，...</title><content type='html'>我不太清楚會需要下載多久 - 基本上我就是開著讓他下然後就沒有理他&lt;br /&gt;如果沒有辦法一直開著下也沒關係，隨時可以停掉，然後要在下載的時候在執行同樣的指令就好了 - 它會自動判別那些需要下載/更新&lt;br /&gt;或者說用componentId方式只下載特定功能 - 舉例來說，如果只用VS來做web開發，那其實Xamarin（手機開發）完全可以不需要（那個比較大因為有手機VM模擬器）&lt;br /&gt;&lt;br /&gt;我個人覺得現在改成這種模式主要原因是更新速度 - 以前開發其實都是很久一次大更新，所以釋放ISO還okay，但是現在都講究敏捷開發，迭代更新速度很快，假設每更新一個模組功能就要重新包一個iso太花時間版本也會很多，乾脆就給大家一個網路下載器，隨時可以更新&lt;br /&gt;可以看到這種趨勢，從VS 2015建議就是這種模式了（VS 2013不確定是不是也是） - 雖然2015也有ISO - 但是那個ISO其實沒有網路下載那種模式來的全面（換句話說2015 ISO其實也沒有包含所有功能，有些功能也是要網路下載）</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/8917035959880499673'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/8917035959880499673'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1491295318142#c8917035959880499673' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/3564829627744114202'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年4月4日 下午4:41'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6877076957904746876</id><published>2017-06-13T12:13:41.313+08:00</published><updated>2017-06-13T12:13:41.313+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>沒有提供ISO可以接受, 但是那麽多workload, 不給一個選擇界面, 抓哪個全靠參數簡直要老命...</title><content type='html'>沒有提供ISO可以接受, 但是那麽多workload, 不給一個選擇界面, 抓哪個全靠參數簡直要老命了.&lt;br /&gt;雖然安裝的時候還有選項可以選擇, 但是下載這部分沒有界面真的是太不人性化.&lt;br /&gt;要是下載只下載一個database, 然後通過安裝頁面點選具體下載哪些内容, 對於個人用戶體驗要好很多.</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/6877076957904746876'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/6877076957904746876'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1497327221313#c6877076957904746876' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/3564829627744114202'/><author><name>ThisIsATestString</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1019383617'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月13日 下午12:13'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6785949671244111291</id><published>2017-06-13T22:28:58.667+08:00</published><updated>2017-06-13T22:28:58.667+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>如果有個gui能夠產生指令的確會比較方便
不過如果只是抓大功能的workload id的話其實也還好...</title><content type='html'>如果有個gui能夠產生指令的確會比較方便&lt;br /&gt;不過如果只是抓大功能的workload id的話其實也還好啦 - 就是要找一下，小麻煩&lt;br /&gt;假設空間夠還是全部抓下來比較方便</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/6785949671244111291'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/6785949671244111291'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1497364138667#c6785949671244111291' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/3564829627744114202'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月13日 下午10:28'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3419922423450708082</id><published>2017-06-21T16:04:25.212+08:00</published><updated>2017-06-21T16:04:25.212+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>對剛接觸的新手實用性很大阿，之前就有遇過別的組員說要整理一下名稱後，就找不到自己檔案的情況呢</title><content type='html'>對剛接觸的新手實用性很大阿，之前就有遇過別的組員說要整理一下名稱後，就找不到自己檔案的情況呢</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6120019698755413264/comments/default/3419922423450708082'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6120019698755413264/comments/default/3419922423450708082'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html?showComment=1498032265212#c3419922423450708082' title=''/><author><name>匿名</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-6120019698755413264' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/6120019698755413264' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-911511049'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月21日 下午4:04'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4850557399252704117</id><published>2017-06-21T18:23:50.499+08:00</published><updated>2017-06-21T18:23:50.499+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>很高興對您有幫助，持續關注，最近還會在放一些git相關內容。</title><content type='html'>很高興對您有幫助，持續關注，最近還會在放一些git相關內容。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6120019698755413264/comments/default/4850557399252704117'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6120019698755413264/comments/default/4850557399252704117'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html?showComment=1498040630499#c4850557399252704117' title=''/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/06/git-properly-rename-file-show-rename-log.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-6120019698755413264' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/6120019698755413264' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月21日 下午6:23'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-9010298303392811522</id><published>2017-06-23T13:06:29.680+08:00</published><updated>2017-06-23T13:06:29.680+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>請教您, 我照做這一系列的文章, 這篇新建MVC專案, 然後是要拷貝前面做的 build.ps1, ...</title><content type='html'>請教您, 我照做這一系列的文章, 這篇新建MVC專案, 然後是要拷貝前面做的 build.ps1, defaut.ps1, 拷貝過來改是嗎?</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/9010298303392811522'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/9010298303392811522'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html?showComment=1498194389680#c9010298303392811522' title=''/><author><name>傑克</name><uri>https://www.blogger.com/profile/08118210352737438666</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh3.googleusercontent.com/-ctFKSnv2AMw/AAAAAAAAAAI/AAAAAAAAACE/srVsSmpFp8c/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1699808065017923606' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1757194648'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月23日 下午1:06'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4373574140302768649</id><published>2017-06-23T13:30:25.135+08:00</published><updated>2017-06-23T14:46:33.902+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>作者已經移除這則留言。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/4373574140302768649'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/4373574140302768649'/><author><name>傑克</name><uri>https://www.blogger.com/profile/08118210352737438666</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh3.googleusercontent.com/-ctFKSnv2AMw/AAAAAAAAAAI/AAAAAAAAACE/srVsSmpFp8c/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1699808065017923606' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-1757194648'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月23日 下午1:30'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4291815107967182258</id><published>2017-06-23T14:42:48.726+08:00</published><updated>2017-06-23T14:42:48.726+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>我試出來了...
是要一個方案裡面,包含
1)Build(專案): 內含default.ps1, b...</title><content type='html'>我試出來了...&lt;br /&gt;是要一個方案裡面,包含&lt;br /&gt;1)Build(專案): 內含default.ps1, build.ps1, 並且安裝NuGet套件:psake&lt;br /&gt;2)MVC(專案)&lt;br /&gt;&lt;br /&gt;不過有新問題, compile還是有錯誤:&lt;br /&gt;-------------------------[Compile]-------------------------&lt;br /&gt;開始建制檔案：C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&lt;br /&gt;Microsoft (R) Build Engine version 14.0.23107.0&lt;br /&gt;Copyright (C) Microsoft Corporation. 著作權所有，並保留一切權利。&lt;br /&gt;&lt;br /&gt;在這個方案中一次建置一個專案。若要啟用平行組建，請加入 &amp;quot;/m&amp;quot; 參數。&lt;br /&gt;已經開始建置於 2017/6/23 14:34:58。&lt;br /&gt;節點 1 (預設目標) 上的專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&amp;quot;。&lt;br /&gt;ValidateSolutionConfiguration:&lt;br /&gt;  建置方案組態 &amp;quot;Release|Any CPU&amp;quot;。&lt;br /&gt;專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&amp;quot; (1) 正在節點 1 (預設目標) 上建置 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS\WebRDS.csproj&amp;quot; (2)。&lt;br /&gt;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS\WebRDS.csproj(1,1): error MSB4041: 專案的預設 XML 命名空間必須是 MSBuild XML 命名空間。如果使用 MSBuild 2003 格式設計專案，請將 xmlns=&amp;quot;http://schemas.m&lt;br /&gt;icrosoft.com/developer/msbuild/2003&amp;quot; 加入至  項目。如果是使用舊版的 1.0 或 1.2 格式設計專案，請將專案轉換為 MSBuild 2003 的格式。&lt;br /&gt;專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS\WebRDS.csproj&amp;quot; (預設目標) 建置完成 -- 失敗。&lt;br /&gt;專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&amp;quot; (1) 正在節點 1 (預設目標) 上建置 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\MyBuildProject\MyBuildProject.csproj&amp;quot; (3)。&lt;br /&gt;GenerateTargetFrameworkMonikerAttribute:&lt;br /&gt;將略過目標 &amp;quot;GenerateTargetFrameworkMonikerAttribute&amp;quot;，因為所有輸出檔對於其輸入檔而言都已更新。&lt;br /&gt;CoreCompile:&lt;br /&gt;將略過目標 &amp;quot;CoreCompile&amp;quot;，因為所有輸出檔對於其輸入檔而言都已更新。&lt;br /&gt;CopyFilesToOutputDirectory:&lt;br /&gt;  正在將檔案從 &amp;quot;obj\Release\MyBuildProject.dll&amp;quot; 複製到 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\.build\temp\MyBuildProject.dll&amp;quot;。&lt;br /&gt;  MyBuildProject -&amp;gt; C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\.build\temp\MyBuildProject.dll&lt;br /&gt;  正在將檔案從 &amp;quot;obj\Release\MyBuildProject.pdb&amp;quot; 複製到 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\.build\temp\MyBuildProject.pdb&amp;quot;。&lt;br /&gt;專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\MyBuildProject\MyBuildProject.csproj&amp;quot; (預設目標) 建置完成。&lt;br /&gt;專案 &amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&amp;quot; (預設目標) 建置完成 -- 失敗。&lt;br /&gt;&lt;br /&gt;建置失敗。&lt;br /&gt;&lt;br /&gt;&amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS.sln&amp;quot; (預設目標) (1) -&amp;gt;&lt;br /&gt;&amp;quot;C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS\WebRDS.csproj&amp;quot; (預設目標) (2) -&amp;gt;&lt;br /&gt;  C:\_0AJ\0_work\zzMyGit\RDS2\1_work\WebRDS\WebRDS\WebRDS.csproj(1,1): error MSB4041: 專案的預設 XML 命名空間必須是 MSBuild XML 命名空間。如果使用 MSBuild 2003 格式設計專案，請將 xmlns=&amp;quot;http://schemas&lt;br /&gt;.microsoft.com/developer/msbuild/2003&amp;quot; 加入至  項目。如果是使用舊版的 1.0 或 1.2 格式設計專案，請將專案轉換為 MSBuild 2003 的格式。&lt;br /&gt;&lt;br /&gt;    0 個警告&lt;br /&gt;    1 個錯誤&lt;br /&gt;&lt;br /&gt;經過時間 00:00:00.86&lt;br /&gt;完成 Compile !&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/4291815107967182258'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/4291815107967182258'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html?showComment=1498200168726#c4291815107967182258' title=''/><author><name>傑克</name><uri>https://www.blogger.com/profile/08118210352737438666</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh3.googleusercontent.com/-ctFKSnv2AMw/AAAAAAAAAAI/AAAAAAAAACE/srVsSmpFp8c/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1699808065017923606' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1757194648'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月23日 下午2:42'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-919391131936354238</id><published>2017-06-25T23:51:42.500+08:00</published><updated>2017-06-25T23:51:42.500+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>您的mvc是 asp .net core的嗎？您的錯誤訊息和這個有點類似 https://githu...</title><content type='html'>您的mvc是 asp .net core的嗎？您的錯誤訊息和這個有點類似 https://github.com/Microsoft/vsts-tasks/issues/3747&lt;br /&gt;如果是，因為目前我還沒在asp .net core上面build過，幫不了您。&lt;br /&gt;如果不是，你可以試試看從github下載我的範例嗎？https://github.com/alantsai-samples/devops-psake/releases/tag/sample%2Fchapter6&lt;br /&gt;您會需要用VS先把他打開，然後還原nuget package（script裡面忘記先restore，所以要手動做）&lt;br /&gt;然後用 powershell呼叫 &lt;br /&gt;\src\BuildProject\build.ps1&lt;br /&gt;看看有沒有成功。&lt;br /&gt;如果有成功（表示script沒有問題，可能是建立出來的專案問題），看是否能夠提供您不能成功的範例程式給我，和您目前使用的VS版本，我幫您試試看</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/919391131936354238'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/919391131936354238'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html?showComment=1498405902500#c919391131936354238' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1699808065017923606/comments/default/4291815107967182258'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2016/12/devopsSeries-buildMvcWebProject.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1699808065017923606' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1699808065017923606' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年6月25日 下午11:51'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6269065268430548096</id><published>2017-07-05T17:13:30.596+08:00</published><updated>2017-07-05T17:13:30.596+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>可以跟您請教個問題
我參考了 http://www.cnblogs.com/JustRun1983/...</title><content type='html'>可以跟您請教個問題&lt;br /&gt;我參考了 http://www.cnblogs.com/JustRun1983/p/3307774.html 這篇文章和您的文章&lt;br /&gt;&lt;br /&gt;關於 Unit of Work 這個類的撰寫我還不是很清楚 我依照您的文章 寫一個&lt;br /&gt;IRepository Repository() 方法 但在EFGenericRepository 出錯找不到這類別&lt;br /&gt;&lt;br /&gt;透過nuget發現要抓 NContext.Extensions.Entity.Framework&lt;br /&gt;本身我自己在學習是使用  EntityFramework version=&amp;quot;6.1.3&amp;quot;&lt;br /&gt;&lt;br /&gt;希望前輩指點&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499246010596#c6269065268430548096' title=''/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月5日 下午5:13'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2303286674486230778</id><published>2017-07-07T00:01:42.183+08:00</published><updated>2017-07-07T00:01:42.183+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>由於提供的錯誤訊息不夠清楚，我還沒有辦法透過描述來了解問題在哪裡。

看是否能夠把你目前有嘗試的專案...</title><content type='html'>由於提供的錯誤訊息不夠清楚，我還沒有辦法透過描述來了解問題在哪裡。&lt;br /&gt;&lt;br /&gt;看是否能夠把你目前有嘗試的專案打包（只需要你嘗試的部分即可 - 可以放到github或者丟個鏈接給我），我直接幫你看看可能會快一些&lt;br /&gt;或者提供一下相關發生位置的錯誤或訊息也可以。&lt;br /&gt;&lt;br /&gt;這個對你幫助應該比較大</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2303286674486230778'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2303286674486230778'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499356902183#c2303286674486230778' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月7日 上午12:01'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2464081640896479757</id><published>2017-07-07T11:54:16.920+08:00</published><updated>2017-07-07T11:54:16.920+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>我將簡單的 Demo 上傳到 Github
https://github.com/Yosheng/M...</title><content type='html'>我將簡單的 Demo 上傳到 Github&lt;br /&gt;https://github.com/Yosheng/MVC-Demo 麻煩前輩指點&lt;br /&gt;&lt;br /&gt;前陣子剛接觸 Spring boot 透過 Java 實作Restful服務對於三層架構不算太陌生&lt;br /&gt;但對於在.NET實現這樣的架構 卻相形見絀 還渴望前輩指點</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2464081640896479757'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2464081640896479757'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499399656920#c2464081640896479757' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月7日 上午11:54'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2333657618059768853</id><published>2017-07-09T11:47:23.110+08:00</published><updated>2017-07-09T11:47:23.110+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>我有送出一個pull request - 說明這邊也貼一下

https://github.com/...</title><content type='html'>我有送出一個pull request - 說明這邊也貼一下&lt;br /&gt;&lt;br /&gt;https://github.com/Yosheng/MVC-Demo/pull/1&lt;br /&gt;&lt;br /&gt;1. 你的範例裡面，實作Repository的叫做 Repository 而不是我之前範例的 EFGenericRepository 所以名稱需要調整&lt;br /&gt;&lt;br /&gt;2. 正常來說，Repository的專案會在所有的dependency裡面最下面的那層（換句話說，大家都會依賴他） - 因此調整Reference的順序&lt;br /&gt;&lt;br /&gt;3. uow並沒有實作IUnitOfWork - 因此增加了這層關係&lt;br /&gt;&lt;br /&gt;4. 增加了一個使用uow的範例&lt;br /&gt;&lt;br /&gt;供你參考</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2333657618059768853'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2333657618059768853'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499572043110#c2333657618059768853' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 上午11:47'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2087594666912783954</id><published>2017-07-09T11:51:20.800+08:00</published><updated>2017-07-09T11:51:20.800+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>謝謝前輩的指點 不勝感激</title><content type='html'>謝謝前輩的指點 不勝感激</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2087594666912783954'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2087594666912783954'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499572280800#c2087594666912783954' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 上午11:51'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4394850774587330130</id><published>2017-07-09T22:47:58.623+08:00</published><updated>2017-07-09T22:47:58.623+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>感謝，辛苦啦 :)</title><content type='html'>感謝，辛苦啦 :)</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/4394850774587330130'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/4394850774587330130'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html?showComment=1499611678623#c4394850774587330130' title=''/><author><name>Duran Hsieh</name><uri>https://www.blogger.com/profile/11107578319408050628</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh4.googleusercontent.com/-yOeNYYh0ovc/AAAAAAAAAAI/AAAAAAAAF-s/Xyt3iNE7lbE/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-708873645690901389' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-864777451'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 下午10:47'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1463327524433842726</id><published>2017-07-09T22:51:59.153+08:00</published><updated>2017-07-09T22:51:59.153+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>你比較辛苦啦 XD</title><content type='html'>你比較辛苦啦 XD</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/1463327524433842726'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/1463327524433842726'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html?showComment=1499611919153#c1463327524433842726' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/4394850774587330130'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-708873645690901389' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 下午10:51'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-374400571131133851</id><published>2017-07-09T22:54:51.447+08:00</published><updated>2017-07-09T22:54:51.447+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>客氣了 - 如果還有問題歡迎在留言給我
也歡迎加入我的粉絲頁和持續關注我的部落格。</title><content type='html'>客氣了 - 如果還有問題歡迎在留言給我&lt;br /&gt;也歡迎加入我的粉絲頁和持續關注我的部落格。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/374400571131133851'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/374400571131133851'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499612091447#c374400571131133851' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 下午10:54'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2086580809310086263</id><published>2017-07-09T23:44:00.900+08:00</published><updated>2017-07-09T23:44:00.900+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>用心到誇張 試圖讓人效仿 666</title><content type='html'>用心到誇張 試圖讓人效仿 666</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/2086580809310086263'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/2086580809310086263'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html?showComment=1499615040900#c2086580809310086263' title=''/><author><name>劉元綸</name><uri>https://www.blogger.com/profile/08652706719043528727</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh3.googleusercontent.com/-RXz7pp_UpkA/AAAAAAAAAAI/AAAAAAAAAAs/r2I59EYrKyY/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-708873645690901389' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1854544296'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月9日 下午11:44'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3539775292181781362</id><published>2017-07-10T07:47:01.212+08:00</published><updated>2017-07-10T07:47:01.212+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>沒有啦 - 其實大家花時間填問卷也是很用心
不能辜負大家的用心
希望如果未來有在給問卷的時候回收率能...</title><content type='html'>沒有啦 - 其實大家花時間填問卷也是很用心&lt;br /&gt;不能辜負大家的用心&lt;br /&gt;希望如果未來有在給問卷的時候回收率能夠在高一些 - 讓我們可以提高整體質量</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/3539775292181781362'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/3539775292181781362'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html?showComment=1499644021212#c3539775292181781362' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/708873645690901389/comments/default/2086580809310086263'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/07/review-study420170624-git-presentation.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-708873645690901389' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/708873645690901389' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月10日 上午7:47'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2666660224741783316</id><published>2017-07-10T15:23:21.488+08:00</published><updated>2017-07-10T15:23:21.488+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>為什麼會是讓 Entity 參照 Repository 而不是 Repository 參照 Enti...</title><content type='html'>為什麼會是讓 Entity 參照 Repository 而不是 Repository 參照 Entity?&lt;br /&gt;三層模式底下 不是先透過 Entity 建立和資料庫之間的關係&lt;br /&gt;再透過 Repository 進行存取嗎? 麻煩前輩指點..&lt;br /&gt;&lt;br /&gt;因為如果讓 Repository 作為最底層感覺怪怪的 Demo中的 Domain 是Entity而不是 Value Object</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2666660224741783316'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/2666660224741783316'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499671401488#c2666660224741783316' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月10日 下午3:23'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-62835127440598864</id><published>2017-07-11T06:42:19.509+08:00</published><updated>2017-07-11T06:42:19.509+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>
補充一下，我上次的描述有點不夠精準

1. Repository嚴格來說不需要參照entity
R...</title><content type='html'>&lt;br /&gt;補充一下，我上次的描述有點不夠精準&lt;br /&gt;&lt;br /&gt;1. Repository嚴格來說不需要參照entity&lt;br /&gt;Repository簡單來想可以理解成為和db某個table溝通的一個管道&lt;br /&gt;Entity代表的是這個db table在物件世界裡面的一個代表&lt;br /&gt;換句話說 Entity是東西本身，而Repository則是取得這個東西的方式&lt;br /&gt;&lt;br /&gt;由於Repository是透過泛型撰寫的關係 - 只需要呼叫這個Repository的“人”（以3層式架構來說，這個人通常是邏輯層）知道這個Repository要呼叫那個entity就好&lt;br /&gt;因此是呼叫Repository的那個人需要參照Repository和Entity。但是Repository和entity兩個之間本身是不需要互相有參照。&lt;br /&gt;&lt;br /&gt;因為只需要呼叫的人知道，我今天要什麼（entity），然後是透過什麼方式（ef的Repository）作為橋樑就好。&lt;br /&gt; &lt;br /&gt;所以Repository會是整個程式的最下面一層 - 因為他已經同等於db連線的概念&lt;br /&gt;（在這個角度來說Entity也會是整個程式的最下面一層，他和Repository應該是平級）&lt;br /&gt;&lt;br /&gt;當然這個的前提是如果使用的方式是用泛型的方式呼叫 - 假設今天不是用泛型的方式呼叫，那麼換句話說每一個entity就會刻一個Repository&lt;br /&gt;在這樣的情況下，Repository會需要知道entity的type（才有辦法刻），因此就會需要參照&lt;br /&gt;&lt;br /&gt;所以這個完全取決於你最後的做法&lt;br /&gt;&lt;br /&gt;2. 延伸到我上次有個commit調整了你的參照&lt;br /&gt;&lt;br /&gt;正常來說，Repository和Entity會寫在同一個專案 - 因為2個基本上組成了 Data Access Layer這一層&lt;br /&gt;不過你的範例程式碼Entity在Domain這一層&lt;br /&gt;然後domain這一層是一個console程式&lt;br /&gt;&lt;br /&gt;從結構上面來說，這個拆解的不夠細，因為會把Data Access Layer （entity）和 邏輯層、UI層（console）混在一起&lt;br /&gt;&lt;br /&gt;造成了，我在console裡面要呼叫範例的時候Domain這個專案要參照Repository（無形中造成Entity 要 參照 Repository的結果）&lt;br /&gt;&lt;br /&gt;我猜測你是在做測試，所以沒有特別提，如果是這種結構，正常來說Entity會是一個獨立的Project，然後Domain會參照Entity和Repository（因為Domain是呼叫的人，還記得第一點提到呼叫的人才需要知道這個關聯關係）&lt;br /&gt;這樣就會發現Entity和Repository其實不需要互相參照&lt;br /&gt;&lt;br /&gt;以上，供你參考</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/62835127440598864'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/62835127440598864'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499726539509#c62835127440598864' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月11日 上午6:42'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-9077072728517800622</id><published>2017-07-11T11:37:17.865+08:00</published><updated>2017-07-11T11:37:17.865+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>demo
├─dal
│  ├─po
│  └─vo
├─service
│  ├─bo
│  ├─...</title><content type='html'>demo&lt;br /&gt;├─dal&lt;br /&gt;│  ├─po&lt;br /&gt;│  └─vo&lt;br /&gt;├─service&lt;br /&gt;│  ├─bo&lt;br /&gt;│  ├─impl&lt;br /&gt;│  └─util&lt;br /&gt;└─web&lt;br /&gt;    ├─para&lt;br /&gt;    └─util&lt;br /&gt;上述是我學習 Spring boot 使用的架構&lt;br /&gt;您所說的 Data Access Layer 相對於我的dal 而po (Persisit Obejct)物件即是存放 entity地方&lt;br /&gt;此外在dal層都會建立 interface 作為repository 提供給 service 進行呼叫&lt;br /&gt;&lt;br /&gt;對應到asp.net這部分我就不太清楚 很多底層的事情都透過spring boot本身的運作機制做掉&lt;br /&gt;好比如依賴注入asp.net依照使用不同的framework有不同做法 拿autoface來說需要寫一個類去實作&lt;br /&gt;&lt;br /&gt;而對於資料存取層 ORM的部分 Asp.net藉由Entity Framework來實作 我選擇使用Code First的方式來完成&lt;br /&gt;所以建立一個 Domain 來存放這些 Entity &lt;br /&gt;就好比在 Spring boot 藉由Hibernate來實作 建立PO來存放Entity道理一樣&lt;br /&gt;&lt;br /&gt;但是在 Repositroy 的部分 我的設想是透過泛型讓所有的 Entity都有自己的Repo並透過繼承的方式 繼承基本的增刪改查功能&lt;br /&gt;藉由這種方式來增加查詢的彈性 因為部分查詢比較複雜就直接寫原生 ado.net去實現&lt;br /&gt;&lt;br /&gt;所以您才會看到我的 Repository參照Domain&lt;br /&gt;也許是我名稱定義不清楚還請前輩指點 我是否將Domain修改為Entity更貼切呢?&lt;br /&gt;&lt;br /&gt;為了實踐低耦合我才將Entity和Repository拆開 方便日後如果不希望選擇Code First只需抽換此層&lt;br /&gt;&lt;br /&gt;程式的進入點 應該是最上層的 Demo (web層 這邊實作MVC架構) 因此我目前應該是還缺乏建立一個 Service&lt;br /&gt;但對於DAL層的設計還請前輩指點 是否我的想法或作法上有缺失?</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/9077072728517800622'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/9077072728517800622'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499744237865#c9077072728517800622' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6269065268430548096'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月11日 上午11:37'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-6971103950892556413</id><published>2017-07-13T07:22:24.670+08:00</published><updated>2017-07-13T07:22:24.670+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>首先先聲明一下，由於我這邊很多的知識來源於我從不同管道學習到的東西，因此很有可能有些是不夠準確或者我...</title><content type='html'>首先先聲明一下，由於我這邊很多的知識來源於我從不同管道學習到的東西，因此很有可能有些是不夠準確或者我描述的不夠好&lt;br /&gt;記得還是保持懷疑的態度，有什麼覺得怪怪我們都能討論看看，畢竟談到架構有時候已經到風格和是不是適合某個情境的情況&lt;br /&gt;&lt;br /&gt;進入正題：&lt;br /&gt;&lt;br /&gt;1. 您列出的結構基本上符合常見的3層式架構，在.net的世界裡面差不多也是如此。&lt;br /&gt;我是沒有接觸過spring boot所以不太了解他的運作模式，因此沒有辦法給您類似的東西能夠參考。&lt;br /&gt;不過您提到的依賴注入的確會透過第三方套件來達成（不過其實寫起來還蠻容易） - 題外話現在很夯的asp .net mvc core 就會內建帶一個依賴注入&lt;br /&gt;&lt;br /&gt;2. 命名的部分 - 一樣我覺得這個是風格和只要一致其實取什麼都好 - 我個人是習慣叫 代表DB的table的class叫Entity（應該是因為EF的關係）&lt;br /&gt;Domain的話比較偏向Service或者系統每個層在溝通之間的Data Transfer Object（DTO）&lt;br /&gt;&lt;br /&gt;3. Repository參照Entity其實沒什麼問題 - 我覺得這個可能是我之前誤導你了 Orz&lt;br /&gt;同我上篇提到，假設你的Repository會在做一些細部的客製化（例如針對某些特定entity再做一些細部的sql tune）- 那麼Repository參照entity沒什麼問題&lt;br /&gt;我那個時候應該是手賤，想說剛好有個console在Domain裡面給你看一下執行效果所以才調整了順序。&lt;br /&gt;&lt;br /&gt;4. 關於使用EF這個事情 - 由於你有提到你可能有複雜邏輯會自行下sql query，那麼或許EF不太適合你。&lt;br /&gt;EF有點重，可以考慮使用一些輕量級的orm（micro orm），例如 Dapper （知名的StackOverflow就是他的創辦人） 就很多人使用。&lt;br /&gt;基本上輕量級的orm和寫sql差不多，差別在於有一些strong type的輔助。有點像是有ado .net的速度，同時又有orm的概念&lt;br /&gt;下面提供幾個鏈接供您參考：&lt;br /&gt;&lt;br /&gt;官方repo：https://github.com/StackExchange/Dapper&lt;br /&gt;黑大寫的介紹：http://blog.darkthread.net/post-2014-05-15-dapper.aspx&lt;br /&gt;&lt;br /&gt;以上有什麼不清楚在和我說</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6971103950892556413'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6971103950892556413'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1499901744670#c6971103950892556413' title=''/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月13日 上午7:22'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8037364009300288159</id><published>2017-07-19T18:30:06.487+08:00</published><updated>2017-07-19T18:30:21.012+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>作者已經移除這則留言。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8037364009300288159'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8037364009300288159'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月19日 下午6:30'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3942649089546477206</id><published>2017-07-19T18:30:35.032+08:00</published><updated>2017-07-19T18:30:35.032+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>前輩提及的 Dapper 我稍微看過 但目前還沒打算深入研究 我想先從EF開始 之後慢慢去嘗試其他的...</title><content type='html'>前輩提及的 Dapper 我稍微看過 但目前還沒打算深入研究 我想先從EF開始 之後慢慢去嘗試其他的ORM框架&lt;br /&gt;經過幾天的思考後我參考下述兩篇文章並修改自己的程式碼，還希望前輩指點&lt;br /&gt;&lt;br /&gt;ASP.NET Web API实践系列02,在MVC4下的一个实例, 包含EF Code First,依赖注入, Bootstrap等&lt;br /&gt;http://www.cnblogs.com/darrenji/p/4049555.html&lt;br /&gt;&lt;br /&gt;這篇文章使用 Unity 作為容器&lt;br /&gt;&lt;br /&gt;Asp.Net MVC+EF+三层架构的完整搭建过程&lt;br /&gt;http://www.cnblogs.com/zzqvq/p/5816091.html&lt;br /&gt;&lt;br /&gt;這篇文章使用 autoface 作為容器&lt;br /&gt;&lt;br /&gt;此外我也參考 ASP.NET MVC 5 網站開發美學 書上所提及使用 Code first 的方法進行開發&lt;br /&gt;但這部份我比較困惑是 好像只有設定 Repository 為起始專案才能正常建立資料庫&lt;br /&gt;倘若設定 Web 為起始專案就無法建立？&lt;br /&gt;&lt;br /&gt;目前我所構思的架構如下&lt;br /&gt;Models -&amp;gt; 存放交換的物件DTO或者VO&lt;br /&gt;Repository -&amp;gt; 比對 DAL層 資料增刪改查的方式 不論使用  Code First or Model First or Database First&lt;br /&gt;  Entity -&amp;gt; 對應到資料表的實體類別&lt;br /&gt;  Common -&amp;gt; 繼承會用到的通用類別&lt;br /&gt;Service -&amp;gt; 比對 BLL層 業務邏輯判斷&lt;br /&gt;Web -&amp;gt; 實現所謂的MVC架構 目前我打算設計成 API輸出和 View輸出都支援 參考 Web API实践系列02&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;碰到的問題是專案之間的參考？不太清楚怎麼設定才能讓 Web 起來的同時 也建立資料庫&lt;br /&gt;&lt;br /&gt;Autofac 不太會使用 我目前建立一個 Container 放在web層 但不知道怎麼注入使用&lt;br /&gt;&lt;br /&gt;最後是我這樣的分層方式 日後我要寫測試類 會不會不容易實做？&lt;br /&gt;&lt;br /&gt;程式碼我依然放在 Github 還請前輩指正&lt;br /&gt;https://github.com/Yosheng/MVC-Demo</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3942649089546477206'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/3942649089546477206'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1500460235032#c3942649089546477206' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6971103950892556413'/><author><name>Jonathan</name><uri>https://www.blogger.com/profile/01844336010345910263</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-656807133'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月19日 下午6:30'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8846040735633248185</id><published>2017-07-23T09:38:22.490+08:00</published><updated>2017-07-23T09:38:22.490+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>code first是在有呼叫到的時候才會觸發建立db - 所以可能你沒用Repository的時候...</title><content type='html'>code first是在有呼叫到的時候才會觸發建立db - 所以可能你沒用Repository的時候完全沒有呼叫到ef所以才沒觸發&lt;br /&gt;&lt;br /&gt;架構的部分沒有太多意見，基本上我自己開起來也差不多是這樣&lt;br /&gt;&lt;br /&gt;關於 DI注入的部分，其實autofac還蠻容易的（應該說每一個DI注入都蠻容易），只需要特別下載一個mvc integration的套件（Autofac.Mvc5）然後在把你的service註冊進去即可&lt;br /&gt;&lt;br /&gt;這個系列我也有介紹過autofac，可以參考：&lt;br /&gt;http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-30-Conclusion.html#WizKMOutline_1414590577032597&lt;br /&gt;&lt;br /&gt;本來在做這個系列要整理一個範例，但是一直沒時間，後來我朋友有用這個系列概念建立一個repo，你也可以參考一下&lt;br /&gt;https://github.com/matsurigoto/mvc-base-project&lt;br /&gt;&lt;br /&gt;以上，如果還有什麼問題，都歡迎在來回復哦</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8846040735633248185'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/8846040735633248185'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html?showComment=1500773902490#c8846040735633248185' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1958344686462714944/comments/default/6971103950892556413'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/10/BuildYourOwnApplicationFrameworkOnMvc-10-UnitOfWork.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1958344686462714944' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1958344686462714944' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年7月23日 上午9:38'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4992276025077256745</id><published>2017-08-17T17:14:28.908+08:00</published><updated>2017-08-17T17:14:28.908+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>請問下載好的c:\vs2017offline\資料夾可以copy到別台電腦去安裝嗎?</title><content type='html'>請問下載好的c:\vs2017offline\資料夾可以copy到別台電腦去安裝嗎?</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4992276025077256745'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4992276025077256745'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1502961268908#c4992276025077256745' title=''/><author><name>peter tsai</name><uri>https://www.blogger.com/profile/03085044427588414186</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-0O-BpAGMPCI/AAAAAAAAAAI/AAAAAAAAAJU/p_0spSw359Q/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1575573969'/><gd:extendedProperty name='blogger.displayTime' value='2017年8月17日 下午5:14'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8376435424840617925</id><published>2017-08-18T09:14:59.071+08:00</published><updated>2017-08-18T09:14:59.071+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>可以的哦 - 基本上copy過去執行就好了
我記得我之前還有把它做成一個iso（比較好copy）然後...</title><content type='html'>可以的哦 - 基本上copy過去執行就好了&lt;br /&gt;我記得我之前還有把它做成一個iso（比較好copy）然後把它mount起來執行也沒問題（不過有點久了也不知道有沒有記錯）</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/8376435424840617925'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/8376435424840617925'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html?showComment=1503018899071#c8376435424840617925' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4992276025077256745'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年8月18日 上午9:14'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2784528184637449933</id><published>2017-08-30T10:17:27.362+08:00</published><updated>2017-08-30T10:17:27.362+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>抓到心得key</title><content type='html'>抓到心得key</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/2784528184637449933'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/2784528184637449933'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html?showComment=1504059447362#c2784528184637449933' title=''/><author><name>路人</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-3430019456418583475' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/3430019456418583475' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-497461712'/><gd:extendedProperty name='blogger.displayTime' value='2017年8月30日 上午10:17'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-2102722216700053045</id><published>2017-09-19T11:53:12.688+08:00</published><updated>2017-09-19T12:05:23.415+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>作者已經移除這則留言。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/2102722216700053045'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/2102722216700053045'/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4992276025077256745'/><author><name>Unknown</name><uri>https://www.blogger.com/profile/12752667870885282138</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-1954364106'/><gd:extendedProperty name='blogger.displayTime' value='2017年9月19日 上午11:53'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-1181650971976469508</id><published>2017-10-17T23:05:51.952+08:00</published><updated>2017-10-17T23:05:51.952+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>這文實在太好了QQ</title><content type='html'>這文實在太好了QQ</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3610367127925014904/comments/default/1181650971976469508'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3610367127925014904/comments/default/1181650971976469508'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html?showComment=1508252751952#c1181650971976469508' title=''/><author><name>zino lin</name><uri>https://www.blogger.com/profile/03602759532081686750</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-3610367127925014904' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/3610367127925014904' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1428739839'/><gd:extendedProperty name='blogger.displayTime' value='2017年10月17日 下午11:05'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8137496599124206255</id><published>2017-10-18T18:37:57.554+08:00</published><updated>2017-10-18T18:37:57.554+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>謝謝您的讚美，很高興有幫助</title><content type='html'>謝謝您的讚美，很高興有幫助</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3610367127925014904/comments/default/8137496599124206255'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3610367127925014904/comments/default/8137496599124206255'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html?showComment=1508323077554#c8137496599124206255' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3610367127925014904/comments/default/1181650971976469508'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-02-ioc-intro.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-3610367127925014904' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/3610367127925014904' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2017年10月18日 下午6:37'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8989080761726673523</id><published>2017-11-29T16:02:24.861+08:00</published><updated>2017-11-29T16:02:24.861+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>您好，這邊文章似乎是基於AutoMapper 4.0的寫法，
但AutoMapper 5.0的語法已...</title><content type='html'>您好，這邊文章似乎是基於AutoMapper 4.0的寫法，&lt;br /&gt;但AutoMapper 5.0的語法已經改變，不知是否有推薦的改寫方式？&lt;br /&gt;&lt;br /&gt;我自己只想到每個ViewModel自行實作ToModel()這種基本作法而已</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6184144553651721180/comments/default/8989080761726673523'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6184144553651721180/comments/default/8989080761726673523'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-08-AutoMapperConfigEasier.html?showComment=1511942544861#c8989080761726673523' title=''/><author><name>匿名</name><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//img1.blogblog.com/img/blank.gif'/></author><thr:in-reply-to href='http://blog.alantsai.net/2014/09/BuildYourOwnApplicationFrameworkOnMvc-08-AutoMapperConfigEasier.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-6184144553651721180' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/6184144553651721180' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1456552970'/><gd:extendedProperty name='blogger.displayTime' value='2017年11月29日 下午4:02'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8853261045978340987</id><published>2018-01-19T16:01:06.563+08:00</published><updated>2018-01-19T16:01:06.563+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>取得台灣股票在計算均線時，可能會發生錯誤
是因為有些日期沒值，變成NA，導致計算錯誤
可以用下列語法...</title><content type='html'>取得台灣股票在計算均線時，可能會發生錯誤&lt;br /&gt;是因為有些日期沒值，變成NA，導致計算錯誤&lt;br /&gt;可以用下列語法移除NA資料&lt;br /&gt;ind &amp;lt;- apply(stock, 1, function(x) all(is.na(x)))&lt;br /&gt;stock &amp;lt;- stock[!ind,]</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6588924631878789539/comments/default/8853261045978340987'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6588924631878789539/comments/default/8853261045978340987'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html?showComment=1516348866563#c8853261045978340987' title=''/><author><name>賴怡君</name><uri>https://www.blogger.com/profile/06474302281246382936</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-X_ni0bbblCI/AAAAAAAAAAI/AAAAAAAAItk/8_ge6rjijC0/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-6588924631878789539' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/6588924631878789539' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-2014381420'/><gd:extendedProperty name='blogger.displayTime' value='2018年1月19日 下午4:01'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3302853802158525120</id><published>2018-01-24T20:39:28.639+08:00</published><updated>2018-01-24T20:39:28.639+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>抱歉回的晚了，最近都沒時間注意部落格
感謝 小賴大大的補充

中間會有NA是因為yahoo那邊資料的...</title><content type='html'>抱歉回的晚了，最近都沒時間注意部落格&lt;br /&gt;感謝 小賴大大的補充&lt;br /&gt;&lt;br /&gt;中間會有NA是因為yahoo那邊資料的問題，所以如果要分析臺股建議還是從台灣的證交所網站parse資料回來&lt;br /&gt;就不會有這個問題。&lt;br /&gt;&lt;br /&gt;如果有機會在和大家介紹。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6588924631878789539/comments/default/3302853802158525120'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6588924631878789539/comments/default/3302853802158525120'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html?showComment=1516797568639#c3302853802158525120' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/6588924631878789539/comments/default/8853261045978340987'/><author><name>Alan Tsai</name><uri>https://www.blogger.com/profile/05823722492933238241</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//lh6.googleusercontent.com/-Qe-SjVpC07I/AAAAAAAAAAI/AAAAAAAAMCs/K8ZQKrqeni8/s32-c/photo.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2018/01/data-science-series-16-r-hello-world-with-stock-analysis-using-quantmod.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-6588924631878789539' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/6588924631878789539' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1648427939'/><gd:extendedProperty name='blogger.displayTime' value='2018年1月24日 下午8:39'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-4390538587091308249</id><published>2018-02-02T17:14:19.038+08:00</published><updated>2018-02-02T17:15:48.289+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>作者已經移除這則留言。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4390538587091308249'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/1965872306512675783/comments/default/4390538587091308249'/><author><name>hotteen ( 蕭金芝-萧金芝 )</name><uri>https://www.blogger.com/profile/00793009643064619762</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//2.bp.blogspot.com/-imDOd1tzTEI/WnNH9CYoOxI/AAAAAAAAOSg/JLSZ41aB93I2Ct4LrajLQHaXbZ0hdl84gCK4BGAYYCw/s32/hsiao.jpg'/></author><thr:in-reply-to href='http://blog.alantsai.net/2017/03/visualstudio2017-offline-install.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-1965872306512675783' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/1965872306512675783' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-1721825461'/><gd:extendedProperty name='blogger.displayTime' value='2018年2月2日 下午5:14'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-8493050395201316366</id><published>2018-03-06T14:38:30.562+08:00</published><updated>2018-03-06T14:41:23.911+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>作者已經移除這則留言。</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/8493050395201316366'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/8493050395201316366'/><author><name>WooLNinesun</name><uri>https://www.blogger.com/profile/16138730541487923876</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-3430019456418583475' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/3430019456418583475' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-1795433312'/><gd:extendedProperty name='blogger.displayTime' value='2018年3月6日 下午2:38'/></entry><entry><id>tag:blogger.com,1999:blog-7924743034677720383.post-3398623423367704053</id><published>2018-03-06T14:41:38.706+08:00</published><updated>2018-03-06T14:41:38.706+08:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>-C 參數是 comment 的意思，說明用途</title><content type='html'>-C 參數是 comment 的意思，說明用途</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/3398623423367704053'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/7924743034677720383/3430019456418583475/comments/default/3398623423367704053'/><link rel='alternate' type='text/html' href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html?showComment=1520318498706#c3398623423367704053' title=''/><author><name>WooLNinesun</name><uri>https://www.blogger.com/profile/16138730541487923876</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35'/></author><thr:in-reply-to href='http://blog.alantsai.net/2015/09/use-ssh-in-windows-for-github.html' ref='tag:blogger.com,1999:blog-7924743034677720383.post-3430019456418583475' source='https://www.blogger.com/feeds/7924743034677720383/posts/default/3430019456418583475' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1795433312'/><gd:extendedProperty name='blogger.displayTime' value='2018年3月6日 下午2:41'/></entry></feed>